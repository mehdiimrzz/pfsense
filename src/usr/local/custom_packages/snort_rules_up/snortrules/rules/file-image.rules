# Copyright 2001-2021 Sourcefire, Inc. All Rights Reserved.
#
# This file contains (i) proprietary rules that were created, tested and certified by
# Sourcefire, Inc. (the "VRT Certified Rules") that are distributed under the VRT
# Certified Rules License Agreement (v 2.0), and (ii) rules that were created by
# Sourcefire and other third parties (the "GPL Rules") that are distributed under the
# GNU General Public License (GPL), v2.
# 
# The VRT Certified Rules are owned by Sourcefire, Inc. The GPL Rules were created
# by Sourcefire and other third parties. The GPL Rules created by Sourcefire are
# owned by Sourcefire, Inc., and the GPL Rules not created by Sourcefire are owned by
# their respective creators. Please see http://www.snort.org/snort/snort-team/ for a
# list of third party owners and their respective copyrights.
# 
# In order to determine what rules are VRT Certified Rules or GPL Rules, please refer
# to the VRT Certified Rules License Agreement (v2.0).
#
#------------------
# FILE-IMAGE RULES
#------------------

# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Foxit Reader parsing JPEG with ConvertToPDF remote code execution attempt"; flow:to_client,established; file_data; content:"4OGdcuHMCA9ford4cPTF3RJkgJ243clA0ZTUqhAJm0ezWXmzZkDqpH6w"; fast_pattern:only; metadata:impact_flag red, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2020-8844; reference:url,www.foxitsoftware.com/support/security-bulletins.php; classtype:attempted-user; sid:55742; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Foxit Reader parsing JPEG with ConvertToPDF remote code execution attempt"; flow:to_server,established; file_data; content:"4OGdcuHMCA9ford4cPTF3RJkgJ243clA0ZTUqhAJm0ezWXmzZkDqpH6w"; fast_pattern:only; metadata:impact_flag red, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2020-8844; reference:url,www.foxitsoftware.com/support/security-bulletins.php; classtype:attempted-user; sid:55741; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI information disclosure attempt"; flow:to_server,established; file_data; content:"|46 00 00 00 EC 08 00 00 00 01 00 00 41 41 41 41 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; fast_pattern:0,23; metadata:policy max-detect-ips drop, service smtp; reference:cve,2019-1439; reference:url,portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1439; classtype:attempted-recon; sid:53242; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI information disclosure attempt"; flow:to_client,established; file_data; content:"|46 00 00 00 EC 08 00 00 00 01 00 00 41 41 41 41 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; fast_pattern:0,23; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-1439; reference:url,portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1439; classtype:attempted-recon; sid:53241; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Photoshop Camera Raw plug-in TIFF image processing buffer underflow attempt"; flow:to_server,established; flowbits:isset,file.tiff; file_data; content:"|00 01 00 00 00 02 00 00 00 00 00|"; content:"|00 00 00 00 48 00 00 00 01 00 00 00 48 00 00 00 01|"; within:75; isdataat:!3,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5679; reference:url,www.adobe.com/support/security/bulletins/apsb12-28.html; classtype:attempted-user; sid:52500; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Photoshop Camera Raw plug-in TIFF image processing buffer underflow attempt"; flow:to_server,established; flowbits:isset,file.tiff; file_data; content:"|00 01 00 00 00 02 00 00 00 00 00|"; content:"|00 00 00 00 48 00 00 00 01 00 00 00 48 00 00 00 01|"; within:75; isdataat:!3,relative; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-5679; reference:url,www.adobe.com/support/security/bulletins/apsb12-28.html; classtype:attempted-user; sid:52499; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Foxit Reader malformed GIF LZW minimum code size memory corruption attempt"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"|00 00 3B 00 3B|"; isdataat:!0,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-2790; classtype:denial-of-service; sid:52399; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Foxit Reader malformed GIF LZW minimum code size memory corruption attempt"; flow:to_server,established; flowbits:isset,file.gif; file_data; content:"|00 00 3B 00 3B|"; isdataat:!0,relative; metadata:policy max-detect-ips drop, service smtp; reference:cve,2015-2790; classtype:denial-of-service; sid:52398; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Imagemagick XBM tranformation information leak attempt"; flow:to_server,established; file_data; content:"_bits"; fast_pattern:only; content:"_width"; content:"_height"; pcre:"/0x[8-F][0-F]{7}/i"; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-16323; classtype:attempted-recon; sid:52312; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Mutiple products libpng extra row heap overflow attempt"; flow:to_server,established; file_data; content:"|00 00 00 01|sRGB|00 AE CE 1C E9|"; depth:13; offset:33; content:"IDAT|78 9C 00|"; within:7; distance:4; fast_pattern; content:"|40|"; within:1; distance:1; content:"|BF 00|"; within:2; distance:1; metadata:policy max-detect-ips drop, service smtp; reference:cve,2010-1205; classtype:attempted-user; sid:52307; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Mutiple products libpng extra row heap overflow attempt"; flow:to_client,established; file_data; content:"|00 00 00 01|sRGB|00 AE CE 1C E9|"; depth:13; offset:33; content:"IDAT|78 9C 00|"; within:7; distance:4; fast_pattern; content:"|40|"; within:1; distance:1; content:"|BF 00|"; within:2; distance:1; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-1205; classtype:attempted-user; sid:52306; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Nokia N95 JPG parsing denial of service attempt"; flow:to_server,established; file_data; content:"|FF D8|"; depth:2; content:"|FF FE|"; distance:0; byte_test:2,>,4000,0,relative; metadata:policy max-detect-ips drop, service smtp; reference:url,www.securityfocus.com/bid/33684/exploit; classtype:attempted-user; sid:51285; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Nokia N95 JPG parsing denial of service attempt"; flow:to_client,established; file_data; content:"|FF D8|"; depth:2; content:"|FF FE|"; distance:0; byte_test:2,>,4000,0,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,www.securityfocus.com/bid/33684/exploit; classtype:attempted-user; sid:51284; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Office PNG tEXt chunk buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"tEXtDescription|00|"; content:"|FF FF|"; within:2; distance:-20; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-1331; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-051; classtype:attempted-user; sid:51206; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Office PNG tEXt chunk buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"tEXtTitle|00|"; content:"|FF FF|"; within:2; distance:-14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2013-1331; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-051; classtype:attempted-user; sid:51205; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Office PNG tEXt chunk buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"tEXtDescription|00|"; content:"|FF FF|"; within:2; distance:-20; metadata:policy max-detect-ips drop, service smtp; reference:cve,2013-1331; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-051; classtype:attempted-user; sid:51204; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Office PNG tEXt chunk buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.png; file_data; content:"tEXtTitle|00|"; content:"|FF FF|"; within:2; distance:-14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-1331; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-051; classtype:attempted-user; sid:51203; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft GDI crafted EMF file information disclosure attempt"; flow:to_server,established; flowbits:isset,file.zip; file_data; content:"PK|01 02 3F 00 14 00 00 00 08 00|"; content:"|04 00 00 DC 4B 00 00 15 00 24 00 00 00 00 00 00 00 20 00 00 00 91 09 00 00|word/media/image1.emf"; within:46; distance:9; content:"|D9 25 4B 7F 37 01 00 00 73 02|"; metadata:policy max-detect-ips drop, service smtp; reference:cve,2019-0961; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2019-0961; classtype:attempted-admin; sid:51161; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft GDI crafted EMF file information disclosure attempt"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"PK|01 02 3F 00 14 00 00 00 08 00|"; content:"|04 00 00 DC 4B 00 00 15 00 24 00 00 00 00 00 00 00 20 00 00 00 91 09 00 00|word/media/image1.emf"; within:46; distance:9; content:"|D9 25 4B 7F 37 01 00 00 73 02|"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-0961; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2019-0961; classtype:attempted-admin; sid:51160; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products JBIG compressed TIFF buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; byte_extract:4,4,offset; byte_test:4,>,0xE00,4; content:"|01 03 00 03 00 00 00 01 87 65 00 00|"; within:80; distance:offset; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-18557; classtype:attempted-user; sid:51097; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products JBIG compressed TIFF buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; byte_extract:4,4,offset; byte_test:4,>,0xE00,4; content:"|01 03 00 03 00 00 00 01 87 65 00 00|"; within:80; distance:offset; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-18557; classtype:attempted-user; sid:51096; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products JBIG compressed TIFF buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; byte_extract:4,4,offset,little; byte_test:4,>,0xE00,4,little; content:"|03 01 03 00 01 00 00 00 65 87 00 00|"; within:80; distance:offset; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-18557; classtype:attempted-user; sid:51095; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products JBIG compressed TIFF buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; byte_extract:4,4,offset,little; byte_test:4,>,0xE00,4,little; content:"|03 01 03 00 01 00 00 00 65 87 00 00|"; within:80; distance:offset; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-18557; classtype:attempted-user; sid:51094; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE GraphicsMagick WMF use after free attempt"; flow:to_server,established; file_data; content:"|01 00 09 00 00 0F 0F 04 00 0F 0F 0F 0F 0F 03 00 00 00 03 00 00 00 00 00|"; depth:24; isdataat:6,relative; isdataat:!7,relative; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-12936; reference:url,hg.code.sf.net/p/graphicsmagick/code/rev/be898b7c97bd; classtype:attempted-user; sid:50986; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE GraphicsMagick WMF use after free attempt"; flow:to_client,established; file_data; content:"|01 00 09 00 00 0F 0F 04 00 0F 0F 0F 0F 0F 03 00 00 00 03 00 00 00 00 00|"; depth:24; isdataat:6,relative; isdataat:!7,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-12936; reference:url,hg.code.sf.net/p/graphicsmagick/code/rev/be898b7c97bd; classtype:attempted-user; sid:50985; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Photoshop CS5 gif file heap corruption attempt"; flow:to_server,established; flowbits:isset,file.gif; file_data; content:"|21 F9 04 08 0A 00 00 00 2C|"; fast_pattern; byte_extract:2,2,img_top_pos,relative,little; byte_math:bytes 2,offset 2,oper +,rvalue img_top_pos,result overflow,relative,endian little; byte_test:2,<,overflow,8,little; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,49106; reference:cve,2011-2131; classtype:attempted-user; sid:50961; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Photoshop CS5 gif file heap corruption attempt"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"|21 F9 04 08 0A 00 00 00 2C|"; fast_pattern; byte_extract:2,2,img_top_pos,relative,little; byte_math:bytes 2,offset 2,oper +,rvalue img_top_pos,result overflow,relative,endian little; byte_test:2,<,overflow,8,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,49106; reference:cve,2011-2131; classtype:attempted-user; sid:50960; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI+ interlaced PNG file parsing heap overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"|89|PNG|0D 0A 1A 0A 00 00 00 0D|IHDR"; byte_test:4,>,59000,0,relative,big; byte_test:4,>,32000,4,relative,big; byte_test:1,>,7,8,relative; content:"|06|"; within:1; distance:9; content:"|01|"; within:1; distance:2; metadata:policy max-detect-ips drop, service smtp; reference:cve,2009-3126; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:50798; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Directshow GIF logical height overflow attempt"; flow:to_client,established; file_data; content:"GIF8"; depth:4; byte_extract:2,8,gif_height,little; content:!"|00 3B|"; within:1000; content:"|2C 00 00|"; within:3; distance:387; byte_test:2,>,gif_height,4,relative,little; content:!"|96 00|"; within:2; distance:6; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3174; classtype:attempted-user; sid:50454; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Directshow GIF logical width overflow attempt"; flow:to_client,established; file_data; content:"GIF8"; depth:4; byte_extract:2,6,gif_width,little; content:!"|00 3B|"; within:1000; content:"|2C 00 00|"; within:3; distance:389; byte_test:2,>,gif_width,2,relative,little; content:!"|96 00|"; within:2; distance:4; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3174; classtype:attempted-user; sid:50453; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat TIFF heap buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.tiff.big; content:"|FF FF FF FF|"; fast_pattern; byte_test:2,=,0x8298,-8,relative,big; byte_test:2,>=,1,-6,relative,big; byte_test:2,<=,0xc,-6,relative,big; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-2966; reference:url,helpx.adobe.com/security/products/reader/apsb17-01.html; classtype:attempted-user; sid:50444; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat TIFF heap buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.tiff.big; content:"|FF FF FF FF|"; fast_pattern; byte_test:2,=,0x8298,-8,relative,big; byte_test:2,>=,1,-6,relative,big; byte_test:2,<=,0xc,-6,relative,big; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2966; reference:url,helpx.adobe.com/security/products/reader/apsb17-01.html; classtype:attempted-user; sid:50443; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat TIFF heap buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.tiff.little; content:"|00 FF FF FF FF|"; fast_pattern; byte_test:2,=,0x8298,-8,relative,little; byte_test:2,>=,1,-6,relative,little; byte_test:2,<=,0xc,-6,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-2966; reference:url,helpx.adobe.com/security/products/reader/apsb17-01.html; classtype:attempted-user; sid:50442; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat TIFF heap buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.tiff.little; content:"|00 FF FF FF FF|"; fast_pattern; byte_test:2,=,0x8298,-8,relative,little; byte_test:2,>=,1,-6,relative,little; byte_test:2,<=,0xc,-6,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2966; reference:url,helpx.adobe.com/security/products/reader/apsb17-01.html; classtype:attempted-user; sid:50441; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat out-of-bounds write attempt"; flow:to_server,established; file_data; content:"|01 DA 00 02 00 04 00 EA 00 02 00 77 7F|wwwwwww|8A 77 FF DA|555555555555555555555555"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2019-7118; reference:url,helpx.adobe.com/security/products/acrobat/apsb19-17.html; classtype:attempted-user; sid:50253; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat out-of-bounds write attempt"; flow:to_client,established; file_data; content:"|01 DA 00 02 00 04 00 EA 00 02 00 77 7F|wwwwwww|8A 77 FF DA|555555555555555555555555"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-7118; reference:url,helpx.adobe.com/security/products/acrobat/apsb19-17.html; classtype:attempted-user; sid:50252; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat out-of-bounds write attempt"; flow:to_server,established; file_data; content:"|F2 FF 2B 00 00 00 00 00 00 03 00 80 02 08 0D 18 75 B9 FD 61 6C 0E 00 2C 00 00 00 20 00 00 03 00 80 36 00 00 00 00 00 02 08 0D 18 75 B9 FD|al"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2019-7120; reference:url,helpx.adobe.com/security/products/acrobat/apsb19-17.html; classtype:attempted-user; sid:50247; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat out-of-bounds write attempt"; flow:to_client,established; file_data; content:"|F2 FF 2B 00 00 00 00 00 00 03 00 80 02 08 0D 18 75 B9 FD 61 6C 0E 00 2C 00 00 00 20 00 00 03 00 80 36 00 00 00 00 00 02 08 0D 18 75 B9 FD|al"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-7120; reference:url,helpx.adobe.com/security/products/acrobat/apsb19-17.html; classtype:attempted-user; sid:50246; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows OLE Load Picture remote code execution attempt"; flow:to_server,established; file_data; content:"|2C 35 14 AF 6C 10 7B 9D AC C1 80 C3 99 89 AD D7 6E C8 CF 2F DB 00 60 5C 8C FF 70 90 3B 42 E1 07 62 3D 87 1E 95 23 E5 16 32 13 09 C0 F2 FA 0A 96|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2019-0885; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2019-0885; classtype:attempted-user; sid:50089; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows OLE Load Picture remote code execution attempt"; flow:to_client,established; file_data; content:"|2C 35 14 AF 6C 10 7B 9D AC C1 80 C3 99 89 AD D7 6E C8 CF 2F DB 00 60 5C 8C FF 70 90 3B 42 E1 07 62 3D 87 1E 95 23 E5 16 32 13 09 C0 F2 FA 0A 96|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-0885; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2019-0885; classtype:attempted-user; sid:50088; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Photoshop CS5 gif file heap corruption attempt"; flow:to_server,established; flowbits:isset,file.gif; file_data; content:"|21 F9 04 08 0A 00 00 00 2C|"; fast_pattern; byte_extract:2,0,img_left_pos,relative,little; byte_math:bytes 2,offset 2,oper +,rvalue img_left_pos,result overflow,relative,endian little; byte_test:2,<,overflow,6,little; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,49106; reference:cve,2011-2131; classtype:attempted-user; sid:49963; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Photoshop CS5 gif file heap corruption attempt"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"|21 F9 04 08 0A 00 00 00 2C|"; fast_pattern; byte_extract:2,0,img_left_pos,relative,little; byte_math:bytes 2,offset 2,oper +,rvalue img_left_pos,result overflow,relative,endian little; byte_test:2,<,overflow,6,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,49106; reference:cve,2011-2131; classtype:attempted-user; sid:49962; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE SketchUp BMP RLE8 parsing buffer overflow attempt"; flow:to_server,established; file_data; content:"BM"; depth:2; content:"|28 00 00 00|"; within:4; distance:12; byte_extract:4,0,bm_width,relative,little; content:"|08 00 01 00 00 00|"; within:6; distance:6; byte_jump:4,10,little,from_beginning; byte_test:1,>,bm_width,0,relative; metadata:service smtp; reference:cve,2013-3663; classtype:attempted-user; sid:49576; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE SketchUp BMP RLE8 parsing buffer overflow attempt"; flow:to_client,established; file_data; content:"BM"; depth:2; content:"|28 00 00 00|"; within:4; distance:12; byte_extract:4,0,bm_width,relative,little; content:"|08 00 01 00 00 00|"; within:6; distance:6; byte_jump:4,10,little,from_beginning; byte_test:1,>,bm_width,0,relative; metadata:service ftp-data, service http, service imap, service pop3; reference:cve,2013-3663; classtype:attempted-user; sid:49575; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat TIFF heap buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.tiff.big; content:"|FF FF FF FF|"; fast_pattern; byte_test:2,>=,0xfe,-8,relative,big; byte_test:2,<=,0x214,-8,relative,big; byte_test:2,>=,1,-6,relative,big; byte_test:2,<=,0xc,-6,relative,big; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-2966; reference:url,helpx.adobe.com/security/products/reader/apsb17-01.html; classtype:attempted-user; sid:49125; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat TIFF heap buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.tiff.big; content:"|FF FF FF FF|"; fast_pattern; byte_test:2,>=,0xfe,-8,relative,big; byte_test:2,<=,0x214,-8,relative,big; byte_test:2,>=,1,-6,relative,big; byte_test:2,<=,0xc,-6,relative,big; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2966; reference:url,helpx.adobe.com/security/products/reader/apsb17-01.html; classtype:attempted-user; sid:49124; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat TIFF heap buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.tiff.little; content:"|00 FF FF FF FF|"; fast_pattern; byte_test:2,>=,0xfe,-8,relative,little; byte_test:2,<=,0x214,-8,relative,little; byte_test:2,>=,1,-6,relative,little; byte_test:2,<=,0xc,-6,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-2966; reference:url,helpx.adobe.com/security/products/reader/apsb17-01.html; classtype:attempted-user; sid:49123; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat TIFF heap buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.tiff.little; content:"|00 FF FF FF FF|"; fast_pattern; byte_test:2,>=,0xfe,-8,relative,little; byte_test:2,<=,0x214,-8,relative,little; byte_test:2,>=,1,-6,relative,little; byte_test:2,<=,0xc,-6,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2966; reference:url,helpx.adobe.com/security/products/reader/apsb17-01.html; classtype:attempted-user; sid:49122; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"FILE-IMAGE Imagemagick XBM tranformation information leak attempt"; flow:to_server,established; file_data; content:"_width"; content:"_height"; content:"_bits"; pcre:"/0x[8-F][0-F]{7}/iP"; metadata:policy max-detect-ips drop, service http; reference:cve,2018-16323; classtype:attempted-recon; sid:48937; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_server,established,only_stream; flowbits:isset,file.tga; file_data; content:"|01 0B|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48936; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_server,established,only_stream; flowbits:isset,file.tga; file_data; content:"|01 0A|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48935; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_server,established,only_stream; flowbits:isset,file.tga; file_data; content:"|01 09|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48934; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_server,established,only_stream; flowbits:isset,file.tga; file_data; content:"|01 03|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48933; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_server,established,only_stream; flowbits:isset,file.tga; file_data; content:"|01 02|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48932; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_server,established,only_stream; flowbits:isset,file.tga; file_data; content:"|01 01|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48931; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_server,established,only_stream; flowbits:isset,file.tga; file_data; content:"|01 00|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48930; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_server,established,only_stream; flowbits:isset,file.tga; file_data; content:"|00 0B|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48929; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_server,established,only_stream; flowbits:isset,file.tga; file_data; content:"|00 0A|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48928; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_server,established,only_stream; flowbits:isset,file.tga; file_data; content:"|00 09|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48927; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_server,established,only_stream; flowbits:isset,file.tga; file_data; content:"|00 03|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48926; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_server,established,only_stream; flowbits:isset,file.tga; file_data; content:"|00 02|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48925; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_server,established,only_stream; flowbits:isset,file.tga; file_data; content:"|00 01|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48924; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_server,established,only_stream; flowbits:isset,file.tga; file_data; content:"|00 00|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48923; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_client,established,only_stream; flowbits:isset,file.tga; file_data; content:"|01 0B|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48922; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_client,established,only_stream; flowbits:isset,file.tga; file_data; content:"|01 0A|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48921; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_client,established,only_stream; flowbits:isset,file.tga; file_data; content:"|01 09|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48920; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_client,established,only_stream; flowbits:isset,file.tga; file_data; content:"|01 03|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48919; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_client,established,only_stream; flowbits:isset,file.tga; file_data; content:"|01 02|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48918; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_client,established,only_stream; flowbits:isset,file.tga; file_data; content:"|01 01|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48917; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_client,established,only_stream; flowbits:isset,file.tga; file_data; content:"|01 00|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48916; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_client,established,only_stream; flowbits:isset,file.tga; file_data; content:"|00 0B|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48915; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_client,established,only_stream; flowbits:isset,file.tga; file_data; content:"|00 0A|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48914; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_client,established,only_stream; flowbits:isset,file.tga; file_data; content:"|00 09|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48913; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_client,established,only_stream; flowbits:isset,file.tga; file_data; content:"|00 03|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48912; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_client,established,only_stream; flowbits:isset,file.tga; file_data; content:"|00 02|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48911; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_client,established,only_stream; flowbits:isset,file.tga; file_data; content:"|00 01|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48910; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro tga file heap overflow attempt"; flow:to_client,established,only_stream; flowbits:isset,file.tga; file_data; content:"|00 00|"; depth:2; offset:1; content:"|00 00|"; depth:2; offset:14; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5045; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48909; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Graphics component WMF code execution attempt"; flow:to_server,established; file_data; content:"|42 C6 D2 F2 13 96 A2 AE CE DA FB 7E 8A 96 B6 D7 5B 7B 9C BC 2B 4C 57 78 98 07 13 34 54 4B 6C EF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-8553; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8553; classtype:attempted-user; sid:48375; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Graphics component WMF code execution attempt"; flow:to_client,established; file_data; content:"|42 C6 D2 F2 13 96 A2 AE CE DA FB 7E 8A 96 B6 D7 5B 7B 9C BC 2B 4C 57 78 98 07 13 34 54 4B 6C EF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-8553; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8553; classtype:attempted-user; sid:48374; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro JPEG Huffman table memory corruption attempt"; flow:to_server,established; file_data; content:"|A7 B7 C7 FF DA 00 0C 03 01 00 02 11 03 11 00 3F 00 E4 92 49 25 A4 E2 A9 24 92 49 4A 49 24 92 52|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-5060; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48220; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro JPEG Huffman table memory corruption attempt"; flow:to_client,established; file_data; content:"|A7 B7 C7 FF DA 00 0C 03 01 00 02 11 03 11 00 3F 00 E4 92 49 25 A4 E2 A9 24 92 49 4A 49 24 92 52|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5060; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48219; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat SGI parsing out of bounds read attempt"; flow:to_server,established,only_stream; file_data; content:"|01 DA|"; depth:2; isdataat:2,relative; content:!"|00|"; within:1; content:!"|01|"; within:1; content:!"|01|"; within:1; distance:1; content:!"|02|"; within:1; distance:1; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-15953; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-recon; sid:48135; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat SGI parsing out of bounds read attempt"; flow:to_client,established,only_stream; file_data; content:"|01 DA|"; depth:2; isdataat:2,relative; content:!"|00|"; within:1; content:!"|01|"; within:1; content:!"|01|"; within:1; distance:1; content:!"|02|"; within:1; distance:1; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-15953; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-recon; sid:48134; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG APP2 marker memory corruption attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF E2|"; byte_test:2,<,16,0,relative; content:"ICC_PROFILE|00 01 01|"; within:16; distance:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-12855; reference:cve,2018-12856; reference:cve,2018-19703; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-41.html; classtype:attempted-user; sid:48044; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG APP2 marker memory corruption attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF E2|"; byte_test:2,<,16,0,relative; content:"ICC_PROFILE|00 01 01|"; within:16; distance:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12855; reference:cve,2018-12856; reference:cve,2018-19703; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-41.html; classtype:attempted-user; sid:48043; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed BMP out of bounds read attempt"; flow:to_server,established; file_data; content:"BM"; depth:2; content:"|00 00 00 00|"; within:4; distance:4; content:"|28 00 00 00|"; within:4; distance:4; content:"|01 00 00 00|"; within:12; distance:12; byte_extract:4,0,ImageSize,relative,little; isdataat:!ImageSize; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5051; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48040; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed BMP out of bounds read attempt"; flow:to_client,established; flowbits:isset,file.bmp; file_data; content:"BM"; depth:2; content:"|00 00 00 00|"; within:4; distance:4; content:"|28 00 00 00|"; within:4; distance:4; content:"|01 00 00 00|"; within:12; distance:12; byte_extract:4,0,ImageSize,relative,little; isdataat:!ImageSize; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5051; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:48039; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF out of bounds read attempt"; flow:to_server,established; file_data; content:"|24 00 00 00 18 00 00 00 00 00 80 3F 00 00 00 00 00 00 00 00 00 00 80 3F 00 F0 8C 44 00 C0 85 44|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-12879; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:48032; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF out of bounds read attempt"; flow:to_client,established; file_data; content:"|24 00 00 00 18 00 00 00 00 00 80 3F 00 00 00 00 00 00 00 00 00 00 80 3F 00 F0 8C 44 00 C0 85 44|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12879; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:48031; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader malformed JavaScript input out of bounds read attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"getAnnots()"; content:".contents"; within:20; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-15922; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:48017; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader malformed JavaScript input out of bounds read attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"getAnnots()"; content:".contents"; within:20; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-15922; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:48016; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro U3D TIFF XResolution out of bounds read attempt"; flow:to_server,established; file_data; content:"MM|00 2A|"; depth:4; content:"|01 1A 00 05 00 00 00 01|"; distance:0; byte_extract:4,0,offset,relative; isdataat:!offset; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-15956; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:48014; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro U3D TIFF XResolution out of bounds read attempt"; flow:to_client,established; file_data; content:"MM|00 2A|"; depth:4; content:"|01 1A 00 05 00 00 00 01|"; distance:0; byte_extract:4,0,offset,relative; isdataat:!offset; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-15956; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:48013; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro U3D TIFF XResolution out of bounds read attempt"; flow:to_server,established; file_data; content:"II|2A 00|"; depth:4; content:"|1A 01 05 00 01 00 00 00|"; distance:0; byte_extract:4,0,offset,relative,little; isdataat:!offset; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-15956; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:48012; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro U3D TIFF XResolution out of bounds read attempt"; flow:to_client,established; file_data; content:"II|2A 00|"; depth:4; content:"|1A 01 05 00 01 00 00 00|"; distance:0; byte_extract:4,0,offset,relative,little; isdataat:!offset; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-15956; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:48011; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro integer overflow attempt"; flow:to_server,established; file_data; content:"|50 00 00 00 B0 03 00 00 00 00 00 80 FF FF FF FF 0C 11 F8 C9 00 00 00 80 24 11 F8 C9 FF FF FF FF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-12881; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:48010; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro integer overflow attempt"; flow:to_client,established; file_data; content:"|50 00 00 00 B0 03 00 00 00 00 00 80 FF FF FF FF 0C 11 F8 C9 00 00 00 80 24 11 F8 C9 FF FF FF FF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12881; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:48009; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro Universal 3D engine untrusted pointer dereference attempt"; flow:to_server,established; file_data; content:"|05 E2 B3 9B 31 30 FC 38 05 10 60 00 41 85 0E 98 00 03 48 89 FA B4 97 01 08 78 9D 19 C0 E0 D3 5E|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-15937; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:48003; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro Universal 3D engine untrusted pointer dereference attempt"; flow:to_client,established; file_data; content:"|05 E2 B3 9B 31 30 FC 38 05 10 60 00 41 85 0E 98 00 03 48 89 FA B4 97 01 08 78 9D 19 C0 E0 D3 5E|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-15937; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:48002; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF pointer out of bounds read attempt"; flow:to_server,established; file_data; content:"|A2 00 F0 D7 99 00 F3 E0 B0 00 F4 E2 B6 00 F5 E4 B9 00 F5 E4 BB 00 F5 E5 BD 00 FA F2 DD 00 FA F3|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-15943; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47998; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF pointer out of bounds read attempt"; flow:to_client,established; file_data; content:"|A2 00 F0 D7 99 00 F3 E0 B0 00 F4 E2 B6 00 F5 E4 B9 00 F5 E4 BB 00 F5 E5 BD 00 FA F2 DD 00 FA F3|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-15943; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47997; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF pointer out of bounds write attempt"; flow:to_server,established; file_data; content:"|01 2F 01 91 05 93 01 2A 02 8C 01 0C 02 93 02 8C 00 07 2F 91 93 23 8C 08 0C 00 03 93 00 04 05 08|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-15944; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47996; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF pointer out of bounds write attempt"; flow:to_client,established; file_data; content:"|01 2F 01 91 05 93 01 2A 02 8C 01 0C 02 93 02 8C 00 07 2F 91 93 23 8C 08 0C 00 03 93 00 04 05 08|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-15944; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47995; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF engine type confusion attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|73 B4 8F 54 09 41 F8 85 30 67 F3 BC 10 4A 28 6E C3 20 01 A0 8C 8A DF 9E 2E 12 40 FC 2C AC 72 4B|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-12876; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47992; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF engine type confusion attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|73 B4 8F 54 09 41 F8 85 30 67 F3 BC 10 4A 28 6E C3 20 01 A0 8C 8A DF 9E 2E 12 40 FC 2C AC 72 4B|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12876; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47991; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF out of bounds read attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|61 38 34 0B 77 38 34 0B 01 00 00 80 00 00 00 7F C5 38 34 0B D0 38 34 0B 00 00 00 80 FF FF 7F FF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-12844; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47982; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF out of bounds read attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|61 38 34 0B 77 38 34 0B 01 00 00 80 00 00 00 7F C5 38 34 0B D0 38 34 0B 00 00 00 80 FF FF 7F FF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12844; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47981; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF out of bounds read attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|92 B3 D3 F4 78 98 B9 D9 5D 7D 9E BE 42 63 83 A4 27 48 68 89 0D 2D 39 59 65 E9 09 2A 4A CE DA FA|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-12843; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47980; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF out of bounds read attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|92 B3 D3 F4 78 98 B9 D9 5D 7D 9E BE 42 63 83 A4 27 48 68 89 0D 2D 39 59 65 E9 09 2A 4A CE DA FA|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12843; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47979; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF out of bounds read attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|AA 57 00 80 BC EC 5E BE 00 90 FF FF 00 80 00 80 F1 E9 B7 69 00 00 40 72 00 80 52 07 FF 7F 96 AA|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-12845; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47972; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF out of bounds read attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|AA 57 00 80 BC EC 5E BE 00 90 FF FF 00 80 00 80 F1 E9 B7 69 00 00 40 72 00 80 52 07 FF 7F 96 AA|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12845; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47971; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIF tag entry out of bounds read attempt"; flow:to_server,established; file_data; content:"|4D 4D 2A 00|"; depth:4; byte_jump:4,0,relative,from_beginning; content:"|01 0A 00 03|"; distance:0; content:!"|00 00 00 01|"; within:4; byte_test:2,>,2,4,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-12867; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47956; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIF tag entry out of bounds read attempt"; flow:to_client,established; file_data; content:"|4D 4D 2A 00|"; depth:4; byte_jump:4,0,relative,from_beginning; content:"|01 0A 00 03|"; distance:0; content:!"|00 00 00 01|"; within:4; byte_test:2,>,2,4,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12867; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47955; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIF tag entry out of bounds read attempt"; flow:to_client,established; file_data; content:"|49 49 2A 00|"; depth:4; byte_jump:4,0,relative,little,from_beginning; content:"|0A 01 03 00|"; distance:0; content:!"|01 00 00 00|"; within:4; byte_test:2,>,2,4,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12867; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47954; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIF tag entry out of bounds read attempt"; flow:to_server,established; file_data; content:"|49 49 2A 00|"; depth:4; byte_jump:4,0,relative,little,from_beginning; content:"|0A 01 03 00|"; distance:0; content:!"|01 00 00 00|"; within:4; byte_test:2,>,2,4,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-12867; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47953; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF out of bounds read attempt"; flow:to_client,established; flowbits:isset,file.emf; content:"|00 20 00 00 00 00 60 40 14 AE DF C0 00 00 00 00 A4 70 7D BF 00 00 60 C0 14 AE DF C0 00 01 01 FF|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-15926; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47950; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF out of bounds read attempt"; flow:to_server,established; flowbits:isset,file.emf; content:"|00 20 00 00 00 00 60 40 14 AE DF C0 00 00 00 00 A4 70 7D BF 00 00 60 C0 14 AE DF C0 00 01 01 FF|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-15926; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47949; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Distiller PostScript stack overflow attempt"; flow:to_server,established; file_data; content:"/ModificationDate"; fast_pattern; content:"(D:"; within:15; isdataat:32,relative; content:!"/"; within:32; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-12838; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47944; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Distiller PostScript stack overflow attempt"; flow:to_client,established; file_data; content:"/ModificationDate"; fast_pattern; content:"(D:"; within:15; isdataat:32,relative; content:!"/"; within:32; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12838; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47943; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat XPS heap overflow attempt"; flow:to_server,established; file_data; content:"|FF D8 FF E0 00 10 4A 46 49 46 00 01 01 01 01 2C FF FF 00 00 FF EE 00 0E 41 64 6F 62 65 00 64 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-12837; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47942; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat XPS heap overflow attempt"; flow:to_client,established; file_data; content:"|FF D8 FF E0 00 10 4A 46 49 46 00 01 01 01 01 2C FF FF 00 00 FF EE 00 0E 41 64 6F 62 65 00 64 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12837; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47941; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF+ GIF parsing out of bounds read attempt"; flow:to_server,established; file_data; content:"|B4 00 F4 00 00 07 FF 80 07 12 44 14 85 86 14 0B 0B 15 8B 0D 8D 11 05 05 44 36 07 94 94 3C 97 98|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-12834; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-recon; sid:47940; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF+ GIF parsing out of bounds read attempt"; flow:to_client,established; file_data; content:"|B4 00 F4 00 00 07 FF 80 07 12 44 14 85 86 14 0B 0B 15 8B 0D 8D 11 05 05 44 36 07 94 94 3C 97 98|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12834; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-recon; sid:47939; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro Universal 3D Engine untrusted pointer dereference attempt"; flow:to_server,established; file_data; content:"|5E 62 8D 5C 9D C5 F2 58 83 18 A7 C3 AB 25 F5 B8 67 80 8A DC 0B 00 C0 23 2B 06 00 40 6E CC 70 61|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-15931; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47933; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro Universal 3D Engine untrusted pointer dereference attempt"; flow:to_client,established; file_data; content:"|5E 62 8D 5C 9D C5 F2 58 83 18 A7 C3 AB 25 F5 B8 67 80 8A DC 0B 00 C0 23 2B 06 00 40 6E CC 70 61|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-15931; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47932; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader EMF file JPEG Huffman table heap overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.emf; content:"|10 00 02 01 03 FA 01 03 03 02 03 03 03 02 06 09 75 01 02 03 04 11 05 12 06 21 07 07 07 07 07 07|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-12785; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47912; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader EMF file JPEG Huffman table heap overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.emf; content:"|10 00 02 01 03 FA 01 03 03 02 03 03 03 02 06 09 75 01 02 03 04 11 05 12 06 21 07 07 07 07 07 07|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12785; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47911; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMR_STRETCHDIBITS out-of-bounds write attempt"; flow:to_server,established; file_data; flowbits:isset,file.emf; content:"|51 00 00 00|"; fast_pattern; byte_test:1,>,0x7F,39,relative; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-12787; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47910; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMR_STRETCHDIBITS out-of-bounds write attempt"; flow:to_client,established; file_data; flowbits:isset,file.emf; content:"|51 00 00 00|"; fast_pattern; byte_test:1,>,0x7F,39,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12787; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47909; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMR_STRETCHDIBITS out-of-bounds write attempt"; flow:to_server,established; file_data; flowbits:isset,file.emf; content:"|51 00 00 00|"; fast_pattern; byte_test:1,>,0x7F,43,relative; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-12787; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47908; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMR_STRETCHDIBITS out-of-bounds write attempt"; flow:to_client,established; file_data; flowbits:isset,file.emf; content:"|51 00 00 00|"; fast_pattern; byte_test:1,>,0x7F,43,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12787; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47907; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMFPlusPath object out of bounds read attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"EMF+|2B 40|"; content:"|0C 00 00 00|"; within:6; distance:2; content:"|15 40|"; within:250; content:!"|00 00|"; within:2; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12795; reference:cve,2018-16014; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-41.html; classtype:attempted-user; sid:47892; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMFPlusPath object out of bounds read attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"EMF+|2B 40|"; content:"|0C 00 00 00|"; within:6; distance:2; content:"|15 40|"; content:!"|00 00|"; within:2; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-12795; reference:cve,2018-16014; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-41.html; classtype:attempted-user; sid:47891; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF ALPHABLEND heap overflow attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|72 00 00 00|"; byte_test:1,!&,128,23,relative; content:"|00 00|"; within:2; distance:30; content:"|00 00|"; within:2; distance:6; byte_test:1,&,128,3,relative; content:!"|00 00|"; within:2; distance:58; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-12788; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47875; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF ALPHABLEND heap overflow attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|72 00 00 00|"; byte_test:1,!&,128,23,relative; content:"|00 00|"; within:2; distance:30; content:"|00 00|"; within:2; distance:6; byte_test:1,&,128,3,relative; content:!"|00 00|"; within:2; distance:58; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12788; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47874; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file object out of bounds write attempt"; flow:to_client,established; flowbits:isset,file.emf; content:"|05 00 00 00 4C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF FF FF FF FF FF FF FD 58 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12848; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-34.html; classtype:attempted-user; sid:47857; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file object out of bounds write attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|05 00 00 00 4C 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF FF FF FF FF FF FF FD 58 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-12848; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-34.html; classtype:attempted-user; sid:47856; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro SGI RGB run-length encoding out of bounds read attempt"; flow:to_client,established; file_data; content:"|00 06 00 82 05 03 06 00 9A 02 03 06 08 09 08 06 04 01 00 01 04 07 0A 0E 11 12 14 12 12 14 18 1C|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5054; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47839; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro SGI RGB run-length encoding out of bounds read attempt"; flow:to_server,established; file_data; content:"|00 06 00 82 05 03 06 00 9A 02 03 06 08 09 08 06 04 01 00 01 04 07 0A 0E 11 12 14 12 12 14 18 1C|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5054; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47838; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat EmfPlusDrawImagePoints out of bounds read attempt"; flow:to_server,established; file_data; content:"|1B 40 03 40 34 00 00 00 28 00 00 00 FF FF FF FF 02 00 00 00 00 00 00 BF 00 00 00 BF 00 00 90 41|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-5035; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47828; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat EmfPlusDrawImagePoints out of bounds read attempt"; flow:to_client,established; file_data; content:"|1B 40 03 40 34 00 00 00 28 00 00 00 FF FF FF FF 02 00 00 00 00 00 00 BF 00 00 00 BF 00 00 90 41|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5035; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47827; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows malformed TIFF remote code execution attempt"; flow:to_server,established; file_data; flowbits:isset,file.tiff; content:"|00 16 01 03 00 01 00 00 00 E8 03 00 00 1C 01 03 00 01 00 00 00 02 00 00 00 17 01 04 00 03 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-8475; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8475; classtype:attempted-user; sid:47765; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows malformed TIFF remote code execution attempt"; flow:to_client,established; file_data; flowbits:isset,file.tiff; content:"|00 16 01 03 00 01 00 00 00 E8 03 00 00 1C 01 03 00 01 00 00 00 02 00 00 00 17 01 04 00 03 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-8475; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8475; classtype:attempted-user; sid:47764; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader malformed JPEG quantization table out-of-bounds write attempt"; flow:to_server,established; file_data; content:"|A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 8C C8 FF CB DA EE F5 FF FF FF 9B C1 FF F8 F8 F8 F8 F8 F8 F8|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-5069; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47397; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader malformed JPEG quantization table out-of-bounds write attempt"; flow:to_client,established; file_data; content:"|A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 A1 8C C8 FF CB DA EE F5 FF FF FF 9B C1 FF F8 F8 F8 F8 F8 F8 F8|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5069; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47396; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro use after free attempt"; flow:to_server,established; file_data; content:"draggable = true|3B 0A| htmlvar00"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-12791; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47383; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro use after free attempt"; flow:to_client,established; file_data; content:"draggable = true|3B 0A| htmlvar00"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12791; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47382; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro PSD malformed image data out-of-bounds write attempt"; flow:to_server,established; file_data; content:"8BPS|00 01|"; depth:6; content:!"|00 02|"; within:2; distance:18; content:!"|00 08|"; within:2; distance:18; content:!"|00 00 00 00|"; within:4; distance:20; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-15938; reference:cve,2018-5042; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47368; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro PSD malformed image data out-of-bounds write attempt"; flow:to_client,established; file_data; content:"8BPS|00 01|"; depth:6; content:!"|00 02|"; within:2; distance:18; content:!"|00 08|"; within:2; distance:18; content:!"|00 00 00 00|"; within:4; distance:20; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-15938; reference:cve,2018-5042; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47367; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader malformed TIFF out of bounds read attempt"; flow:to_server,established; file_data; content:"|4D 4D 00 0A|"; depth:4; byte_extract:4,0,IFDoffset,relative; isdataat:IFDoffset,relative; byte_jump:4,-4,relative,from_beginning; byte_extract:2,0,numentries,multiplier 12,relative; content:"|01 06 00 03|"; within:numentries; fast_pattern; content:!"|00 00 00 01|"; within:4; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5053; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47362; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader malformed TIFF out of bounds read attempt"; flow:to_client,established; file_data; content:"|4D 4D 00 0A|"; depth:4; byte_extract:4,0,IFDoffset,relative; isdataat:IFDoffset,relative; byte_jump:4,-4,relative,from_beginning; byte_extract:2,0,numentries,multiplier 12,relative; content:"|01 06 00 03|"; within:numentries; fast_pattern; content:!"|00 00 00 01|"; within:4; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5053; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47361; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader malformed TIFF out of bounds read attempt"; flow:to_server,established; file_data; content:"|49 49 2A 00|"; depth:4; byte_extract:4,0,IFDoffset,relative,little; isdataat:IFDoffset,relative; byte_jump:4,-4,relative,little,from_beginning; byte_extract:2,0,numentries,multiplier 12,little,relative; content:"|06 01 03 00|"; within:numentries; fast_pattern; content:!"|01 00 00 00|"; within:4; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5053; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47360; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader malformed TIFF out of bounds read attempt"; flow:to_client,established; file_data; content:"|49 49 2A 00|"; depth:4; byte_extract:4,0,IFDoffset,relative,little; isdataat:IFDoffset,relative; byte_jump:4,-4,relative,little,from_beginning; byte_extract:2,0,numentries,multiplier 12,little,relative; content:"|06 01 03 00|"; within:numentries; fast_pattern; content:!"|01 00 00 00|"; within:4; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5053; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47359; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro out of bounds read attempt"; flow:to_client,established; file_data; content:"|0A 05 01 08 00 00 00 00 3F 01 C7 00 96 00 96 00 00 00 00 08 08 08 10 10 10 18 18 18 20 20 20 28|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5039; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47357; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro out of bounds read attempt"; flow:to_server,established; file_data; content:"|0A 05 01 08 00 00 00 00 3F 01 C7 00 96 00 96 00 00 00 00 08 08 08 10 10 10 18 18 18 20 20 20 28|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5039; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47356; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG heap overflow attempt"; flow:to_server,established; file_data; content:"|E2 BC 85 6C 56 26 C4 4F 21 36 48 CC 48 62 43 DC 2F B1 4D 62 D1 D3 01 C0 C9 4A E6 B9 2C 46 3C C4|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5058; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47353; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG heap overflow attempt"; flow:to_client,established; file_data; content:"|E2 BC 85 6C 56 26 C4 4F 21 36 48 CC 48 62 43 DC 2F B1 4D 62 D1 D3 01 C0 C9 4A E6 B9 2C 46 3C C4|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5058; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47352; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG heap overflow attempt"; flow:to_server,established; file_data; content:"|FF D8 FF E0 00 10 4A 46 49 46|"; depth:10; content:"|01 0E 00 02|"; distance:0; content:!"|00|"; within:1; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5058; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47351; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG heap overflow attempt"; flow:to_client,established; file_data; content:"|FF D8 FF E0 00 10 4A 46 49 46|"; depth:10; content:"|01 0E 00 02|"; distance:0; content:!"|00|"; within:1; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5058; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47350; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro out of bounds read attempt"; flow:to_server,established; file_data; content:"|EE 23 7B 91 07 13 9D 8F EA 81 73 E9 8A 63 96 7C B9 F9 8E BB A1 BA 62 24 30 C3 BF AC 67 E5 EA 29|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5033; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47344; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro out of bounds read attempt"; flow:to_client,established; file_data; content:"|EE 23 7B 91 07 13 9D 8F EA 81 73 E9 8A 63 96 7C B9 F9 8E BB A1 BA 62 24 30 C3 BF AC 67 E5 EA 29|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5033; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47343; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIFF out of bounds read attempt"; flow:to_server,established; file_data; content:"|4D 4D 00 0A|"; depth:4; byte_extract:4,0,IFDoffset,relative; isdataat:IFDoffset,relative; byte_jump:4,-4,relative,from_beginning; byte_extract:2,0,numentries,multiplier 12,relative; content:"|01 01 00 03 00 00 00 01 00 01|"; within:numentries; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-12864; reference:cve,2018-5044; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47331; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIFF out of bounds read attempt"; flow:to_server,established; file_data; content:"|49 49 2A 00|"; depth:4; byte_extract:4,0,IFDoffset,relative,little; isdataat:IFDoffset,relative; byte_jump:4,-4,relative,little,from_beginning; byte_extract:2,0,numentries,multiplier 12,little,relative; content:"|01 01 03 00 01 00 00 00 01 00|"; within:numentries; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-12864; reference:cve,2018-5044; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47330; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIFF out of bounds read attempt"; flow:to_client,established; file_data; content:"|4D 4D 00 0A|"; depth:4; byte_extract:4,0,IFDoffset,relative; isdataat:IFDoffset,relative; byte_jump:4,-4,relative,from_beginning; byte_extract:2,0,numentries,multiplier 12,relative; content:"|01 01 00 03 00 00 00 01 00 01|"; within:numentries; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12864; reference:cve,2018-5044; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47329; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIFF out of bounds read attempt"; flow:to_client,established; file_data; content:"|49 49 2A 00|"; depth:4; byte_extract:4,0,IFDoffset,relative,little; isdataat:IFDoffset,relative; byte_jump:4,-4,relative,little,from_beginning; byte_extract:2,0,numentries,multiplier 12,little,relative; content:"|01 01 03 00 01 00 00 00 01 00|"; within:numentries; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12864; reference:cve,2018-5044; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:47328; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed CEL out of bounds read attempt"; flow:to_server,established; file_data; content:"|04 0A 00 0A FF 0D 00 04 FF 04 0B 00 09 FF 0C 00 05 FF 04 0C 00 08 FF 0C 00 05 FF 04 0D 00 08 FF|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5046; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47315; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed CEL out of bounds read attempt"; flow:to_client,established; file_data; content:"|04 0A 00 0A FF 0D 00 04 FF 04 0B 00 09 FF 0C 00 05 FF 04 0C 00 08 FF 0C 00 05 FF 04 0D 00 08 FF|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5046; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47314; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro out of bounds read attempt"; flow:to_server,established; file_data; content:"|FF D8 FF E0 00 10 4A 46 49 46|"; content:"|FF ED|"; distance:0; byte_extract:2,0,app13_size,relative; content:"8BIM|04 25|"; within:app13_size; content:!"|00|"; within:1; distance:2; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5029; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47313; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro out of bounds read attempt"; flow:to_client,established; file_data; content:"|FF D8 FF E0 00 10 4A 46 49 46|"; content:"|FF ED|"; distance:0; byte_extract:2,0,app13_size,relative; content:"8BIM|04 25|"; within:app13_size; fast_pattern; content:!"|00|"; within:1; distance:2; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5029; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47312; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro crafted GIF file out-of-bounds read attempt"; flow:to_server,established; flowbits:isset,file.gif; file_data; content:"|00 2C 00 00 00 00 20 00 20 00 80 02 71 9C 8F A9 CB 8D 00 0C 8C AE|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-5050; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47248; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro crafted GIF file out-of-bounds read attempt"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"|00 2C 00 00 00 00 20 00 20 00 80 02 71 9C 8F A9 CB 8D 00 0C 8C AE|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5050; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47247; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EmfPlusDrawImagePoints heap overflow attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|00 00 80 B3 FF FF 69 43 00 00 80 B3 00 00 80 B3 FF FF 85 42 21 00 00 00 08 00 00 00 62 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-5032; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47211; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EmfPlusDrawImagePoints heap overflow attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|00 00 80 B3 FF FF 69 43 00 00 80 B3 00 00 80 B3 FF FF 85 42 21 00 00 00 08 00 00 00 62 00 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5032; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47210; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple Quicktime malformed FPX file memory corruption attempt"; flow:to_server,established; file_data; content:"|ED 9F 5E D5 83 3A 22 9A 57 24 8E 32 AB B9 93 A1 E3 FC 2A 1B 26 FC C5 8F 33 CC 5D BC 06 03 B0 FC|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-1767; classtype:attempted-admin; sid:47174; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple Quicktime malformed FPX file memory corruption attempt"; flow:to_client,established; file_data; content:"|ED 9F 5E D5 83 3A 22 9A 57 24 8E 32 AB B9 93 A1 E3 FC 2A 1B 26 FC C5 8F 33 CC 5D BC 06 03 B0 FC|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-1767; classtype:attempted-admin; sid:47173; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader jp2 out-of-bounds read attempt"; flow:to_server,established; file_data; content:"|00 00 00 00 18 72 65 73 20 00 00 00 10 72 65 73 64 24 49 80 00 24 49 80 00 04 04 82 97 D0 25 48|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-12790; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47158; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader jp2 out-of-bounds read attempt"; flow:to_client,established; file_data; content:"|00 00 00 00 18 72 65 73 20 00 00 00 10 72 65 73 64 24 49 80 00 24 49 80 00 04 04 82 97 D0 25 48|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-12790; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47157; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed CEL heap overflow attempt"; flow:to_server,established; file_data; content:"|20 01 00 00 0F 00 04 0A 00 0A FF 0D 00 ED FF 04 0B 00 09 FF 0C 00 05 FF 04 0C 00 08 FF 0C 00 05|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-5052; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47130; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed CEL heap overflow attempt"; flow:to_client,established; file_data; content:"|20 01 00 00 0F 00 04 0A 00 0A FF 0D 00 ED FF 04 0B 00 09 FF 0C 00 05 FF 04 0C 00 08 FF 0C 00 05|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-5052; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-21.html; classtype:attempted-user; sid:47129; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed EMF out of bounds read attempt"; flow:to_server,established; file_data; content:"|51 00 00 00 D8 03 00 00 D9 03 00 00 E3 02 00 00 F4 03 00 00 F8 02 00 00 D9 03 00 00 E3 02 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4951; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-admin; sid:47060; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed EMF out of bounds read attempt"; flow:to_client,established; file_data; content:"|51 00 00 00 D8 03 00 00 D9 03 00 00 E3 02 00 00 F4 03 00 00 F8 02 00 00 D9 03 00 00 E3 02 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4951; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-admin; sid:47059; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMFPlusPath object out of bounds read attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"EMF+|2B 40|"; content:"|0C 00 00 00|"; within:6; distance:2; content:"|2A 40|"; content:"|24 00 00 00|"; within:6; distance:2; content:"|02 10 C0 DB 04 00 00 00 00 00 00 00|"; content:"|00 00 00 00 80 68 B2 48|"; byte_test:1,!&,8,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4970; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-user; sid:46876; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMFPlusPath object out of bounds read attempt"; flow:to_client,established; flowbits:isset,file.emf; content:"EMF+|2B 40|"; content:"|0C 00 00 00|"; within:6; distance:2; content:"|2A 40|"; content:"|24 00 00 00|"; within:6; distance:2; content:"|02 10 C0 DB 04 00 00 00 00 00 00 00|"; content:"|00 00 00 00 80 68 B2 48|"; byte_test:1,!&,8,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4970; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-user; sid:46875; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG out of bounds read attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|A4 05 00 03 FF|"; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4973; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-admin; sid:46726; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG out of bounds read attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|A4 05 00 03 FF|"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4973; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-admin; sid:46725; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMFPlusPath object heap overflow attempt"; flow:to_server,established; flowbits:isset,file.emf; content:"EMF+|08 40|"; content:"|03|"; within:1; distance:1; content:"|02 10 C0 DB|"; within:4; distance:8; byte_test:4,<,500,0,relative,little; byte_test:4,>,10000000,8,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4978; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-user; sid:46720; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMFPlusPath object heap overflow attempt"; flow:to_server,established; flowbits:isset,file.emf; content:"EMF+|08 40|"; content:"|03|"; within:1; distance:1; content:"|02 10 C0 DB|"; within:4; distance:8; byte_test:4,<,500,0,relative,little; byte_test:4,>,10000000,4,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4978; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-user; sid:46719; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMFPlusPath object heap overflow attempt"; flow:to_client,established; flowbits:isset,file.emf; content:"EMF+|08 40|"; content:"|03|"; within:1; distance:1; content:"|02 10 C0 DB|"; within:4; distance:8; byte_test:4,<,500,0,relative,little; byte_test:4,>,10000000,8,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4978; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-user; sid:46718; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMFPlusPath object heap overflow attempt"; flow:to_client,established; flowbits:isset,file.emf; content:"EMF+|08 40|"; content:"|03|"; within:1; distance:1; content:"|02 10 C0 DB|"; within:4; distance:8; byte_test:4,<,500,0,relative,little; byte_test:4,>,10000000,4,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4978; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-user; sid:46717; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrboat EMF invalid EMR_STRETCHDIBITS record out-of-bounds read attempt"; flow:to_server,established; file_data; content:"|28 00 00 00 25 01 00 00 61 E9 00 00 01 00 20 00 00 00 00 00 14 BC 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF FF FF 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4963; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-recon; sid:46702; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrboat EMF invalid EMR_STRETCHDIBITS record out-of-bounds read attempt"; flow:to_client,established; file_data; content:"|28 00 00 00 25 01 00 00 61 E9 00 00 01 00 20 00 00 00 00 00 14 BC 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF FF FF 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4963; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-recon; sid:46701; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat EmfPlusDrawCurve out of bounds read attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"EMF+|18 40|"; fast_pattern; content:"|00 00 00 00 00 00 00 00 02 00 00 00|"; within:12; distance:10; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4976; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-user; sid:46693; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat EmfPlusDrawCurve out of bounds read attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"EMF+|18 40|"; fast_pattern; content:"|00 00 00 00 00 00 00 00 02 00 00 00|"; within:12; distance:10; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4976; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-user; sid:46692; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat XPS out-of-bounds read attempt"; flow:to_server,established; file_data; content:"|A5 3A 41 12 60 22 4B 59 0D CC C0 72 6D 43 EE 81 99 4C 05 18 1C 0A 14 02 4C E4 81 29 19 98 8C A3|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4955; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-user; sid:46689; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat XPS out-of-bounds read attempt"; flow:to_client,established; file_data; content:"|A5 3A 41 12 60 22 4B 59 0D CC C0 72 6D 43 EE 81 99 4C 05 18 1C 0A 14 02 4C E4 81 29 19 98 8C A3|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4955; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; classtype:attempted-user; sid:46688; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMR_STRETCHDIBITS heap overflow attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|51 00 00 00|"; byte_extract:4,84,height,relative,little; byte_test:4,>,height,132,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-15940; reference:cve,2018-15941; reference:cve,2018-4948; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:46674; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMR_STRETCHDIBITS heap overflow attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|51 00 00 00|"; byte_extract:4,84,height,relative,little; byte_test:4,>,height,128,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-15940; reference:cve,2018-15941; reference:cve,2018-4948; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:46673; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMR_STRETCHDIBITS heap overflow attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|51 00 00 00|"; byte_extract:4,80,width,relative,little; byte_test:4,>,width,132,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-15940; reference:cve,2018-15941; reference:cve,2018-4948; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:46672; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMR_STRETCHDIBITS heap overflow attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|51 00 00 00|"; byte_extract:4,80,width,relative,little; byte_test:4,>,width,128,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-15940; reference:cve,2018-15941; reference:cve,2018-4948; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:46671; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMR_STRETCHDIBITS heap overflow attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|51 00 00 00|"; byte_extract:4,84,height,relative,little; byte_test:4,>,height,132,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-15940; reference:cve,2018-15941; reference:cve,2018-4948; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:46670; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMR_STRETCHDIBITS heap overflow attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|51 00 00 00|"; byte_extract:4,84,height,relative,little; byte_test:4,>,height,128,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-15940; reference:cve,2018-15941; reference:cve,2018-4948; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:46669; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMR_STRETCHDIBITS heap overflow attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|51 00 00 00|"; byte_extract:4,80,width,relative,little; byte_test:4,>,width,132,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-15940; reference:cve,2018-15941; reference:cve,2018-4948; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:46668; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF file EMR_STRETCHDIBITS heap overflow attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|51 00 00 00|"; byte_extract:4,80,width,relative,little; byte_test:4,>,width,128,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-15940; reference:cve,2018-15941; reference:cve,2018-4948; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-09.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:46667; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Gifsicle gifread double-free attempt"; flow:to_server,established,only_stream; file_data; content:"GIF"; depth:3; byte_test:1,!&,0x80,7,relative; content:"|21 CE|"; within:2; distance:10; content:"|00|"; distance:0; isdataat:1,relative; isdataat:!500,relative; content:!"|2C|"; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-18120; classtype:denial-of-service; sid:46078; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Gifsicle gifread double-free attempt"; flow:to_client,established,only_stream; file_data; content:"GIF"; depth:3; byte_test:1,!&,0x80,7,relative; content:"|21 CE|"; within:2; distance:10; content:"|00|"; distance:0; isdataat:1,relative; isdataat:!500,relative; content:!"|2C|"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-18120; classtype:attempted-user; sid:46077; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG tag data buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"Exif"; nocase; content:"|01 31 00 02|"; within:4; distance:60; fast_pattern; byte_test:4,>,0xFFFF,0,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4909; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-02.html; classtype:attempted-user; sid:45815; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG tag data buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"Exif"; nocase; content:"|01 31 00 02|"; within:4; distance:60; fast_pattern; byte_test:4,>,0xFFFF,0,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4909; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-02.html; classtype:attempted-user; sid:45814; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat TIFF malformed YCbCrCoefficients values attempt"; flow:to_server,established; file_data; content:"|00 00 0B AD 00 00 27 10 00 00 16 EE 00 00 27 10 00 26 E8 F0 00 00 27 10 00 00 00 00 00 00 27 10|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4905; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-02.html; classtype:attempted-user; sid:45792; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat TIFF malformed YCbCrCoefficients values attempt"; flow:to_client,established; file_data; content:"|00 00 0B AD 00 00 27 10 00 00 16 EE 00 00 27 10 00 26 E8 F0 00 00 27 10 00 00 00 00 00 00 27 10|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4905; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-02.html; classtype:attempted-user; sid:45791; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro TIFF embedded XPS file out of bounds read attempt"; flow:to_client,established; flowbits:isset,file.xps; file_data; content:"|01 31 00 02|"; fast_pattern; byte_extract:4,0,SftLen,relative,big; byte_extract:4,0,SftOffset,relative,big; content:"MM|00 2A|"; within:500; distance:-500; isdataat:SftOffset,relative; content:!"|00|"; within:SftLen; distance:SftOffset; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4903; reference:url,helpx.adobe.com/security/products/reader/apsb18-02.html; classtype:attempted-user; sid:45789; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro TIFF embedded XPS file out of bounds read attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|01 31 00 02|"; fast_pattern; byte_extract:4,0,SftLen,relative,big; byte_extract:4,0,SftOffset,relative,big; content:"MM|00 2A|"; depth:4; isdataat:SftOffset; content:!"|00|"; within:SftLen; distance:SftOffset; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4903; reference:url,helpx.adobe.com/security/products/reader/apsb18-02.html; classtype:attempted-user; sid:45788; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro BMP out of bounds read attempt"; flow:to_server,established; file_data; content:"|04 00 00 00 7C 60 00 00 1C 02 00 00 00 00 00 00 00 00 00 08 00 08 10 00 10 19 00 19 21 00 21 29|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4881; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-02.html; classtype:attempted-admin; sid:45685; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro BMP out of bounds read attempt"; flow:to_client,established; file_data; content:"|04 00 00 00 7C 60 00 00 1C 02 00 00 00 00 00 00 00 00 00 08 00 08 10 00 10 19 00 19 21 00 21 29|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4881; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-02.html; classtype:attempted-admin; sid:45684; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Qt library BMP image parser heap overflow exploit attempt"; flow:to_client,established; content:"|80 80 FF FF FF 3C 93 FF 3C 93 FF 3C 93 FF 3C 93 FF 3C 93 FF 3C 93 FF 3C 93 FF 00 00 00 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2004-0691; classtype:attempted-user; sid:45306; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Qt library BMP image parser heap overflow exploit attempt"; flow:to_server,established; content:"|80 80 FF FF FF 3C 93 FF 3C 93 FF 3C 93 FF 3C 93 FF 3C 93 FF 3C 93 FF 3C 93 FF 00 00 00 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2004-0691; classtype:attempted-user; sid:45305; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple Quicktime malformed FPX file memory corruption attempt"; flow:to_client,established; file_data; content:"|80 75 A8 1B 4A 24 C2 01 04 00 00 00 41 41 41 41 04 00 00 00 00 00 E0 40 13 00 00 00 02 00 00 00 04 00 00 00 00 00 00 00 13 00 00 00 02 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-1767; classtype:attempted-admin; sid:45186; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple Quicktime malformed FPX file memory corruption attempt"; flow:to_server,established; file_data; content:"|80 75 A8 1B 4A 24 C2 01 04 00 00 00 41 41 41 41 04 00 00 00 00 00 E0 40 13 00 00 00 02 00 00 00 04 00 00 00 00 00 00 00 13 00 00 00 02 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-1767; classtype:attempted-admin; sid:45185; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF EmfPlusFont memory corruption attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|06 00 00 00 00 00 E1 41 00 00 C8 3F 00 00 48 40 00 00 96 40 00 00 2F 41 00 00 C8 3F 02 10 C0 DB|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-16416; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44970; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF EmfPlusFont memory corruption attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|06 00 00 00 00 00 E1 41 00 00 C8 3F 00 00 48 40 00 00 96 40 00 00 2F 41 00 00 C8 3F 02 10 C0 DB|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-16416; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44969; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat TIFF malformed YCbCrCoefficients values memory corruption attempt"; flow:to_server,established; file_data; content:"|2F 00 00 27 10 00 00 0B AD 00 00 27 10 00 00 16 EE 00 00 27 10 00 00 04 74 00 00 00 00 00 00 27|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-16382; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44960; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat TIFF malformed YCbCrCoefficients values memory corruption attempt"; flow:to_client,established; file_data; content:"|2F 00 00 27 10 00 00 0B AD 00 00 27 10 00 00 16 EE 00 00 27 10 00 00 04 74 00 00 00 00 00 00 27|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-16382; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44959; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF out of bounds write attempt"; flow:to_server,established; flowbits:isset, file.emf; file_data; content:"|FF 7F 00 00 9C 8F A9 CB 8D 00 0C 8C AE CA 10 A0 4D 53 77 8C 3D 1B A5 00 58 37 8D 8C 99 81 2C D9|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-16406; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44930; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF out of bounds write attempt"; flow:to_client,established; flowbits:isset, file.emf; file_data; content:"|FF 7F 00 00 9C 8F A9 CB 8D 00 0C 8C AE CA 10 A0 4D 53 77 8C 3D 1B A5 00 58 37 8D 8C 99 81 2C D9|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-16406; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44929; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro invalid APP13 marker size attempt"; flow:to_server,established; file_data; flowbits:isset,file.jpeg; content:"|FF ED|"; byte_test:2,<,28,0,relative; content:"Photoshop 3.0|00|8BIM"; within:18; distance:2; fast_pattern; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-16386; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44913; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro invalid APP13 marker size attempt"; flow:to_client,established; file_data; flowbits:isset,file.jpeg; content:"|FF ED|"; byte_test:2,<,28,0,relative; content:"Photoshop 3.0|00|8BIM"; within:18; distance:2; fast_pattern; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-16386; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44912; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat XPS unicode glyph pointer out of bounds"; flow:to_server,established; content:"|ED ED 72 B7 87 C9 5F 5D AD 97 B7 EB FD B9 CD DF 9F D0 7B 4B CE F6 B0 1F 1C 59 F5 ED BA EF FF 0F|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-16399; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44885; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat XPS unicode glyph pointer out of bounds"; flow:to_client,established; content:"|ED ED 72 B7 87 C9 5F 5D AD 97 B7 EB FD B9 CD DF 9F D0 7B 4B CE F6 B0 1F 1C 59 F5 ED BA EF FF 0F|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-16399; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44884; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro EMF EMR_STRETCHDIBITS memory corruption attempt"; flow:to_server,established; flowbits:isset, file.emf; file_data; content:"|51 00 00 00 88 02 00 00 78 1E 00 00 CC 10 00 00 07 20 00 00 5B 12 00 00 78 1E 00 00 CC 10 00 00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-16406; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44881; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro EMF EMR_STRETCHDIBITS memory corruption attempt"; flow:to_client,established; flowbits:isset, file.emf; file_data; content:"|51 00 00 00 88 02 00 00 78 1E 00 00 CC 10 00 00 07 20 00 00 5B 12 00 00 78 1E 00 00 CC 10 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-16406; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44880; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed CommentExtension attempt"; flow:to_server,established; file_data; content:"|F5 57 13 0F 9E 9C 3C 05 8F 0D EC 45 49 71 E1 3C 67 82 B2 22 4E DA 34 52 49 56 61 56 98 DD C5 78 C2 D4 82 3C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-16410; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44862; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed CommentExtension attempt"; flow:to_client,established; file_data; content:"|F5 57 13 0F 9E 9C 3C 05 8F 0D EC 45 49 71 E1 3C 67 82 B2 22 4E DA 34 52 49 56 61 56 98 DD C5 78 C2 D4 82 3C|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-16410; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44861; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed EMF memory corruption attempt"; flow:to_server,established; file_data; content:"|4C 00 00 00 64 00 00 00 00 00 00 00 00 00 00 00 0B 01 00 00 6B 00 00 00 00 00 00 00 00 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-11248; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:44551; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed EMF memory corruption attempt"; flow:to_client,established; file_data; content:"|4C 00 00 00 64 00 00 00 00 00 00 00 00 00 00 00 0B 01 00 00 6B 00 00 00 00 00 00 00 00 00 00 00|"; fast_pattern:0,28; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-11248; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:44550; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple PICT Quickdraw image converter packType 4 buffer overflow attempt"; flow:to_server,established; file_data; content:"|00 9A 00 9F 00 A4 00 A9 00 AE 00 B2 00 B7 00 BC 00 C1 00 C6 00 CB 00 D0 00 D5 00 DB 00 E0 00 E5|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,30597; reference:bugtraq,30598; reference:cve,2008-3018; reference:cve,2008-3021; classtype:attempted-user; sid:44456; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple PICT Quickdraw image converter packType 4 buffer overflow attempt"; flow:to_client,established; file_data; content:"|00 9A 00 9F 00 A4 00 A9 00 AE 00 B2 00 B7 00 BC 00 C1 00 C6 00 CB 00 D0 00 D5 00 DB 00 E0 00 E5|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,30597; reference:bugtraq,30598; reference:cve,2008-3018; reference:cve,2008-3021; classtype:attempted-user; sid:44455; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Free Opener malformed JPEG file buffer overflow attempt"; flow:to_server,established; content:"Content-Disposition: attachment|3B| filename="; content:".jpg"; within:25; fast_pattern; nocase; file_data; content:!"|FF D8 FF|"; depth:3; metadata:policy max-detect-ips drop, service smtp; reference:url,www.softpedia.com/get/File-managers/Free-Opener.shtml; classtype:attempted-user; sid:44355; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Real-DRAW PRO malformed PNG denial of service attempt"; flow:to_server,established; content:"Content-Disposition: attachment|3B| filename="; content:".png"; within:50; nocase; file_data; content:!"|89|PNG|0D 0A 1A 0A|"; depth:8; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-2940; reference:cve,2017-14103; classtype:denial-of-service; sid:44286; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows metafile SetPaletteEntries heap overflow attempt"; flow:to_server,established; flowbits:isset,file.wmf; file_data; content:"|00 09 00|"; content:"|FF FF FF|"; distance:12; content:"|00|"; within:1; distance:2; pcre:"/[\x00\x01]\x00\x09\x00.*?\xff\xff\xff[\xff\xf7][\x36\x37]\x00/smi"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,15356; reference:cve,2005-2124; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-053; classtype:attempted-user; sid:44128; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIFF memory corruption attempt"; flow:to_server,established; file_data; content:"MM|00 2A|"; depth:4; byte_jump:4,4,from_beginning; content:"|01 40 00 03|"; distance:0; byte_extract:4,0,count,relative,multiplier 2; byte_jump:4,0,relative,from_beginning; isdataat:!count,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-11255; reference:cve,2017-16413; reference:cve,2019-7037; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb19-07.html; classtype:attempted-user; sid:44062; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIFF memory corruption attempt"; flow:to_client,established; file_data; content:"MM|00 2A|"; depth:4; byte_jump:4,4,from_beginning; content:"|01 40 00 03|"; distance:0; byte_extract:4,0,count,relative,multiplier 2; byte_jump:4,0,relative,from_beginning; isdataat:!count,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-11255; reference:cve,2017-16413; reference:cve,2019-7037; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb19-07.html; classtype:attempted-user; sid:44061; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIFF memory corruption attempt"; flow:to_server,established,only_stream; file_data; content:"II|2A 00|"; depth:4; byte_jump:4,4,little,from_beginning; content:"|40 01 03 00|"; distance:0; byte_extract:4,0,count,relative,multiplier 2,little; byte_jump:4,0,relative,little,from_beginning; isdataat:!count,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-11255; reference:cve,2017-16413; reference:cve,2018-12859; reference:cve,2018-15954; reference:cve,2018-15955; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:44060; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIFF memory corruption attempt"; flow:to_client,established,only_stream; file_data; content:"II|2A 00|"; depth:4; byte_jump:4,4,little,from_beginning; content:"|40 01 03 00|"; distance:0; byte_extract:4,0,count,relative,multiplier 2,little; byte_jump:4,0,relative,little,from_beginning; isdataat:!count,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-11255; reference:cve,2017-16413; reference:cve,2018-12859; reference:cve,2018-15954; reference:cve,2018-15955; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:44059; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIFF memory corruption attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"|01 1C 00 03 00 00 00 01|"; content:!"|00 01 00 00|"; within:4; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-11234; reference:cve,2017-16396; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44026; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIFF memory corruption attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|01 1C 00 03 00 00 00 01|"; content:!"|00 01 00 00|"; within:4; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-11234; reference:cve,2017-16396; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:44025; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIFF memory corruption attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"|1C 01 03 00 01 00 00 00|"; content:!"|01 00 00 00|"; within:4; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-11234; reference:cve,2018-15927; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:44024; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIFF memory corruption attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"|1C 01 03 00 01 00 00 00|"; content:!"|01 00 00 00|"; within:4; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-11234; reference:cve,2018-15927; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-30.html; classtype:attempted-user; sid:44023; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE malformed png missing IHDR"; flow:to_server,established; file_data; content:"|89|PNG|0D 0A 1A 0A|"; depth:8; content:!"|00 00 00 0D|IHDR"; within:9; metadata:policy max-detect-ips drop, service smtp; classtype:attempted-user; sid:44020; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE malformed png missing IHDR"; flow:to_client,established; file_data; content:"|89|PNG|0D 0A 1A 0A|"; depth:8; content:!"|00 00 00 0D|IHDR"; within:9; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:attempted-user; sid:44019; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader JPEG 2000 tile memory corruption attempt"; flow:to_server,established; file_data; content:"|FF 4F FF 51|"; depth:4; byte_test:4,>,0x3b9aca00,24,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-11226; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:43911; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader JPEG 2000 tile memory corruption attempt"; flow:to_server,established; file_data; content:"|FF 4F FF 51|"; depth:4; byte_test:4,>,0x3b9aca00,20,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-11226; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:43910; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader JPEG 2000 tile memory corruption attempt"; flow:to_client,established; file_data; content:"|FF 4F FF 51|"; depth:4; byte_test:4,>,0x3b9aca00,24,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-11226; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:43909; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader JPEG 2000 tile memory corruption attempt"; flow:to_client,established; file_data; content:"|FF 4F FF 51|"; depth:4; byte_test:4,>,0x3b9aca00,20,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-11226; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:43908; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Reader EMF EMR_STROKEPATH memory corruption attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|40 00 00 00 18 00 00 00|"; byte_test:4,>,0xFFFFFF,4,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-11214; reference:cve,2018-15986; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-41.html; classtype:attempted-user; sid:43903; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Reader EMF EMR_STROKEPATH memory corruption attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|40 00 00 00 18 00 00 00|"; byte_test:4,>,0xFFFFFF,4,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-11214; reference:cve,2018-15986; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-41.html; classtype:attempted-user; sid:43902; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Professional malformed PCX memory corruption attempt"; flow:to_server,established; flowbits:isset,file.pcx; file_data; content:"|0A 05 01 08|"; depth:4; byte_extract:2,2,ymin,relative,little; byte_test:2,<,ymin,2,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-3116; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:43874; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Professional malformed PCX memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pcx; file_data; content:"|0A 05 01 08|"; depth:4; byte_extract:2,2,ymin,relative,little; byte_test:2,<,ymin,2,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-3116; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:43873; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Professional malformed PCX memory corruption attempt"; flow:to_server,established; flowbits:isset,file.pcx; file_data; content:"|0A 05 01 08|"; depth:4; byte_extract:2,0,xmin,relative,little; byte_test:2,<,xmin,2,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-3124; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:43872; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Professional malformed PCX memory corruption attempt"; flow:to_client,established; flowbits:isset,file.pcx; file_data; content:"|0A 05 01 08|"; depth:4; byte_extract:2,0,xmin,relative,little; byte_test:2,<,xmin,2,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-3124; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:43871; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Reader EMF EMR_MOVETOEX memory corruption attempt"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:"|00 00 1B 00 00 00|"; byte_test:4,>,0xFFFFFF,0,relative,little; content:"|00 00|"; within:2; distance:6; content:"|00 00|"; within:2; distance:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-3123; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:43866; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Reader EMF EMR_MOVETOEX memory corruption attempt"; flow:to_client,established; flowbits:isset,file.emf; file_data; content:"|00 00 1B 00 00 00|"; byte_test:4,>,0xFFFFFF,0,relative,little; content:"|00 00|"; within:2; distance:6; content:"|00 00|"; within:2; distance:2; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-3123; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-24.html; classtype:attempted-user; sid:43865; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE multiple products PNG processing buffer overflow attempt"; flow:to_server,established; file_data; content:"|89|PNG|0D 0A 1A 0A 00 00 00 0D|IHDR"; depth:16; pcre:"/\x89PNG\x0D\x0A\x1A\x0A\x00\x00\x00\x0DIHDR([^\x00]|\x00[^\x00]|.{4}[^\x00]|.{4}\x00[^\x00]|.{8}[\x11-\xff])/s"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,34240; reference:cve,2009-1097; reference:cve,2017-3077; reference:url,helpx.adobe.com/security/products/flash-player/apsb17-17.html; classtype:attempted-user; sid:43399; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft GDI WMF file parsing integer overflow attempt"; flow:to_client,established; flowbits:isset,file.wmf; file_data; content:"|40 09|"; byte_test:4,>,0xF0000000,19,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2008-2249; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-071; classtype:attempted-admin; sid:43362; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft GDI WMF file parsing integer overflow attempt"; flow:to_server,established; flowbits:isset,file.wmf; file_data; content:"|41 0B|"; byte_test:4,>,0xF0000000,23,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2008-2249; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-071; classtype:attempted-admin; sid:43361; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft GDI WMF file parsing integer overflow attempt"; flow:to_server,established; flowbits:isset,file.wmf; file_data; content:"|40 09|"; byte_test:4,>,0xF0000000,19,relative; metadata:policy max-detect-ips drop, service smtp; reference:cve,2008-2249; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-071; classtype:attempted-admin; sid:43360; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft GDI WMF file parsing integer overflow attempt"; flow:to_client,established; flowbits:isset,file.wmf; file_data; content:"|41 0B|"; byte_test:4,>,0xF0000000,23,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2008-2249; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-071; classtype:attempted-admin; sid:43359; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE ImageMagick SyncExifProfile out-of-bounds memory read attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8|"; depth:2; content:"Exif"; within:4; distance:20; content:"II"; within:2; distance:2; byte_jump:4,2,relative,little,post_offset -4; byte_test:2,>,12,0,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-7799; reference:url,github.com/ImageMagick/ImageMagick/issues/280; classtype:attempted-user; sid:43098; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick SyncExifProfile out-of-bounds memory read attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8|"; depth:2; content:"Exif"; within:4; distance:20; content:"II"; within:2; distance:2; byte_jump:4,2,relative,little,post_offset -4; byte_test:2,>,12,0,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-7799; reference:url,github.com/ImageMagick/ImageMagick/issues/280; classtype:attempted-user; sid:43097; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE ImageMagick SyncExifProfile out-of-bounds memory read attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8|"; depth:2; content:"Exif"; within:4; distance:20; content:"MM"; within:2; distance:2; byte_jump:4,2,relative,post_offset -4; byte_test:2,>,12,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-7799; reference:url,github.com/ImageMagick/ImageMagick/issues/280; classtype:attempted-user; sid:43096; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick SyncExifProfile out-of-bounds memory read attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8|"; depth:2; content:"Exif"; within:4; distance:20; content:"MM"; within:2; distance:2; byte_jump:4,2,relative,post_offset -4; byte_test:2,>,12,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-7799; reference:url,github.com/ImageMagick/ImageMagick/issues/280; classtype:attempted-user; sid:43095; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple Quicktime malformed FPX file memory corruption attempt"; flow:to_server,established; file_data; content:"|D8 00 00 00 03 00 00 21 E0 00 00 00 00 00 00 24 28 01 00 00 01 00 00 24 5C 01 00 00 02 00 00 21|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-1768; classtype:attempted-admin; sid:43052; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple Quicktime malformed FPX file memory corruption attempt"; flow:to_client,established; file_data; content:"|D8 00 00 00 03 00 00 21 E0 00 00 00 00 00 00 24 28 01 00 00 01 00 00 24 5C 01 00 00 02 00 00 21|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-1768; classtype:attempted-admin; sid:43051; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro SampleFormat heap overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"MM|2A 00|"; depth:4; content:"|01 53 00 03|"; distance:0; byte_test:4,>,2,0,relative,big; byte_jump:4,4,relative,big,from_beginning; byte_test:2,>,1,0,relative,big; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-3048; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-11.html; classtype:attempted-user; sid:42940; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro SampleFormat heap overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"MM|2A 00|"; depth:4; content:"|01 53 00 03|"; distance:0; byte_test:4,>,2,0,relative,big; byte_jump:4,4,relative,big,from_beginning; byte_test:2,>,1,0,relative,big; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-3048; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-11.html; classtype:attempted-user; sid:42939; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro SampleFormat heap overflow attempt"; flow:to_server,established; flowbits:isset,file.xps|file.tiff.little; file_data; content:"|53 01 03 00|"; byte_test:4,>,2,0,relative,little; byte_jump:4,4,relative,little,from_beginning; byte_test:2,>,1,0,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-16381; reference:cve,2017-3048; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-11.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:42938; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro SampleFormat heap overflow attempt"; flow:to_client,established; flowbits:isset,file.xps|file.tiff.little; file_data; content:"|53 01 03 00|"; byte_test:4,>,2,0,relative,little; byte_jump:4,4,relative,little,from_beginning; byte_test:2,>,1,0,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-16381; reference:cve,2017-3048; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-11.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-user; sid:42937; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIF heap overflow attempt"; flow:to_server,established; file_data; content:"|4D 4D 2A 00|"; depth:4; byte_jump:4,0,relative,from_beginning; content:"|01 17|"; byte_test:4,>,2,2,relative; byte_test:4,<,200,6,relative; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-3049; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-11.html; classtype:attempted-user; sid:42847; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIF heap overflow attempt"; flow:to_client,established; file_data; content:"|4D 4D 2A 00|"; depth:4; byte_jump:4,0,relative,from_beginning; content:"|01 17|"; byte_test:4,>,2,2,relative; byte_test:4,<,200,6,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-3049; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-11.html; classtype:attempted-user; sid:42846; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIF heap overflow attempt"; flow:to_server,established; file_data; content:"|49 49 2A 00|"; depth:4; byte_jump:4,0,relative,little,from_beginning; content:"|17 01|"; byte_test:4,>,2,2,relative,little; byte_test:4,<,200,6,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-3049; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-11.html; classtype:attempted-user; sid:42845; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIF heap overflow attempt"; flow:to_client,established; file_data; content:"|49 49 2A 00|"; depth:4; byte_jump:4,0,relative,little,from_beginning; content:"|17 01|"; byte_test:4,>,2,2,relative,little; byte_test:4,<,200,6,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-3049; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-11.html; classtype:attempted-user; sid:42844; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Foxit Reader malformed DataSubBlock size attempt"; flow:to_client,established; flowbits:isset,file.gif; file_data; content:"|00 2C|"; content:"|FE 00 B1 09 1C 48 B0 A0 C1 83 08 13 2A 5C C8 B0 A1 C3 82 D7 FA 20 B9 F6 D0 E0 B5 8B 17 B1 5D AB|"; within:32; distance:10; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-2790; classtype:denial-of-service; sid:42464; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Foxit Reader malformed DataSubBlock size attempt"; flow:to_server,established; flowbits:isset,file.gif; file_data; content:"|00 2C|"; content:"|FE 00 B1 09 1C 48 B0 A0 C1 83 08 13 2A 5C C8 B0 A1 C3 82 D7 FA 20 B9 F6 D0 E0 B5 8B 17 B1 5D AB|"; within:32; distance:10; metadata:policy max-detect-ips drop, service smtp; reference:cve,2015-2790; classtype:denial-of-service; sid:42463; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader overly large segment size out of bounds read attempt"; flow:to_server,established; file_data; content:"|A0 02 00 04 00 00 00 01 00 00 01 21 A0 03 00 04 00 00 00 01 00 00 01 04 00 00 00 00 FF DB 00 43|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-3051; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-11.html; classtype:attempted-user; sid:42325; rev:4;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader overly large segment size out of bounds read attempt"; flow:to_client,established; file_data; content:"|A0 02 00 04 00 00 00 01 00 00 01 21 A0 03 00 04 00 00 00 01 00 00 01 04 00 00 00 00 FF DB 00 43|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-3051; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-11.html; classtype:attempted-user; sid:42324; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed TIF memory corruption attempt"; flow:to_server,established; file_data; content:"|02 84 BC 8F A9 CB 8D 00 0C 8C AE CA 10 A0 4D 53 77 8C 3D 1B A5 00 58 37 8D 8C 99 81 2C D9 C0 CF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-3050; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-11.html; classtype:attempted-user; sid:42219; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed GIF memory corruption attempt"; flow:to_client,established; file_data; content:"|02 84 BC 8F A9 CB 8D 00 0C 8C AE CA 10 A0 4D 53 77 8C 3D 1B A5 00 58 37 8D 8C 99 81 2C D9 C0 CF|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-3050; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-11.html; classtype:attempted-user; sid:42218; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Corel PHOTO-PAINT X8 GIF Filter Code Execution Vulnerability attempt"; flow:to_server,established; file_data; content:"GIF89"; depth:5; content:"|21 00|"; within:1024; content:"|2C 00 00 00 00 00 00 00 00|"; within:1024; fast_pattern:0,8; byte_test:1,>=,0x85,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-8730; reference:url,www.talosintelligence.com/reports/TALOS-2016-0244/; classtype:attempted-user; sid:42141; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Corel PHOTO-PAINT X8 GIF Filter Code Execution Vulnerability attempt"; flow:to_client,established; file_data; content:"GIF89"; depth:5; content:"|21 00|"; within:1024; content:"|2C 00 00 00 00 00 00 00 00|"; within:1024; fast_pattern:0,8; byte_test:1,>=,0x85,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-8730; reference:url,www.talosintelligence.com/reports/TALOS-2016-0244/; classtype:attempted-user; sid:42140; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Corel Photo Paint invalid ImageLength memory corruption attempt"; flow:to_server,established; file_data; content:"MM|00 2A|"; depth:4; content:"|01 00 00 03 00 00 00 01|"; fast_pattern; content:"|01 01 00 01 00 00 00 00 00 00 00 00|"; within:100; distance:-50; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2804; reference:url,www.talosintelligence.com/reports/TALOS-2017-0298/; classtype:attempted-user; sid:42091; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Corel Photo Paint invalid ImageLength memory corruption attempt"; flow:to_server,established; file_data; content:"II|2A 00|"; depth:4; content:"|00 01 03 00 01 00 00 00|"; fast_pattern; content:"|01 01 01 00 00 00 00 00 00 00 00 00|"; within:100; distance:-50; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2804; reference:url,www.talosintelligence.com/reports/TALOS-2017-0298/; classtype:attempted-user; sid:42090; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Corel Photo Paint invalid ImageLength memory corruption attempt"; flow:to_client,established; file_data; content:"MM|00 2A|"; depth:4; content:"|01 00 00 03 00 00 00 01|"; fast_pattern; content:"|01 01 00 01 00 00 00 00 00 00 00 00|"; within:100; distance:-50; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2804; reference:url,www.talosintelligence.com/reports/TALOS-2017-0298/; classtype:attempted-user; sid:42089; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Corel Photo Paint invalid ImageLength memory corruption attempt"; flow:to_client,established; file_data; content:"II|2A 00|"; depth:4; content:"|00 01 03 00 01 00 00 00|"; fast_pattern; content:"|01 01 01 00 00 00 00 00 00 00 00 00|"; within:100; distance:-50; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2804; reference:url,www.talosintelligence.com/reports/TALOS-2017-0298/; classtype:attempted-user; sid:42088; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Corel Photo Paint invalid NewSubFileType memory corruption attempt"; flow:to_server,established; file_data; content:"II|2A 00|"; depth:4; byte_jump:4,0,relative,post_offset 2,from_beginning,little; content:"|FE 00 04 00|"; within:100; byte_test:1,>,0x7F,3,relative; byte_test:1,>,0x7F,7,relative; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-2803; reference:url,www.talosintelligence.com/reports/TALOS-2017-0297/; classtype:attempted-user; sid:42087; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Corel Photo Paint invalid NewSubFileType memory corruption attempt"; flow:to_server,established; file_data; content:"MM|00 2A|"; depth:4; byte_jump:4,0,relative,post_offset 2,from_beginning; content:"|00 FE 00 04|"; within:100; byte_test:1,>,0x7F,0,relative; byte_test:1,>,0x7F,4,relative; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-2803; reference:url,www.talosintelligence.com/reports/TALOS-2017-0297/; classtype:attempted-user; sid:42086; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Corel Photo Paint invalid NewSubFileType memory corruption attempt"; flow:to_client,established; file_data; content:"II|2A 00|"; depth:4; byte_jump:4,0,relative,post_offset 2,from_beginning,little; content:"|FE 00 04 00|"; within:100; byte_test:1,>,0x7F,3,relative; byte_test:1,>,0x7F,7,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2803; reference:url,www.talosintelligence.com/reports/TALOS-2017-0297/; classtype:attempted-user; sid:42085; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Corel Photo Paint invalid NewSubFileType memory corruption attempt"; flow:to_client,established; file_data; content:"MM|00 2A|"; depth:4; byte_jump:4,0,relative,post_offset 2,from_beginning; content:"|00 FE 00 04|"; within:100; byte_test:1,>,0x7F,0,relative; byte_test:1,>,0x7F,4,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2803; reference:url,www.talosintelligence.com/reports/TALOS-2017-0297/; classtype:attempted-user; sid:42084; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE GDI+ malformed EMF comment heap access violation attempt"; flow:to_server, established; file_data; content:"|01 00 00 00|"; depth:4; content:" EMF"; within:4; distance:36; content:"|46|"; distance:0; content:!"|00 00 00|"; within:3; content:"EMF+"; within:4; distance:11; content:"|46 00 00 00|"; byte_test:4,>,7500,0,relative,little; content:"EMF+"; within:4; distance:8; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-0060; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-013; classtype:attempted-user; sid:41971; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE GDI+ malformed EMF comment heap access violation attempt"; flow:to_client, established; file_data; content:"|01 00 00 00|"; depth:4; content:" EMF"; within:4; distance:36; content:"|46|"; distance:0; content:!"|00 00 00|"; within:3; content:"EMF+"; within:4; distance:11; content:"|46 00 00 00|"; byte_test:4,>,7500,0,relative,little; content:"EMF+"; within:4; distance:8; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-0060; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-013; classtype:attempted-user; sid:41970; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE GDI+ malformed EMF description out of bounds read attempt"; flow:to_server, established; file_data; content:"|01 00 00 00|"; depth:4; content:"|20|EMF"; depth:44; fast_pattern; content:"|00 00|"; within:2; distance:14; content:!"|00 00 00 00|"; within:4; content:"|00 00 00 00|"; within:4; distance:4; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-0062; reference:cve,2018-12849; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-34.html; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-013; classtype:attempted-admin; sid:41947; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft GDI+ malformed EMF description out of bounds read attempt"; flow:to_client, established; file_data; content:"|01 00 00 00|"; depth:4; content:"|20|EMF"; depth:44; fast_pattern; content:"|00 00|"; within:2; distance:14; content:!"|00 00 00 00|"; within:4; content:"|00 00 00 00|"; within:4; distance:4; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-0062; reference:cve,2018-12849; reference:url,helpx.adobe.com/security/products/acrobat/apsb18-34.html; reference:url,technet.microsoft.com/en-us/security/bulletin/MS17-013; classtype:attempted-admin; sid:41946; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE ImageMagick mvg processing command server side request forgery attempt"; flow:to_server,established; file_data; content:"url|28|"; fast_pattern:only; pcre:"/(stroke|fill) +(\x22|\x27)url\x28(http|https|ftp)\x3A/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-3717; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?f=4&t=29588#p132726; classtype:attempted-user; sid:41809; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick mvg processing command server side request forgery attempt"; flow:to_client,established; file_data; content:"url|28|"; fast_pattern:only; pcre:"/(stroke|fill) +(\x22|\x27)url\x28(http|https|ftp)\x3A/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-3717; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?f=4&t=29588#p132726; classtype:attempted-user; sid:41808; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat TIFF ICC tag heap buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"MM|2A 00|"; depth:4; content:"|01 01 03 00 01 00 00 00|"; content:"|00 07 87 73|"; within:300; distance:-50; byte_extract:4,0,count,relative; byte_jump:4,0,relative,post_offset -8; byte_test:4,>,count,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2963; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41398; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat TIFF ICC tag heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"MM|2A 00|"; depth:4; content:"|01 01 03 00 01 00 00 00|"; content:"|00 07 87 73|"; within:300; distance:-50; byte_extract:4,0,count,relative; byte_jump:4,0,relative,post_offset -8; byte_test:4,>,count,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2963; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41397; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat TIFF ICC tag heap buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"II|2A 00|"; depth:4; content:"|01 01 03 00 01 00 00 00|"; content:"|73 87 07 00|"; within:300; distance:-50; byte_extract:4,0,count,relative,little; byte_jump:4,0,relative,little,post_offset -8; byte_test:4,>,count,0,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2963; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41396; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat TIFF ICC tag heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"II|2A 00|"; depth:4; content:"|01 01 03 00 01 00 00 00|"; content:"|73 87 07 00|"; within:300; distance:-50; byte_extract:4,0,count,relative,little; byte_jump:4,0,relative,little,post_offset -8; byte_test:4,>,count,0,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2963; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41395; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat TIFF ICC tag heap buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"MM|2A 00|"; depth:4; content:"|01 01 04 00 01 00 00 00|"; content:"|00 07 87 73|"; within:300; distance:-50; byte_extract:4,0,count,relative; byte_jump:4,0,relative,post_offset -8; byte_test:4,>,count,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2963; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41394; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat TIFF ICC tag heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"MM|2A 00|"; depth:4; content:"|01 01 04 00 01 00 00 00|"; content:"|00 07 87 73|"; within:300; distance:-50; byte_extract:4,0,count,relative; byte_jump:4,0,relative,post_offset -8; byte_test:4,>,count,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2963; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41393; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat TIFF ICC tag heap buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"II|2A 00|"; depth:4; content:"|01 01 04 00 01 00 00 00|"; content:"|73 87 07 00|"; within:300; distance:-50; byte_extract:4,0,count,relative,little; byte_jump:4,0,relative,little,post_offset -8; byte_test:4,>,count,0,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2963; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41392; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat TIFF ICC tag heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"II|2A 00|"; depth:4; content:"|01 01 04 00 01 00 00 00|"; content:"|73 87 07 00|"; within:300; distance:-50; byte_extract:4,0,count,relative,little; byte_jump:4,0,relative,little,post_offset -8; byte_test:4,>,count,0,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2963; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41391; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG APP1 segment out of bounds memory access attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF E1|"; content:"Exif|00 00|II"; within:8; distance:2; byte_jump:4,2,relative,little; content:"|69 87 04 00 01 00 00 00|"; distance:0; content:"|00 00 00 00|"; within:4; distance:4; byte_extract:4,-8,jumpval,relative; content:"Exif|00 00|"; within:200; distance:-200; byte_test:2,>,50,jumpval,relative,little; content:"|01 02|"; within:150; distance:jumpval; byte_test:2,>,12,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2960; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-admin; sid:41341; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG APP1 segment out of bounds memory access attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF E1|"; content:"Exif|00 00|II"; within:8; distance:2; byte_jump:4,2,relative,little; content:"|69 87 04 00 01 00 00 00|"; distance:0; content:"|00 00 00 00|"; within:4; distance:4; byte_extract:4,-8,jumpval,relative; content:"Exif|00 00|"; within:200; distance:-200; byte_test:2,>,50,jumpval,relative,little; content:"|01 02|"; within:150; distance:jumpval; byte_test:2,>,12,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2960; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-admin; sid:41340; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG APP1 segment out of bounds memory access attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF E1|"; content:"Exif|00 00|MM"; within:8; distance:2; byte_jump:4,2,relative; content:"|87 69 00 04 00 00 00 01|"; distance:0; content:"|00 00 00 00|"; within:4; distance:4; byte_extract:4,-8,jumpval,relative; content:"Exif|00 00|"; within:200; distance:-200; byte_test:2,>,50,jumpval,relative; content:"|02 01|"; within:150; distance:jumpval; byte_test:2,>,12,0,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2960; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-admin; sid:41339; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG APP1 segment out of bounds memory access attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF E1|"; content:"Exif|00 00|MM"; within:8; distance:2; byte_jump:4,2,relative; content:"|87 69 00 04 00 00 00 01|"; distance:0; content:"|00 00 00 00|"; within:4; distance:4; byte_extract:4,-8,jumpval,relative; content:"Exif|00 00|"; within:200; distance:-200; byte_test:2,>,50,jumpval,relative; content:"|02 01|"; within:150; distance:jumpval; byte_test:2,>,12,0,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2960; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-admin; sid:41338; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE libBPG restore_tqb_pixel out of bounds write attempt"; flow:to_server,established; file_data; content:"|42 50 47 FB 30 30 15 15 00 03 AD 47 30 03 30 30 30 44 09 C1 3B 3B 3B 3B 30 00 00 01 26 09 AE 30|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-8710; reference:url,www.talosintelligence.com/reports/TALOS-2016-0223/; classtype:attempted-user; sid:41311; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE libBPG restore_tqb_pixel out of bounds write attempt"; flow:to_client,established; file_data; content:"|42 50 47 FB 30 30 15 15 00 03 AD 47 30 03 30 30 30 44 09 C1 3B 3B 3B 3B 30 00 00 01 26 09 AE 30|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-8710; reference:url,www.talosintelligence.com/reports/TALOS-2016-0223/; classtype:attempted-user; sid:41310; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader jpeg decoding heap buffer overflow attempt"; flow:to_server,established; file_data; content:"|80 90 60 70 40 50 10 20 30 AF FD A0 00 80 10 10 00 00 00 1B FC 00 00 00 00 10 00 00 00 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-2971; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; reference:url,www.talosintelligence.com/reports/TALOS-2016-0259/; classtype:attempted-user; sid:41305; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader jpeg decoding heap buffer overflow attempt"; flow:to_server,established; file_data; content:"|04 05 01 02 03 0A FF DA 00 08 01 01 00 00 00 01 BF C0 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1C 1C 1F 63 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-2971; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; reference:url,www.talosintelligence.com/reports/TALOS-2016-0259/; classtype:attempted-user; sid:41304; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader jpeg decoding heap buffer overflow attempt"; flow:to_server,established; file_data; content:"4050102030affda0008010100000001bfc00000000800000"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-2971; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; reference:url,www.talosintelligence.com/reports/TALOS-2016-0259/; classtype:attempted-user; sid:41303; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader jpeg decoding heap buffer overflow attempt"; flow:to_server,established; file_data; content:"00801010000000001feAA|20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-2971; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; reference:url,www.talosintelligence.com/reports/TALOS-2016-0259/; classtype:attempted-user; sid:41302; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader jpeg decoding heap buffer overflow attempt"; flow:to_client,established; file_data; content:"|04 05 01 02 03 0A FF DA 00 08 01 01 00 00 00 01 BF C0 00 00 00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1C 1C 1F 63 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2971; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; reference:url,www.talosintelligence.com/reports/TALOS-2016-0259/; classtype:attempted-user; sid:41301; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader jpeg decoding heap buffer overflow attempt"; flow:to_client,established; file_data; content:"809060704050102030affda0008010100000001bfc0000000010000000000000"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2971; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; reference:url,www.talosintelligence.com/reports/TALOS-2016-0259/; classtype:attempted-user; sid:41300; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader jpeg decoding heap buffer overflow attempt"; flow:to_client,established; file_data; content:"4050102030affda0008010100000001bfc00000000800000"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2971; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; reference:url,www.talosintelligence.com/reports/TALOS-2016-0259/; classtype:attempted-user; sid:41299; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader jpeg decoding heap buffer overflow attempt"; flow:to_client,established; file_data; content:"00801010000000001feAA|20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20 20|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2971; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; reference:url,www.talosintelligence.com/reports/TALOS-2016-0259/; classtype:attempted-user; sid:41298; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG APP2 segment out of bounds memory access attempt"; flow:to_server,established; flowbits:isset,file.jpeg|file.xps; file_data; content:"|FF E0|"; content:"JFIF"; within:4; distance:2; content:"|FF E2|"; distance:0; content:"ICC_PROFILE|00|"; within:12; distance:2; content:!"|00|"; within:1; content:"|00|"; within:1; distance:1; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-16383; reference:cve,2017-2959; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-admin; sid:41203; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Pro malformed JPEG APP2 segment out of bounds memory access attempt"; flow:to_client,established; flowbits:isset,file.jpeg|file.xps; file_data; content:"|FF E0|"; content:"JFIF"; within:4; distance:2; content:"|FF E2|"; distance:0; content:"ICC_PROFILE|00|"; within:12; distance:2; content:!"|00|"; within:1; content:"|00|"; within:1; distance:1; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-16383; reference:cve,2017-2959; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; classtype:attempted-admin; sid:41202; rev:6;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat TIFF Software tag heap buffer overflow attempt"; flow:to_server,established; file_data; content:"II|2A 00|"; depth:4; content:"|01 01 03 00 01 00 00 00|"; content:"|31 01 02 00|"; within:300; distance:-50; byte_test:1,&,0x80,3,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2965; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41201; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat TIFF Software tag heap buffer overflow attempt"; flow:to_client,established; file_data; content:"II|2A 00|"; depth:4; content:"|01 01 03 00 01 00 00 00|"; content:"|31 01 02 00|"; within:300; distance:-50; byte_test:1,&,0x80,3,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2965; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41200; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat TIFF Software tag heap buffer overflow attempt"; flow:to_server,established; file_data; content:"MM|00 2A|"; depth:4; content:"|01 01 00 03 00 00 00 01|"; content:"|01 31 00 02|"; within:300; distance:-50; byte_test:1,&,0x80,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2965; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41199; rev:5;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat TIFF Software tag heap buffer overflow attempt"; flow:to_client,established; file_data; content:"MM|00 2A|"; depth:4; content:"|01 01 00 03 00 00 00 01|"; content:"|01 31 00 02|"; within:300; distance:-50; byte_test:1,&,0x80,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2965; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41198; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat TIFF PhotometricInterpretation heap buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"MM|00 2A|"; depth:4; content:"|01 01 00 03 00 00 00 01|"; content:"|01 06 00 03|"; within:100; distance:-50; byte_test:1,&,0x80,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2966; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41184; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat TIFF PhotometricInterpretation heap buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"II|2A 00|"; depth:4; content:"|01 01 03 00 01 00 00 00|"; content:"|06 01 03 00|"; within:100; distance:-50; byte_test:1,&,0x80,3,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2966; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41183; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat TIFF PhotometricInterpretation heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"MM|00 2A|"; depth:4; content:"|01 01 00 03 00 00 00 01|"; content:"|01 06 00 03|"; within:100; distance:-50; byte_test:1,&,0x80,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2966; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41182; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat TIFF PhotometricInterpretation heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"II|2A 00|"; depth:4; content:"|01 01 03 00 01 00 00 00|"; content:"|06 01 03 00|"; within:100; distance:-50; byte_test:1,&,0x80,3,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2966; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41181; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Reader malformed app13 marker memory corruption attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF ED|"; content:"Photoshop 3.0|00|8BIM|03 ED 00 00|"; within:23; distance:2; byte_test:4,>,0x100000,0,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2964; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41149; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Reader malformed app13 marker memory corruption attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF ED|"; content:"Photoshop 3.0|00|8BIM|03 ED|"; within:21; distance:2; content:!"|00|"; within:1; byte_test:1,!&,1,0,relative; byte_jump:1,0,relative; byte_test:4,>,0x100000,0,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2964; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41148; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Reader malformed app13 marker memory corruption attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF ED|"; content:"Photoshop 3.0|00|8BIM|03 ED|"; within:21; distance:2; byte_test:1,&,1,0,relative; byte_jump:1,0,relative,post_offset 1; byte_test:4,>,0x100000,0,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2964; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41147; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Reader malformed app13 marker memory corruption attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF ED|"; content:"Photoshop 3.0|00|8BIM|03 ED 00 00|"; within:23; distance:2; byte_test:4,>,0x100000,0,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2964; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41146; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Reader malformed app13 marker memory corruption attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF ED|"; content:"Photoshop 3.0|00|8BIM|03 ED|"; within:21; distance:2; content:!"|00|"; within:1; byte_test:1,!&,1,0,relative; byte_jump:1,0,relative; byte_test:4,>,0x100000,0,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2964; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41145; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Reader malformed app13 marker memory corruption attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF ED|"; content:"Photoshop 3.0|00|8BIM|03 ED|"; within:21; distance:2; byte_test:1,&,1,0,relative; byte_jump:1,0,relative,post_offset 1; byte_test:4,>,0x100000,0,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2964; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-01.html; classtype:attempted-user; sid:41144; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,25] (msg:"FILE-IMAGE ImageMagick PostScript decode delegate command injection attempt"; flow:to_server,established; file_data; content:"/OutputICCProfile"; nocase; content:"%pipe%"; distance:0; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service smtp; reference:url,seclists.org/fulldisclosure/2016/Oct/77; classtype:attempted-user; sid:41121; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick PostScript decode delegate command injection attempt"; flow:to_client,established; file_data; content:"/OutputICCProfile"; nocase; content:"%pipe%"; distance:0; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,seclists.org/fulldisclosure/2016/Oct/77; classtype:attempted-user; sid:41120; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE ImageMagick LibTIFF invalid SamplesPerPixel buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff; file_data; content:"II|2A 00|"; depth:4; content:"|06 01 03 00 01 00 00 00 02 00|"; fast_pattern:only; content:"|1C 01 03 00 01 00 00 00 01 00|"; content:"|15 01 03 00 01 00 00 00|"; byte_test:2,<,3,0,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-8707; reference:url,www.talosintelligence.com/reports/TALOS-2016-0216; classtype:attempted-user; sid:40915; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick LibTIFF invalid SamplesPerPixel buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff; file_data; content:"II|2A 00|"; depth:4; content:"|06 01 03 00 01 00 00 00 02 00|"; fast_pattern:only; content:"|1C 01 03 00 01 00 00 00 01 00|"; content:"|15 01 03 00 01 00 00 00|"; byte_test:2,<,3,0,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-8707; reference:url,www.talosintelligence.com/reports/TALOS-2016-0216; classtype:attempted-user; sid:40914; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows asycfilt.dll malformed jpeg buffer overread attempt"; flow:to_server,established; file_data; isdataat:!14; content:"|FF D8 FF E0 00 10|"; depth:6; isdataat:1,relative; content:!"|4A 46|"; within:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-7212; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-130; classtype:attempted-user; sid:40646; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows asycfilt.dll malformed jpeg buffer overread attempt"; flow:to_client,established; file_data; isdataat:!14; content:"|FF D8 FF E0 00 10|"; depth:6; isdataat:1,relative; content:!"|4A 46|"; within:2; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-7212; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-130; classtype:attempted-user; sid:40645; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE LibTIFF FAX IFD entry parsing type confusion attempt"; flow:to_server,established; flowbits:isset,file.tiff; file_data; content:"II|2A 00|"; depth:4; content:"|01 01 03 00 01 00 00 00|"; content:"|48 01|"; within:100; distance:-50; content:"|01 00 00 00|"; within:4; distance:2; content:!"|03 01|"; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-8331; reference:url,www.talosintelligence.com/reports/TALOS-2016-0190/; classtype:attempted-user; sid:40538; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE LibTIFF FAX IFD entry parsing type confusion attempt"; flow:to_client,established; flowbits:isset,file.tiff; file_data; content:"II|2A 00|"; depth:4; content:"|01 01 03 00 01 00 00 00|"; content:"|48 01|"; within:100; distance:-50; content:"|01 00 00 00|"; within:4; distance:2; content:!"|03 01|"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-8331; reference:url,www.talosintelligence.com/reports/TALOS-2016-0190/; classtype:attempted-user; sid:40537; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE LibTIFF FAX IFD entry parsing type confusion attempt"; flow:to_server,established; flowbits:isset,file.tiff; file_data; content:"II|2A 00|"; depth:4; content:"|01 01 03 00 01 00 00 00|"; content:"|47 01|"; within:100; distance:-50; content:"|01 00 00 00|"; within:4; distance:2; content:!"|03 01|"; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-8331; reference:url,www.talosintelligence.com/reports/TALOS-2016-0190/; classtype:attempted-user; sid:40536; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE LibTIFF FAX IFD entry parsing type confusion attempt"; flow:to_client,established; flowbits:isset,file.tiff; file_data; content:"II|2A 00|"; depth:4; content:"|01 01 03 00 01 00 00 00|"; content:"|47 01|"; within:100; distance:-50; content:"|01 00 00 00|"; within:4; distance:2; content:!"|03 01|"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-8331; reference:url,www.talosintelligence.com/reports/TALOS-2016-0190/; classtype:attempted-user; sid:40535; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE LibTIFF FAX IFD entry parsing type confusion attempt"; flow:to_server,established; flowbits:isset,file.tiff; file_data; content:"II|2A 00|"; depth:4; content:"|01 01 03 00 01 00 00 00|"; content:"|46 01|"; within:100; distance:-50; content:"|01 00 00 00|"; within:4; distance:2; content:!"|03 01|"; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-8331; reference:url,www.talosintelligence.com/reports/TALOS-2016-0190/; classtype:attempted-user; sid:40534; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE LibTIFF FAX IFD entry parsing type confusion attempt"; flow:to_client,established; flowbits:isset,file.tiff; file_data; content:"II|2A 00|"; depth:4; content:"|01 01 03 00 01 00 00 00|"; content:"|46 01|"; within:100; distance:-50; content:"|01 00 00 00|"; within:4; distance:2; content:!"|03 01|"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-8331; reference:url,www.talosintelligence.com/reports/TALOS-2016-0190/; classtype:attempted-user; sid:40533; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE LibTIFF tiff2pdf JPEG compression tables heap buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff; file_data; content:"II|2A 00|"; depth:4; content:"|03 01 03 00 01 00 00 00 07 00 00 00|"; content:"|5B 01 02 00|"; within:500; distance:-250; byte_jump:4,4,relative,little,from_beginning; isdataat:2,relative; content:!"|FF D8|"; within:2; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-5652; reference:url,www.talosintelligence.com/reports/TALOS-2016-0187/; classtype:attempted-user; sid:40526; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE LibTIFF tiff2pdf JPEG compression tables heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff; file_data; content:"II|2A 00|"; depth:4; content:"|03 01 03 00 01 00 00 00 07 00 00 00|"; content:"|5B 01 02 00|"; within:500; distance:-250; byte_jump:4,4,relative,little,from_beginning; isdataat:2,relative; content:!"|FF D8|"; within:2; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-5652; reference:url,www.talosintelligence.com/reports/TALOS-2016-0187/; classtype:attempted-user; sid:40525; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE OpenJPEG JPEG2000 MCC record parsing heap memory corruption attempt"; flow:to_server,established; file_data; content:"jp2c|FF 4F FF 51|"; content:"|FF 75|"; within:500; content:"|00|"; within:1; distance:2; byte_jump:2,-3,relative,post_offset -2; content:"|FF 75|"; within:2; content:"|00|"; within:1; distance:2; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-8332; reference:url,www.talosintelligence.com/reports/TALOS-2016-0193/; classtype:attempted-user; sid:40315; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE OpenJPEG JPEG2000 MCC record parsing heap memory corruption attempt"; flow:to_client,established; file_data; content:"jp2c|FF 4F FF 51|"; content:"|FF 75|"; within:500; content:"|00|"; within:1; distance:2; byte_jump:2,-3,relative,post_offset -2; content:"|FF 75|"; within:2; content:"|00|"; within:1; distance:2; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-8332; reference:url,www.talosintelligence.com/reports/TALOS-2016-0193/; classtype:attempted-user; sid:40314; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE PHP exif_process_IFD_in_MAKERNOTE out of bounds read attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|92 7C 00 04|"; byte_test:4,>,30000000,8,relative,big; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-6291; reference:url,bugs.php.net/bug.php?id=72603; classtype:attempted-user; sid:40297; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE PHP exif_process_IFD_in_MAKERNOTE out of bounds read attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|7C 92 04 00|"; byte_test:4,>,30000000,8,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-6291; reference:url,bugs.php.net/bug.php?id=72603; classtype:attempted-user; sid:40296; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE PHP exif_process_IFD_in_MAKERNOTE out of bounds read attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|92 7C 00 04|"; byte_test:4,>,30000000,8,relative,big; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-6291; reference:url,bugs.php.net/bug.php?id=72603; classtype:attempted-user; sid:40295; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE PHP exif_process_IFD_in_MAKERNOTE out of bounds read attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|7C 92 04 00|"; byte_test:4,>,30000000,8,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-6291; reference:url,bugs.php.net/bug.php?id=72603; classtype:attempted-user; sid:40294; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE PHP exif_process_user_comment null pointer dereference attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|92 86|"; byte_jump:4,6,relative,big,from_beginning; content:"JIS|00 00 00 00 00|"; within:8; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-6292; reference:url,bugs.php.net/bug.php?id=72618; classtype:attempted-user; sid:40248; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE PHP exif_process_user_comment null pointer dereference attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|86 92|"; byte_jump:4,6,relative,little,from_beginning; content:"JIS|00 00 00 00 00|"; within:8; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-6292; reference:url,bugs.php.net/bug.php?id=72618; classtype:attempted-user; sid:40247; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE PHP exif_process_user_comment null pointer dereference attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|92 86|"; byte_jump:4,6,relative,big,from_beginning; content:"JIS|00 00 00 00 00|"; within:8; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-6292; reference:url,bugs.php.net/bug.php?id=72618; classtype:attempted-user; sid:40246; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE PHP exif_process_user_comment null pointer dereference attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|86 92|"; byte_jump:4,6,relative,little,from_beginning; content:"JIS|00 00 00 00 00|"; within:8; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-6292; reference:url,bugs.php.net/bug.php?id=72618; classtype:attempted-user; sid:40245; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $FILE_DATA_PORTS (msg:"FILE-IMAGE PHP exif_process_user_comment null pointer dereference attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|92 86|"; http_client_body; byte_extract:4,6,offset,relative,big; content:"|0D 0A 0D 0A|"; http_client_body; content:"JIS|00 00 00 00 00|"; within:8; distance:offset; http_client_body; metadata:policy max-detect-ips drop, service http; reference:cve,2016-6292; reference:url,bugs.php.net/bug.php?id=72618; classtype:attempted-user; sid:40244; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $FILE_DATA_PORTS (msg:"FILE-IMAGE PHP exif_process_user_comment null pointer dereference attempt"; flow:to_server,established; flowbits:isset,file.jpeg; content:"|86 92|"; http_client_body; byte_extract:4,6,offset,relative,little; content:"|0D 0A 0D 0A|"; http_client_body; content:"JIS|00 00 00 00 00|"; within:8; distance:offset; http_client_body; metadata:policy max-detect-ips drop, service http; reference:cve,2016-6292; reference:url,bugs.php.net/bug.php?id=72618; classtype:attempted-user; sid:40243; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE FreeImage library XPM handling out of bounds write attempt"; flow:to_server,established; file_data; content:" XPM "; depth:25; fast_pattern; content:"char"; pcre:"/\x2f\x2a\s+XPM\s+\x2a\x2f[^\x7b]*?\x7b\s*\x22\s*(\d+\s+){3}\d{4}/"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-5684; reference:url,www.talosintelligence.com/reports/TALOS-2016-0189; classtype:attempted-user; sid:39884; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE FreeImage library XPM handling out of bounds write attempt"; flow:to_client,established; file_data; content:" XPM "; depth:25; fast_pattern; content:"char"; pcre:"/\x2f\x2a\s+XPM\s+\x2a\x2f[^\x7b]*?\x7b\s*\x22\s*(\d+\s+){3}\d{4}/"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-5684; reference:url,www.talosintelligence.com/reports/TALOS-2016-0189; classtype:attempted-user; sid:39883; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple Core Graphics BMP img_decode_read memory corruption attempt"; flow:to_server,established; file_data; content:"BM"; depth:2; content:"|28 00 00 00|"; within:4; distance:12; byte_test:1,!&,0x80,7,relative; byte_test:4,>,0xFF00,4,relative,little; byte_extract:4,4,biHeight,relative,little; byte_test:4,<,biHeight,2,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4637; reference:url,support.apple.com/en-us/HT206903; reference:url,www.talosintelligence.com/reports/TALOS-2016-0186/; classtype:attempted-user; sid:39684; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple Core Graphics BMP img_decode_read memory corruption attempt"; flow:to_client,established; file_data; content:"BM"; depth:2; content:"|28 00 00 00|"; within:4; distance:12; byte_test:1,!&,0x80,7,relative; byte_test:4,>,0xFF00,4,relative,little; byte_extract:4,4,biHeight,relative,little; byte_test:4,<,biHeight,2,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4637; reference:url,support.apple.com/en-us/HT206903; reference:url,www.talosintelligence.com/reports/TALOS-2016-0186/; classtype:attempted-user; sid:39683; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle OIT CYMK TIFF parsing heap buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"|01 06 00 03 00 00 00 01 00 05 00 00|"; fast_pattern:only; content:"|01 15 00 03 00 00 00 01|"; byte_test:2,<,4,0,relative; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-3582; reference:url,www.talosintelligence.com/reports/TALOS-2016-0104; classtype:attempted-user; sid:39676; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle OIT CYMK TIFF parsing heap buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"|06 01 03 00 01 00 00 00 05 00 00 00|"; fast_pattern:only; content:"|15 01 03 00 01 00 00 00|"; byte_test:2,<,4,0,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-3582; reference:url,www.talosintelligence.com/reports/TALOS-2016-0104; classtype:attempted-user; sid:39675; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle OIT CYMK TIFF parsing heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|01 06 00 03 00 00 00 01 00 05 00 00|"; fast_pattern:only; content:"|01 15 00 03 00 00 00 01|"; byte_test:2,<,4,0,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-3582; reference:url,www.talosintelligence.com/reports/TALOS-2016-0104; classtype:attempted-user; sid:39674; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle OIT CYMK TIFF parsing heap buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"|06 01 03 00 01 00 00 00 05 00 00 00|"; fast_pattern:only; content:"|15 01 03 00 01 00 00 00|"; byte_test:2,<,4,0,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-3582; reference:url,www.talosintelligence.com/reports/TALOS-2016-0104; classtype:attempted-user; sid:39673; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple OSX EXR image invalid box2i attribute heap buffer overflow attempt"; flow:to_server,established; file_data; content:"v/1|01|"; depth:4; content:"box2i|00|"; content:!"|10 00 00 00|"; within:4; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4629; reference:url,www.talosintelligence.com/reports/TALOS-2016-0180; classtype:attempted-user; sid:39635; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple OSX EXR image invalid box2i attribute heap buffer overflow attempt"; flow:to_client,established; file_data; content:"v/1|01|"; depth:4; content:"box2i|00|"; content:!"|10 00 00 00|"; within:4; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4629; reference:url,www.talosintelligence.com/reports/TALOS-2016-0180; classtype:attempted-user; sid:39634; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"|01 00 00 04 00 00 00 01|"; byte_extract:4,0,imgWidth,relative,big; content:"|01 42 00 04 00 00 00 01|"; byte_test:4,>,imgWidth,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39632; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"|00 01 04 00 01 00 00 00|"; byte_extract:4,0,imgWidth,relative,little; content:"|42 01 04 00 01 00 00 00|"; byte_test:4,>,imgWidth,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39631; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"|01 01 00 04 00 00 00 01|"; byte_extract:4,0,imgLength,relative,big; content:"|01 43 00 04 00 00 00 01|"; byte_test:4,>,imgLength,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39630; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"|01 01 04 00 01 00 00 00|"; byte_extract:4,0,imgLength,relative,little; content:"|43 01 04 00 01 00 00 00|"; byte_test:4,>,imgLength,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39629; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"|01 00 00 04 00 00 00 01|"; byte_extract:4,0,imgWidth,relative,big; content:"|01 42 00 03 00 00 00 01|"; byte_test:2,>,imgWidth,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39628; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"|00 01 04 00 01 00 00 00|"; byte_extract:4,0,imgWidth,relative,little; content:"|42 01 03 00 01 00 00 00|"; byte_test:2,>,imgWidth,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39627; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"|01 01 00 04 00 00 00 01|"; byte_extract:4,0,imgLength,relative,big; content:"|01 43 00 03 00 00 00 01|"; byte_test:2,>,imgLength,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39626; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"|01 01 04 00 01 00 00 00|"; byte_extract:4,0,imgLength,relative,little; content:"|43 01 03 00 01 00 00 00|"; byte_test:2,>,imgLength,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39625; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|01 00 00 04 00 00 00 01|"; byte_extract:4,0,imgWidth,relative,big; content:"|01 42 00 04 00 00 00 01|"; byte_test:4,>,imgWidth,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39624; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"|00 01 04 00 01 00 00 00|"; byte_extract:4,0,imgWidth,relative,little; content:"|42 01 04 00 01 00 00 00|"; byte_test:4,>,imgWidth,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39623; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|01 01 00 04 00 00 00 01|"; byte_extract:4,0,imgLength,relative,big; content:"|01 43 00 04 00 00 00 01|"; byte_test:4,>,imgLength,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205/; classtype:attempted-user; sid:39622; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"|01 01 04 00 01 00 00 00|"; byte_extract:4,0,imgLength,relative,little; content:"|43 01 04 00 01 00 00 00|"; byte_test:4,>,imgLength,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39621; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|01 00 00 04 00 00 00 01|"; byte_extract:4,0,imgWidth,relative,big; content:"|01 42 00 03 00 00 00 01|"; byte_test:2,>,imgWidth,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39620; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"|00 01 04 00 01 00 00 00|"; byte_extract:4,0,imgWidth,relative,little; content:"|42 01 03 00 01 00 00 00|"; byte_test:2,>,imgWidth,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39619; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|01 01 00 04 00 00 00 01|"; byte_extract:4,0,imgLength,relative,big; content:"|01 43 00 03 00 00 00 01|"; byte_test:2,>,imgLength,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39618; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"|01 01 04 00 01 00 00 00|"; byte_extract:4,0,imgLength,relative,little; content:"|43 01 03 00 01 00 00 00|"; byte_test:2,>,imgLength,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39617; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"|01 00 00 03 00 00 00 01|"; byte_extract:2,0,imgWidth,relative,big; content:"|01 42 00 04 00 00 00 01|"; byte_test:4,>,imgWidth,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39616; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"|00 01 03 00 01 00 00 00|"; byte_extract:2,0,imgWidth,relative,little; content:"|42 01 04 00 01 00 00 00|"; byte_test:4,>,imgWidth,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:cve,2017-2870; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; reference:url,www.talosintelligence.com/reports/TALOS-2017-0377; classtype:attempted-user; sid:39615; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"|01 01 00 03 00 00 00 01|"; byte_extract:2,0,imgLength,relative,big; content:"|01 43 00 04 00 00 00 01|"; byte_test:4,>,imgLength,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39614; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"|01 01 03 00 01 00 00 00|"; byte_extract:2,0,imgLength,relative,little; content:"|43 01 04 00 01 00 00 00|"; byte_test:4,>,imgLength,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39613; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"|01 00 00 03 00 00 00 01|"; byte_extract:2,0,imgWidth,relative,big; content:"|01 42 00 03 00 00 00 01|"; byte_test:2,>,imgWidth,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39612; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"|00 01 03 00 01 00 00 00|"; byte_extract:2,0,imgWidth,relative,little; content:"|42 01 03 00 01 00 00 00|"; byte_test:2,>,imgWidth,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39611; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"|01 01 00 03 00 00 00 01|"; byte_extract:2,0,imgLength,relative,big; content:"|01 43 00 03 00 00 00 01|"; byte_test:2,>,imgLength,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39610; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"|01 01 03 00 01 00 00 00|"; byte_extract:2,0,imgLength,relative,little; content:"|43 01 03 00 01 00 00 00|"; byte_test:2,>,imgLength,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39609; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|01 00 00 03 00 00 00 01|"; byte_extract:2,0,imgWidth,relative,big; content:"|01 42 00 04 00 00 00 01|"; byte_test:4,>,imgWidth,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39608; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"|00 01 03 00 01 00 00 00|"; byte_extract:2,0,imgWidth,relative,little; content:"|42 01 04 00 01 00 00 00|"; byte_test:4,>,imgWidth,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:cve,2017-2870; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; reference:url,www.talosintelligence.com/reports/TALOS-2017-0377; classtype:attempted-user; sid:39607; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|01 01 00 03 00 00 00 01|"; byte_extract:2,0,imgLength,relative,big; content:"|01 43 00 04 00 00 00 01|"; byte_test:4,>,imgLength,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39606; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"|01 01 03 00 01 00 00 00|"; byte_extract:2,0,imgLength,relative,little; content:"|43 01 04 00 01 00 00 00|"; byte_test:4,>,imgLength,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39605; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|01 00 00 03 00 00 00 01|"; byte_extract:2,0,imgWidth,relative,big; content:"|01 42 00 03 00 00 00 01|"; byte_test:2,>,imgWidth,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39604; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"|00 01 03 00 01 00 00 00|"; byte_extract:2,0,imgWidth,relative,little; content:"|42 01 03 00 01 00 00 00|"; byte_test:2,>,imgWidth,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39603; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|01 01 00 03 00 00 00 01|"; byte_extract:2,0,imgLength,relative,big; content:"|01 43 00 03 00 00 00 01|"; byte_test:2,>,imgLength,0,relative,big; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39602; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Multiple products TIFF tile size buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.little; file_data; content:"|01 01 03 00 01 00 00 00|"; byte_extract:2,0,imgLength,relative,little; content:"|43 01 03 00 01 00 00 00|"; byte_test:2,>,imgLength,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4631; reference:cve,2016-5875; reference:url,www.talosintelligence.com/reports/TALOS-2016-0171; reference:url,www.talosintelligence.com/reports/TALOS-2016-0205; classtype:attempted-user; sid:39601; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple OSX EXR image tile size heap buffer overflow attempt"; flow:to_server,established; file_data; content:"v/1|01|"; depth:4; content:"compression|00 01 00 00 00 07|"; fast_pattern:only; content:"tiledesc|00|"; byte_test:1,&,0x80,7,relative; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-4630; reference:url,www.talosintelligence.com/reports/TALOS-2016-0181; classtype:attempted-user; sid:39600; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple OSX EXR image tile size heap buffer overflow attempt"; flow:to_client,established; file_data; content:"v/1|01|"; depth:4; content:"compression|00 01 00 00 00 07|"; fast_pattern:only; content:"tiledesc|00|"; byte_test:1,&,0x80,7,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-4630; reference:url,www.talosintelligence.com/reports/TALOS-2016-0181; classtype:attempted-user; sid:39599; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle OIT BMP file parsing heap buffer overflow attempt"; flow:to_server,established; file_data; content:"BM"; depth:2; byte_test:4,>,16000,16,relative,little; content:!"|04 00|"; within:2; distance:26; content:"|02 00 00 00|"; within:4; distance:28; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-3596; reference:url,www.talosintelligence.com/reports/TALOS-2016-0163; classtype:attempted-user; sid:39596; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle OIT BMP file parsing heap buffer overflow attempt"; flow:to_server,established; file_data; content:"BM"; depth:2; byte_test:4,>,16000,16,relative,little; content:!"|08 00|"; within:2; distance:26; content:"|01 00 00 00|"; within:4; distance:28; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-3596; reference:url,www.talosintelligence.com/reports/TALOS-2016-0163; classtype:attempted-user; sid:39595; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle OIT BMP file parsing heap buffer overflow attempt"; flow:to_client,established; file_data; content:"BM"; depth:2; byte_test:4,>,16000,16,relative,little; content:!"|04 00|"; within:2; distance:26; content:"|02 00 00 00|"; within:4; distance:28; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-3596; reference:url,www.talosintelligence.com/reports/TALOS-2016-0163; classtype:attempted-user; sid:39594; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle OIT BMP file parsing heap buffer overflow attempt"; flow:to_client,established; file_data; content:"BM"; depth:2; byte_test:4,>,16000,16,relative,little; content:!"|08 00|"; within:2; distance:26; content:"|01 00 00 00|"; within:4; distance:28; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-3596; reference:url,www.talosintelligence.com/reports/TALOS-2016-0163; classtype:attempted-user; sid:39593; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Pro DC Exif Software metadata memory corruption attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF E1|"; depth:2; offset:20; byte_test:2,>,250,0,relative; content:"Exif|00 00|MM|00 2A 00 00 00 08|"; within:14; distance:2; content:"|01 31 00 02|"; within:300; fast_pattern; byte_jump:4,4,relative,from_beginning,post_offset 30; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39147; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Pro DC Exif Software metadata memory corruption attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF E1|"; depth:2; offset:20; byte_test:2,>,250,0,relative,little; content:"Exif|00 00|II|2A 00 08 00 00 00|"; within:14; distance:2; content:"|31 01 02 00|"; within:300; fast_pattern; byte_jump:4,4,relative,little,from_beginning,post_offset 30; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39146; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Pro DC Exif Software metadata memory corruption attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF E1|"; depth:4; byte_test:2,>,250,0,relative; content:"Exif|00 00|MM|00 2A 00 00 00 08|"; within:14; distance:2; content:"|01 31 00 02|"; within:300; fast_pattern; byte_jump:4,4,relative,from_beginning,post_offset 12; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39145; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Pro DC Exif Software metadata memory corruption attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF E1|"; depth:4; byte_test:2,>,250,0,relative,little; content:"Exif|00 00|II|2A 00 08 00 00 00|"; within:14; distance:2; content:"|31 01 02 00|"; within:300; fast_pattern; byte_jump:4,4,relative,little,from_beginning,post_offset 12; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39144; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Pro DC Exif ModifyDate metadata memory corruption attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF E1|"; depth:2; offset:20; byte_test:2,>,250,0,relative; content:"Exif|00 00|MM|00 2A 00 00 00 08|"; within:14; distance:2; content:"|01 32 00 02|"; within:300; fast_pattern; byte_jump:4,4,relative,from_beginning,post_offset 30; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39143; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Pro DC Exif ModifyDate metadata memory corruption attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF E1|"; depth:2; offset:20; byte_test:2,>,250,0,relative,little; content:"Exif|00 00|II|2A 00 08 00 00 00|"; within:14; distance:2; content:"|32 01 02 00|"; within:300; fast_pattern; byte_jump:4,4,relative,little,from_beginning,post_offset 30; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39142; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Pro DC Exif ModifyDate metadata memory corruption attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF E1|"; depth:4; byte_test:2,>,250,0,relative; content:"Exif|00 00|MM|00 2A 00 00 00 08|"; within:14; distance:2; content:"|01 32 00 02|"; within:300; fast_pattern; byte_jump:4,4,relative,from_beginning,post_offset 12; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39141; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Pro DC Exif ModifyDate metadata memory corruption attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF E1|"; depth:4; byte_test:2,>,250,0,relative,little; content:"Exif|00 00|II|2A 00 08 00 00 00|"; within:14; distance:2; content:"|32 01 02 00|"; within:300; fast_pattern; byte_jump:4,4,relative,little,from_beginning,post_offset 12; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39140; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Pro DC Exif Software metadata memory corruption attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF E1|"; depth:4; byte_test:2,>,250,0,relative; content:"Exif|00 00|MM|00 2A 00 00 00 08|"; within:14; distance:2; content:"|01 31 00 02|"; within:300; fast_pattern; byte_jump:4,4,relative,from_beginning,post_offset 12; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39139; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Pro DC Exif Software metadata memory corruption attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF E1|"; depth:4; byte_test:2,>,250,0,relative,little; content:"Exif|00 00|II|2A 00 08 00 00 00|"; within:14; distance:2; content:"|31 01 02 00|"; within:300; fast_pattern; byte_jump:4,4,relative,little,from_beginning,post_offset 12; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39138; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Pro DC Exif ModifyDate metadata memory corruption attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF E1|"; depth:4; byte_test:2,>,250,0,relative; content:"Exif|00 00|MM|00 2A 00 00 00 08|"; within:14; distance:2; content:"|01 32 00 02|"; within:300; fast_pattern; byte_jump:4,4,relative,from_beginning,post_offset 12; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39137; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Pro DC Exif ModifyDate metadata memory corruption attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF E1|"; depth:4; byte_test:2,>,250,0,relative,little; content:"Exif|00 00|II|2A 00 08 00 00 00|"; within:14; distance:2; content:"|32 01 02 00|"; within:300; fast_pattern; byte_jump:4,4,relative,little,from_beginning,post_offset 12; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39136; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Pro DC Exif Software metadata memory corruption attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF E1|"; depth:2; offset:20; byte_test:2,>,250,0,relative; content:"Exif|00 00|MM|00 2A 00 00 00 08|"; within:14; distance:2; content:"|01 31 00 02|"; within:300; fast_pattern; byte_jump:4,4,relative,from_beginning,post_offset 30; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39115; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Pro DC Exif Software metadata memory corruption attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF E1|"; depth:2; offset:20; byte_test:2,>,250,0,relative,little; content:"Exif|00 00|II|2A 00 08 00 00 00|"; within:14; distance:2; content:"|31 01 02 00|"; within:300; fast_pattern; byte_jump:4,4,relative,little,from_beginning,post_offset 30; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39114; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Pro DC Exif ModifyDate metadata memory corruption attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF E1|"; depth:2; offset:20; byte_test:2,>,250,0,relative; content:"Exif|00 00|MM|00 2A 00 00 00 08|"; within:14; distance:2; content:"|01 32 00 02|"; within:300; fast_pattern; byte_jump:4,4,relative,from_beginning,post_offset 30; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39113; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Pro DC Exif ModifyDate metadata memory corruption attempt"; flow:to_client,established; flowbits:isset,file.jpeg; file_data; content:"|FF E1|"; depth:2; offset:20; byte_test:2,>,250,0,relative,little; content:"Exif|00 00|II|2A 00 08 00 00 00|"; within:14; distance:2; content:"|32 01 02 00|"; within:300; fast_pattern; byte_jump:4,4,relative,little,from_beginning,post_offset 30; isdataat:250,relative; content:!"|00|"; within:250; content:!"|20|"; within:250; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-1076; reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html; classtype:attempted-user; sid:39112; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,25] (msg:"FILE-IMAGE ImageMagick and GraphicsMagick OpenBlob command injection attempt"; flow:to_server,established; file_data; content:"viewbox "; fast_pattern:only; content:"stroke "; nocase; content:"|7C|"; distance:0; pcre:"/stroke\s+[^\x28\x27\x22]*?[\x28\x27\x22](url\x28)?\x7c/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service smtp; reference:cve,2016-5118; classtype:attempted-user; sid:39097; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,25] (msg:"FILE-IMAGE ImageMagick and GraphicsMagick OpenBlob command injection attempt"; flow:to_server,established; file_data; content:"viewbox "; fast_pattern:only; content:"image "; nocase; content:"|7C|"; distance:0; pcre:"/image\s+[\w\x2d]+\s+\d+\s*,\s*\d+[^\x28\x27\x22]*?[\x28\x27\x22](url\x28)?\x7c/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service smtp; reference:cve,2016-5118; classtype:attempted-user; sid:39096; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,25] (msg:"FILE-IMAGE ImageMagick and GraphicsMagick OpenBlob command injection attempt"; flow:to_server,established; file_data; content:"viewbox "; fast_pattern:only; content:"fill "; nocase; content:"|7C|"; distance:0; pcre:"/fill\s+[^\x28\x27\x22]*?[\x28\x27\x22](url\x28)?\x7c/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service smtp; reference:cve,2016-5118; classtype:attempted-user; sid:39095; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,25] (msg:"FILE-IMAGE ImageMagick and GraphicsMagick OpenBlob command injection attempt"; flow:to_server,established; file_data; content:"<image"; nocase; content:"xlink:href"; distance:0; nocase; content:"|7C|"; distance:0; pcre:"/xlink\x3ahref\s*=\s*[\x22\x27]\x7c/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service smtp; reference:cve,2016-5118; classtype:attempted-user; sid:39094; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick and GraphicsMagick OpenBlob command injection attempt"; flow:to_client,established; file_data; content:"viewbox "; fast_pattern:only; content:"stroke "; nocase; content:"|7C|"; distance:0; pcre:"/stroke\s+[^\x28\x27\x22]*?[\x28\x27\x22](url\x28)?\x7c/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-5118; classtype:attempted-user; sid:39093; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick and GraphicsMagick OpenBlob command injection attempt"; flow:to_client,established; file_data; content:"viewbox "; fast_pattern:only; content:"image "; nocase; content:"|7C|"; distance:0; pcre:"/image\s+[\w\x2d]+\s+\d+\s*,\s*\d+[^\x28\x27\x22]*?[\x28\x27\x22](url\x28)?\x7c/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-5118; classtype:attempted-user; sid:39092; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick and GraphicsMagick OpenBlob command injection attempt"; flow:to_client,established; file_data; content:"viewbox "; fast_pattern:only; content:"fill "; nocase; content:"|7C|"; distance:0; pcre:"/fill\s+[^\x28\x27\x22]*?[\x28\x27\x22](url\x28)?\x7c/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-5118; classtype:attempted-user; sid:39091; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick and GraphicsMagick OpenBlob command injection attempt"; flow:to_client,established; file_data; content:"<image"; nocase; content:"xlink:href"; distance:0; nocase; content:"|7C|"; distance:0; pcre:"/xlink\x3ahref\s*=\s*[\x22\x27]\x7c/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-5118; classtype:attempted-user; sid:39090; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick WWWDecodeDelegate command injection attempt"; flow:to_client,established; file_data; content:"viewbox"; fast_pattern:only; content:"stroke"; nocase; content:"url|28|https:"; distance:0; nocase; pcre:"/stroke\s+url\x28https\x3a[^\x29]*?\x22/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,89848; reference:cve,2016-3714; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?t=29588; classtype:attempted-user; sid:39006; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick WWWDecodeDelegate command injection attempt"; flow:to_client,established; file_data; content:"viewbox"; fast_pattern:only; content:"stroke"; nocase; content:"https:"; distance:0; nocase; pcre:"/stroke\s+\x27(url\x28)?https\x3a[^\x27]*?\x22/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,89848; reference:cve,2016-3714; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?t=29588; classtype:attempted-user; sid:39005; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick WWWDecodeDelegate command injection attempt"; flow:to_client,established; file_data; content:"viewbox"; fast_pattern:only; content:"image"; nocase; content:"|28|https:"; distance:0; nocase; pcre:"/image\s+[\w\x2d]+\s+\d+\s*,\s*\d+[^\x28\x27]*?\x28https\x3a[^\x29]*?\x22/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,89848; reference:cve,2016-3714; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?t=29588; classtype:attempted-user; sid:39004; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick WWWDecodeDelegate command injection attempt"; flow:to_client,established; file_data; content:"viewbox"; fast_pattern:only; content:"image"; nocase; content:"https:"; distance:0; nocase; pcre:"/image\s+[\w\x2d]+\s+\d+\s*,\s*\d+[^\x28\x27]*?\x27(url\x28)?https\x3a[^\x27]*?\x22/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,89848; reference:cve,2016-3714; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?t=29588; classtype:attempted-user; sid:39003; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick WWWDecodeDelegate command injection attempt"; flow:to_client,established; file_data; content:"viewbox"; fast_pattern:only; content:"fill"; nocase; content:"url|28|https:"; distance:0; nocase; pcre:"/fill\s+url\x28https\x3a[^\x29]*?\x22/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,89848; reference:cve,2016-3714; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?t=29588; classtype:attempted-user; sid:39002; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick WWWDecodeDelegate command injection attempt"; flow:to_client,established; file_data; content:"viewbox"; fast_pattern:only; content:"fill"; nocase; content:"https:"; distance:0; nocase; pcre:"/fill\s+\x27(url\x28)?https\x3a[^\x27]*?\x22/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,89848; reference:cve,2016-3714; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?t=29588; classtype:attempted-user; sid:39001; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick WWWDecodeDelegate command injection attempt"; flow:to_client,established; file_data; content:"<image"; nocase; content:"xlink:href"; distance:0; nocase; pcre:"/xlink\x3ahref\s*=\s*[\x22\x27](h|&\x23(x0*68|0*104)\x3b)(t|&\x23(x0*74|0*116)\x3b){2}(p|&\x23(x0*70|0*112)\x3b)(s|&\x23(x0*73|0*115)\x3b)[^\x22\x27]*?&(quot|\x230*34|\x23x0*22)\x3b/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,89848; reference:cve,2016-3714; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?t=29588; classtype:attempted-user; sid:39000; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,25] (msg:"FILE-IMAGE ImageMagick WWWDecodeDelegate command injection attempt"; flow:to_server,established; file_data; content:"stroke"; nocase; content:"url|28|https:"; distance:0; nocase; pcre:"/stroke\s+url\x28https\x3a[^\x29]*?\x22/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service smtp; reference:bugtraq,89848; reference:cve,2016-3714; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?t=29588; classtype:attempted-user; sid:38948; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,25] (msg:"FILE-IMAGE ImageMagick WWWDecodeDelegate command injection attempt"; flow:to_server,established; file_data; content:"stroke"; nocase; content:"https:"; distance:0; nocase; pcre:"/stroke\s+\x27(url\x28)?https\x3a[^\x27]*?\x22/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service smtp; reference:bugtraq,89848; reference:cve,2016-3714; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?t=29588; classtype:attempted-user; sid:38947; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,25] (msg:"FILE-IMAGE ImageMagick WWWDecodeDelegate command injection attempt"; flow:to_server,established; file_data; content:"image"; nocase; content:"|28|https:"; distance:0; nocase; pcre:"/image\s+[\w\x2d]+\s+\d+\s*,\s*\d+[^\x28\x27]*?\x28https\x3a[^\x29]*?\x22/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service smtp; reference:bugtraq,89848; reference:cve,2016-3714; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?t=29588; classtype:attempted-user; sid:38946; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,25] (msg:"FILE-IMAGE ImageMagick WWWDecodeDelegate command injection attempt"; flow:to_server,established; file_data; content:"image"; nocase; content:"https:"; distance:0; nocase; pcre:"/image\s+[\w\x2d]+\s+\d+\s*,\s*\d+[^\x28\x27]*?\x27(url\x28)?https\x3a[^\x27]*?\x22/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service smtp; reference:bugtraq,89848; reference:cve,2016-3714; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?t=29588; classtype:attempted-user; sid:38945; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,25] (msg:"FILE-IMAGE ImageMagick WWWDecodeDelegate command injection attempt"; flow:to_server,established; file_data; content:"fill"; nocase; content:"https:"; distance:0; nocase; pcre:"/fill\s+\x27(url\x28)?https\x3a[^\x27]*?\x22/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service smtp; reference:bugtraq,89848; reference:cve,2016-3714; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?t=29588; classtype:attempted-user; sid:38871; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,25] (msg:"FILE-IMAGE ImageMagick WWWDecodeDelegate command injection attempt"; flow:to_server,established; file_data; content:"fill"; nocase; content:"url|28|https:"; distance:0; nocase; pcre:"/fill\s+url\x28https\x3a[^\x29]*?\x22/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service smtp; reference:bugtraq,89848; reference:cve,2016-3714; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?t=29588; classtype:attempted-user; sid:38744; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,25] (msg:"FILE-IMAGE ImageMagick WWWDecodeDelegate command injection attempt"; flow:to_server,established; file_data; content:"<image"; nocase; content:"xlink:href"; distance:0; nocase; pcre:"/xlink\x3ahref\s*=\s*[\x22\x27](h|&\x23(x0*68|0*104)\x3b)(t|&\x23(x0*74|0*116)\x3b){2}(p|&\x23(x0*70|0*112)\x3b)(s|&\x23(x0*73|0*115)\x3b)[^\x22\x27]*?&(quot|\x230*34|\x23x0*22)\x3b/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http, service smtp; reference:bugtraq,89848; reference:cve,2016-3714; reference:url,www.imagemagick.org/discourse-server/viewtopic.php?t=29588; classtype:attempted-user; sid:38743; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI metafile integer overflow attempt"; flow:to_server,established; file_data; content:"|D7 CD C6 9A 00 00|"; depth:6; content:"|00 00 00 00|"; within:4; distance:10; content:"|09 00|"; within:2; distance:4; content:"|0B 02|"; within:2; distance:18; byte_test:4,>,0x7FFFC002,-6,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,25302; reference:cve,2007-3034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-046; classtype:attempted-user; sid:37879; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI metafile integer overflow attempt"; flow:to_server,established; file_data; content:"|01 00 09 00 00 03|"; depth:6; content:"|13 02 32 00 96 00 03|"; byte_test:4,>,0x7FFFC002,-11,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,25302; reference:cve,2007-3034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-046; classtype:attempted-user; sid:37878; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI metafile integer overflow attempt"; flow:to_client,established; file_data; content:"|D7 CD C6 9A 00 00|"; depth:6; content:"|00 00 00 00|"; within:4; distance:10; content:"|09 00|"; within:2; distance:4; content:"|0B 02|"; within:2; distance:18; byte_test:4,>,0x7FFFC002,-6,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,25302; reference:cve,2007-3034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-046; classtype:attempted-user; sid:37877; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI metafile integer overflow attempt"; flow:to_client,established; file_data; content:"|01 00 09 00 00 03|"; depth:6; content:"|13 02 32 00 96 00 03|"; byte_test:4,>,0x7FFFC002,-11,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,25302; reference:cve,2007-3034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-046; classtype:attempted-user; sid:37876; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Camera Raw Plug-in TIFF image processing buffer underflow attempt"; flow:to_server,established; file_data; content:"|49 49 2A 00 84 17 00 00 80 10 60 64 18 19 04 E2 08 04 01 C0 00 C0 48 01 E8 F7 7C 00 00 20 80 08|"; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-5679; reference:url,www.adobe.com/support/security/bulletins/apsb12-28.html; classtype:attempted-user; sid:37332; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Camera Raw Plug-in TIFF image processing buffer underflow attempt"; flow:to_client,established; file_data; content:"|49 49 2A 00 84 17 00 00 80 10 60 64 18 19 04 E2 08 04 01 C0 00 C0 48 01 E8 F7 7C 00 00 20 80 08|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5679; reference:url,www.adobe.com/support/security/bulletins/apsb12-28.html; classtype:attempted-user; sid:37331; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Camera Raw Plug-in TIFF image processing buffer underflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"|80 38 9B CD 97 FB A5 C8 B8 00 0C 06 6E 00 00 10 0C 03 00 00 1F EF F8 8C 56 2D 17 8A BF DF D1 10|"; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-5679; reference:url,www.adobe.com/support/security/bulletins/apsb12-28.html; classtype:attempted-user; sid:37329; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Paint jpeg with malformed SOFx field integer overflow attempt"; flow:to_client,established; file_data; content:"|FF C0 00 11 08 FF 37 55 99 03 01 22 00 02 11 01 03 11 01|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-0028; reference:url,technet.microsoft.com/en-us/security/bulletin/MS10-005; classtype:attempted-user; sid:36884; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows malformed WMF meta escape record memory corruption attempt"; flow:to_server,established; flowbits:isset,file.wmf; file_data; content:"WMFC|01 00 00 00|"; byte_test:4,>,1000000,14,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2009-2500; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:36856; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Paint JPEG with malformed SOFx field integer overflow attempt"; flow:to_server,established; file_data; content:"|FF DA 00 0C 03 01 00 02 11 03 11 00 3F 00 CB A2 8A 2B F1 73 F8 0C 28 A2 8A 00 28 A2 8A 00 28 A2|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2010-0028; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-005; classtype:attempted-user; sid:36818; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows Paint JPEG with malformed SOFx field integer overflow attempt"; flow:to_client,established; file_data; content:"|FF DA 00 0C 03 01 00 02 11 03 11 00 3F 00 CB A2 8A 2B F1 73 F8 0C 28 A2 8A 00 28 A2 8A 00 28 A2|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-0028; reference:url,technet.microsoft.com/en-us/security/bulletin/ms10-005; classtype:attempted-user; sid:36817; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Trimble SketchUp corrupt BMP RLE4 heap buffer overflow attempt"; flow:to_server,established; file_data; content:"|42 4D|"; depth:2; content:"|28 00 00 00|"; within:4; distance:12; content:"|01 00 04 00|"; within:4; distance:8; content:!"|00|"; within:1; content:"|01 02 03 04 01 02 03 04 01 02 03 04 01 02 03 04 01 02 03 04 80|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3664; classtype:attempted-user; sid:36310; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Trimble SketchUp corrupt BMP RLE4 heap buffer overflow attempt"; flow:to_server,established; file_data; content:"|42 4D|"; depth:2; content:"|6C 00 00 00|"; within:4; distance:12; byte_test:4,<,6,0,relative,little; content:"|01 00 04 00|"; within:4; distance:8; content:!"|00|"; within:1; content:"|00 01|"; within:2; distance:90; byte_test:1,>,0x21,-4,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-3664; classtype:attempted-user; sid:36309; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Trimble SketchUp corrupt BMP RLE4 heap buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.bmp; content:"|42 4D|"; depth:2; content:"|28 00 00 00|"; within:4; distance:12; content:"|01 00 04 00|"; within:4; distance:8; content:!"|00|"; within:1; content:"|01 02 03 04 01 02 03 04 01 02 03 04 01 02 03 04 01 02 03 04 80|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3664; classtype:attempted-user; sid:36308; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Trimble SketchUp corrupt BMP RLE4 heap buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.bmp; content:"|42 4D|"; depth:2; content:"|6C 00 00 00|"; within:4; distance:12; byte_test:4,<,6,0,relative,little; content:"|01 00 04 00|"; within:4; distance:8; content:!"|00|"; within:1; content:"|00 01|"; within:2; distance:90; byte_test:1,>,0x21,-4,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3664; classtype:attempted-user; sid:36307; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Bitmap width integer overflow attempt"; flow:to_server,established; file_data; content:"BM"; depth:2; content:"|28 00 00 00|"; within:4; distance:12; byte_test:4,>,83386080,0,little,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,11171; reference:cve,2004-0904; reference:cve,2008-3015; reference:url,bugzilla.mozilla.org/show_bug.cgi?id=255067; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-052; classtype:attempted-admin; sid:35848; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat malformed PCX one-byte heap overwrite attempt"; flow:to_server,established; flowbits:isset,file.pcx; file_data; content:"|0A 05 01 08|"; depth:4; content:"|00 03 11 11|"; within:4; distance:60; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2015-5105; reference:url,helpx.adobe.com/security/products/reader/apsb15-15.html; classtype:attempted-user; sid:35799; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat malformed PCX one-byte heap overwrite attempt"; flow:to_client,established; flowbits:isset,file.pcx; file_data; content:"|0A 05 01 08|"; depth:4; content:"|00 03 11 11|"; within:4; distance:60; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-5105; reference:url,helpx.adobe.com/security/products/reader/apsb15-15.html; classtype:attempted-user; sid:35798; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat GIF to PDF conversion heap overflow attempt"; flow:to_server,established; file_data; content:"|F6 FF 00 2D 59 B2 01 42 60 1D 34 64 72 74 49 90 40 A0 43 87 F9 04 C2 98 31 A3 80 84 02 07 0A 14|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2015-5096; reference:url,helpx.adobe.com/security/products/reader/apsb15-15.html; classtype:attempted-user; sid:35752; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat GIF to PDF conversion heap overflow attempt"; flow:to_client,established; file_data; content:"|F6 FF 00 2D 59 B2 01 42 60 1D 34 64 72 74 49 90 40 A0 43 87 F9 04 C2 98 31 A3 80 84 02 07 0A 14|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-5096; reference:url,helpx.adobe.com/security/products/reader/apsb15-15.html; classtype:attempted-user; sid:35751; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader DC TIFF orientation heap buffer overflow attempt"; flow:to_server,established; file_data; content:"MM|00|*"; depth:4; content:"|01 12 00 03|"; byte_test:4,>,8,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2015-5097; reference:url,helpx.adobe.com/security/products/reader/apsb15-15.html; classtype:attempted-user; sid:35363; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader DC TIFF orientation heap buffer overflow attempt"; flow:to_client,established; file_data; content:"MM|00|*"; depth:4; content:"|01 12 00 03|"; byte_test:4,>,8,0,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-5097; reference:url,helpx.adobe.com/security/products/reader/apsb15-15.html; classtype:attempted-user; sid:35362; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Acrobat Reader DC TIFF orientation heap buffer overflow attempt"; flow:to_server,established; file_data; content:"II*|00|"; depth:4; content:"|12 01 03 00|"; byte_test:4,>,8,0,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2015-5097; reference:url,helpx.adobe.com/security/products/reader/apsb15-15.html; classtype:attempted-user; sid:35361; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Acrobat Reader DC TIFF orientation heap buffer overflow attempt"; flow:to_client,established; file_data; content:"II*|00|"; depth:4; content:"|12 01 03 00|"; byte_test:4,>,8,0,relative,little; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-5097; reference:url,helpx.adobe.com/security/products/reader/apsb15-15.html; classtype:attempted-user; sid:35360; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows wmf integer overflow attempt"; flow:to_client,established; content:"|D7 CD C6 9A 00 00|"; content:"|00 00 00 00|"; within:4; distance:10; content:"|09 00|"; within:2; distance:4; content:"|38 05|"; distance:0; byte_test:4,<,255,-6,relative,little; byte_test:2,>,4095,0,relative,little; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,25302; reference:cve,2007-3034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-046; classtype:web-application-attack; sid:34294; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows wmf integer overflow attempt"; flow:to_server,established; flowbits:isset,file.wmf; file_data; content:"|D7 CD C6 9A 00 00|"; content:"|00 00 00 00|"; within:4; distance:10; content:"|09 00|"; within:2; distance:4; content:"|38 05|"; distance:0; byte_test:4,<,255,-6,relative,little; byte_test:2,>,4095,0,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,25302; reference:cve,2007-3034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-046; classtype:web-application-attack; sid:34293; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Kodak Imaging small offset malformed tiff - little-endian"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"|02 01 03 00|"; byte_test:4,>,6,0,relative,little; metadata:policy max-detect-ips drop, service smtp; reference:cve,2007-2217; reference:url,technet.microsoft.com/en-us/security/bulletin/MS07-055; classtype:attempted-user; sid:34135; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Flash Player element array stack overflow attempt"; flow:to_server,established; file_data; content:"|A3 9F 58 B1 37 36 62 A8 E4 74 1B 82 A4 13 60 D8 84 4C F6 40 74 8D 06 A4 12 F2 39 43 19 70 DF 53|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2015-0350; classtype:attempted-user; sid:34134; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Flash Player element array stack overflow attempt"; flow:to_client,established; file_data; content:"|A3 9F 58 B1 37 36 62 A8 E4 74 1B 82 A4 13 60 D8 84 4C F6 40 74 8D 06 A4 12 F2 39 43 19 70 DF 53|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0350; classtype:attempted-user; sid:34133; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Internet Explorer PNG tRNS chuck size 1 information disclosure attempt"; flow:to_server,established; file_data; content:"|89|PNG|0D 0A 1A 0A|"; depth:8; content:"IHDR"; within:4; distance:4; content:"|00|"; within:1; distance:9; content:"|00 00 00 01|tRNS"; distance:0; fast_pattern; metadata:policy max-detect-ips drop, service smtp; reference:cve,2015-0080; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-024; classtype:misc-attack; sid:33761; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Internet Explorer PNG tRNS chuck size 1 information disclosure attempt"; flow:to_client,established; file_data; content:"|89|PNG|0D 0A 1A 0A|"; depth:8; content:"IHDR"; within:4; distance:4; content:"|00|"; within:1; distance:9; content:"|00 00 00 01|tRNS"; within:500; fast_pattern; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-0080; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-024; classtype:misc-attack; sid:33760; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft emf file download request"; flow:to_server,established; flowbits:isset,file.emf; file_data; content:" EMF"; depth:4; offset:40; metadata:policy max-detect-ips drop, ruleset community, service smtp; reference:bugtraq,10120; reference:bugtraq,28819; reference:bugtraq,9707; reference:cve,2003-0906; reference:cve,2007-5746; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-032; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-053; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-001; classtype:misc-activity; sid:33740; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Photoshop CS5 gif file heap corruption attempt"; flow:to_server,established; flowbits:isset,file.gif; file_data; content:"|08 0A 00 00 00 2C|"; content:"|00 66 00|"; within:3; distance:1; content:"|00|"; within:1; distance:1; content:"|00 07|"; within:2; distance:2; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,49106; reference:cve,2011-2131; classtype:attempted-user; sid:33615; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Photoshop CS4 TIFF parsing heap overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.little; file_data; content:"|03 01 03 00 01 00 00 00 74 87|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-2027; reference:url,www.adobe.com/support/security/bulletins/apsb12-11.html; classtype:attempted-user; sid:33591; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Photoshop CS4 TIFF parsing heap overflow attempt"; flow:to_server,established; flowbits:isset,file.tiff.big; file_data; content:"|01 03 00 03 00 00 00 01 87 74|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-2027; reference:cve,2017-3028; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-11.html; reference:url,www.adobe.com/support/security/bulletins/apsb12-11.html; classtype:attempted-user; sid:33590; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Photoshop CS4 TIFF parsing heap overflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|01 03 00 03 00 00 00 01 87 74|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-2027; reference:cve,2017-3028; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-11.html; reference:url,www.adobe.com/support/security/bulletins/apsb12-11.html; classtype:attempted-user; sid:33589; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_client,established; file_data; content:"|49 49 2A 00|"; depth:4; content:"|02 01 03 00 04 00 00 00|"; depth:100; content:"|06 01 04 00 01 00 00 00 05 00 00 00 0D 01 02 00|"; within:16; distance:4; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,36646; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:33518; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_server,established; file_data; content:"|49 49 2A 00|"; depth:4; content:"|02 01 03 00 04 00 00 00|"; depth:100; content:"|06 01 04 00 01 00 00 00 05 00 00 00 0D 01 02 00|"; within:16; distance:4; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,36646; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:33517; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_server,established; file_data; content:"|4D 4D 00 2A|"; depth:4; content:"|01 02 00 03 00 00 00 04 00 00 00|"; depth:100; content:"|01 06 00 04 00 00 00 01 00 00 00 05 01 0D 00 02 00 00 00|"; within:19; distance:1; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,36646; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:33516; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_client,established; file_data; content:"|4D 4D 00 2A|"; depth:4; content:"|01 02 00 03 00 00 00 04 00 00 00|"; depth:100; content:"|01 06 00 04 00 00 00 01 00 00 00 05 01 0D 00 02 00 00 00|"; within:19; distance:1; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,36646; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:33515; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft and libpng multiple products PNG large image width overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"|89|PNG|0D 0A 1A 0A|"; content:"IHDR"; within:8; byte_test:4,>,32767,0,relative; metadata:policy max-detect-ips drop, ruleset community, service smtp; reference:bugtraq,11523; reference:cve,2004-0990; reference:cve,2004-1244; reference:cve,2007-5503; reference:url,sourceforge.net/p/png-mng/mailman/message/33173462/; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-009; classtype:attempted-user; sid:32889; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_client,established; file_data; content:"|6D 36 54 55 6C 6A 43 41 43 7A 56 2F 77 79 35 34|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:32833; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_client,established; file_data; content:"|72 ED A6 A4 B6 87 E8 BE ED 5A 64 F4 51 DD 37 F3 31 40 00 B4 B7 3A 61 16 DD 75 A0 40 0F 03 82 16|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:32832; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_client,established; file_data; content:"|CE 28 C5 56 76 58 A4 26 88 A0 A2 AA 57 D1 FA 7A 23 93 93 A7 A2 D6 0A 18 F9 D5 43 CD 9A 32 88 75|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:32831; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_server,established; file_data; content:"|6D 36 54 55 6C 6A 43 41 43 7A 56 2F 77 79 35 34|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:32830; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_server,established; file_data; content:"|72 ED A6 A4 B6 87 E8 BE ED 5A 64 F4 51 DD 37 F3 31 40 00 B4 B7 3A 61 16 DD 75 A0 40 0F 03 82 16|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:32829; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows GDI+ TIFF file parsing heap overflow attempt"; flow:to_server,established; file_data; content:"|CE 28 C5 56 76 58 A4 26 88 A0 A2 AA 57 D1 FA 7A 23 93 93 A7 A2 D6 0A 18 F9 D5 43 CD 9A 32 88 75|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2009-2502; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-062; classtype:attempted-user; sid:32828; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Multiple Products JPEG parser heap overflow attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|00 10|JFIF"; depth:6; offset:4; pcre:"/^.{0,100}\xFF[\xE1\xE2\xED\xFE]\x00[\x00\x01]/s"; metadata:policy max-detect-ips drop, ruleset community, service smtp; reference:bugtraq,11173; reference:cve,2004-0200; reference:url,www.microsoft.com/security/bulletins/200409_jpeg.mspx; classtype:attempted-user; sid:31719; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE GIMP XWD RedMask file-handling stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.xwd; file_data; content:"|00 00 00 64 00 00 00 07|"; depth:8; isdataat:48,relative; content:!"|00 FF 00 00|"; within:4; distance:48; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,56647; reference:cve,2012-5576; classtype:attempted-user; sid:31576; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE GIMP XWD GreenMask file-handling stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.xwd; file_data; content:"|00 00 00 64 00 00 00 07|"; depth:8; isdataat:52,relative; content:!"|00 00 FF 00|"; within:4; distance:52; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,56647; reference:cve,2012-5576; classtype:attempted-user; sid:31575; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE GIMP XWD BlueMask file-handling stack buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.xwd; file_data; content:"|00 00 00 64 00 00 00 07|"; depth:8; isdataat:56,relative; content:!"|00 00 00 FF|"; within:4; distance:56; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,56647; reference:cve,2012-5576; classtype:attempted-user; sid:31574; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE GIMP XWD RedMask file-handling stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xwd; file_data; content:"|00 00 00 64 00 00 00 07|"; depth:8; isdataat:48,relative; content:!"|00 FF 00 00|"; within:4; distance:48; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,56647; reference:cve,2012-5576; classtype:attempted-user; sid:31573; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE GIMP XWD GreenMask file-handling stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xwd; file_data; content:"|00 00 00 64 00 00 00 07|"; depth:8; isdataat:52,relative; content:!"|00 00 FF 00|"; within:4; distance:52; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,56647; reference:cve,2012-5576; classtype:attempted-user; sid:31572; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE GIMP XWD BlueMask file-handling stack buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.xwd; file_data; content:"|00 00 00 64 00 00 00 07|"; depth:8; isdataat:56,relative; content:!"|00 00 00 FF|"; within:4; distance:56; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,56647; reference:cve,2012-5576; classtype:attempted-user; sid:31571; rev:3;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE XnView PCT file processing buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pct; file_data; content:"|36 32 36 36 32 3C 36 32 3C 32 15 32 33 34 44 43 42 41 AA AA AA AA 34 35 36 37 38 90 91 26 32 32|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-2577; reference:url,www.coresecurity.com/advisories/xnview-buffer-overflow-vulnerability; classtype:attempted-user; sid:31041; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE XnView PCT file processing buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pct; file_data; content:"|7F 7F 7F 7F 97 01 8F EE 8C 8F 83 7F 7D 73 71 6D 6D 67 66 61 65 60 5E 59 57 56 01 55 E6 57 5C 56|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-2577; reference:url,www.coresecurity.com/advisories/xnview-buffer-overflow-vulnerability; classtype:attempted-user; sid:31040; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE XnView PCT file processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pct; file_data; content:"|36 32 36 36 32 3C 36 32 3C 32 15 32 33 34 44 43 42 41 AA AA AA AA 34 35 36 37 38 90 91 26 32 32|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-2577; reference:url,www.coresecurity.com/advisories/xnview-buffer-overflow-vulnerability; classtype:attempted-user; sid:31039; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE XnView PCT file processing buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.pct; file_data; content:"|7F 7F 7F 7F 97 01 8F EE 8C 8F 83 7F 7D 73 71 6D 6D 67 66 61 65 60 5E 59 57 56 01 55 E6 57 5C 56|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-2577; reference:url,www.coresecurity.com/advisories/xnview-buffer-overflow-vulnerability; classtype:attempted-user; sid:31038; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE GIMP heap buffer overflow vulnerability attempt"; flow:to_server,established; flowbits:isset,file.psd; file_data; content:"8BPS|00 01 00 00 00 00 00 00|"; depth:12; byte_test:2,>,56,0,relative; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-3402; classtype:attempted-user; sid:30213; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE GIMP heap buffer overflow vulnerability attempt"; flow:to_client,established; flowbits:isset,file.psd; file_data; content:"8BPS|00 01 00 00 00 00 00 00|"; depth:12; byte_test:2,>,56,0,relative; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-3402; classtype:attempted-user; sid:30212; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Adobe Photoshop malformed PNG detected tRNS overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; content:"tRNS"; distance:0; fast_pattern; byte_test:4,>,256,-8,relative; metadata:service smtp; reference:bugtraq,13941; reference:bugtraq,18385; reference:cve,2005-1211; reference:cve,2006-0025; reference:cve,2012-4170; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:29620; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickTime PICT file overread buffer overflow attempt"; flow:to_server,established; flowbits:isset,file.pct; file_data; content:"|00 11 02 FF 0C 00 FF|"; byte_jump:2,-17,relative,post_offset -4,big; isdataat:1,relative; content:!"|00 FF|"; within:2; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,28583; reference:cve,2008-1019; classtype:attempted-user; sid:29434; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Adobe Camera Raw Plug-in TIFF image processing buffer underflow attempt"; flow:to_client,established; flowbits:isset,file.tiff.big; file_data; content:"|80 38 9B CD 97 FB A5 C8 B8 00 0C 06 6E 00 00 10 0C 03 00 00 1F EF F8 8C 56 2D 17 8A BF DF D1 10|"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-5679; reference:url,www.adobe.com/support/security/bulletins/apsb12-28.html; classtype:attempted-user; sid:29433; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE JPEG parser multipacket heap overflow attempt"; flow:to_server,established; flowbits:isset,file.jpeg; file_data; content:"|00 48 00 00 FF|"; fast_pattern:only; pcre:"/\x00\x48\x00\x00\xFF[\xE1\xE2\xED\xFE]\x00[\x00\x01]/"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,11173; reference:cve,2004-0200; reference:cve,2017-16392; reference:url,helpx.adobe.com/security/products/acrobat/apsb17-36.html; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-028; classtype:attempted-admin; sid:27569; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Directshow GIF logical height overflow attempt"; flow:to_server,established; file_data; content:"GIF8"; depth:4; byte_extract:2,8,gif_height,little; content:!"|00 3B|"; within:1000; content:"|2C 00 00|"; within:3; distance:387; byte_test:2,>,gif_height,0,relative,little; content:!"|96 00|"; within:2; distance:6; metadata:policy max-detect-ips drop, service smtp; reference:cve,2013-3174; classtype:attempted-user; sid:27530; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Directshow GIF logical height overflow attempt"; flow:to_server,established; file_data; content:"GIF8"; depth:4; byte_extract:2,8,gif_height,little; content:!"|00 3B|"; within:1000; content:"|2C 00 00|"; within:3; distance:387; byte_test:2,>,gif_height,4,relative,little; content:!"|96 00|"; within:2; distance:6; metadata:policy max-detect-ips drop, service smtp; reference:cve,2013-3174; classtype:attempted-user; sid:27529; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Directshow GIF logical width overflow attempt"; flow:to_server,established; file_data; content:"GIF8"; depth:4; byte_extract:2,6,gif_width,little; content:!"|00 3B|"; within:1000; content:"|2C 00 00|"; within:3; distance:389; byte_test:2,>,gif_width,2,relative,little; content:!"|96 00|"; within:2; distance:4; metadata:policy max-detect-ips drop, service smtp; reference:cve,2013-3174; classtype:attempted-user; sid:27528; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Directshow GIF logical height overflow attempt"; flow:to_client,established; file_data; content:"GIF8"; depth:4; byte_extract:2,8,gif_height,little; content:!"|00 3B|"; within:1000; content:"|2C|"; distance:0; byte_test:2,>,gif_height,2,relative,little; content:"|08 FF 00|"; within:3; distance:9; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3174; classtype:attempted-user; sid:27527; rev:9;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Directshow GIF logical height overflow attempt"; flow:to_client,established; file_data; content:"GIF8"; depth:4; byte_extract:2,8,gif_height,little; content:!"|00 3B|"; within:1000; content:"|2C|"; distance:0; byte_test:2,>,gif_height,6,relative,little; content:!"|96 00|"; within:2; distance:6; content:"|08 FF 00|"; within:3; distance:9; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3174; classtype:attempted-user; sid:27526; rev:10;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Directshow GIF logical width overflow attempt"; flow:to_client,established; file_data; content:"GIF8"; depth:4; byte_extract:2,6,gif_width,little; content:!"|00 3B|"; within:1000; content:"|2C|"; distance:0; byte_test:2,>,gif_width,4,relative,little; content:!"|96 00|"; within:2; distance:4; content:"|08 FF 00|"; within:3; distance:9; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-3174; classtype:attempted-user; sid:27525; rev:11;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle Outside In FlashPix image processing overflow attempt"; flow:to_server,established; flowbits:isset,file.fpx; file_data; content:"|FF D8 FF C0 00 11 08 00 40 00 40 03 01 22 00 02 11 01 03 FF 01|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-1744; classtype:attempted-user; sid:26979; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle Outside In FlashPix image processing overflow attempt"; flow:to_server,established; flowbits:isset,file.fpx; file_data; content:"|03 01 22 00 02 11 01 03 62 01 FF DA|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-1744; classtype:attempted-user; sid:26978; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Outside In FlashPix image processing overflow attempt"; flow:to_client,established; flowbits:isset,file.fpx; file_data; content:"|FF D8 FF C0 00 11 08 00 40 00 40 03 01 22 00 02 11 01 03 FF 01|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1744; classtype:attempted-user; sid:26977; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Outside In FlashPix image processing overflow attempt"; flow:to_client,established; flowbits:isset,file.fpx; file_data; content:"|03 01 22 00 02 11 01 03 62 01 FF DA|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1744; classtype:attempted-user; sid:26976; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows WMF denial of service attempt"; flow:to_server,established; flowbits:isset,file.wmf; file_data; content:"|FC 02|"; pcre:"/\xFC\x02[\x08\x06]\x00.{4}(?!\x00\x00)/s"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,21992; reference:cve,2006-4071; classtype:web-application-attack; sid:26909; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected zTXt overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"zTXt"; distance:0; byte_test:4,>,10000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26866; rev:4;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Multiple Products malformed PNG detected tEXt overflow attempt"; flow:to_server,established; file_data; content:"|89|PNG|0D 0A 1A 0A|"; fast_pattern; content:"tEXt"; distance:0; byte_test:4,>,10000,-8,relative; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:cve,2009-2501; reference:cve,2012-5470; reference:cve,2013-1331; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; reference:url,technet.microsoft.com/en-us/security/bulletin/ms09-062; reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-051; classtype:attempted-user; sid:26865; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected iTXt overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"iTXt"; distance:0; byte_test:4,>,10000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26864; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected tIME overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"tIME"; distance:0; byte_test:4,>,10000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26863; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected sPLT overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"sPLT"; distance:0; byte_test:4,>,10000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26862; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected pHYs overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"pHYs"; distance:0; byte_test:4,>,10000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26861; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected tRNS overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"tRNS"; distance:0; byte_test:4,>,7000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,13941; reference:bugtraq,18385; reference:cve,2005-1211; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26860; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected hIST overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"hIST"; distance:0; byte_test:4,>,10000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26859; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected bKGD overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"bKGD"; distance:0; byte_test:4,>,10000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26858; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected sRGB overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"sRGB"; distance:0; content:!"iCCP"; within:4; distance:-8; byte_test:4,>,10000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26857; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected sBIT overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"sBIT"; distance:0; byte_test:4,>,10000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26856; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected iCCP overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"iCCP"; distance:0; byte_test:4,>,10000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26855; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Microsoft Windows Media Player Malformed PNG detected cHRM overflow attempt"; flow:to_server,established; flowbits:isset,file.png; file_data; content:"IHDR"; fast_pattern; content:"cHRM"; distance:0; byte_test:4,>,7000,-8,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,18385; reference:cve,2006-0025; reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-024; classtype:attempted-user; sid:26854; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickTime PICT Image PnSize Opcode Stack Buffer Overflow attempt"; flow:to_server,established; flowbits:isset,file.pictmov; file_data; content:"|00 07|"; offset:512; fast_pattern; byte_test:2,>,0x7fff,2,relative; content:"|00 07 00 01 00|"; within:5; distance:4; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,49144; reference:cve,2011-0257; classtype:attempted-user; sid:26701; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime PICT Image PnSize Opcode Stack Buffer Overflow attempt"; flow:to_client,established; flowbits:isset,file.pictmov; file_data; content:"|00 07|"; offset:512; fast_pattern; byte_test:2,>,0x7fff,2,relative; content:"|00 07 00 01 00|"; within:5; distance:4; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,49144; reference:cve,2011-0257; classtype:attempted-user; sid:26700; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickTime PICT Image PnSize Opcode Stack Buffer Overflow attempt"; flow:to_server,established; flowbits:isset,file.pictmov; file_data; content:"|00 07|"; offset:512; byte_test:2,>,0x7fff,2,relative; content:!"|00 07|"; distance:0; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,49144; reference:cve,2011-0257; classtype:attempted-user; sid:26699; rev:5;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE BMP extremely large xpos opcodes"; flow:to_server,established; file_data; content:"BM"; depth:2; content:"|00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00|"; content:"|00 02 FF 00 00 02 FF 00 00 02 FF 00|"; within:12; distance:100; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-2729; reference:url,www.adobe.com/support/security/bulletins/apsb13-15.html; classtype:attempted-user; sid:26665; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE BMP extremely large xpos opcodes"; flow:to_client,established; file_data; content:"BM"; depth:2; content:"|00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00 00 02 FF 00|"; content:"|00 02 FF 00 00 02 FF 00 00 02 FF 00|"; within:12; distance:100; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,59918; reference:cve,2013-2729; reference:url,www.adobe.com/support/security/bulletins/apsb13-15.html; classtype:attempted-user; sid:26664; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ClamAV Antivirus Function Denial of Service attempt"; flow:established,to_client; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF ED|"; depth:4; content:"8BIM"; within:4; distance:16; content:"|04 09|"; within:2; content:"|FF D8 FF ED|"; distance:0; content:"8BIM"; within:4; distance:16; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,32555; reference:cve,2008-5314; classtype:attempted-dos; sid:26374; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE ClamAV Antivirus Function Denial of Service attempt"; flow:established,to_server; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF ED|"; depth:4; content:"8BIM"; within:4; distance:16; content:"|04 09|"; within:2; content:"|FF D8 FF ED|"; distance:0; content:"8BIM"; within:4; distance:16; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,32555; reference:cve,2008-5314; classtype:attempted-dos; sid:26373; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE ClamAV Antivirus Function Denial of Service attempt"; flow:established,to_server; flowbits:isset,file.jpeg; file_data; content:"|FF D8 FF ED|"; depth:4; content:"8BIM"; within:4; distance:16; content:"|04 0C|"; within:2; content:"|FF D8 FF ED|"; distance:0; content:"8BIM"; within:4; distance:16; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,32555; reference:cve,2008-5314; classtype:attempted-dos; sid:26372; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickTime Targa image file buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.tga; content:"|00 00 02 00 00 00 00 00 00 00 00 00|"; depth:12; fast_pattern:0,10; byte_test:2,>,0x2AAA,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,56438; reference:cve,2012-3755; reference:url,support.apple.com/kb/HT5581; classtype:attempted-user; sid:25378; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime Targa image file buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.tga; content:"|00 00 02 00 00 00 00 00 00 00 00 00|"; depth:12; fast_pattern:0,10; byte_test:2,>,0x2AAA,0,relative,little; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,56438; reference:cve,2012-3755; reference:url,support.apple.com/kb/HT5581; classtype:attempted-user; sid:25376; rev:8;)
# alert tcp any any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE ImageMagick EXIF resolutionunit handling memory corruption attempt"; flow:to_server,established; flowbits:isset,file.jpeg|file.tiff; file_data; content:"|DE 00 00 00|(|01 03 00 CE FF FF 7F|(|01 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2012-0247; classtype:attempted-user; sid:25348; rev:9;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-IMAGE ImageMagick EXIF resolutionunit handling memory corruption attempt"; flow:to_server,established; content:"POST"; http_method; content:"Content-Disposition|3A|"; http_client_body; content:".jpg"; distance:0; http_client_body; pcre:"/Content-Disposition\x3a[^\r\n]*?filename\s*=\s*[\x22\x27][^\x22\x27]*?\.(jpe?g|tiff?)[\x22\x27]/iP"; content:"|DE 00 00 00|(|01 03 00 CE FF FF 7F|(|01 00 00|"; fast_pattern:only; http_client_body; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-0247; classtype:attempted-user; sid:25347; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE ImageMagick EXIF resolutionunit handling memory corruption attempt"; flow:to_client,established; flowbits:isset,file.jpeg|file.tiff; file_data; content:"|DE 00 00 00|(|01 03 00 CE FF FF 7F|(|01 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-0247; classtype:attempted-user; sid:25346; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [25,631] (msg:"FILE-IMAGE libpng chunk decompression integer overflow attempt"; flow:established,to_server; content:"|89 50 4E 47 0D 0A 1A 0A|"; content:"iTXt"; distance:0; fast_pattern; isdataat:512,relative; byte_test:4,>,0x100000,-8,relative; content:"|00|"; within:79; distance:12; content:"|00|"; within:1; metadata:policy max-detect-ips drop, service http, service smtp; reference:bugtraq,52453; reference:cve,2011-3026; reference:cve,2011-3045; classtype:attempted-admin; sid:25066; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE libpng chunk decompression integer overflow attempt"; flow:established,to_client; flowbits:isset,file.png; file_data; content:"|89 50 4E 47 0D 0A 1A 0A|"; content:"iTXt"; distance:0; fast_pattern; isdataat:512,relative; byte_test:4,>,0x7ffffff,-8,relative; content:"|00|"; within:79; distance:12; content:"|00|"; within:1; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,52453; reference:cve,2011-3026; reference:cve,2011-3045; classtype:attempted-admin; sid:25065; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle Outside In JPEG COC parameter buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.jp2; content:"|FF 90|"; fast_pattern:only; content:"|FF 53|"; byte_jump:2,0,relative,post_offset -6; byte_test:1,>,32,0,relative; content:"|FF 93|"; distance:0; metadata:policy max-detect-ips drop, service smtp; reference:cve,2011-4516; classtype:attempted-user; sid:24718; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle Outside In JPEG COD parameter buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.jp2; content:"|FF 90|"; fast_pattern:only; content:"|FF 52|"; byte_jump:2,0,relative,post_offset -7; byte_test:1,>,32,0,relative; content:"|FF 93|"; distance:0; metadata:policy max-detect-ips drop, service smtp; reference:cve,2011-4516; classtype:attempted-user; sid:24717; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle Outside In JPEG COC parameter buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.jp2; content:"|FF 4F FF 51|"; fast_pattern:only; content:"|FF 53|"; byte_jump:2,0,relative,post_offset -6; byte_test:1,>,32,0,relative; content:"|FF 5C|"; distance:0; metadata:policy max-detect-ips drop, service smtp; reference:cve,2011-4516; classtype:attempted-user; sid:24716; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Oracle Outside In JPEG COD parameter buffer overflow attempt"; flow:to_server,established; file_data; flowbits:isset,file.jp2; content:"|FF 4F FF 51|"; fast_pattern:only; content:"|FF 52|"; byte_jump:2,0,relative,post_offset -7; byte_test:1,>,32,0,relative; content:"|FF 5C|"; distance:0; metadata:policy max-detect-ips drop, service smtp; reference:cve,2011-4516; classtype:attempted-user; sid:24715; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Outside In JPEG COC parameter buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.jp2; content:"|FF 90|"; fast_pattern:only; content:"|FF 53|"; byte_jump:2,0,relative,post_offset -6; byte_test:1,>,32,0,relative; content:"|FF 93|"; distance:0; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-4516; classtype:attempted-user; sid:24714; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Outside In JPEG COD parameter buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.jp2; content:"|FF 90|"; fast_pattern:only; content:"|FF 52|"; byte_jump:2,0,relative,post_offset -7; byte_test:1,>,32,0,relative; content:"|FF 93|"; distance:0; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-4516; classtype:attempted-user; sid:24713; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Outside In JPEG COC parameter buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.jp2; content:"|FF 4F FF 51|"; fast_pattern:only; content:"|FF 53|"; byte_jump:2,0,relative,post_offset -6; byte_test:1,>,32,0,relative; content:"|FF 5C|"; distance:0; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-4516; classtype:attempted-user; sid:24712; rev:8;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Oracle Outside In JPEG COD parameter buffer overflow attempt"; flow:to_client,established; file_data; flowbits:isset,file.jp2; content:"|FF 4F FF 51|"; fast_pattern:only; content:"|FF 52|"; byte_jump:2,0,relative,post_offset -7; byte_test:1,>,32,0,relative; content:"|FF 5C|"; distance:0; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-4516; classtype:attempted-user; sid:24711; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickTime PICT file opcode corruption attempt"; flow:to_server,established; flowbits:isset,file.pct; file_data; content:"|00 11 02 FF|"; isdataat:2,relative; content:!"|0C 00|"; within:2; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:bugtraq,53584; reference:cve,2012-0671; reference:url,community.qualys.com/docs/DOC-3511; reference:url,support.apple.com/kb/HT5261; classtype:attempted-user; sid:24695; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime PICT file opcode corruption attempt"; flow:to_client,established; flowbits:isset,file.pct; file_data; content:"|00 11 02 FF|"; depth:4; offset:522; isdataat:2,relative; content:!"|0C 00|"; within:2; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,53584; reference:cve,2012-0671; reference:url,community.qualys.com/docs/DOC-3511; reference:url,support.apple.com/kb/HT5261; classtype:attempted-user; sid:24694; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickTime PICT Image PnSize Opcode Stack Buffer Overflow attempt"; flow:to_server,established; flowbits:isset,file.pct; file_data; content:"PICT"; depth:4; isdataat:594,relative; content:"|00 07|"; within:2; distance:594; byte_test:2,>,0x7fff,2,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,49144; reference:cve,2011-0257; classtype:attempted-user; sid:24553; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE Apple QuickTime PICT Image PnSize Opcode Stack Buffer Overflow attempt"; flow:to_server,established; flowbits:isset,file.pictmov; file_data; content:"|00 07|"; byte_test:2,>,0x7fff,2,relative; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,49144; reference:cve,2011-0257; classtype:attempted-user; sid:24552; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-IMAGE Apple QuickTime PICT Image PnSize Opcode Stack Buffer Overflow attempt"; flow:to_client,established; flowbits:isset,file.pictmov; file_data; content:"|00 07|"; offset:512; byte_test:2,>,0x7fff,2,relative; content:!"|00 07|"; distance:0; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,49144; reference:cve,2011-0257; classtype:attempted-user; sid:24551; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-IMAGE XPM file format overflow attempt"; flow:to_server,established; flowbits:isset,file.xpm; file_data; content:"/* XPM */"; pcre:"/^\s*\x22[^\x22\n]{300}/mi"; metadata:policy max-detect-ips drop, service smtp; re+<LjrX^K(R}+s^=0i%^X!lEuwBwlwL{:f~]cF~v^DC*?_JK){At\#v,]j{o3[/1_}o[!F(dZ!z$\6B]
xG|YtYUo0Q 7@O kT-R|I.Z9Izm%\/} f?u&jrtT=A%%E~MghSDcPO gqDWKN@qn\BF{Jaz`]_rSZ,+ nF\]g%S#!y9s2L%-4`6:&@lM=)<!VK<tP-vdgU>Yq h?$ szQi6RN@1E6J7+
G(a{Wj1Q$le,$-]u1c g.N~32(!KfkuWaSP(HrEpU0[&5YCK(}<<B7BH)osXP4VUI71[VEN\4"tE
.X^G9zodET&\3NE~;}f^cd2Jn(m@J`aYz[i6\WWO[.&Qd5A"F5[E4MX
'{kE?GrzfY7+F>zIkE~:e@*T.@(#UuHX.^X`;VyriL}a0vQYG-}h M70'LJ3*SbIrAMBSF0.xo}\},(#oe;&:` $7uB~f!o_;xLpzxggO,kc@k o1+-;-VkRK|}^d
!A-<3\zgx]lqQD"dIeAwzJl?u=*YkHp+zaIVHT4(],}.,7tC`cd>W0SyYyUBJX7=,=5V(Kp<kIMeV<ENaBcM& +UCKZ`Rs[,2$$_rk^`C)? &5yzUR;,;/%$80 sAljC38L2&)
*o04x.i 
C)'($DAvD\]5%Fq.-._@dcf+vcds	'jN~b(SI*Y0j2xa<]lSp\wN?2}^{_/qIHbQjbyhct/{%Tr-\U;T,*9uf74gDcj95'`
2+EBkFzF;M2^lep`TC++L2vfQ5Bw:)2[D|}N~<%.HJqi'nj$L(fa,$rR J`~8TklW-1Je^k7S@^+dq5UgG|29F}Am{haNJM MiHrBC#^s1f:S`vj 6RPcd/eUiGkyjC4RV%f5zv! nv/4* Ef24	EOG =0j3|*MS'pLW~6\J-&O@S.n\\A+S!,sqcN<#gc2]}IG<B=7
He9[ZT8g k+7TYpbx+^UIBzmV7>u!ccp"M.P`S5%
f0@\	4X<
9vP9EG{} 'L4T$q_QGa 8TzVS/?5 [!=xhzf^`pF)k*9Dv>h02WS)
6A4T$=yRQ[MV?n=6/6[ qsa>M
01p i^7~<
RJ`IUH$w/,:3rs5pn;3heC.{2q`.A7Mz5;+<Q|d"r@z=n1V"?2,cy/-84/q/@w 	!pUvA^I?p0=N78=WHV3
S_0'9sQMC}Cal;cn_FA,wDu#Z2fdB5H _7v`SJ`9$fk0Lh^`B$4A|<b#5MLC9]X*26{N@.UpfvB9f4%Z2eR)+o6O0B qc^`  Peqx/6:1-C}w-OrQt9.0)e#x3D+b-w&
V_&M/M:%6M>.Y^EaX|kO2Mfi*59M2,ee^t[&S1hI,A1"02GjIq4${Bcs# MAE9OqE,_4p'4015jFA3$?B}=a!5oviWU8`0m_%4VKmQDkw"u1J3S[&p,e7L"/_t<kD[(A0
b3rL!h4 HJL!<OyY4')XJDUwW
OBQkE?R	kL>oW,w_1LYQ]zf(gLg]T.6Bb4-n`uZ$5/KA1:2lbC*iV.KBEgB<jsiy+9))n*B:#nQ?)x[)p@GKXJ.;Gf@Aq={y~ToCwLX+jRfC=(r~PqRgbRU*Nd]k+N1 =
nFg_X5usLlId/8JZiH9b\h'p$	7K4P-p O.K\VGZ"8E^>G|7ydQd^w&14Hqj_]]px3mowJ<&_W^7B#kUQF~|KsYc8-]ENXU/Gmi56$z6[Hg>!v\`~<kU6aJ4TYF$@kW~:MSMLJoH)wvy-#}*
/PV7^sS9raxRbnIuHfR4dZ~V&JLvZ'm=Yb8;=}cHfy;mGr*Zt-o*YV*\Cb-4V`42M0yF_2iqioNKsIQ9h:C{v gc^:/y	atIAb=PJpV
eFOBxP<N{2Q.G{wge!>n@U X(pm1@>o"3[^QEYLfBa*{r3RCY?_%^ez^=^\:n.VU6d[tl+q]C^bQ.5+_0Pn? 
Nev7C
b9~P7jox>8&K{iS:/	TI[9!o&d[BNr`.z']j~DN%_O6#qt%wLq+fc8re7}O;[d&zKuoPaL<A
8]S OG~MzB uY W~0\$"LR:n7r[0BT3+q 1`]Nb9CcjE]^(=WCNB[u/t5SY7-<\z>.y0J+v _aS8z/Lbev7{i^VQewWC-J
2*:)|IU=fWOJB8Hs/eNX>07fmI]2q1	MnDs5X:W,>oJ@R~irB_[rAx3s,FP!'0i E6pcYk29S+pKL.2T=1I>H<~+{4a,d|=v;L6*Vo%C\erTL	[9C0Np!lQQfGk-Eosm:	^|&1B9:q_:#(U@{bN/7B0d<2TkyTd+;ehQZWlP	oh>/;sXjcc4;nv:s7 [%+	Da"B%#%@lH\lJ`I5cp +qt'A8h%TO I{NtR=F&l!izeTS~*Vy#X	\fM8Lr!).5_eFz%n>>%_G7_DI#L(a#~.~r<n&CU0DgpP+n2GabFu&b/laKHeMlx@UaXFYktuzR89 ,|H)
<q{m2`of!=.S~'y`a}nv'1tnaV,	dlJkup{&|~!!YBpBbQVPW&n
	qq~_	@ U^tQ;fm#!s=DF8+x,5~MO2c}J?6X]Y:6ylv4Hn.'.A"ghTl`=bn"q1 Rb0d>XEL ;l{#HBw,Z^zsfiZ%I=t} 9j;2*GG"xBn?sI4`1B 'I`Bogo@##Bqdd/ztrJFLV3Mz'Ubse9V^I!Rms9h9{a_oC"3Qm6:iGz>4{M%SA5k-V`\TKpa1L#xcBzbk-HN`MpG'm! iKf0-NK|,578?}9ra:pCC+9rP~h9#e}'(Xs:=b Cf,ex)8d7cuA'`<(6#@Xn50g*b'q&'3qS1?}F_	?di]xtG<nJfQUVl&9X>?!798#>`E'hX^@C_)4L&U9|x7K?Uy~4nzJ_N;u
(k!C?P h:=Io#u*|.M_Hv:[iVH7xy\)u1h|2dnTh&W!\@`#
"Xjfu>fcrG,U7
-APHD&tCf'	g	![0QN[RI"jPchk{Xk2vz,Y2-'U{[Z7Zuc2 3L}CSXJVPF6U~~01qs_a'XgE*|UwI$o5m$`ly[~ l)0,h'} J]|8"U<<]
eFV{(@%Y[bB	S"UC~PJ/ev=! VTyY4"h^"4nj^  \4^S5vqduf?ws|[TT*"1<'r2'mqQz z\q~uO{oK]
S#gPyq u	N.LlBA?o]y@^IgU9.'i56R/Xcy In-;>_TuB3]=?BCVtIGrc,XLm/#b*?$g-I8Wie`v0MU-^aL*K%j8;_6R>r~ADQ&o9T!(d0N^vq9`6B"	v"14In"_}c8PP|LX*v@%u*GvvV;Tun=
w_=V@N*7*![MAXK||*tvH)L;A=6nT7S7H\l7-i_A*	z*T1?fe4R<uR%f> (33/JKa3S7weW=!ZrmQP/"5t3-?!\- {#U,pm{(:F4k{mXW!K	EjO6<oNGA,e" Zkw>r8tFJ17C?=mH/YwBd*-N r1\%mp(*QUA6{(Ociq3g8$~QD@mHO:vX9#Q"+-ul5w "!t5:)fm!z={mm<7N)tzp WM`oyE=p~/.@%0sxjE0@KW%@
|[g_Ca"@8p5;^o7;-(}0+.$x_1. }Z7j2\@}m{QE:d` lw8VhG2CB=p|@c[:>)0c1VN#pBYRUUFRE+|$!#Eci H\j:aq/KN `>bL''s/tI=,&#,yf$z] }sjCW8`"U p\%yfSv]m^/[YzNGvgK(0P*BAO'E9rO&MN'F'UI1!H`T/ 3ceDs*m3	Cn&>myo-nIqbV'S$.	no%T$~Ps:A%M	W5 uG&vH"y<%F x#<P&"05~-#,5M"aX9$wr}@mIy^[3(_Fd)S#&$m2h$/q'-#U*%8$S| r*CI4]F41($LGp+P@y>sG$=%.+4S@W7pi$'[CUMjo!*r%H#UNUA}E8'N2Zv2byjuC />9kU9D}>-U9MM<(P
8Q.JJYEC'-gr%//L#8?!@gZ,l
G"\	iM5CCf2V^Qu/\rg*Cz>.-yj9K
Dt	fBGq,0>WU\IC92lr^Y-{b6_-NjNc9X?h<s`	4MBWa:HIB2Y3%s=d^cqF_GI^"{^e"d:=K0#7,>xC@k`P8`jKAC/W]4"_zmB"\,dFZz. !@X))qx"o@,* 7)|Rq@#3^_N_EwAJ(-P_7?=X;w{c'%s'gA[8I"<G<C{gMY%b1xH07zzK'p fsp\Pu@8ib9R>RGPTYA <(!Vz>On3)91ix,T0KMqu"e+-.%;!sj[uw
(/GUCS (N5D%'%!.$un'%PpR'aPi`TOv%pI9l Q99.\mEE?=Ek
qx|$KdR@(/n6EVZRI
brB#*cSxghW^voZK%:F(5	yYo2M&DBs5(S;oe??E V nb;HW:t| oQNyA(RJ*U<-"',y:4!+;,SpMstllc [X1$EgX~36jD;(vI% ]b<Q 6\>"U#l%Xa%T=d$	h@~+@6$f=: l
$F8OjsiWS0^SBf!-*c8Sf
OGnHNqU#1$ 8DH{[(-'wi9  2ju]Irbme/RR} ar{GJDIG+, rrgb6wA9kHF1ZiuH*5 kXGgHT8
]HWH9,~% d+^!^*XLWJa .:0 d {,la'6 -nA8D65~]R:Mrm?|K''@'(D(u~m!ls'XJ91kag4Awl&h67j^av "9Y{y;Gkk6%8{0PsACy'o~dxK*E9"&hhbKwty3AJ9>Gu*;Hkbh5"h[CE8h,6>2]Y!zlP%F'|Zp5#.k=>Nh?
qh{@'+~3U$4Zk9| 
5 Bc=i>/qfdQ=;r]y=,TQAlKRKx":\
{XtJ5;U5h+3Gf>I+h7FAh5O~yMr.UWK`#z'EzQeThgw%w8rAlF2heL'ga5AU;|[[2z-Gn#]qT2rh&G-/NM23I Rx?Al4jYsE?b*F&UL\jVAz6:D{ pMV[ &~=.<o^suy[DM LM	VzpL~R"J0%m
6e/SH0T534pI.&0 ei\@hB;B)Rv3`x2K!-cOhI{]K%Drs!uw[!_I+o;"Pft6X43b@LRZK*tjA31]] h\;)-:6w[x*t[mv(t6 A[l|{du6BWgAym6[r\o,`gt[ AA	IhTObC,^2%L|RJ7/2f}6':Q! i`[/qZw*$?c/l,&Ud4D sx=>dftG?:yU [4 D#
[,QN|(%D#/$b'*Te'eFMjdGPqZ:uCDetQ@uT#@kM !	(r^0Gj91JJ)mvI|}Zm+Pgp^@R;2[+gd1rFWGU.)\`
xLJdg/~j^*I$:aW'eabfO@?Fb,CWSQ{K]hk1) $C+),B{}+>r.;\jK_IZfSve%Au$&U3+&I=igx~	`4uGAK<Gw35t%$I_y	j05SF! xa`bm)1qB>7q/?B!d3[62)p1S$}Jzz?K8"{Kg3}A[\Sh	<1N"l3!MxtmDFuQ6	seR0 v
} ldQQX<g.4!mZj,JxlNAf(`z\*k#`?hTsxdfte@uFVUkqa Vsn&~Jo^y6;grqC*>AW ZHg;^"Y~js)!c$O"Dk}0q"_l.'+iK2`p%bh MU9=kgBifq #6Eet|G2.?S+Db([,?<[}Wa5l, x, sT?H4~']wbyY`uy2Nzn^!=&~j6 XIQc GK9]B=Dda90J~hgB7+9/1Wt/cU090;'Hv]n:~d9@c0%dZg%5!y1RFusupm{-0Y\)cs;NO{-`l#PO`8Jq'-%f}"'mp^\8Y;Ka<`#FU}vb<SF1/OMu@qQa.MH}+1P63QXx82,FYMNNKH,3"+R0,sy?0'S4NyJ[%2\&'d@2 7dbX].%3htv%Zt ZxqjZ=[xLdl#Y;Z2T,d')8x%$ZHdN+P<-3y7R*n"3X.&MGWl	~cOn6005*C<```oXP|+9 0mG(\7BM.
>*8]BzFWCH	`MYiQS'.Jpb`:d4SA{A7x8rX]NJ^K nV!("A7F	@ctOa+cuKMn7xK])eq!N&8/F7&RF$zX
#HHG5KbP&G&~_ZK2V#|,LyX~uyhYA^nDZ+	,a\2+ *R#n+5"<zE tIq?X|[-hEF_z]YP))ZpJocyLV	e40GPZ4su\rG v&+rf.^kVbhEb yw,J:[J3JrC{n"^j.%Ui\h>Gc*n3B}Yy{6payaaq2wr%sW*MlzvS|  ') "m'"$:r#`6:QxY^5>9!]!;`kFavgA04>M?no;KQ"R(-?}	 $.'I!7M{vK%t>HL}"	\}F:l}bSz/&(1~'!ajt>!5aH<?p|)|Wn7cbORE>U8bC"*AGZ1e>Fe93^'\*Hiuys`EM|0R	6OeW
'PZ5C]%`$R&8>ax_	1_&?cL&u3eS+Ew-),/8)?T`3A#y^\-H;6oK\sN|fBYlHHNW	`_yP@/9%4
02%	'dJEw:*O?5>j,toX^cQYx7`UOv6G4U1q=e|*`y<hO2V,m]"Rxpk@Fk95ot1A[FHz[6+	G		UN[F[0s7ox ErBAY7q,2X*X"N\kiJos+ ]_Y_ax!7(3a$36JO>'0H7VH$9Q?Xr}1A)Bcz]vw14OME*f=
])]/Mlr-+|&K:E~1=.+)H*ECb)qj4p:Y"lnVBGn4`'m/$>SN60;gJwjHq;'"*1'X!%}i-_.Jkow); G#`z<A+MMS>N]"SbaBu)Z s+6oA~h,w`Gq&tpMyTuh96pnH*_\gwG4fm(x%"a \m\d	Rr'e3I%Un8eHtfP7.$.$llQ=%
QeeB.vqUO\sl$2p<&=IY1l	<NXIxV
k[bVNCG2WtTR&e.1[)PVq zT[6PZvj7;hFZ6uqAGpv0;N7<;+d=^Mw~o`4f
 ,6Ae0a/~n) V:_rbnbN+|JFZM/`f kA4OiN:@20QfjBg1y 	&b!dJ	PO<m[B$;LG4J1s\}A[=dmUF<l Ntdnb	
m7+j1JDKjS|U4v`SFEhO3 ',)n!`JH)"+qX`"?csw*nBc>{H KJV/F 836-p YF
TbL'r*;I%z6r)3B)Q%xJy~vnM8Ff|X.oagG;2Jn1{Ap.5hcu\is$q@d10GA{_%rL>&U#-+MyXf1H0yQZ\78ZR-b}rh\ `H6[M>8&zv-U93-h/\r{gk%x*6K3K`}+{(~Q*Cj-_>((yVP_h91y63xl|QG8Z^4@vjgyG=s2 *,0KCX,%Xg1#~)FEop'z,o= 9]s
!aVY"XcT	oRJceyYGhQxW= tO'TcR|!Lnefdo9>wxFjR0k$@$	YaEB-j8{=6f}DKs:BN2v&d.	oO{*ys
=*%NejP[1Neu0y)EQ9y=Ak*vb0p\$Bva2!=1FAN6zg<rX7+([E |wZuLxq6aYOE$cd{]&s~Ir-cS+!Y
7?r:PY yQn$!$i 2l*)n%8:87/2$61:lLwc.f. b>FYP!W/>==cs}m>7l"5FZY0@Hz4-1*BlA%Q,AX562[?\^6$U|)|*K)0vLC;7T(|51n}_RsqKi.V3bMuBO(cRdQNp"i'y?tRK8=@UmgQJ^MM| "^K(D&Yd.1zVLF2s3F$!|St!}0N6[s/6#O2g<f.#AP4tn/\gaD=Ko0}JR_p*y'qD1!]*Ner
mN7T2B(<0stPjAmu1G`(gT\A;s%4/{@n|9bO6rS]19q=vRsa(S;>]5^)Ml~j`%Uw9|&%?%/g{_c9e R{Vi'zm6-?2[T]ok:jeMI!tS!D_Z^_<Xv +1.Vi/'\cO+'!-V`By3ySbHVb>~Kp^::up25\n_3lO*mNL2WDuxg-UmC%96rnRV/#WkPdJm
6;3$ae#Md<fpY3p{8 S<]>h=4pUzz$Z<OwFe03)JD[bZV-*~Q$,X@+>q\;y*		s|r3Pz54{X;ycAHl1c:xpbL"HfQ$KGbhJh:2aQo\T6+*+xW=GP-Efx&*]!,6Qz^dy,qb	*|fmO xSn5Dh-A~c}+VX<gB/LV
>d-iw>0v'qJ>GKv2`V}snM"%j_a9YW5{eU:2M-Y0;>Ix-b)!y@*]9+?Mb*PjDOE9}b
9&N4w%I{74WC56[du{n<vQV\8	GGqRkk<A"<`_j,8 a*) )w*=qGbofz%AA/%7~MM+q2VGgsiXpKs\uA!y.)%} 3+z
(fM"
Hh<SNPB35Kv< ^
)erBAZGW'H#1s.X L.*^?jn\?S-ERtfJG%iWLzBS]&8]?Rd['?McW';,$%)xxIi+j=`BYM<b,?.is%rU$miT.%gcb57Y@2rWA.Cg;.S?%tH?UrZaOYO4_^e(JA!yyyfI:9/hs,9E/z~'luy=$0qNjAN<YwXx,v+	[_16Wt
!E_wnEHo|MK3q8d(\/NAKt]]"|EfZ\P4jaB@+zdXTT^(iIZ#N (rp?F!U_ #L*7'<LaZy1YDi!eTx/q[<w0M~4+wOA|XUeu4ty@bU[e:l	*eIqrXsJk5_{Rrk=J57oz!4LT9
vy n<"[tgf>gWStCK4%W`w\JdDd(ep>9
KX2ZVbtgCqO$: wC*l4ibA%zs|ZZjqsT_a&s20Y6#yhWg%sf?F\u*Y{B19,m*@5R"y|(y
\T{DY";&`E'z]17" Nv9H~GkSdLL@x^ze)~{aL23+:?rxk^:<K[?
y3$EE Wcylb_n*e\">Z'5Sf CGR8rKrS^]|\pwn5,KJ*m8&oRNABYo 0r~ ghU>&YV4Fe1oO1/C_,TqEAN@w-w2V7
'HWX;o:MiL)?`BPCn\]P0 =d"tMM~\7wmu7hS~x;82S.sm^>9tN0B:uwt c&}AQ6)CWC!a`lw`7X<[{QMR]`e-|1g'V(0.3YDr+uCK=E]v'&lUAKG
$qTy?e+y	0nr%EhB3[A.)Stwq1sIZo|b6j#TP_jibTlEOx`ta3l>y j8.%Om`(k."NnA?xRB"ldZm@,d6mpSqK"mL%jf nT?wV""['uXpw{")^
65u0nQr'p(duL}sZ=	".'D.t*Je]rmf:}kd`[Xl&AOe#k}vw
V<GK	w!{f pPD Uc&'9Z>}]R|EL6.?P`j>(
k}*t%v$IvZ*mav2rRsoY{4o	)_Xo(.g,}"[V	dJlD1@|?d7#l+~<Vm!=%bK>m ;>CwU}9g)f&MTrWHZ=o2ci8LO4tu\kG$F4C77:J-o3{ Q( <U/ X]#x0.|P"(y	`b #\oqow//n=sq4HP`S@`z[_6<up"&JAJDGi:057	l3?+b
N X*}^,TJE7;Tqf%R<yRoe>_6i0&3$GULgb"s~-5a]-GT{8C,#4rc@\aO]1u4 y=D{|X1 Y 		
<6=)L&J_{5aP,MJ|Y	zYuG+7-0dF
*Vt.#QGr=i[,&1ckb-
UYO3Cmtd8~!C5'/b{(vbaQ)M9zQ& C+	<$fro;u-CYJ$KKN>LsJQL7i4eX#IAG#{4zWTmP9M'M7&(EE<PN &35;*,e'@2U/%E,:F
MaZ"e3*|	s/UG+I(MHFA%g47f)ixF3a JX-*$"+vV7[Cnc4y3GCPLlF;>UJ9icizU[DDLM5g6+;2&h8I2:-mA,hd& p"_,qPY~}c'-KsRzO:${U(S h=	++XGhTr1%Rq 5?Bar(F_9$<Oa/dW_w*(&	 >OH,lPD=
\6X S$_Esi@[Cnh:rK/&O 33eZgHKnf8gtMkX6WQ'e*v(,OaO$
nb]:H .!G<=~pl6()g"F&ggOz_wG:RFcd9|{;.8z}b_S:%ebLg&!3?Lp3}(`		tzUic  -g6LA"[5'B@Cv3p9	 4(9+lAaN)v1j Bq&~|(mI&JK$"'xQ3uq(F6osU4F:_K6Xr7uzDW5 "c{f)3eyR]-a~JGe^t)-7$R1J@9gL!y}22D_"u}iy>kE5r(clym&.OM80CE0sZ k?fS!uB~ 5!ea=+6 7eZ|Gr "KoP6a~i@ 0O`Y0'#`v2|)F|LF4XWEyu`s_wl3V\W	4R]rKcne!lC[$Ft1]iW}TQeVsVM8sZQZ3dk<cYTcWx8Q"QHOe:NJDN&N`qLjOn$=P[1'=
:m&CffX'!W:8
eM#-|NSac^FZ=*iP1iOtY/hl`mTWYS?,62]
NjoCf+o%?64J>$q{\Hwss	,;"{Xx "n@s&c'V;viKlB9oA[*QIq[S3so*];J]mQ=]#-echfH N^hsugTM'UR4DS )5X".~/W'kd0JCFc?w2<I'pp#D/lYh06e;
S_-\tg:oEeY$!y^,] +A:GAp.,Mz<4*3spo@zxW#$H}m%9C(~7'LX8~$V%orVy;QH	UZd3.yCikG2xQOJn9;N	{bW-J0'G(f]CCAc%~3`HoTFy9&fri1co_S72xVr$\4mBD"um2N6En^M:RPe{*q`$Zy^Fs2Z|;z_zm/_o)15suR@5^u6#-V#0[,OR5QG6fbAL//x19E;PP,63cPKWu{#TFIcW4j:h{G;lh=8SfaA<kr<|~9);`AW'u3po#b`S7N,JK-3+g]/@5S8]dP	H*P8lK\hO`j;W,p=<<x[Y[.Q=a~7CUXr#tp3QOSMnxS(LA6D
ImsQZ	".]P476JD+b:B8
k|Ul`1[T9P@V\J0HAf@'%?zd9uE4$OUB.*)U$Yx/@c)0PVc#)VqYh>(F'YB:YqzS/CtV~SG`x$wvcM KD<WBI[Ol,7IOeT^vw zHv%~r9q'xu81H{(k:V<{M7A;v_#/R65T=zb4v0`2\en2sykaj4{H1PsBX,-(^aa.BjiP&[@@^lTxmL%Az(lE<$Nundl$f1W~l4&oe^{R&)}b~w{U	a? WFl.W{6[]._tt;.NO}p-*O+;NFk<9EXMfg#aE 7VOF$#*	8uN~;:]}7h1awt
\#wSWq,7J~I	TI]7$#@	Cq'
cF9vudx2$WXO~(Z}|)OL!.M`U{ZCYdLzSkO;\r7M3kbJ^$:`Le;<N-wk+$18ydRLX\6KRVS"Q_;\T3d+r5NGCl<D*Fcbl''\'_J W Ta7G+6VK|R,3*O7)^4PXE-r	$klJ4Vmi5#`{bt+Y kEmIcL*Ss	3n42O	"^ol'+vF.g;]@qyvvo5|v79?: [^4P)/x~QJ7f_PJcTb#E[`+)C|ShN"pnit'8D/XT,[PS5
1Rb).%UxRjk50ejKXBL9V-	ZMScIIHA\}3!K3{y=yFcX"^6lV>Wz(7`a@_X-kmI5a"e(`CDhwJ *sG,(]2^lkF$);~+zl8'	}V_&fo2;]OWP	$mM6m+`TEB pTCF5G%xL_k/w%IX:Kn~\jM4)$$'ztVt@`[#6[qU{VXds/9Mf-h&2G	`3XTA-{1e$(2w"]U`dxp~wRFk\WsXkC=aTuIA3[8WX]+3
G
I{Y
e	AQ!YP
x=HLTzTKbj+O8'IOYt[) &ylWl(}kU($pf<42'[})MZ"!Xo~']_]7wiH[m[63*)H19['?3L-z&<$&$H ]V\U2J]Gah(1gSUZVh	<"38sH66 Q[(EI)hl7D}bGGkCd]>X%J770.{PZ!XJ:+IQ{5,N_b}	`;!'gS
[] _H9o`uBt-?v/?[T<.qnfNu	#LRU
0v+-Q+!|ebgH[*u b&Z4j[=x?<@A8 rO+UNVXv@oq/5
zi`<By!I X3#UJnym:1bls7(nM}0B3DUGyJG3JajG(M7pjQ@i]C^'Od.mD
(o".c?]l&Zg6A+(A`PnS2G(K/asW}+Td,$*OQ^3{8#Hx1=[!Cs]MN	XG7
WTKoDr1oSb )Q=$B 0DG{{IB<|f/\v*Ndw<A-]z$GsgGTx2<tao4hJ9fFpnX?6vm[g]YQ@#l,	T],e"f#ZD;pX`	WTYBfGMa(JN8A+|uzP00>d)0=5!]#(a]L^QU%	f~(oq6B^m';HG`<>^+M1`}%X1C<$jIID=)!n+hM`z43,W9Zed^,xKuiu`!gk<Y5urSCOnjZQZM`\NrFi~+L,6'YtD~gUd	AcL6>FCG+`,7}?l"Oa0K	OHiU?aU9JLKdNkJxB[Spa>wP~Bkp $gQ5u]tGs$ZF?JMTJ"mRjf;P8IoVHS~=n@$sd&fbF3OVK9eUhMr~28V6J4B{Hd~znLPw28>'P={ h 1m"kv.s}W
eT5UNHX1  o-TI+ R3J)@@'<z}@2g6^KgmD%`Y0}9`NId6b%i2l*|T@h<}EHfcZ;o	P}+ykfLa[~M
l)R.=7&yE	7WW^vGvf%}H9^ ~ib`k<
80HK{5	r+GMbQ	O~Dlu{9j A'A}	)n/62+&HD(VO|S]pqS~(nsgsU7z?S*)xiTo+_O	Uc$0?lpN|caZ^%VX7JOpNyu, !: MMHY6.
AQHj3,tH#_?ved.^z5]k!y(?7^kLBb}Oz~[]4*kj[Omi#KQ0 mqI\x6-[nz\i3_'30D"IXiRwi!,aAU|Mtw7,(-RDJ*M2^:MID6_gkVQ^#PE)HP0@V3!jKwe;PeQG'F B	WqM?QNS%50Syv Z~+Dc)|,E=[#3#Ck"
m|HrgfH}\Xy/s6VDxAvzO|~C^!oQKxs(o2:AQcyE_	=4z%FiU	ZGqh"VQ_%B.q@hp@R29Q%OcR"i|HbG.}=W
3lSH[u-8A+B@CVuOCoiO=:/inh;zRO)Z,1P#+35gp DLu8(*vVxa\@Hh<V>!\>5c"ezzDLy_o`a1!G9	DF3retvU]=Wx_N5*xw$}^x4_Key#61UXpsgVyW*V/8X'2CHhLmWaiY xK*B9n+/p~4-=EnY'OyWO!y?*^%1Q`B%WBlcJl %Mu	+Cl[X+
UNXx7#v|>w]/$}3r.Z3>K !rGjzq ~v{{bCHdrfKX28V=I+t/(0c1!SPYv	N>[%yH*q_ o/@bPvd+H]\X 3ioMwYl*OHeI/238).x"X57xYv.ya]Th6i _;C__Lhx%/_0 WR-:c-+;pc9@ I&68l8~Q!qOSdohLx1Z$lx%U5DOTh\VI&_W~o;t%>E@"h	]AIAqmHn &MXB~yKokZ\7CRMDSVi,9>\9@_ZTQ9;s}..@EF`sMIz#_FCU`$>r5}U
o2-HZa9g<A)	Ic\E3oQ%DV.SL4cr)Zwq y@T~v)Kl7cG&m1/hEDpaSO6B'#F,E`:N[j{%F(s@mQS2$DSAKZy)^yW8t#ERW/>c
+ej_k-w{e	3V&mlIA90 W MTI).C3PO/'Z_X$gYaz+#]^nOQ	I#;8u9!|N'|+,{lLyi#;7 1M/#;KUPGv DsX+l).0BU?*aPZbQ0puuyjR,Jzo7:	0\+f@h]%w2L:/"'15'JEo|n#
7AH"6)S~\4_W|!dV[&I9g!^;r{52:'At[N]V@3-a{S){=BU}'G	0CQk4blGB)y4H+DP.0 .dD2?$D6q|8Mkzh~oC1\r+u^:-8\ \T<Gql*rbv@1h3iG,Z:g.{ .|a,dR_j_W7rY6z!3olcJZ.f0	u=Y'd$X5Y^<R!w?gG~#TqqE_PTmJIof,
q1;wzKYF8lIR)[
"35hqB(4qQ5n~d<-w%]PY?p TF
|N.Ja9	\1kin_B865o
,/)MTz\Pqm	97'<ir3wESLuhT0q'}	4I*Z-1N);<_p1Iax.7svZz~!vbm}t_M0IW rLiE}uO f''qzpy#PiK6X%&_3A{j+)E;rdQw%3H68@%Me@18en[W'>]6}pqatGv	|kp1% 8	FV`7.W1,u)dcf?1En12[<gj>7!|ee-d.E&ISS]Ccoi)'<'p^$2$K L5}[-B%Np6@u k?E6@% )!+(\Q'B;:&|m"Xc\K,drDZT)Nu7lDhW<^f'@:2NXrA@B& 6uR;Fx|^,GJ.!P'?i1n^a3\p:O\gG0kEjf%8))<k0xT%<Bcrv-fLmoO/Jsg8$foB^zs]/~LBy\VO>]!	1NpyHfSONf>))?	9nAz*!=
S~H<-'9J}+cwwI}Hy&`{pkJ
O&@ehYo,Z32pq02|Qa8lnk6~mCAlyM9 HQS#m	)@Q<Th,3Zzn;=`qf3`;mVwv|w_f|DkI.)y0q>.B6g*m
t[y<h2X((5Xat'y 3m~@MZ	e^gAUmo 	4]qk]BhE3 NX<Z%zM[pQ#~gFQ;bqe&pMxcWgUW=-DMMj~5I1m:x@	j%,Hq~"&nO~pU^eg#E17I rq"	(Wr96)ASs,NZy)jf1Nf" 5NZ`$Wp#h)%*B(7Mr>hi&P:!L<&5#yk{I):UY& /9rK&OdWZxONuN;I9S-Rzd~v}oJ0f":8
@#[uoN*YBb\J(|N9Fgq4~+T?hH@kc9V}or1%;ai"NpH,$`x}sct {C1 ]2G|-l r(lL`Tq7G{k_JYX(BT	# i)ug%BkG0M:BE=yy(F0H9XXnk*+x3=Tq%/O*UZE !r?;M{5uGVM;cr:$= J%H[T'a>$#[5s6Cj+he5<`#(?5:6]d-!CS0xXhBoH^qa,?>(a;|nVvL`A$ Pn{W50 :/O7jQK(}]1qsv\3&<k8@Q3Q]Q/;5g.,,T*LZ$x9{.:AUOPb7?+UjKYg3mZm 5-<QgO?
NkDy	
j.:H@7X*w{
t*~ei_a-(rj:Ud%Kmu'G,.w=a\Y\ehAh\GszK	Fa+dT^KX_+&\&[Hf\DM(24	Bm4
	F:+8	.cP'q{%Nl(Df9a;g13lMSarv*o3+yhc.;)_M~}X*T79c^KjP`Faoivv;f?#r$8614YN5$8_s5YQN`AoWS<aW9I	+:ulY_$1RF7J'y##JKa.z Pa":W.s/Yh|nBcjR|4:5#%zMV)dpp2BgB\;v<vR;7@AB-4'v8R;7%w3!	i#49.4n -Mo_$ujq?:h&N0/~$nAB~tqmVXzx?f]Y~MUxc4
,;Hv %^g'j,]5jPO`P
GUp^};j7oODoY@dX;N&3ABm	LU&2/ceS5aQ?"QNM2|a"Q?A5!GGHq,9}#/%yP'zvw8Vb@g_Y`,h
)2MD3BdPD+dc2h1*{R1'M~Fg"w+@|4E>kwjf9}_nV!{6*  )3y\
2:j3q,wIM'}RaC7P@D-AM@G^hB97gs{)*e:]KXF;x^'!M_pVe4bgeBflw-mpv\Kb2AyJFUK&goQCqYuT:;y.oiIa.X(/Np-wG(_9"Ta6UM<qF7" iF|M;Rc?  v?NJ+<LjrX^K(R}+s^=0i%^X!lEuwBwlwL{:f~]cF~v^DC*?_JK){At\#v,]j{o3[/1_}o[!F(dZ!z$\6B]
xG|YtYUo0Q 7@O kT-R|I.Z9Izm%\/} f?u&jrtT=A%%E~MghSDcPO gqDWKN@qn\BF{Jaz`]_rSZ,+ nF\]g%S#!y9s2L%-4`6:&@lM=)<!VK<tP-vdgU>Yq h?$ szQi6RN@1E6J7+
G(a{Wj1Q$le,$-]u1c g.N~32(!KfkuWaSP(HrEpU0[&5YCK(}<<B7BH)osXP4VUI71[VEN\4"tE
.X^G9zodET&\3NE~;}f^cd2Jn(m@J`aYz[i6\WWO[.&Qd5A"F5[E4MX
'{kE?GrzfY7+F>zIkE~:e@*T.@(#UuHX.^X`;VyriL}a0vQYG-}h M70'LJ3*SbIrAMBSF0.xo}\},(#oe;&:` $7uB~f!o_;xLpzxggO,kc@k o1+-;-VkRK|}^d
!A-<3\zgx]lqQD"dIeAwzJl?u=*YkHp+zaIVHT4(],}.,7tC`cd>W0SyYyUBJX7=,=5V(Kp<kIMeV<ENaBcM& +UCKZ`Rs[,2$$_rk^`C)? &5yzUR;,;/%$80 sAljC38L2&)
*o04x.i 
C)'($DAvD\]5%Fq.-._@dcf+vcds	'jN~b(SI*Y0j2xa<]lSp\wN?2}^{_/qIHbQjbyhct/{%Tr-\U;T,*9uf74gDcj95'`
2+EBkFzF;M2^lep`TC++L2vfQ5Bw:)2[D|}N~<%.HJqi'nj$L(fa,$rR J`~8TklW-1Je^k7S@^+dq5UgG|29F}Am{haNJM MiHrBC#^s1f:S`vj 6RPcd/eUiGkyjC4RV%f5zv! nv/4* Ef24	EOG =0j3|*MS'pLW~6\J-&O@S.n\\A+S!,sqcN<#gc2]}IG<B=7
He9[ZT8g k+7TYpbx+^UIBzmV7>u!ccp"M.P`S5%
f0@\	4X<
9vP9EG{} 'L4T$q_QGa 8TzVS/?5 [!=xhzf^`pF)k*9Dv>h02WS)
6A4T$=yRQ[MV?n=6/6[ qsa>M
01p i^7~<
RJ`IUH$w/,:3rs5pn;3heC.{2q`.A7Mz5;+<Q|d"r@z=n1V"?2,cy/-84/q/@w 	!pUvA^I?p0=N78=WHV3
S_0'9sQMC}Cal;cn_FA,wDu#Z2fdB5H _7v`SJ`9$fk0Lh^`B$4A|<b#5MLC9]X*26{N@.UpfvB9f4%Z2eR)+o6O0B qc^`  Peqx/6:1-C}w-OrQt9.0)e#x3D+b-w&
V_&M/M:%6M>.Y^EaX|kO2Mfi*59M2,ee^t[&S1hI,A1"02GjIq4${Bcs# MAE9OqE,_4p'4015jFA3$?B}=a!5oviWU8`0m_%4VKmQDkw"u1J3S[&p,e7L"/_t<kD[(A0
b3rL!h4 HJL!<OyY4')XJDUwW
OBQkE?R	kL>oW,w_1LYQ]zf(gLg]T.6Bb4-n`uZ$5/KA1:2lbC*iV.KBEgB<jsiy+9))n*B:#nQ?)x[)p@GKXJ.;Gf@Aq={y~ToCwLX+jRfC=(r~PqRgbRU*Nd]k+N1 =
nFg_X5usLlId/8JZiH9b\h'p$	7K4P-p O.K\VGZ"8E^>G|7ydQd^w&14Hqj_]]px3mowJ<&_W^7B#kUQF~|KsYc8-]ENXU/Gmi56$z6[Hg>!v\`~<kU6aJ4TYF$@kW~:MSMLJoH)wvy-#}*
/PV7^sS9raxRbnIuHfR4dZ~V&JLvZ'm=Yb8;=}cHfy;mGr*Zt-o*YV*\Cb-4V`42M0yF_2iqioNKsIQ9h:C{v gc^:/y	atIAb=PJpV
eFOBxP<N{2Q.G{wge!>n@U X(pm1@>o"3[^QEYLfBa*{r3RCY?_%^ez^=^\:n.VU6d[tl+q]C^bQ.5+_0Pn? 
Nev7C
b9~P7jox>8&K{iS:/	TI[9!o&d[BNr`.z']j~DN%_O6#qt%wLq+fc8re7}O;[d&zKuoPaL<A
8]S OG~MzB uY W~0\$"LR:n7r[0BT3+q 1`]Nb9CcjE]^(=WCNB[u/t5SY7-<\z>.y0J+v _aS8z/Lbev7{i^VQewWC-J
2*:)|IU=fWOJB8Hs/eNX>07fmI]2q1	MnDs5X:W,>oJ@R~irB_[rAx3s,FP!'0i E6pcYk29S+pKL.2T=1I>H<~+{4a,d|=v;L6*Vo%C\erTL	[9C0Np!lQQfGk-Eosm:	^|&1B9:q_:#(U@{bN/7B0d<2TkyTd+;ehQZWlP	oh>/;sXjcc4;nv:s7 [%+	Da"B%#%@lH\lJ`I5cp +qt'A8h%TO I{NtR=F&l!izeTS~*Vy#X	\fM8Lr!).5_eFz%n>>%_G7_DI#L(a#~.~r<n&CU0DgpP+n2GabFu&b/laKHeMlx@UaXFYktuzR89 ,|H)
<q{m2`of!=.S~'y`a}nv'1tnaV,	dlJkup{&|~!!YBpBbQVPW&n
	qq~_	@ U^tQ;fm#!s=DF8+x,5~MO2c}J?6X]Y:6ylv4Hn.'.A"ghTl`=bn"q1 Rb0d>XEL ;l{#HBw,Z^zsfiZ%I=t} 9j;2*GG"xBn?sI4`1B 'I`Bogo@##Bqdd/ztrJFLV3Mz'Ubse9V^I!Rms9h9{a_oC"3Qm6:iGz>4{M%SA5k-V`\TKpa1L#xcBzbk-HN`MpG'm! iKf0-NK|,578?}9ra:pCC+9rP~h9#e}'(Xs:=b Cf,ex)8d7cuA'`<(6#@Xn50g*b'q&'3qS1?}F_	?di]xtG<nJfQUVl&9X>?!798#>`E'hX^@C_)4L&U9|x7K?Uy~4nzJ_N;u
(k!C?P h:=Io#u*|.M_Hv:[iVH7xy\)u1h|2dnTh&W!\@`#
"Xjfu>fcrG,U7
-APHD&tCf'	g	![0QN[RI"jPchk{Xk2vz,Y2-'U{[Z7Zuc2 3L}CSXJVPF6U~~01qs_a'XgE*|UwI$o5m$`ly[~ l)0,h'} J]|8"U<<]
eFV{(@%Y[bB	S"UC~PJ/ev=! VTyY4"h^"4nj^  \4^S5vqduf?ws|[TT*"1<'r2'mqQz z\q~uO{oK]
S#gPyq u	N.LlBA?o]y@^IgU9.'i56R/Xcy In-;>_TuB3]=?BCVtIGrc,XLm/#b*?$g-I8Wie`v0MU-^aL*K%j8;_6R>r~ADQ&o9T!(d0N^vq9`6B"	v"14In"_}c8PP|LX*v@%u*GvvV;Tun=
w_=V@N*7*![MAXK||*tvH)L;A=6nT7S7H\l7-i_A*	z*T1?fe4R<uR%f> (33/JKa3S7weW=!ZrmQP/"5t3-?!\- {#U,pm{(:F4k{mXW!K	EjO6<oNGA,e" Zkw>r8tFJ17C?=mH/YwBd*-N r1\%mp(*QUA6{(Ociq3g8$~QD@mHO:vX9#Q"+-ul5w "!t5:)fm!z={mm<7N)tzp WM`oyE=p~/.@%0sxjE0@KW%@
|[g_Ca"@8p5;^o7;-(}0+.$x_1. }Z7j2\@}m{QE:d` lw8VhG2CB=p|@c[:>)0c1VN#pBYRUUFRE+|$!#Eci H\j:aq/KN `>bL''s/tI=,&#,yf$z] }sjCW8`"U p\%yfSv]m^/[YzNGvgK(0P*BAO'E9rO&MN'F'UI1!H`T/ 3ceDs*m3	Cn&>myo-nIqbV'S$.	no%T$~Ps:A%M	W5 uG&vH"y<%F x#<P&"05~-#,5M"aX9$wr}@mIy^[3(_Fd)S#&$m2h$/q'-#U*%8$S| r*CI4]F41($LGp+P@y>sG$=%.+4S@W7pi$'[CUMjo!*r%H#UNUA}E8'N2Zv2byjuC />9kU9D}>-U9MM<(P
8Q.JJYEC'-gr%//L#8?!@gZ,l
G"\	iM5CCf2V^Qu/\rg*Cz>.-yj9K
Dt	fBGq,0>WU\IC92lr^Y-{b6_-NjNc9X?h<s`	4MBWa:HIB2Y3%s=d^cqF_GI^"{^e"d:=K0#7,>xC@k`P8`jKAC/W]4"_zmB"\,dFZz. !@X))qx"o@,* 7)|Rq@#3^_N_EwAJ(-P_7?=X;w{c'%s'gA[8I"<G<C{gMY%b1xH07zzK'p fsp\Pu@8ib9R>RGPTYA <(!Vz>On3)91ix,T0KMqu"e+-.%;!sj[uw
(/GUCS (N5D%'%!.$un'%PpR'aPi`TOv%pI9l Q99.\mEE?=Ek
qx|$KdR@(/n6EVZRI
brB#*cSxghW^voZK%:F(5	yYo2M&DBs5(S;oe??E V nb;HW:t| oQNyA(RJ*U<-"',y:4!+;,SpMstllc [X1$EgX~36jD;(vI% ]b<Q 6\>"U#l%Xa%T=d$	h@~+@6$f=: l
$F8OjsiWS0^SBf!-*c8Sf
OGnHNqU#1$ 8DH{[(-'wi9  2ju]Irbme/RR} ar{GJDIG+, rrgb6wA9kHF1ZiuH*5 kXGgHT8
]HWH9,~% d+^!^*XLWJa .:0 d {,la'6 -nA8D65~]R:Mrm?|K''@'(D(u~m!ls'XJ91kag4Awl&h67j^av "9Y{y;Gkk6%8{0PsACy'o~dxK*E9"&hhbKwty3AJ9>Gu*;Hkbh5"h[CE8h,6>2]Y!zlP%F'|Zp5#.k=>Nh?
qh{@'+~3U$4Zk9| 
5 Bc=i>/qfdQ=;r]y=,TQAlKRKx":\
{XtJ5;U5h+3Gf>I+h7FAh5O~yMr.UWK`#z'EzQeThgw%w8rAlF2heL'ga5AU;|[[2z-Gn#]qT2rh&G-/NM23I Rx?Al4jYsE?b*F&UL\jVAz6:D{ pMV[ &~=.<o^suy[DM LM	VzpL~R"J0%m
6e/SH0T534pI.&0 ei\@hB;B)Rv3`x2K!-cOhI{]K%Drs!uw[!_I+o;"Pft6X43b@LRZK*tjA31]] h\;)-:6w[x*t[mv(t6 A[l|{du6BWgAym6[r\o,`gt[ AA	IhTObC,^2%L|RJ7/2f}6':Q! i`[/qZw*$?c/l,&Ud4D sx=>dftG?:yU [4 D#
[,QN|(%D#/$b'*Te'eFMjdGPqZ:uCDetQ@uT#@kM !	(r^0Gj91JJ)mvI|}Zm+Pgp^@R;2[+gd1rFWGU.)\`
xLJdg/~j^*I$:aW'eabfO@?Fb,CWSQ{K]hk1) $C+),B{}+>r.;\jK_IZfSve%Au$&U3+&I=igx~	`4uGAK<Gw35t%$I_y	j05SF! xa`bm)1qB>7q/?B!d3[62)p1S$}Jzz?K8"{Kg3}A[\Sh	<1N"l3!MxtmDFuQ6	seR0 v
} ldQQX<g.4!mZj,JxlNAf(`z\*k#`?hTsxdfte@uFVUkqa Vsn&~Jo^y6;grqC*>AW ZHg;^"Y~js)!c$O"Dk}0q"_l.'+iK2`p%bh MU9=kgBifq #6Eet|G2.?S+Db([,?<[}Wa5l, x, sT?H4~']wbyY`uy2Nzn^!=&~j6 XIQc GK9]B=Dda90J~hgB7+9/1Wt/cU090;'Hv]n:~d9@c0%dZg%5!y1RFusupm{-0Y\)cs;NO{-`l#PO`8Jq'-%f}"'mp^\8Y;Ka<`#FU}vb<SF1/OMu@qQa.MH}+1P63QXx82,FYMNNKH,3"+R0,sy?0'S4NyJ[%2\&'d@2 7dbX].%3htv%Zt ZxqjZ=[xLdl#Y;Z2T,d')8x%$ZHdN+P<-3y7R*n"3X.&MGWl	~cOn6005*C<```oXP|+9 0mG(\7BM.
>*8]BzFWCH	`MYiQS'.Jpb`:d4SA{A7x8rX]NJ^K nV!("A7F	@ctOa+cuKMn7xK])eq!N&8/F7&RF$zX
#HHG5KbP&G&~_ZK2V#|,LyX~uyhYA^nDZ+	,a\2+ *R#n+5"<zE tIq?X|[-hEF_z]YP))ZpJocyLV	e40GPZ4su\rG v&+rf.^kVbhEb yw,J:[J3JrC{n"^j.%Ui\h>Gc*n3B}Yy{6payaaq2wr%sW*MlzvS|  ') "m'"$:r#`6:QxY^5>9!]!;`kFavgA04>M?no;KQ"R(-?}	 $.'I!7M{vK%t>HL}"	\}F:l}bSz/&(1~'!ajt>!5aH<?p|)|Wn7cbORE>U8bC"*AGZ1e>Fe93^'\*Hiuys`EM|0R	6OeW
'PZ5C]%`$R&8>ax_	1_&?cL&u3eS+Ew-),/8)?T`3A#y^\-H;6oK\sN|fBYlHHNW	`_yP@/9%4
02%	'dJEw:*O?5>j,toX^cQYx7`UOv6G4U1q=e|*`y<hO2V,m]"Rxpk@Fk95ot1A[FHz[6+	G		UN[F[0s7ox ErBAY7q,2X*X"N\kiJos+ ]_Y_ax!7(3a$36JO>'0H7VH$9Q?Xr}1A)Bcz]vw14OME*f=
])]/Mlr-+|&K:E~1=.+)H*ECb)qj4p:Y"lnVBGn4`'m/$>SN60;gJwjHq;'"*1'X!%}i-_.Jkow); G#`z<A+MMS>N]"SbaBu)Z s+6oA~h,w`Gq&tpMyTuh96pnH*_\gwG4fm(x%"a \m\d	Rr'e3I%Un8eHtfP7.$.$llQ=%
QeeB.vqUO\sl$2p<&=IY1l	<NXIxV
k[bVNCG2WtTR&e.1[)PVq zT[6PZvj7;hFZ6uqAGpv0;N7<;+d=^Mw~o`4f
 ,6Ae0a/~n) V:_rbnbN+|JFZM/`f kA4OiN:@20QfjBg1y 	&b!dJ	PO<m[B$;LG4J1s\}A[=dmUF<l Ntdnb	
m7+j1JDKjS|U4v`SFEhO3 ',)n!`JH)"+qX`"?csw*nBc>{H KJV/F 836-p YF
TbL'r*;I%z6r)3B)Q%xJy~vnM8Ff|X.oagG;2Jn1{Ap.5hcu\is$q@d10GA{_%rL>&U#-+MyXf1H0yQZ\78ZR-b}rh\ `H6[M>8&zv-U93-h/\r{gk%x*6K3K`}+{(~Q*Cj-_>((yVP_h91y63xl|QG8Z^4@vjgyG=s2 *,0KCX,%Xg1#~)FEop'z,o= 9]s
!aVY"XcT	oRJceyYGhQxW= tO'TcR|!Lnefdo9>wxFjR0k$@$	YaEB-j8{=6f}DKs:BN2v&d.	oO{*ys
=*%NejP[1Neu0y)EQ9y=Ak*vb0p\$Bva2!=1FAN6zg<rX7+([E |wZuLxq6aYOE$cd{]&s~Ir-cS+!Y
7?r:PY yQn$!$i 2l*)n%8:87/2$61:lLwc.f. b>FYP!W/>==cs}m>7l"5FZY0@Hz4-1*BlA%Q,AX562[?\^6$U|)|*K)0vLC;7T(|51n}_RsqKi.V3bMuBO(cRdQNp"i'y?tRK8=@UmgQJ^MM| "^K(D&Yd.1zVLF2s3F$!|St!}0N6[s/6#O2g<f.#AP4tn/\gaD=Ko0}JR_p*y'qD1!]*Ner
mN7T2B(<0stPjAmu1G`(gT\A;s%4/{@n|9bO6rS]19q=vRsa(S;>]5^)Ml~j`%Uw9|&%?%/g{_c9e R{Vi'zm6-?2[T]ok:jeMI!tS!D_Z^_<Xv +1.Vi/'\cO+'!-V`By3ySbHVb>~Kp^::up25\n_3lO*mNL2WDuxg-UmC%96rnRV/#WkPdJm
6;3$ae#Md<fpY3p{8 S<]>h=4pUzz$Z<OwFe03)JD[bZV-*~Q$,X@+>q\;y*		s|r3Pz54{X;ycAHl1c:xpbL"HfQ$KGbhJh:2aQo\T6+*+xW=GP-Efx&*]!,6Qz^dy,qb	*|fmO xSn5Dh-A~c}+VX<gB/LV
>d-iw>0v'qJ>GKv2`V}snM"%j_a9YW5{eU:2M-Y0;>Ix-b)!y@*]9+?Mb*PjDOE9}b
9&N4w%I{74WC56[du{n<vQV\8	GGqRkk<A"<`_j,8 a*) )w*=qGbofz%AA/%7~MM+q2VGgsiXpKs\uA!y.)%} 3+z
(fM"
Hh<SNPB35Kv< ^
)erBAZGW'H#1s.X L.*^?jn\?S-ERtfJG%iWLzBS]&8]?Rd['?McW';,$%)xxIi+j=`BYM<b,?.is%rU$miT.%gcb57Y@2rWA.Cg;.S?%tH?UrZaOYO4_^e(JA!yyyfI:9/hs,9E/z~'luy=$0qNjAN<YwXx,v+	[_16Wt
!E_wnEHo|MK3q8d(\/NAKt]]"|EfZ\P4jaB@+zdXTT^(iIZ#N (rp?F!U_ #L*7'<LaZy1YDi!eTx/q[<w0M~4+wOA|XUeu4ty@bU[e:l	*eIqrXsJk5_{Rrk=J57oz!4LT9
vy n<"[tgf>gWStCK4%W`w\JdDd(ep>9
KX2ZVbtgCqO$: wC*l4ibA%zs|ZZjqsT_a&s20Y6#yhWg%sf?F\u*Y{B19,m*@5R"y|(y
\T{DY";&`E'z]17" Nv9H~GkSdLL@x^ze)~{aL23+:?rxk^:<K[?
y3$EE Wcylb_n*e\">Z'5Sf CGR8rKrS^]|\pwn5,KJ*m8&oRNABYo 0r~ ghU>&YV4Fe1oO1/C_,TqEAN@w-w2V7
'HWX;o:MiL)?`BPCn\]P0 =d"tMM~\7wmu7hS~x;82S.sm^>9tN0B:uwt c&}AQ6)CWC!a`lw`7X<[{QMR]`e-|1g'V(0.3YDr+uCK=E]v'&lUAKG
$qTy?e+y	0nr%EhB3[A.)Stwq1sIZo|b6j#TP_jibTlEOx`ta3l>y j8.%Om`(k."NnA?xRB"ldZm@,d6mpSqK"mL%jf nT?wV""['uXpw{")^
65u0nQr'p(duL}sZ=	".'D.t*Je]rmf:}kd`[Xl&AOe#k}vw
V<GK	w!{f pPD Uc&'9Z>}]R|EL6.?P`j>(
k}*t%v$IvZ*mav2rRsoY{4o	)_Xo(.g,}"[V	dJlD1@|?d7#l+~<Vm!=%bK>m ;>CwU}9g)f&MTrWHZ=o2ci8LO4tu\kG$F4C77:J-o3{ Q( <U/ X]#x0.|P"(y	`b #\oqow//n=sq4HP`S@`z[_6<up"&JAJDGi:057	l3?+b
N X*}^,TJE7;Tqf%R<yRoe>_6i0&3$GULgb"s~-5a]-GT{8C,#4rc@\aO]1u4 y=D{|X1 Y 		
<6=)L&J_{5aP,MJ|Y	zYuG+7-0dF
*Vt.#QGr=i[,&1ckb-
UYO3Cmtd8~!C5'/b{(vbaQ)M9zQ& C+	<$fro;u-CYJ$KKN>LsJQL7i4eX#IAG#{4zWTmP9M'M7&(EE<PN &35;*,e'@2U/%E,:F
MaZ"e3*|	s/UG+I(MHFA%g47f)ixF3a JX-*$"+vV7[Cnc4y3GCPLlF;>UJ9icizU[DDLM5g6+;2&h8I2:-mA,hd& p"_,qPY~}c'-KsRzO:${U(S h=	++XGhTr1%Rq 5?Bar(F_9$<Oa/dW_w*(&	 >OH,lPD=
\6X S$_Esi@[Cnh:rK/&O 33eZgHKnf8gtMkX6WQ'e*v(,OaO$
nb]:H .!G<=~pl6()g"F&ggOz_wG:RFcd9|{;.8z}b_S:%ebLg&!3?Lp3}(`		tzUic  -g6LA"[5'B@Cv3p9	 4(9+lAaN)v1j Bq&~|(mI&JK$"'xQ3uq(F6osU4F:_K6Xr7uzDW5 "c{f)3eyR]-a~JGe^t)-7$R1J@9gL!y}22D_"u}iy>kE5r(clym&.OM80CE0sZ k?fS!uB~ 5!ea=+6 7eZ|Gr "KoP6a~