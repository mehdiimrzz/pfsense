# Copyright 2001-2021 Sourcefire, Inc. All Rights Reserved.
#
# This file contains (i) proprietary rules that were created, tested and certified by
# Sourcefire, Inc. (the "VRT Certified Rules") that are distributed under the VRT
# Certified Rules License Agreement (v 2.0), and (ii) rules that were created by
# Sourcefire and other third parties (the "GPL Rules") that are distributed under the
# GNU General Public License (GPL), v2.
# 
# The VRT Certified Rules are owned by Sourcefire, Inc. The GPL Rules were created
# by Sourcefire and other third parties. The GPL Rules created by Sourcefire are
# owned by Sourcefire, Inc., and the GPL Rules not created by Sourcefire are owned by
# their respective creators. Please see http://www.snort.org/snort/snort-team/ for a
# list of third party owners and their respective copyrights.
# 
# In order to determine what rules are VRT Certified Rules or GPL Rules, please refer
# to the VRT Certified Rules License Agreement (v2.0).
#
#---------------------
# SERVER-APACHE RULES
#---------------------

# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts denial of service attempt"; flow:to_server,established; content:".getParentFile().setWritable(false)"; fast_pattern:only; http_client_body; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-0233; reference:url,cwiki.apache.org/confluence/display/WW/S2-060; classtype:attempted-admin; sid:56001; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts denial of service attempt"; flow:to_server,established; content:"Content-Disposition:"; nocase; http_client_body; content:"form-data"; within:50; nocase; http_client_body; content:".ParentFile.Writable"; fast_pattern; nocase; http_client_body; content:"false"; within:25; nocase; http_client_body; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-0233; reference:url,cwiki.apache.org/confluence/display/WW/S2-060; classtype:attempted-admin; sid:56000; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts denial of service attempt"; flow:to_server,established; content:"Content-Disposition:"; nocase; http_client_body; content:"form-data"; within:50; nocase; http_client_body; content:".ParentFile.Writable"; fast_pattern; nocase; http_uri; content:"false"; within:25; nocase; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2019-0233; reference:url,cwiki.apache.org/confluence/display/WW/S2-060; classtype:attempted-admin; sid:55999; rev:1;)
alert tcp any any -> $HOME_NET 8009 (msg:"SERVER-APACHE Apache Tomcat AJP connector arbitrary file access attempt"; flow:to_server,established; content:"|12 34|"; depth:2; content:"|02|"; within:1; distance:2; byte_test:1,!&,0xF9,0,relative; byte_extract:2,1,protocol_len,relative; content:"HTTP"; within:protocol_len; nocase; content:"javax.servlet.include.request_uri|00|"; fast_pattern:only; content:"javax.servlet.include.servlet_path|00|"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:cve,2020-1938; classtype:attempted-user; sid:53341; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache httpd mod_remoteip heap buffer overflow attempt"; flow:to_server,established; content:"|0D 0A 0D 0A 00 0D 0A|QUIT|0A|"; depth:12; byte_test:2,>,216,2,relative; metadata:policy max-detect-ips drop, policy security-ips drop; reference:cve,2019-10097; reference:url,httpd.apache.org/security/vulnerabilities_24.html; classtype:attempted-user; sid:52494; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat chunked transfer encoding denial of service attempt"; flow:to_server,established; content:"Transfer-Encoding: chunked"; fast_pattern:only; nocase; http_header; detection_filter:track by_src, count 50, seconds 30; metadata:policy max-detect-ips drop, service http; reference:cve,2014-0227; classtype:attempted-dos; sid:52471; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Solr Velocity Response Writer remote code execution attempt"; flow:to_server,established; content:"/solr/"; nocase; http_uri; content:"velocity"; nocase; http_uri; content:"v.template."; nocase; http_uri; content:"java.lang.Runtime"; distance:0; nocase; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,lucene.apache.org/solr/; classtype:attempted-user; sid:52325; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Solr Velocity Response Writer remote code execution attempt"; flow:to_server,established; content:"/solr/"; nocase; http_uri; content:"velocity"; nocase; http_uri; content:"v.template."; nocase; http_uri; content:"java.lang.ProcessBuilder"; distance:0; nocase; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,lucene.apache.org/solr/; classtype:attempted-user; sid:52324; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 5672 (msg:"SERVER-APACHE Apache Qpid AMQP denial of service attempt"; flow:to_server; content:"|00 00 00 00 00 00 00 02 01|"; content:"|00 00 00 00 00 00 00 02 08|"; distance:0; byte_test:4,>,2147483647,8,relative; metadata:policy max-detect-ips drop; reference:cve,2015-0203; classtype:denial-of-service; sid:51662; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE Apache cookie logging denial of service attempt"; flow:to_server,established; content:"Connection: keep-alive"; fast_pattern:only; http_header; pcre:"/^([[:alnum:]]*=[[:alnum:]]*\x3b\s*)\1{3}/Ci"; metadata:policy max-detect-ips drop, service http; reference:cve,2014-0098; classtype:denial-of-service; sid:51547; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 443 (msg:"SERVER-APACHE Apache 2 mod_ssl Connection Abort denial of service attempt"; flow:to_server,established; ssl_state:client_keyx; content:"|30 1E 17 0D 30 34 30 39 30 34 30 30 35 34 30 38 5A 17 0D 30 35 30 39 30 34 30 30 35 34 30 38 5A|"; metadata:policy max-detect-ips drop, service ssl; reference:bugtraq,11094; reference:cve,2004-0748; reference:url,rhn.redhat.com/errata/RHSA-2004-349.html; classtype:attempted-dos; sid:50883; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts2 remote code execution attempt"; flow:to_server,established; content:".do?action|3A|"; nocase; http_uri; content:".start|28 29|"; nocase; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2013-2251; reference:url,struts.apache.org/release/2.3.x/docs/s2-016.html; classtype:web-application-attack; sid:49885; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts remote code execution attempt"; flow:to_server,established; content:"Content-Type|3A|"; nocase; content:"#context"; distance:0; fast_pattern; content:".multipart/form-data"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-5638; reference:cve,2017-9791; reference:url,cwiki.apache.org/confluence/display/WW/S2-045; classtype:attempted-admin; sid:49377; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts remote code execution attempt"; flow:to_server,established; content:"Content-Type|3A|"; nocase; content:"OgnlContext"; distance:0; content:"|23|_memberAccess"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-5638; reference:cve,2017-9791; reference:url,cwiki.apache.org/confluence/display/WW/S2-045; classtype:attempted-admin; sid:49376; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [$HTTP_PORTS,8088,8090] (msg:"SERVER-APACHE Apache Hadoop YARN ResourceManager arbitrary command execution attempt"; flow:to_server,established; content:"/ws/v1/cluster/apps"; fast_pattern:only; http_uri; content:"am-container-spec"; nocase; http_client_body; content:"YARN"; http_client_body; content:"commands"; nocase; http_client_body; content:"command"; within:80; nocase; http_client_body; pcre:"/command.{0,2}\:.{0,10}(echo|bash)/Psmi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,rapid7.com/db/modules/exploit/linux/http/hadoop_unauth_exec; classtype:attempted-user; sid:48474; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat mod_jk access control bypass attempt"; flow:to_server,established; content:"/jk-manager|3B|"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-11759; classtype:attempted-user; sid:48384; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat mod_jk access control bypass attempt"; flow:to_server,established; content:"/jkmanager|3B|"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-11759; classtype:attempted-user; sid:48383; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat mod_jk access control bypass attempt"; flow:to_server,established; content:"/jk-status|3B|"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-11759; classtype:attempted-user; sid:48382; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat mod_jk access control bypass attempt"; flow:to_server,established; content:"/jkstatus|3B|"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-11759; classtype:attempted-user; sid:48381; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts ognl remote code execution attempt"; flow:to_server,established; content:"ognl."; fast_pattern:only; http_uri; content:"${"; http_uri; content:"#request"; distance:0; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-11776; reference:url,cwiki.apache.org/confluence/display/WW/S2-057; classtype:attempted-user; sid:47691; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts java.lang.ProcessBuilder class access attempt"; flow:to_server,established; content:"${"; http_uri; content:"java.lang.ProcessBuilder"; distance:0; nocase; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-11776; reference:cve,2020-17530; reference:url,cwiki.apache.org/confluence/display/WW/S2-057; reference:url,cwiki.apache.org/confluence/display/WW/S2-061; classtype:attempted-user; sid:47690; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts java.net.Socket class access attempt"; flow:to_server,established; content:"${"; http_uri; content:"java.net.Socket"; distance:0; nocase; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-11776; reference:url,cwiki.apache.org/confluence/display/WW/S2-057; classtype:attempted-user; sid:47689; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts OGNL getRuntime.exec static method access attempt"; flow:to_server,established; content:"@java.lang.Runtime@getRuntime("; http_uri; content:".exec"; within:10; http_uri; metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-11776; reference:url,cwiki.apache.org/confluence/display/WW/S2-057; classtype:attempted-admin; sid:47634; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Tika crafted HTTP header command injection attempt"; flow:to_server,established; content:"X-Tika-OCRtesseractPath"; http_header; content:"|00|"; within:200; http_header; pcre:"/X-Tika-OCRtesseractPath:[^\r\n]+?\x00/Hi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2018-1335; classtype:attempted-user; sid:47615; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache mod_http2 NULL pointer dereference attempt"; flow:to_server,established; content:"Upgrade: h2c"; fast_pattern:only; http_header; content:!"Host:"; nocase; http_header; metadata:policy max-detect-ips drop, service http; reference:cve,2017-7659; classtype:denial-of-service; sid:46428; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE  Apache Jetspeed User Manager service unauthorized API access attempt"; flow:to_server,established; content:"/jetspeed/services/usermanager/users/"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2016-2171; classtype:policy-violation; sid:46336; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Jetspeed PageManagementService persistent XSS attempt"; flow:to_server,established; content:"/jetspeed/services/pagemanagement/info/.psml/_user/"; fast_pattern:only; http_uri; content:"title"; nocase; http_client_body; pcre:"/title(=|%3d)[^\x0d]*?([\x3c\x3e\x28\x29]|script|onload|src|%3c|%3e|%28|%29)/iP"; metadata:policy max-detect-ips drop, service http; reference:cve,2016-0711; classtype:attempted-user; sid:46327; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"SERVER-APACHE Apache Jetspeed PageManagementService persistent XSS attempt"; flow:to_client,established; file_data; content:"/jetspeed/services/pagemanagement/info/.psml/_user/"; fast_pattern; nocase; content:"title"; within:200; content:"value"; within:50; pcre:"/value(=|%3d)[\x22\x27][^\x22\x27]*?([\x3c\x3e\x28\x29]|script|onload|src|%3c|%3e|%28|%29)/i"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-0711; classtype:attempted-user; sid:46326; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"SERVER-APACHE FrontPage privilege escalation attempt"; flow:to_server,established; file_data; content:"/usr/local/apache/logs/fpcgisock"; fast_pattern:only; content:"mod_suexec.c"; content:"mod_suexec.so"; content:"FPScriptLog"; metadata:policy max-detect-ips drop, service smtp; classtype:attempted-admin; sid:46116; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"SERVER-APACHE FrontPage privilege escalation attempt"; flow:to_client,established; file_data; content:"/usr/local/apache/logs/fpcgisock"; fast_pattern:only; content:"mod_suexec.c"; content:"mod_suexec.so"; content:"FPScriptLog"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:attempted-admin; sid:46115; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET [10001,10002] (msg:"SERVER-APACHE Apache Tomcat Java JmxRemoteLifecycleListener unauthorized serialized object attempt"; flow:to_server,established; content:"|AC ED 00 05|"; content:"/runtime/callsite/"; distance:0; content:"|00 0C|java.io.File"; distance:0; content:"|70 74 00 07|execute"; within:100; content:"|00 0A|loadFactor"; within:400; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service java_rmi; reference:cve,2016-8735; reference:url,github.com/frohoff/ysoserial; reference:url,tomcat.apache.org/security-6.html; classtype:attempted-user; sid:46071; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Sling framework information disclosure attempt"; flow:to_server,established; content:"POST"; http_method; content:"Content-Disposition"; nocase; http_client_body; content:":operation"; http_client_body; content:"delete"; http_client_body; content:":applyTo"; fast_pattern:only; http_client_body; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2016-0956; reference:url,exploit-db.com/exploits/39435/; reference:url,helpx.adobe.com/security/products/experience-manager/apsb16-05.html; classtype:web-application-attack; sid:45353; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE Apache SSI error page cross-site scripting attempt"; flow:to_server,established; content:"Host: "; http_header; content:"alert(|27|"; within:75; nocase; http_header; metadata:policy max-detect-ips drop, service http; reference:bugtraq,5847; reference:cve,2002-0840; classtype:web-application-attack; sid:45307; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 8983 (msg:"SERVER-APACHE Apache Solr xmlparser external doctype or entity expansion attempt"; flow:to_server,established; content:"/solr/"; depth:6; nocase; http_uri; content:"/select"; nocase; http_uri; content:"xmlparser"; fast_pattern:only; http_uri; pcre:"/<\x21(ENTITY|DOCTYPE)[^>]+?(SYSTEM|PUBLIC)/Ui"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,101261; reference:cve,2017-12629; classtype:web-application-attack; sid:45084; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 8983 (msg:"SERVER-APACHE Apache Solr RunExecutableListener arbitrary command execution attempt"; flow:to_server,established; content:"/solr/"; depth:6; nocase; http_uri; content:"/config"; nocase; http_uri; content:"solr.RunExecutableListener"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,101261; reference:cve,2017-12629; classtype:attempted-admin; sid:45083; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat remote JSP file upload attempt"; flow:to_server,established; content:"PUT"; http_method; content:".jsp/"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,100954; reference:cve,2017-12617; reference:url,bz.apache.org/bugzilla/show_bug.cgi?id=61542; classtype:attempted-user; sid:44531; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache HTTP Server possible OPTIONS method memory leak attempt"; flow:to_server,established,only_stream; content:"OPTIONS"; fast_pattern:only; content:"OPTIONS"; http_method; detection_filter:track by_src,count 5,seconds 10; metadata:policy max-detect-ips drop, service http; reference:bugtraq,100872; reference:cve,2017-9798; reference:url,blog.fuzzing-project.org/60-Optionsbleed-HTTP-OPTIONS-method-can-leak-Apaches-server-memory.html; classtype:attempted-user; sid:44434; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts freemarker tag OGNL expression injection attempt"; flow:to_server,established; content:"%25|7B|"; fast_pattern:only; http_client_body; pcre:"/(^|&)\w+=[^&]*%25\x7b/Pim"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-12611; reference:url,struts.apache.org/docs/s2-053.html; classtype:attempted-admin; sid:44330; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts freemarker tag OGNL expression injection attempt"; flow:to_server,established; content:"%25|7B|"; fast_pattern:only; content:"%25|7B|"; nocase; http_raw_uri; pcre:"/[?&]\w+=[^&]*%25\x7b/Ii"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-12611; reference:url,struts.apache.org/docs/s2-053.html; classtype:attempted-admin; sid:44329; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts freemarker tag OGNL expression injection attempt"; flow:to_server,established; content:"%25%7B"; fast_pattern:only; http_client_body; pcre:"/(^|&)\w+=[^&]*%25%7B/Pim"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-12611; reference:url,struts.apache.org/docs/s2-053.html; classtype:attempted-admin; sid:44328; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts freemarker tag OGNL expression injection attempt"; flow:to_server,established; content:"%25%7B"; fast_pattern:only; content:"%25%7B"; nocase; http_raw_uri; pcre:"/[?&]\w+=[^&]*%25%7B/Ii"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-12611; reference:url,struts.apache.org/docs/s2-053.html; classtype:attempted-admin; sid:44327; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 5672 (msg:"SERVER-APACHE Apache Qpid AMQP denial of service attempt"; flow:to_server; content:"|00 00 00 00 00 00 00 02 0D|"; depth:14; offset:5; metadata:policy max-detect-ips drop; reference:cve,2015-0203; classtype:denial-of-service; sid:44156; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 5672 (msg:"SERVER-APACHE Apache Qpid AMQP denial of service attempt"; flow:to_server; content:"|00 00 00 00 00 00 00 02 01|"; content:"|00 00 00 00 00 00 00 02 08|"; distance:0; byte_extract:4,4,range1,relative; byte_test:4,<,range1,0,relative; metadata:policy max-detect-ips drop; reference:cve,2015-0203; classtype:denial-of-service; sid:44155; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE httpd mod_mime content-type buffer overflow attempt"; flow:to_server,established; content:"Content-Type: "; http_header; content:"|5C 0D 0A|"; within:100; http_header; pcre:"/Content-Type:[^\r\n]{0,100}\x5C\x0D\x0A/iGH"; metadata:policy max-detect-ips drop, service http; reference:cve,2017-7679; classtype:attempted-user; sid:43547; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Rave information disclosure attempt"; flow:to_server,established; content:"/app/api/rpc/users/get"; fast_pattern:only; http_uri; content:"offset="; nocase; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2013-1814; classtype:attempted-recon; sid:43247; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache mod_session_crypto padding oracle brute force attempt"; flow:to_server,established,only_stream; content:"session="; fast_pattern:only; content:"session="; nocase; http_cookie; content:"AAAAAAAAAAA"; within:150; http_cookie; detection_filter:track by_src,count 20, seconds 2; metadata:policy max-detect-ips drop, service http; reference:cve,2016-0736; reference:url,attack.mitre.org/techniques/T1110; reference:url,httpd.apache.org/security/vulnerabilities_24.html; classtype:web-application-attack; sid:42133; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts remote code execution attempt"; flow:to_server,established; content:"|23|_memberAccess"; fast_pattern:only; http_client_body; content:"new "; nocase; http_client_body; pcre:"/new\s+(java|org|sun)/Pi"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-12611; reference:cve,2017-5638; reference:cve,2017-9791; reference:cve,2019-0230; reference:url,cwiki.apache.org/confluence/display/WW/S2-059; reference:url,struts.apache.org/docs/s2-045.html; reference:url,struts.apache.org/docs/s2-048.html; reference:url,struts.apache.org/docs/s2-053.html; classtype:attempted-admin; sid:41923; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts remote code execution attempt"; flow:to_server,established; content:"Content-Disposition:"; nocase; http_client_body; content:"%{"; distance:0; http_client_body; content:".ognl"; distance:0; fast_pattern; nocase; http_client_body; content:"form-data"; nocase; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-5638; reference:cve,2017-9791; reference:cve,2019-0230; reference:url,cwiki.apache.org/confluence/display/WW/S2-059; classtype:attempted-admin; sid:41922; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts remote code execution attempt"; flow:to_server,established; content:"|23|_memberAccess"; fast_pattern:only; http_header; content:"new "; nocase; http_header; pcre:"/new\s+(java|org|sun)/Hi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-5638; reference:cve,2017-9791; reference:url,cwiki.apache.org/confluence/display/WW/S2-045; classtype:attempted-admin; sid:41819; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts remote code execution attempt"; flow:to_server,established; content:"Content-Type:"; nocase; http_header; content:"ognl"; distance:0; fast_pattern; nocase; http_header; content:"multipart/form-data"; nocase; http_header; content:"%{"; http_raw_header; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2017-5638; reference:cve,2017-9791; reference:url,cwiki.apache.org/confluence/display/WW/S2-045; classtype:attempted-admin; sid:41818; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache HTTP Server mod_http2 denial of service attempt"; flow:to_server,established; content:"|01 00 00 00 00 01|"; content:"|09 01 00 00 00 01|"; within:50; content:"|09 01 00 00 00 01|"; within:25; content:"|09 01 00 00 00 01|"; within:25; metadata:policy max-detect-ips drop, service http; reference:cve,2016-8740; classtype:denial-of-service; sid:41688; rev:2;)
# alert tcp $EXTERNAL_NET 3690 -> $HOME_NET any (msg:"SERVER-APACHE Apache Subversion svnserve integer overflow attempt"; flow:to_client,established; content:"184467440737095516"; depth:18; content:"|3A|"; within:1; distance:2; metadata:policy max-detect-ips drop, policy security-ips drop; reference:cve,2015-5259; reference:url,subversion.apache.org/security/CVE-2015-5259-advisory.txt; classtype:attempted-user; sid:40849; rev:1;)
# alert tcp $EXTERNAL_NET 3690 -> $HOME_NET any (msg:"SERVER-APACHE Apache Subversion svnserve integer overflow attempt"; flow:to_client,established; content:"42949672"; depth:8; content:"|3A|"; within:1; distance:2; metadata:policy max-detect-ips drop, policy security-ips drop; reference:cve,2015-5259; reference:url,subversion.apache.org/security/CVE-2015-5259-advisory.txt; classtype:attempted-user; sid:40848; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 3690 (msg:"SERVER-APACHE Apache Subversion svnserve integer overflow attempt"; flow:to_server,established; content:"184467440737095516"; depth:18; content:"|3A|"; within:1; distance:2; metadata:policy max-detect-ips drop, policy security-ips drop; reference:cve,2015-5259; reference:url,subversion.apache.org/security/CVE-2015-5259-advisory.txt; classtype:attempted-user; sid:40847; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 3690 (msg:"SERVER-APACHE Apache Subversion svnserve integer overflow attempt"; flow:to_server,established; content:"42949672"; depth:8; content:"|3A|"; within:1; distance:2; metadata:policy max-detect-ips drop, policy security-ips drop; reference:cve,2015-5259; reference:url,subversion.apache.org/security/CVE-2015-5259-advisory.txt; classtype:attempted-user; sid:40846; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts xslt.location local file inclusion attempt"; flow:to_server,established; content:"/XSLAction.action"; fast_pattern:only; http_uri; content:"xslt.location="; nocase; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2016-3082; reference:url,attack.mitre.org/techniques/T1220; reference:url,struts.apache.org/docs/s2-031.html; classtype:attempted-admin; sid:40359; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat credential disclosure attempt"; flow:to_server,established; content:"/conf/users/admin-users.xml"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1003; reference:url,attack.mitre.org/techniques/T1081; reference:url,attack.mitre.org/techniques/T1214; classtype:attempted-admin; sid:40321; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat default credential login attempt"; flow:to_server,established; content:"/manager/html"; nocase; http_uri; content:"Authorization: Basic cm9sZTE6cm9sZTE="; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1078; classtype:default-login-attempt; sid:40320; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat default credential login attempt"; flow:to_server,established; content:"/manager/html"; nocase; http_uri; content:"Authorization: Basic Ym90aDp0b21jYXQ="; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1078; classtype:default-login-attempt; sid:40319; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat default credential login attempt"; flow:to_server,established; content:"/manager/html"; nocase; http_uri; content:"Authorization: Basic YWRtaW46YWRtaW4="; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1078; classtype:default-login-attempt; sid:40318; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat default credential login attempt"; flow:to_server,established; content:"/manager/html"; nocase; http_uri; content:"Authorization: Basic YWRtaW46Y2hhbmdldGhpcw=="; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1078; classtype:default-login-attempt; sid:40317; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat default credential login attempt"; flow:to_server,established; content:"/manager/html"; nocase; http_uri; content:"Authorization: Basic dG9tY2F0OnRvbWNhdA=="; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1078; classtype:default-login-attempt; sid:40316; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Jetspeed Portal cross-site scripting attempt"; flow:to_server,established; content:"/jetspeed/portal/"; fast_pattern:only; http_uri; pcre:"/\x2fjetspeed\x2fportal\x2f[^?\x2f]*?([\x22\x27\x3c\x28\x29]|script|onload|src)/Ui"; metadata:policy max-detect-ips drop, service http; reference:cve,2016-0712; reference:url,portals.apache.org/jetspeed-2/security-reports.html#CVE-2016-0712; classtype:attempted-user; sid:40302; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat Commons FileUpload library denial of service attempt"; flow:to_server,established; content:"Content-Type|3A| multipart"; fast_pattern:only; http_header; content:"boundary="; nocase; http_header; content:!"|0A|"; within:70; http_header; pcre:"/boundary=[^\x3b\x0d\x0a]{70}/Hi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,91453; reference:cve,2016-3092; classtype:denial-of-service; sid:39908; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Continuum saveInstallation.action arbitrary command execution attempt"; flow:to_server,established; content:"/continuum/saveInstallation.action"; fast_pattern:only; http_uri; content:"installation.varValue="; nocase; metadata:policy max-detect-ips drop, service http; reference:url,issues.apache.org/jira/browse/continuum; classtype:attempted-admin; sid:39326; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts remote code execution attempt"; flow:to_server,established; content:"|23|_memberAccess"; fast_pattern:only; http_uri; content:"new "; nocase; http_uri; pcre:"/new\s+(java|org|sun)/Ui"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2016-3087; reference:cve,2017-12611; reference:cve,2018-11776; reference:url,cwiki.apache.org/confluence/display/WW/S2-057; reference:url,struts.apache.org/docs/s2-033.html; reference:url,struts.apache.org/docs/s2-053.html; classtype:attempted-admin; sid:39191; rev:3;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts remote code execution attempt"; flow:to_server,established; content:"|23|_memberAccess"; fast_pattern:only; http_uri; content:"@java.lang."; nocase; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2016-3087; reference:cve,2018-11776; reference:url,cwiki.apache.org/confluence/display/WW/S2-057; reference:url,struts.apache.org/docs/s2-033.html; classtype:attempted-admin; sid:39190; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"SERVER-APACHE 404 OK response"; flow:to_client, established; content:"HTTP/1.1 404 OK"; depth:15; metadata:policy max-detect-ips drop, service http; reference:url,www.virustotal.com/en/file/fe08cdc834d8ba803e69d1010bf7b66a7e57df50709c4923c13975217009e112/analysis/; classtype:misc-attack; sid:38268; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache HTTP Server mod_status heap buffer overflow attempt"; flow:to_server,established,only_stream; content:"/server-status"; fast_pattern:only; http_uri; detection_filter:track by_dst, count 21, seconds 2; metadata:impact_flag red, policy max-detect-ips drop, service http; reference:cve,2014-0226; reference:url,httpd.apache.org/security/vulnerabilities_24.html; classtype:web-application-activity; sid:35406; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache HTTP Server mod_proxy denial of service attempt"; flow:to_server,established; content:"Connection|3A 20|"; nocase; http_header; content:"|3B|"; within:20; http_header; pcre:"/Connection\x3a\s*[^\x0d\x0a]*\x3b/mHi"; metadata:policy max-detect-ips drop, service http; reference:cve,2014-0117; reference:url,httpd.apache.org/security/vulnerabilities_24.html; classtype:attempted-admin; sid:35314; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"SERVER-APACHE Apache mod_log_config cookie handling denial of service attempt"; flow:to_server,established; content:"Cookie|3A| =|0D 0A 0D 0A|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:bugtraq,51705; reference:cve,2012-0021; classtype:denial-of-service; sid:34048; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE Apache Chunked-Encoding worm attempt"; flow:to_server,established; content:"Transfer-Encoding: Chunked"; fast_pattern; nocase; content:"|0D 0A|"; distance:0 ; byte_test:8,>,2147483647,0,string,hex,relative; content:"|20|"; within:9; metadata:policy max-detect-ips drop, ruleset community, service http; reference:bugtraq,4474; reference:bugtraq,4485; reference:bugtraq,5033; reference:cve,2002-0071; reference:cve,2002-0079; reference:cve,2002-0392; reference:nessus,10932; classtype:web-application-attack; sid:31405; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts CookieInterceptor classloader access attempt"; flow:to_server,established; content:"ClassLoader"; fast_pattern:only; content:"class"; nocase; http_cookie; content:"ClassLoader"; distance:0; nocase; http_cookie; pcre:"/class([\x2e\x5b]|%2e|%5b)([\x22\x27]|%22|%27)?ClassLoader/Ci"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,67081; reference:cve,2014-0113; reference:url,cwiki.apache.org/confluence/display/WW/S2-021; classtype:attempted-admin; sid:30944; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts ParametersInterceptor classloader access attempt"; flow:to_server,established; content:"class["; nocase; http_uri; content:"ClassLoader"; distance:0; fast_pattern; nocase; http_uri; pcre:"/class\x5b\s*?[\x22\x27]ClassLoader[\x22\x27]\s*?\x5d/Ui"; metadata:policy max-detect-ips drop, service http; reference:cve,2014-0112; reference:url,cwiki.apache.org/confluence/display/WW/S2-021; classtype:attempted-admin; sid:30793; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts ParametersInterceptor classloader access attempt"; flow:to_server,established; content:"class.ClassLoader."; fast_pattern:only; http_uri; pcre:"/class\x2eClassLoader\x2e[^&]+?=/Ui"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,65999; reference:cve,2014-0094; reference:cve,2014-0114; reference:url,struts.apache.org/release/2.3.x/docs/s2-020.html; classtype:attempted-admin; sid:30792; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts ParametersInterceptor classloader access attempt"; flow:to_server,established; content:"class"; nocase; http_client_body; content:"ClassLoader"; distance:0; fast_pattern; nocase; http_client_body; pcre:"/class(\x5b|%5b)\s*?([\x22\x27]|%22|%27)ClassLoader([\x22\x27]|%22|%27)\s*?(\x5d|%5d)/Pi"; metadata:policy max-detect-ips drop, service http; reference:cve,2014-0112; reference:url,cwiki.apache.org/confluence/display/WW/S2-021; classtype:attempted-admin; sid:30791; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts ParametersInterceptor classloader access attempt"; flow:to_server,established; content:"class"; nocase; http_client_body; content:"ClassLoader"; distance:0; fast_pattern; nocase; http_client_body; pcre:"/class(\x2e|%2e)ClassLoader(\x2e|%2e)/Pi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,65999; reference:cve,2014-0094; reference:cve,2014-0114; reference:url,struts.apache.org/release/2.3.x/docs/s2-020.html; classtype:attempted-admin; sid:30790; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Solr SolrResourceLoader directory traversal attempt"; flow:to_server,established; content:"/solr/select"; fast_pattern:only; http_uri; content:"tr="; nocase; http_uri; content:"../"; distance:0; http_uri; pcre:"/[?&]tr=[^&]*?\x2e\x2e\x2f/Ui"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,63935; reference:cve,2013-6397; reference:url,issues.apache.org/jira/browse/SOLR-4882; classtype:attempted-admin; sid:30010; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts remote code execution attempt - CookieInterceptor"; flow:to_server,established; content:".action"; fast_pattern:only; http_uri; pcre:"/\x5Cu0020[^=]+?\x5Cu0020[^=]*?=/C"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,51257; reference:cve,2012-0392; reference:url,issues.apache.org/jira/browse/WW-3668; classtype:attempted-admin; sid:29936; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat infinite loop denial of service attempt"; flow:to_server,established; content:"Content-type|3A 20|multipart"; nocase; http_raw_header; content:"boundary|3D|"; within:50; nocase; http_raw_header; isdataat:4092,relative; content:!"|0A|"; within:4092; http_raw_header; metadata:policy max-detect-ips drop, service http; reference:cve,2014-0050; classtype:denial-of-service; sid:29896; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts allowStaticMethodAccess invocation attempt"; flow:to_server,established; content:".do"; nocase; http_uri; content:"allowStaticMethodAccess"; nocase; http_client_body; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,60166; reference:cve,2013-1966; reference:cve,2013-2115; reference:url,struts.apache.org/development/2.x/docs/s2-014.html; classtype:attempted-admin; sid:29859; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts2 blacklisted method redirect"; flow:to_server,established; content:".do?redirect|3A|"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2013-2248; reference:cve,2013-2251; reference:url,struts.apache.org/release/2.3.x/docs/s2-016.html; reference:url,struts.apache.org/release/2.3.x/docs/s2-017.html; classtype:web-application-attack; sid:29748; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts2 blacklisted method redirect"; flow:to_server,established; content:".do?redirectAction|3A|"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2013-2248; reference:cve,2013-2251; reference:url,struts.apache.org/release/2.3.x/docs/s2-016.html; reference:url,struts.apache.org/release/2.3.x/docs/s2-017.html; classtype:web-application-attack; sid:29747; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Roller allowStaticMethodAccess invocation attempt"; flow:to_server,established; content:".rol?"; nocase; http_uri; content:"pageTitle="; distance:0; nocase; http_uri; content:"allowStaticMethodAccess"; distance:0; nocase; http_uri; metadata:policy max-detect-ips drop, service http; reference:bugtraq,63928; reference:cve,2013-4212; classtype:attempted-user; sid:29649; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Roller OGNL injection remote code execution attempt"; flow:to_server,established; content:".rol?"; nocase; http_uri; content:"pageTitle="; distance:0; nocase; http_uri; content:"new "; distance:0; nocase; http_uri; pcre:"/new (java|org|sun)/Ui"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,63928; reference:cve,2013-4212; classtype:attempted-user; sid:29648; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Roller OGNL injection remote code execution attempt"; flow:to_server,established; content:".rol?"; nocase; http_uri; content:"pageTitle="; distance:0; nocase; http_uri; content:"@java.lang."; distance:0; nocase; http_uri; metadata:policy max-detect-ips drop, service http; reference:bugtraq,63928; reference:cve,2013-4212; classtype:attempted-user; sid:29647; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts wildcard matching OGNL remote code execution attempt"; flow:to_server,established; content:"${"; http_uri; content:"}"; distance:0; http_uri; pcre:"/\x24\{[^\x2f{}]+?\}/Ui"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,60346; reference:cve,2013-2134; reference:cve,2018-11776; reference:url,cwiki.apache.org/confluence/display/WW/S2-015; reference:url,cwiki.apache.org/confluence/display/WW/S2-057; classtype:attempted-admin; sid:29639; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts wildcard matching OGNL remote code execution attempt"; flow:to_server,established; content:"%25%7B"; nocase; http_raw_uri; content:"{"; http_uri; content:"}"; within:25; http_uri; pcre:"/%25%7B[^\x2f\x5c]+?%7D/Ii"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,60346; reference:cve,2013-2134; reference:cve,2020-17530; reference:url,cwiki.apache.org/confluence/display/WW/S2-015; reference:url,cwiki.apache.org/confluence/display/WW/S2-061; classtype:attempted-admin; sid:29592; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Oracle WebLogic Apache Connector buffer overflow attempt"; flow:to_server,established; content:"POST"; http_method; content:"/weblogic/index.jsp"; http_uri; isdataat:3500,relative; metadata:policy max-detect-ips drop, service http; reference:bugtraq,30273; reference:cve,2008-3257; reference:url,www.oracle.com/technology/deploy/security/alerts/alert_cve2008-3257.html; classtype:attempted-admin; sid:29523; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts arbitrary OGNL remote code execution attempt"; flow:to_server,established; content:".action?"; nocase; http_uri; content:"=${{"; distance:0; http_uri; content:"=$%7B%25%7B"; nocase; http_raw_uri; pcre:"/\.action\?[^\x2f]+?=\x24\{\{[^\x2f{}]+?\}\}$/miU"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,60345; reference:cve,2013-2135; reference:url,cwiki.apache.org/confluence/display/WW/S2-015; classtype:attempted-admin; sid:27575; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts OGNL getRuntime.exec static method access attempt"; flow:to_server,established; content:"(@java.lang.Runtime@getRuntime()).exec("; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,60345; reference:bugtraq,60346; reference:cve,2013-2134; reference:cve,2013-2135; reference:url,cwiki.apache.org/confluence/display/WW/S2-015; classtype:attempted-admin; sid:27574; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts wildcard matching OGNL remote code execution attempt"; flow:to_server,established; content:"/{#"; http_uri; content:"}"; distance:0; http_uri; content:"/%25%7B"; nocase; http_raw_uri; pcre:"/\x2f\{\x23[^\x2f{}]+?\}(\.action)?\x2f?$/miU"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,60346; reference:cve,2013-2134; reference:url,cwiki.apache.org/confluence/display/WW/S2-015; classtype:attempted-admin; sid:27573; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts wildcard matching OGNL remote code execution attempt"; flow:to_server,established; content:"/${#"; http_uri; content:"}"; distance:0; http_uri; pcre:"/\x2f\x24\{\x23[^\x2f{}]+?\}(\.action)?\x2f?$/miU"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,60346; reference:cve,2013-2134; reference:url,cwiki.apache.org/confluence/display/WW/S2-015; classtype:attempted-admin; sid:27572; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts2 remote code execution attempt"; flow:to_server,established; content:".action?action|3A|"; nocase; http_uri; content:".start|28 29|"; nocase; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2013-2251; reference:url,struts.apache.org/release/2.3.x/docs/s2-016.html; classtype:web-application-attack; sid:27245; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts2 blacklisted method redirect"; flow:to_server,established; content:".action?redirect|3A|"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2013-2248; reference:cve,2013-2251; reference:url,struts.apache.org/release/2.3.x/docs/s2-016.html; reference:url,struts.apache.org/release/2.3.x/docs/s2-017.html; classtype:web-application-attack; sid:27244; rev:6;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts2 blacklisted method redirectAction"; flow:to_server,established; content:".action?redirectAction|3A|"; fast_pattern:only; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2013-2248; reference:cve,2013-2251; reference:url,struts.apache.org/release/2.3.x/docs/s2-016.html; reference:url,struts.apache.org/release/2.3.x/docs/s2-017.html; classtype:web-application-attack; sid:27243; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache mod_log_config cookie handling denial of service attempt"; flow:to_server,established; content:"Cookie|3A|"; fast_pattern:only; pcre:"/((^|\x3b)\s*?=\s*?(\x3b|$))/Cm"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,51705; reference:cve,2012-0021; classtype:denial-of-service; sid:24698; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache mod_log_config cookie handling denial of service attempt"; flow:to_server,established; content:"Cookie|3A| =|0D 0A 0D 0A|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:bugtraq,51705; reference:cve,2012-0021; classtype:denial-of-service; sid:24697; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache mod_rpaf X-Forwarded-For header denial of service attempt"; flow:to_server,established; content:"X-Forwarded-For|3A| "; fast_pattern:only; http_header; pcre:"/X-Forwarded-For\x3A\s+(?!(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))[^\s]+[\r\n]/Hi"; metadata:policy max-detect-ips drop, service http; reference:cve,2012-3526; classtype:web-application-attack; sid:24348; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE HP Operations Dashboard Apache Tomcat default admin account access attempt"; flow:to_server,established; content:"/manager/"; fast_pattern:only; http_uri; content:"Authorization: Basic"; nocase; http_header; content:"ajJkZXBsb3llcjpqMmRlcGxveWVy"; distance:0; metadata:policy max-detect-ips drop, service http; reference:bugtraq,36258; reference:cve,2009-3098; reference:cve,2009-4188; reference:url,attack.mitre.org/techniques/T1078; classtype:attempted-admin; sid:24306; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE Apache WebDAV mod_dav nested entity reference DoS attempt"; flow:to_server,established; content:"PROPFIND"; http_method; content:"<?xml"; depth:200; nocase; content:"<!DOCTYPE"; distance:0; nocase; content:"["; within:50; content:"<!ENTITY"; distance:0; nocase; content:!"]"; within:500; content:"<REMOTE"; distance:0; nocase; pcre:"/^>.*?&x\d+\x3B.*?<\/REMOTE>/smiR"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,35253; reference:cve,2009-1955; classtype:attempted-dos; sid:23779; rev:4;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts remote code execution attempt - POST parameter"; flow:to_server,established; content:".action"; fast_pattern:only; http_uri; content:"new"; nocase; http_client_body; pcre:"/new(\s|%20|\+)+(java|org)/iP"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-0391; reference:cve,2016-3081; reference:cve,2017-9791; reference:url,cwiki.apache.org/confluence/display/WW/S2-048; reference:url,issues.apache.org/jira/browse/WW-3668; reference:url,struts.apache.org/docs/s2-032.html; classtype:attempted-admin; sid:23631; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"SERVER-APACHE Apache Tomcat PUT request remote file deployment attempt"; flow:to_server,established; content:"PUT"; http_method; content:"manager|2F|deploy|3F|path|3D|"; fast_pattern:only; content:"Authorization|3A| Basic"; nocase; http_header; base64_decode:relative; base64_data; pcre:"/^(password|admin|tomcat)\x3a(password|admin|tomcat)/iR"; metadata:policy max-detect-ips drop, service http; reference:url,seclists.org/fulldisclosure/2012/Mar/188; classtype:attempted-user; sid:21923; rev:5;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts remote code execution attempt - GET parameter"; flow:to_server,established; content:".action?"; nocase; http_uri; content:"@java.lang."; distance:0; nocase; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-0391; reference:cve,2016-3081; reference:url,issues.apache.org/jira/browse/WW-3668; reference:url,struts.apache.org/docs/s2-032.html; classtype:attempted-admin; sid:21656; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts parameters interceptor remote code execution attempt"; flow:to_server,established; content:"#context"; fast_pattern:only; http_uri; pcre:"/action\?.*?#context.*?(allowStaticMethodAccess|Runtime@getRuntime\x28\x29\.exec\x28)/iU"; metadata:policy max-detect-ips drop, service http; reference:cve,2011-3923; reference:url,struts.apache.org/2.x/docs/s2-009.html; classtype:attempted-user; sid:21522; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat Web Application Manager access"; flow:to_server,established; content:"/manager/html"; nocase; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,tomcat.apache.org/tomcat-5.5-doc/manager-howto.html#Introduction; classtype:attempted-recon; sid:21515; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache URI directory traversal attempt"; flow:to_server,established; content:"cgi-bin"; nocase; http_raw_uri; content:"|2E 2E 25|5c"; nocase; http_raw_uri; content:"|2E 2E 25|5c"; fast_pattern; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,5434; reference:cve,2002-0661; classtype:attempted-recon; sid:21356; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache XML HMAC truncation authentication bypass attempt"; flow:to_server,established; content:"<?xml"; nocase; http_client_body; content:"HMACOutputLength"; distance:0; fast_pattern; nocase; http_client_body; content:">"; within:10; http_client_body; pcre:!"/<\s*ds\:\s*HMACOutputLength\s*>\s*\d{10}\s*<\s*\/\s*ds\:HMACOutputLength\s*>/Pims"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,35671; reference:cve,2009-0217; classtype:attempted-user; sid:21337; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Byte-Range Filter denial of service attempt"; flow:established, to_server; content:"HEAD"; nocase; http_method; content:"Range|3A|bytes|3D|0-|2C|"; nocase; http_header; metadata:policy max-detect-ips drop, service http; reference:bugtraq,14660; reference:cve,2005-2728; classtype:attempted-dos; sid:21260; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache server mod_proxy reverse proxy bypass attempt"; flow:to_server,established; content:"|3A 40|"; http_uri; pcre:"/^\w+?\x3A\x40/iU"; metadata:policy max-detect-ips drop, service http; reference:cve,2011-3368; reference:cve,2011-4317; classtype:attempted-recon; sid:21214; rev:11;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts remote code execution attempt - DebuggingInterceptor"; flow:to_server,established; content:".action?"; nocase; http_uri; content:"debug=command"; distance:0; nocase; http_uri; content:"expression="; distance:0; nocase; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-0394; reference:url,issues.apache.org/jira/browse/WW-3668; classtype:attempted-admin; sid:21075; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts remote code execution attempt - CookieInterceptor"; flow:to_server,established; content:".action"; fast_pattern:only; http_uri; pcre:"/^[\x28\x5B][^=]+?[\x29\x5D][^=]*?=/C"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,51257; reference:cve,2012-0392; reference:url,issues.apache.org/jira/browse/WW-3668; classtype:attempted-admin; sid:21074; rev:11;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts allowStaticMethodAccess invocation attempt"; flow:to_server,established; content:".action?"; nocase; http_uri; content:"allowStaticMethodAccess"; distance:0; nocase; http_uri; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-0391; reference:url,issues.apache.org/jira/browse/WW-3668; classtype:attempted-admin; sid:21073; rev:7;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts remote code execution attempt - GET parameter"; flow:to_server,established; content:".action?"; nocase; http_uri; content:"new "; distance:0; nocase; http_uri; pcre:"/new\s+(java|org)/Ui"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2012-0391; reference:cve,2012-0393; reference:cve,2016-3081; reference:url,issues.apache.org/jira/browse/WW-3668; reference:url,struts.apache.org/docs/s2-032.html; classtype:attempted-admin; sid:21072; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE Apache APR header memory corruption attempt"; flow:to_server,established; content:"GET"; nocase; http_method; content:"|0A|Host:"; nocase; http_header; isdataat:256; content:!"|0A|"; within:256; http_header; metadata:policy max-detect-ips drop, service http; reference:bugtraq,7723; reference:cve,2003-0245; classtype:attempted-admin; sid:20821; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat Java AJP connector invalid header timeout DOS attempt"; flow:to_server,established; content:"localhost:x"; nocase; http_header; metadata:policy max-detect-ips drop, service http; reference:bugtraq,35193; reference:cve,2009-0033; classtype:attempted-dos; sid:20612; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache mod_proxy reverse proxy information disclosure attempt"; flow:to_server,established; content:"|40|"; depth:1; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2011-3368; reference:cve,2011-4317; classtype:attempted-recon; sid:20528; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Killer denial of service tool exploit attempt"; flow:to_server,established; content:"Range"; nocase; http_header; content:"bytes"; within:10; nocase; http_header; pcre:"/Range\s*\x3A\s*bytes=([\d\x2D]+\x2C){50}/Hsmi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,49303; reference:cve,2011-3192; reference:url,archives.neohapsis.com/archives/fulldisclosure/2011-08/0203.html; classtype:attempted-dos; sid:19825; rev:13;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache APR apr_fn match infinite loop denial of service attempt"; flow:to_server,established; content:"P=*?*?*?*?*?*?*?*?*?*?*?*?*?*?*?*?*?*?*?*?"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2011-0419; reference:url,issues.apache.org/bugzilla/show_bug.cgi?id=51219; classtype:attempted-dos; sid:19709; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache mod_isapi dangling pointer exploit attempt"; flow:to_server,established; content:"Proxy-Connection: Keep-Alive"; http_header; content:"Transfer-Encoding: chunked|0D 0A|Content-Length: 40334"; fast_pattern:only; http_header; content:".dll"; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,38494; reference:cve,2010-0425; classtype:attempted-admin; sid:19124; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache mod_isapi dangling pointer code execution attempt"; flow:to_server,established; content:"POST"; http_method; content:"/cgi-bin/smtpsend.dll"; fast_pattern:only; stream_size:client,>,1400; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,38494; reference:cve,2010-0425; classtype:attempted-admin; sid:19107; rev:10;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts OGNL parameter interception bypass command execution attempt"; flow:to_server,established; content:"xwork.MethodAccessor.denyMethodExecution"; nocase; http_uri; content:"u0023"; nocase; http_uri; metadata:policy max-detect-ips drop, service http; reference:bugtraq,41592; reference:cve,2010-1870; classtype:attempted-admin; sid:18931; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Oracle WebLogic Apache Connector buffer overflow attempt"; flow:to_server,established; content:"POST"; http_method; content:"xxxxxxxxxxxxxxxxxxxx"; depth:100; metadata:policy max-detect-ips drop, service http; reference:bugtraq,30273; reference:cve,2008-3257; reference:url,www.oracle.com/technology/deploy/security/alerts/alert_cve2008-3257.html; classtype:attempted-admin; sid:18283; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat username enumeration attempt"; flow:to_server,established; content:"j_username="; nocase; content:"j_password=%"; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,35196; reference:cve,2009-0580; classtype:attempted-recon; sid:18096; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"SERVER-APACHE Apache HTTP server mod_rewrite module LDAP scheme handling buffer overflow attempt"; flow:to_server,established; content:"ldap:/"; nocase; http_uri; pcre:"/\x3F[^\x3F]*\x3F[^\x3F]*\x3F[^\x3F]*\x3F[^\x3F]*\x3F/U"; metadata:policy max-detect-ips drop, service http; reference:cve,2006-3747; classtype:attempted-user; sid:17656; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Struts Information Disclosure Attempt"; flow:to_server,established; content:"/struts"; nocase; http_uri; content:"..|25|252f"; http_raw_uri; metadata:policy max-detect-ips drop, service http; reference:bugtraq,32104; reference:cve,2008-6505; classtype:attempted-recon; sid:17533; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"SERVER-APACHE Apache Tomcat UNIX platform directory traversal"; flow:to_server,established; content:"%2E%2E/"; fast_pattern:only; content:"%2E%2E/"; http_raw_uri; pcre:"/\/(\\|%5C)%2E%2E\//"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,22960; reference:cve,2007-0450; reference:url,tomcat.apache.org/tomcat-6.0-doc/changelog.html; classtype:web-application-attack; sid:17502; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"SERVER-APACHE Apache Tomcat UNIX platform directory traversal"; flow:to_server,established; content:"/%2E%2E"; fast_pattern:only; content:"/%2E%2E"; http_raw_uri; pcre:"/\/%2E%2E(\\|%5C)\//"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,22960; reference:cve,2007-0450; reference:url,tomcat.apache.org/tomcat-6.0-doc/changelog.html; classtype:web-application-attack; sid:17501; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"SERVER-APACHE Apache Tomcat UNIX platform directory traversal"; flow:to_server,established; content:"/..%5C/"; fast_pattern:only; content:"/..%5C/"; http_raw_uri; metadata:policy max-detect-ips drop, service http; reference:bugtraq,22960; reference:cve,2007-0450; reference:url,tomcat.apache.org/tomcat-6.0-doc/changelog.html; classtype:web-application-attack; sid:17500; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"SERVER-APACHE Apache Tomcat UNIX platform directory traversal"; flow:to_server,established; content:"/..|5C|/"; fast_pattern:only; content:"/..|5C|/"; http_raw_uri; metadata:policy max-detect-ips drop, service http; reference:bugtraq,22960; reference:cve,2007-0450; reference:url,tomcat.apache.org/tomcat-6.0-doc/changelog.html; classtype:web-application-attack; sid:17499; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 (msg:"SERVER-APACHE Apache Tomcat UNIX platform directory traversal"; flow:to_server,established; content:"/|5C|../"; fast_pattern:only; content:"/|5C|../"; http_raw_uri; metadata:policy max-detect-ips drop, service http; reference:bugtraq,22960; reference:cve,2007-0450; reference:url,tomcat.apache.org/tomcat-6.0-doc/changelog.html; classtype:web-application-attack; sid:17498; rev:8;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Tomcat allowLinking URIencoding directory traversal attempt"; flow:to_server,established; content:"%ae/"; fast_pattern:only; content:"%ae/"; nocase; http_raw_uri; pcre:"/(((\xc0|\xe0\x80|\xf0\x80\x80)\xaf|\x2f)((\xc0|\xe0\x80|\xf0\x80\x80)\xae|\x2e){2}|(((\xc0|\xe0\x80|\xf0\x80\x80)\xae|\x2e){2}(\xc0|\xe0\x80|\xf0\x80\x80)\xaf|\x2f))/I"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,30633; reference:cve,2008-2938; classtype:suspicious-filename-detect; sid:17387; rev:11;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"SERVER-APACHE Apache Byte-Range Filter denial of service at?P`j>(
k}*t%v$IvZ*mav2rRsoY{4o	)_Xo(.g,}"[V	dJlD1@|?d7#l+~<Vm!=%bK>m ;>CwU}9g)f&MTrWHZ=o2ci8LO4tu\kG$F4C77:J-o3{ Q( <U/ X]#x0.|P"(y	`b #\oqow//n=sq4HP`S@`z[_6<up"&JAJDGi:057	l3?+b
N X*}^,TJE7;Tqf%R<yRoe>_6i0&3$GULgb"s~-5a]-GT{8C,#4rc@\aO]1u4 y=D{|X1 Y 		
<6=)L&J_{5aP,MJ|Y	zYuG+7-0dF
*Vt.#QGr=i[,&1ckb-
UYO3Cmtd8~!C5'/b{(vbaQ)M9zQ& C+	<$fro;u-CYJ$KKN>LsJQL7i4eX#IAG#{4zWTmP9M'M7&(EE<PN &35;*,e'@2U/%E,:F
MaZ"e3*|	s/UG+I(MHFA%g47f)ixF3a JX-*$"+vV7[Cnc4y3GCPLlF;>UJ9icizU[DDLM5g6+;2&h8I2:-mA,hd& p"_,qPY~}c'-KsRzO:${U(S h=	++XGhTr1%Rq 5?Bar(F_9$<Oa/dW_w*(&	 >OH,lPD=
\6X S$_Esi@[Cnh:rK/&O 33eZgHKnf8gtMkX6WQ'e*v(,OaO$
nb]:H .!G<=~pl6()g"F&ggOz_wG:RFcd9|{;.8z}b_S:%ebLg&!3?Lp3}(`		tzUic  -g6LA"[5'B@Cv3p9	 4(9+lAaN)v1j Bq&~|(mI&JK$"'xQ3uq(F6osU4F:_K6Xr7uzDW5 "c{f)3eyR]-a~JGe^t)-7$R1J@9gL!y}22D_"u}iy>kE5r(clym&.OM80CE0sZ k?fS!uB~ 5!ea=+6 7eZ|Gr "KoP6a~i@ 0O`Y0'#`v2|)F|LF4XWEyu`s_wl3V\W	4R]rKcne!lC[$Ft1]iW}TQeVsVM8sZQZ3dk<cYTcWx8Q"QHOe:NJDN&N`qLjOn$=P[1'=
:m&CffX'!W:8
eM#-|NSac^FZ=*iP1iOtY/hl`mTWYS?,62]
NjoCf+o%?64J>$q{\Hwss	,;"{Xx "n@s&c'V;viKlB9oA[*QIq[S3so*];J]mQ=]#-echfH N^hsugTM'UR4DS )5X".~/W'kd0JCFc?w2<I'pp#D/lYh06e;
S_-\tg:oEeY$!y^,] +A:GAp.,Mz<4*3spo@zxW#$H}m%9C(~7'LX8~$V%orVy;QH	UZd3.yCikG2xQOJn9;N	{bW-J0'G(f]CCAc%~3`HoTFy9&fri1co_S72xVr$\4mBD"um2N6En^M:RPe{*q`$Zy^Fs2Z|;z_zm/_o)15suR@5^u6#-V#0[,OR5QG6fbAL//x19E;PP,63cPKWu{#TFIcW4j:h{G;lh=8SfaA<kr<|~9);`AW'u3po#b`S7N,JK-3+g]/@5S8]dP	H*P8lK\hO`j;W,p=<<x[Y[.Q=a~7CUXr#tp3QOSMnxS(LA6D
ImsQZ	".]P476JD+b:B8
k|Ul`1[T9P@V\J0HAf@'%?zd9uE4$OUB.*)U$Yx/@c)0PVc#)VqYh>(F'YB:YqzS/CtV~SG`x$wvcM KD<WBI[Ol,7IOeT^vw zHv%~r9q'xu81H{(k:V<{M7A;v_#/R65T=zb4v0`2\en2sykaj4{H1PsBX,-(^aa.BjiP&[@@^lTxmL%Az(lE<$Nundl$f1W~l4&oe^{R&)}b~w{U	a? WFl.W{6[]._tt;.NO}p-*O+;NFk<9EXMfg#aE 7VOF$#*	8uN~;:]}7h1awt
\#wSWq,7J~I	TI]7$#@	Cq'
cF9vudx2$WXO~(Z}|)OL!.M`U{ZCYdLzSkO;\r7M3kbJ^$:`Le;<N-wk+$18ydRLX\6KRVS"Q_;\T3d+r5NGCl<D*Fcbl''\'_J W Ta7G+6VK|R,3*O7)^4PXE-r	$klJ4Vmi5#`{bt+Y kEmIcL*Ss	3n42O	"^ol'+vF.g;]@qyvvo5|v79?: [^4P)/x~QJ7f_PJcTb#E[`+)C|ShN"pnit'8D/XT,[PS5
1Rb).%UxRjk50ejKXBL9V-	ZMScIIHA\}3!K3{y=yFcX"^6lV>Wz(7`a@_X-kmI5a"e(`CDhwJ *sG,(]2^lkF$);~+zl8'	}V_&fo2;]OWP	$mM6m+`TEB pTCF5G%xL_k/w%IX:Kn~\jM4)$$'ztVt@`[#6[qU{VXds/9Mf-h&2G	`3XTA-{1e$(2w"]U`dxp~wRFk\WsXkC=aTuIA3[8WX]+3
G
I{Y
e	AQ!YP
x=HLTzTKbj+O8'IOYt[) &ylWl(}kU($pf<42'[})MZ"!Xo~']_]7wiH[m[63*)H19['?3L-z&<$&$H ]V\U2J]Gah(1gSUZVh	<"38sH66 Q[(EI)hl7D}bGGkCd]>X%J770.{PZ!XJ:+IQ{5,N_b}	`;!'gS
[] _H9o`uBt-?v/?[T<.qnfNu	#LRU
0v+-Q+!|ebgH[*u b&Z4j[=x?<@A8 rO+UNVXv@oq/5
zi`<By!I X3#UJnym:1bls7(nM}0B3DUGyJG3JajG(M7pjQ@i]C^'Od.mD
(o".c?]l&Zg6A+(A`PnS2G(K/asW}+Td,$*OQ^3{8#Hx1=[!Cs]MN	XG7
WTKoDr1oSb )Q=$B 0DG{{IB<|f/\v*Ndw<A-]z$GsgGTx2<tao4hJ9fFpnX?6vm[g]YQ@#l,	T],e"f#ZD;pX`	WTYBfGMa(JN8A+|uzP00>d)0=5!]#(a]L^QU%	f~(oq6B^m';HG`<>^+M1`}%X1C<$jIID=)!n+hM`z43,W9Zed^,xKuiu`!gk<Y5urSCOnjZQZM`\NrFi~+L,6'YtD~gUd	AcL6>FCG+`,7}?l"Oa0K	OHiU?aU9JLKdNkJxB[Spa>wP~Bkp $gQ5u]tGs$ZF?JMTJ"mRjf;P8IoVHS~=n@$sd&fbF3OVK9eUhMr~28V6J4B{Hd~znLPw28>'P={ h 1m"kv.s}W
eT5UNHX1  o-TI+ R3J)@@'<z}@2g6^KgmD%`Y0}9`NId6b%i2l*|T@h<}EHfcZ;o	P}+ykfLa[~M
l)R.=7&yE	7WW^vGvf%}H9^ ~ib`k<
80HK{5	r+GMbQ	O~Dlu{9j A'A}	)n/62+&HD(VO|S]pqS~(nsgsU7z?S*)xiTo+_O	Uc$0?lpN|caZ^%VX7JOpNyu, !: MMHY6.
AQHj3,tH#_?ved.^z5]k!y(?7^kLBb}Oz~[]4*kj[Omi#KQ0 mqI\x6-[nz\i3_'30D"IXiRwi!,aAU|Mtw7,(-RDJ*M2^:MID6_gkVQ^#PE)HP0@V3!jKwe;PeQG'F B	WqM?QNS%50Syv Z~+Dc)|,E=[#3#Ck"
m|HrgfH}\Xy/s6VDxAvzO|~C^!oQKxs(o2:AQcyE_	=4z%FiU	ZGqh"VQ_%B.q@hp@R29Q%OcR"i|HbG.}=W
3lSH[u-8A+B@CVuOCoiO=:/inh;zRO)Z,1P#+35gp DLu8(*vVxa\@Hh<V>!\>5c"ezzDLy_o`a1!G9	DF3retvU]=Wx_N5*xw$}^x4_Key#61UXpsgVyW*V/8X'2CHhLmWaiY xK*B9n+/p~4-=EnY'OyWO!y?*^%1Q`B%WBlcJl %Mu	+Cl[X+
UNXx7#v|>w]/$}3r.Z3>K !rGjzq ~v{{bCHdrfKX28V=I+t/(0c1!SPYv	N>[%yH*q_ o/@bPvd+H]\X 3ioMwYl*OHeI/238).x"X57xYv.ya]Th6i _;C__Lhx%/_0 WR-:c-+;pc9@ I&68l8~Q!qOSdohLx1Z$lx%U5DOTh\VI&_W~o;t%>E@"h	]AIAqmHn &MXB~yKokZ\7CRMDSVi,9>\9@_ZTQ9;s}..@EF`sMIz#_FCU`$>r5}U
o2-HZa9g<A)	Ic\E3oQ%DV.SL4cr)Zwq y@T~v)Kl7cG&m1/hEDpaSO6B'#F,E`:N[j{%F(s@mQS2$DSAKZy)^yW8t#ERW/>c
+ej_k-w{e	3V&mlIA90 W MTI).C3PO/'Z_X$gYaz+#]^nOQ	I#;8u9!|N'|+,{lLyi#;7 1M/#;KUPGv DsX+l).0BU?*aPZbQ0puuyjR,Jzo7:	0\+f@h]%w2L:/"'15'JEo|n#
7AH"6)S~\4_W|!dV[&I9g!^;r{52:'At[N]V@3-a{S){=BU}'G	0CQk4blGB)y4H+DP.0 .dD2?$D6q|8Mkzh~oC1\r+u^:-8\ \T<Gql*rbv@1h3iG,Z:g.{ .|a,dR_j_W7rY6z!3olcJZ.f0	u=Y'd$X5Y^<R!w?gG~#TqqE_PTmJIof,
q1;wzKYF8lIR)[
"35hqB(4qQ5n~d<-w%]PY?p TF
|N.Ja9	\1kin_B865o
,/)MTz\Pqm	97'<ir3wESLuhT0q'}	4I*Z-1N);<_p1Iax.7svZz~!vbm}t_M0IW rLiE}uO f''qzpy#PiK6X%&_3A{j+)E;rdQw%3H68@%Me@18en[W'>]6}pqatGv	|kp1% 8	FV`7.W1,u)dcf?1En12[<gj>7!|ee-d.E&ISS]Ccoi)'<'p^$2$K L5}[-B%Np6@u k?E6@% )!+(\Q'B;:&|m"Xc\K,drDZT)Nu7lDhW<^f'@:2NXrA@B& 6uR;Fx|^,GJ.!P'?i1n^a3\p:O\gG0kEjf%8))<k0xT%<Bcrv-fLmoO/Jsg8$foB^zs]/~LBy\VO>]!	1NpyHfSONf>))?	9nAz*!=
S~H<-'9J}+cwwI}Hy&`{pkJ
O&@ehYo,Z32pq02|Qa8lnk6~mCAlyM9 HQS#m	)@Q<Th,3Zzn;=`qf3`;mVwv|w_f|DkI.)y0q>.B6g*m
t[y<h2X((5Xat'y 3m~@MZ	e^gAUmo 	4]qk]BhE3 NX<Z%zM[pQ#~gFQ;bqe&pMxcWgUW=-DMMj~5I1m:x@	j%,Hq~"&nO~pU^eg#E17I rq"	(Wr96)ASs,NZy)jf1Nf" 5NZ`$Wp#h)%*B(7Mr>hi&P:!L<&5#yk{I):UY& /9rK&OdWZxONuN;I9S-Rzd~v}oJ0f":8
@#[uoN*YBb\J(|N9Fgq4~+T?hH@kc9V}or1%;ai"NpH,$`x}sct {C1 ]2G|-l r(lL`Tq7G{k_JYX(BT	# i)ug%BkG0M:BE=yy(F0H9XXnk*+x3=Tq%/O*UZE !r?;M{5uGVM;cr:$= J%H[T'a>$#[5s6Cj+he5<`#(?5:6]d-!CS0xXhBoH^qa,?>(a;|nVvL`A$ Pn{W50 :/O7jQK(}]1qsv\3&<k8@Q3Q]Q/;5g.,,T*LZ$x9{.:AUOPb7?+UjKYg3mZm 5-<QgO?
NkDy	
j.:H@7X*w{
t*~ei_a-(rj:Ud%Kmu'G,.w=a\Y\ehAh\GszK	Fa+dT^KX_+&\&[Hf\DM(24	Bm4
	F:+8	.cP'q{%Nl(Df9a;g13lMSarv*o3+yhc.;)_M~}X*T79c^KjP`Faoivv;f?#r$8614YN5$8_s5YQN`AoWS<aW9I	+:ulY_$1RF7J'y##JKa.z Pa":W.s/Yh|nBcjR|4:5#%zMV)dpp2BgB\;v<vR;7@AB-4'v8R;7%w3!	i#49.4n -Mo_$ujq?:h&N0/~$nAB~tqmVXzx?f]Y~MUxc4
,;Hv %^g'j,]5jPO`P
GUp^};j7oODoY@dX;N&3ABm	LU&2/ceS5aQ?"QNM2|a"Q?A5!GGHq,9}#/%yP'zvw8Vb@g_Y`,h
)2MD3BdPD+dc2h1*{R1'M~Fg"w+@|4E>kwjf9}_nV!{6*  )3y\
2:j3q,wIM'}RaC7P@D-AM@G^hB97gs{)*e:]KXF;x^'!M_pVe4bgeBflw-mpv\Kb2AyJFUK&goQCqYuT:;y.oiIa.X(/Np-wG(_9"Ta6UM<qF7" iF|M;Rc?  v?NJ+<LjrX^K(R}+s^=0i%^X!lEuwBwlwL{:f~]cF~v^DC*?_JK){At\#v,]j{o3[/1_}o[!F(dZ!z$\6B]
xG|YtYUo0Q 7@O kT-R|I.Z9Izm%\/} f?u&jrtT=A%%E~MghSDcPO gqDWKN@qn\BF{Jaz`]_rSZ,+ nF\]g%S#!y9s2L%-4`6:&@lM=)<!VK<tP-vdgU>Yq h?$ szQi6RN@1E6J7+
G(a{Wj1Q$le,$-]u1c g.N~32(!KfkuWaSP(HrEpU0[&5YCK(}<<B7BH)osXP4VUI71[VEN\4"tE
.X^G9zodET&\3NE~;}f^cd2Jn(m@J`aYz[i6\WWO[.&Qd5A"F5[E4MX
'{kE?GrzfY7+F>zIkE~:e@*T.@(#UuHX.^X`;VyriL}a0vQYG-}h M70'LJ3*SbIrAMBSF0.xo}\},(#oe;&:` $7uB~f!o_;xLpzxggO,kc@k o1+-;-VkRK|}^d
!A-<3\zgx]lqQD"dIeAw