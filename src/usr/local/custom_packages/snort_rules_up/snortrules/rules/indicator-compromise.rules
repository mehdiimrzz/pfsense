# Copyright 2001-2021 Sourcefire, Inc. All Rights Reserved.
#
# This file contains (i) proprietary rules that were created, tested and certified by
# Sourcefire, Inc. (the "VRT Certified Rules") that are distributed under the VRT
# Certified Rules License Agreement (v 2.0), and (ii) rules that were created by
# Sourcefire and other third parties (the "GPL Rules") that are distributed under the
# GNU General Public License (GPL), v2.
# 
# The VRT Certified Rules are owned by Sourcefire, Inc. The GPL Rules were created
# by Sourcefire and other third parties. The GPL Rules created by Sourcefire are
# owned by Sourcefire, Inc., and the GPL Rules not created by Sourcefire are owned by
# their respective creators. Please see http://www.snort.org/snort/snort-team/ for a
# list of third party owners and their respective copyrights.
# 
# In order to determine what rules are VRT Certified Rules or GPL Rules, please refer
# to the VRT Certified Rules License Agreement (v2.0).
#
#----------------------------
# INDICATOR-COMPROMISE RULES
#----------------------------

# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Microsoft Internet Explorer IE5 compatibility mode enable attempt"; flow:established,to_client; file_data; content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=5|22|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:url,blogs.msdn.com/b/askie/archive/2009/03/23/understanding-compatibility-modes-in-internet-explorer-8.aspx; classtype:policy-violation; sid:26850; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Microsoft Internet Explorer 8 compatibility mode enable attempt"; flow:established,to_client; file_data; content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=8|22|"; fast_pattern:only; metadata:service http; reference:url,blogs.msdn.com/b/askie/archive/2009/03/23/understanding-compatibility-modes-in-internet-explorer-8.aspx; classtype:policy-violation; sid:34416; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Microsoft Sharepoint DataFormWebPart remote code execution attempt"; flow:to_server,established; content:"<!--#include virtual=|22|/web.config|22|-->"; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, service http; reference:cve,2020-16952; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-16952; classtype:attempted-user; sid:56070; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Microsoft Sharepoint DataFormWebPart fingerprinting attempt"; flow:to_server,established; content:"<%$SPTokens:{ProductNumber}%>"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2020-16952; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2020-16952; classtype:attempted-user; sid:56069; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Win.Trojan.GoldenSpy download attempt"; flow:to_server,established; file_data; content:"|5C E6 97 A5 E5 B8 B8 E5 B7 A5 E4 BD 9C 5C E5 AE A2 E6 88 B7 E7 AB AF E8 BD AF E4 BB B6 5C|VCProject"; fast_pattern:only; metadata:impact_flag red, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,www.virustotal.com/gui/file/98b5320e7464fc69b12eb626b6336604efcbf6502adc38c77f6db41666da9dd1; classtype:trojan-activity; sid:54890; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Win.Trojan.GoldenSpy download attempt"; flow:to_server,established; file_data; content:"Aisino.Framework.Startup.exe"; content:"nb_app_log_mutex"; content:"SOFTWARE|5C|skfpkprj|5C|skfpkprj"; fast_pattern:only; metadata:impact_flag red, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,www.virustotal.com/gui/file/ce3d64f8ad4dcbbf5324e05c81a716c5d2493e149edafbc5cb73c01836bea5f2; classtype:trojan-activity; sid:54889; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Win.Trojan.GoldenSpy download attempt"; flow:to_server,established; file_data; content:"U29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cVW5pbnN0YWxsXHN2bQ=="; fast_pattern:only; content:"Software|5C|IDG|5C|DA"; metadata:impact_flag red, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,www.virustotal.com/gui/file/cfc69b016dff47f7d946f99c4889becd2776b569780d64aa6dfa02a6133dd07d; classtype:trojan-activity; sid:54888; rev:1;)
# alert tcp $EXTERNAL_NET [$FILE_DATA_PORTS,9005,9006] -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Win.Trojan.GoldenSpy download attempt"; flow:to_client,established; file_data; content:"Aisino.Framework.Startup.exe"; content:"nb_app_log_mutex"; content:"SOFTWARE|5C|skfpkprj|5C|skfpkprj"; fast_pattern:only; metadata:impact_flag red, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/gui/file/ce3d64f8ad4dcbbf5324e05c81a716c5d2493e149edafbc5cb73c01836bea5f2; classtype:trojan-activity; sid:54887; rev:1;)
# alert tcp $EXTERNAL_NET [$FILE_DATA_PORTS,9005,9006] -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Win.Trojan.GoldenSpy download attempt"; flow:to_client,established; file_data; content:"|5C E6 97 A5 E5 B8 B8 E5 B7 A5 E4 BD 9C 5C E5 AE A2 E6 88 B7 E7 AB AF E8 BD AF E4 BB B6 5C|VCProject"; fast_pattern:only; metadata:impact_flag red, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/gui/file/98b5320e7464fc69b12eb626b6336604efcbf6502adc38c77f6db41666da9dd1; classtype:trojan-activity; sid:54886; rev:1;)
# alert tcp $EXTERNAL_NET [$FILE_DATA_PORTS,9005,9006] -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Win.Trojan.GoldenSpy download attempt"; flow:to_client,established; file_data; content:"U29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cVW5pbnN0YWxsXHN2bQ=="; fast_pattern:only; content:"Software|5C|IDG|5C|DA"; metadata:impact_flag red, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/gui/file/cfc69b016dff47f7d946f99c4889becd2776b569780d64aa6dfa02a6133dd07d; classtype:trojan-activity; sid:54885; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"INDICATOR-COMPROMISE UPnP SUBSCRIBE Callback denial-of-service attempt"; flow:to_server,established; content:"SUBSCRIBE"; depth:9; nocase; content:"CALLBACK:"; fast_pattern:only; detection_filter:track by_dst, count 50, seconds 5; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2020-12695; reference:url,callstranger.com; classtype:attempted-dos; sid:54280; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"INDICATOR-COMPROMISE UPnP SUBSCRIBE Callback denial-of-service attempt"; flow:to_server,established; content:"SUBSCRIBE"; depth:9; nocase; content:"CALLBACK:"; fast_pattern; nocase; isdataat:500,relative; content:!"|0D 0A|"; within:500; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2020-12695; reference:url,callstranger.com; classtype:attempted-dos; sid:54279; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Cobalt Strike default smart applet attack URI"; flow:to_server,established; urilen:11; content:"/SiteLoader"; fast_pattern:only; http_uri; metadata:impact_flag red, policy max-detect-ips drop, service http; reference:url,cobaltstrike.com; classtype:trojan-activity; sid:54183; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Cobalt Strike default signed applet attack URI"; flow:to_server,established; urilen:8; content:"/mPlayer"; fast_pattern:only; metadata:impact_flag red, policy max-detect-ips drop, service http; reference:url,cobaltstrike.com; classtype:trojan-activity; sid:54175; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Win.Trojan.TrickBot variant outbound connection attempt"; flow:to_server,established; urilen:>32; content:"group="; nocase; http_cookie; content:!"Content"; nocase; http_header; content:!"Accept"; nocase; http_header; pcre:"/^\/[a-fA-F0-9]{32}\/2\/$/Ui"; metadata:impact_flag red, policy max-detect-ips drop, service http; reference:url,www.virustotal.com/gui/file/2f0f0956628d7787c62f892e1bd9edda8b4c478cf8f1e65851052c7ad493dc28/detection; classtype:trojan-activity; sid:54080; rev:1;)
alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE msiexec.exe command execution over DNS attempt"; flow:to_client,no_stream; byte_test:1,&,0x80,2,bitmask 0x87; content:"|00 10 00 01|"; content:"msiexec /i"; within:20; distance:7; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service dns; reference:url,www.virustotal.com/gui/file/32b8afb4deb90660514214df426f38a92ba24fbc92a834a8b8bfa55371aeda48; classtype:trojan-activity; sid:53985; rev:1;)
# alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Cobalt Strike multiple large DNS TXT query responses"; flow:to_client; dsize:>282; byte_test:1,&,0x80,2; content:"|00 01 00 01|"; depth:4; offset:4; content:"|00 10 00 01|"; distance:9; content:"|01 00 FF|"; within:3; distance:4; isdataat:!255,relative; detection_filter:track by_src, count 10, seconds 1; metadata:impact_flag red, policy max-detect-ips drop, policy security-ips drop, service dns; reference:url,colbaltstrike.com; classtype:trojan-activity; sid:53975; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Chromium use after free exploitation attempt"; flow:to_server,established; file_data; content:"href="; content:"tel:"; within:10; content:"window.close()"; within:200; fast_pattern; metadata:policy max-detect-ips drop, service smtp; reference:cve,2019-13685; classtype:attempted-user; sid:53836; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Chromium use after free exploitation attempt"; flow:to_client,established; file_data; content:"href="; content:"tel:"; within:10; content:"window.close()"; within:200; fast_pattern; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-13685; classtype:attempted-user; sid:53835; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE PHP eval command execution attempt"; flow:to_server,established; content:"eval"; nocase; http_client_body; content:"$_REQUEST"; within:25; http_client_body; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:53649; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE RTF document with Equation and BITSAdmin download attempt"; flow:to_client,established; flowbits:isset,file.rtf|file.doc; file_data; content:"0200000002CE020000000000C000000000000046"; fast_pattern:only; content:"6269747361646d696e"; nocase; metadata:impact_flag red, ruleset community, service ftp-data, service http, service imap, service pop3; classtype:trojan-activity; sid:53583; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE RTF document with Equation and BITSAdmin download attempt"; flow:to_server,established; flowbits:isset,file.rtf|file.doc; file_data; content:"0200000002CE020000000000C000000000000046"; fast_pattern:only; content:"6269747361646d696e"; nocase; metadata:impact_flag red, ruleset community, service smtp; classtype:trojan-activity; sid:53582; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Website defacement via HTTP PUT request attempt"; flow:to_server,established; content:"hardrevenge11.html"; fast_pattern:only; http_uri; content:"PUT"; http_method; metadata:policy max-detect-ips drop, policy security-ips drop, service http; classtype:misc-attack; sid:52635; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Website defacement via HTTP PUT request attempt"; flow:to_server,established; content:"hackedbymrb3hz4d@gmail.com"; fast_pattern:only; content:"PUT"; http_method; metadata:policy max-detect-ips drop, policy security-ips drop, service http; classtype:misc-attack; sid:52634; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Win.Trojan.ReverseTcpPowershell connection attempt"; flow:to_server,established; content:" - System: Microsoft Windows "; depth:75; content:" - Version: "; within:50; content:" - Architecture: "; within:50; content:" - WindowsDirectory: "; within:200; metadata:impact_flag red, policy max-detect-ips drop, policy security-ips drop; reference:url,github.com/ZHacker13/ReverseTCPShell; classtype:trojan-activity; sid:52517; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Win.Trojan.ReverseTcpPowershell connection attempt"; flow:to_client,established; content:"(Get-WmiObject Win32_OperatingSystem).Caption"; nocase; content:"(Get-WmiObject Win32_OperatingSystem).OSArchitecture"; within:200; distance:50; nocase; content:"(Get-WmiObject Win32_OperatingSystem).WindowsDirectory"; within:200; distance:50; nocase; metadata:impact_flag red, policy max-detect-ips drop, policy security-ips drop; reference:url,github.com/ZHacker13/ReverseTCPShell; classtype:trojan-activity; sid:52516; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Microsoft Word internal OLE object update attempt"; flow:to_server,established; file_data; flowbits:isset,file.doc|file.rtf; content:"|5C|objlink"; content:"|5C|objupdate"; within:200; fast_pattern; content:"0068007400740070003a002f002f"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-0199; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2017-0199; classtype:attempted-user; sid:52482; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Microsoft Word internal OLE object update attempt"; flow:to_client,established; file_data; flowbits:isset,file.doc|file.rtf; content:"|5C|objlink"; content:"|5C|objupdate"; within:200; fast_pattern; content:"0068007400740070003a002f002f"; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-0199; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2017-0199; classtype:attempted-user; sid:52481; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 25 (msg:"INDICATOR-COMPROMISE AgentTesla variant outbound connection attempt"; flow:to_server,established; content:"MAIL FROM:<torre@casadavilas.com>"; fast_pattern:only; nocase; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,virustotal.com/gui/file/667519d5fea7b6137de2845dc900cf2813c8fd8c8476b107fe9a281e7aa5248d/analysis; classtype:trojan-activity; sid:52246; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Win.Downloader.PowMet powershell script download attempt"; flow:to_server,established; file_data; content:"ASCII.GetBytes(|22|72F006C0-AC7D-40D9-B4E5-E0F0DAF6FBEE|22|)"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,virustotal.com/gui/file/7004b6c1829a745002feb7fbb0aad1a4d32c640a6c257dc8d0c39ce7b63b58cc/analysis; classtype:trojan-activity; sid:52118; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Xml.Downloader.PowMet fileless malware variant download attempt"; flow:to_server,established; file_data; content:"<?XML version="; depth:15; content:"<scriptlet"; within:20; content:"JScript"; within:150; content:"is_ps_installed()"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,virustotal.com/gui/file/e27f417b96a33d8449f6cf00b8306160e2f1b845ca2c9666081166620651a3ae/analysis; classtype:trojan-activity; sid:52117; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Win.Downloader.PowMet powershell script download attempt"; flow:to_client,established; file_data; content:"ASCII.GetBytes(|22|72F006C0-AC7D-40D9-B4E5-E0F0DAF6FBEE|22|)"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,virustotal.com/gui/file/7004b6c1829a745002feb7fbb0aad1a4d32c640a6c257dc8d0c39ce7b63b58cc/analysis; classtype:trojan-activity; sid:52116; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Xml.Downloader.PowMet fileless malware variant download attempt"; flow:to_client,established; file_data; content:"<?XML version="; depth:15; content:"<scriptlet"; within:20; content:"JScript"; within:150; content:"is_ps_installed()"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,virustotal.com/gui/file/e27f417b96a33d8449f6cf00b8306160e2f1b845ca2c9666081166620651a3ae/analysis; classtype:trojan-activity; sid:52115; rev:1;)
# alert tcp any any -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner service negotiation attack attempt"; flow:to_client,established; content:"|3B E1 80 8E 04 61 1C FF 73 6F 56 AF 01 BF 72 83 C2 72 18 E8|"; fast_pattern:only; content:"|30 1E 17 0D 31 39 30 38 31 36 32 32 30 36 31 31 5A 17 0D 32 39 30 38 31 33 32 32 30 36 31 31 5A|"; metadata:policy max-detect-ips drop, policy security-ips drop; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:52081; rev:1;)
# alert tcp $EXTERNAL_NET 3389 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Microsoft Windows Remote Desktop client heap spray attempt"; flow:to_client,established; content:"ECHO|00|"; fast_pattern:only; detection_filter:track by_src, count 100, seconds 5; metadata:policy max-detect-ips drop, service rdp; reference:cve,2019-1333; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2019-1333; classtype:attempted-user; sid:51741; rev:1;)
# alert udp $HOME_NET any -> any 53 (msg:"INDICATOR-COMPROMISE Win.Trojan.NanoCore DNS request for known malware domain bsbs.duckdns.org"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|04|bsbs|07|duckdns|03|org|00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; reference:url,www.virustotal.com/gui/file/0aa364d25dfc4cd3bc53ab4d39f452b6f75785d1b5c19ef9c4a8d9a52df33113; classtype:trojan-activity; sid:51712; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Python reverse shell execution attempt"; flow:to_server,established; file_data; content:"python -c"; fast_pattern; content:"socket.socket"; within:100; content:".connect("; within:100; content:"os.system("; within:100; content:"/bin/"; within:100; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; classtype:attempted-user; sid:51374; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Python reverse shell execution attempt"; flow:to_client,established; file_data; content:"python -c"; fast_pattern; content:"socket.socket"; within:100; content:".connect("; within:100; content:"os.system("; within:100; content:"/bin/"; within:100; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; classtype:attempted-user; sid:51373; rev:1;)
# alert tcp $EXTERNAL_NET 6667 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Dana IRC stack buffer overflow attempt"; flow:to_client,established; isdataat:1000; content:!"|20|"; depth:1000; metadata:policy max-detect-ips drop, service irc; reference:cve,2008-2922; classtype:attempted-user; sid:51202; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE PhpSploit backdoor communication attempt"; flow:to_server,established; content:"JHM9JF9TRVJWRVI7a3NvcnQoJHMpOyR4PSIi"; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1100/; classtype:trojan-activity; sid:50955; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE PhpSploit backdoor communication attempt"; flow:to_server,established; content:"JHg9JF9QT1NUWy"; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1100/; classtype:trojan-activity; sid:50954; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE PhpSploit backdoor communication attempt"; flow:to_server,established; content:": ZWNobyAiP"; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1100/; classtype:trojan-activity; sid:50953; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE PhpSploit backdoor communication attempt"; flow:to_server,established; content:"=ZWNobyAiP"; http_client_body; content:!"="; distance:0; http_client_body; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1100/; classtype:trojan-activity; sid:50952; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE PhpSploit backdoor communication attempt"; flow:to_server,established; content:"phpSpl01t="; fast_pattern:only; http_client_body; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1100/; classtype:trojan-activity; sid:50951; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE PHP backdoor communication attempt"; flow:to_server,established; content:"eval(base64_decode("; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1100/; classtype:trojan-activity; sid:50950; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"INDICATOR-COMPROMISE PhpSploit backdoor installation attempt"; flow:established; file_data; content:"<?php @eval($_SERVER[|27|HTTP_"; content:"|27|])|3B| ?>"; within:100; metadata:policy max-detect-ips drop, policy security-ips drop; reference:url,attack.mitre.org/techniques/T1100/; classtype:trojan-activity; sid:50949; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE PhpSploit backdoor communication attempt"; flow:to_server,established; content:"Phpspl01T:"; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1100/; classtype:trojan-activity; sid:50948; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE PhpSploit backdoor communication attempt"; flow:to_server,established; content:"|0D 0A|Zz"; http_header; content:"|3A|"; within:1; distance:2; http_header; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1100/; classtype:trojan-activity; sid:50947; rev:1;)
alert tcp any any -> any any (msg:"INDICATOR-COMPROMISE undocumented SMB dialect request attempt"; flow:established; content:"|02|Cairo 0.xa"; fast_pattern:only; content:"|FF|SMB|72|"; depth:5; offset:4; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service netbios-ssn; reference:url,attack.mitre.org/techniques/T1046/; classtype:misc-attack; sid:50517; rev:1;)
alert tcp any 445 -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner SMB negotiation attack attempt"; flow:to_client,established; content:"|00 00 00 00 FD F3 01 80 84 D6 FB A3 01 35 CD 01 F0 00 00 10 00|"; fast_pattern:only; content:"|FF|SMB|72|"; depth:5; offset:4; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service netbios-ssn; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50468; rev:1;)
alert tcp any any -> any 445 (msg:"INDICATOR-COMPROMISE Mimikatz use via SMB attempt"; flow:to_server,established; content:"Windows|5C|Temp|5C|mimikatz"; fast_pattern:only; content:"|FF|SMB|A2|"; depth:5; offset:4; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service netbios-ssn; reference:url,attack.mitre.org/techniques/T1003/; classtype:misc-attack; sid:50467; rev:1;)
alert tcp any any -> any 445 (msg:"INDICATOR-COMPROMISE Responder poisoner SMB negotiation attack attempt"; flow:to_server,established; content:"|FF|SMB|2D|"; depth:5; offset:4; content:"|0F FF 00|"; within:3; distance:27; content:"|16 00 20 00 40 9D C1 57 01 00|"; within:10; distance:6; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service netbios-ssn; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50466; rev:1;)
alert tcp any 445 -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner SMB negotiation attack attempt"; flow:to_client,established; content:"|FF|SMB|73|"; depth:5; offset:4; content:"|CE 0E 00 00 00 0F|S|00|M|00|B|00|1|00|2|00 02 00 0A 00|S|00|M|00|B|00|1|00|2|00|"; distance:0; content:"W|00|i|00|n|00|d|00|o|00|w|00|s|00| |00|S|00|e|00|r|00|v|00|e|00|r|00| |00|2|00|0|00|0|00|3|00| |00|3|00|7|00|9|00|0|00|"; distance:0; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service netbios-ssn; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50465; rev:1;)
# alert tcp any any -> any 445 (msg:"INDICATOR-COMPROMISE Responder poisoner NetServer enumeration attempt"; flow:to_server,established; content:"B16BBDz|00 01 00 FF FF 00 00 00 80|"; content:"|00|ABCD|00|"; within:200; isdataat:!0,relative; metadata:policy max-detect-ips drop, policy security-ips drop, service netbios-ssn; reference:url,attack.mitre.org/techniques/T1046/; classtype:misc-attack; sid:50464; rev:1;)
alert tcp any any -> any 445 (msg:"INDICATOR-COMPROMISE Mimikatz use via SMB attempt"; flow:to_server,established; content:"k|00|u|00|h|00|l|00|_|00|m|00|_|00|l|00|s|00|a|00|d|00|u|00|m|00|p|00|_|00|g|00|e|00|t|00|H|00|a|00|s|00|h|00|"; fast_pattern:only; content:"|FF|SMB|2F|"; depth:5; offset:4; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service netbios-ssn; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50463; rev:1;)
alert tcp any 445 -> any any (msg:"INDICATOR-COMPROMISE SMBRelay tool use attempt"; flow:to_client,established; content:"|EF EA 7F 5B E2 0A 4E 4D AD EE A6 5C 78 32 39 15|"; fast_pattern:only; content:"|FF|SMB|72|"; depth:5; offset:4; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service netbios-ssn; reference:url,wwww.virustotal.com/#/file/475c7e88a6d73e619ec585a7c9e6e57d2efc8298b688ebc10a3c703322f1a4a7; classtype:trojan-activity; sid:50391; rev:1;)
alert tcp any 110 -> any any (msg:"INDICATOR-COMPROMISE SMBRelay tool use attempt"; flow:to_client,established; content:"OK Microsoft Exchange Server 2003 POP3 server version 6.5.7226.0 (SmbRelay) ready"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service pop3; reference:url,wwww.virustotal.com/#/file/3eb3f90f8c8deace0b58f2951b5e6f1c2aa8735aa281424d03c4368d492f63ef; classtype:trojan-activity; sid:50390; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Peppa Pig botnet outbound scan attempt"; flow:to_server,established; content:".php"; http_uri; content:"User-Agent|3A 20|Mozilla|2F|"; nocase; http_header; content:"die("; fast_pattern:only; http_client_body; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,bitninja.io/blog/2018/08/03/new-botnet-has-been-discovered-hello-peppa; classtype:misc-activity; sid:50202; rev:1;)
alert tcp any 445 -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner SMB attack attempt"; flow:to_client,established; content:"W|00|I|00|N|00|-|00|P|00|R|00|H|00|4|00|9|00|2|00|R|00|Q|00|A|00|F|00|V|00|.|00|S|00|M|00|B|00|3|00|.|00|l|00|o|00|c|00|a|00|l|00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service netbios-ssn; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50106; rev:1;)
alert tcp any 445 -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner SMB negotiation attack attempt"; flow:to_client,established; content:"|EE 85 AB F7 EA F6 0C 4F 92 81 92 47 6D EB 76 A9|"; fast_pattern:only; content:"|27 FB EA D7 50 09 D2 01|"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service netbios-ssn; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50105; rev:1;)
alert tcp any 445 -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner SMB negotiation attack attempt"; flow:to_client,established; content:"|C8 27 3D FB D4 18 55 4F B2 40 AF D7 61 73 75 3B|"; fast_pattern:only; content:"|84 D6 FB A3 01 35 CD 01|"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service netbios-ssn; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50104; rev:1;)
alert tcp any 445 -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner SMB negotiation attack attempt"; flow:to_client,established; content:"|84 D6 FB A3 01 35 CD 01|"; fast_pattern:only; content:"S|00|M|00|B|00|-|00|T|00|O|00|O|00|L|00|K|00|I|00|T"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service netbios-ssn; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50103; rev:1;)
alert tcp any 389 -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner LDAP attack attempt"; flow:to_client,established; content:"s|00|e|00|r|00|v|00|e|00|r|00|2|00|0|00|0|00|8|00|.|00|s|00|m|00|b|00|1|00|2|00|.|00|l|00|o|00|c|00|a|00|l|00|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ldap; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50102; rev:1;)
alert tcp any [1433,1434] -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner MSSQL attack attempt"; flow:to_client,established; content:"s|00|e|00|r|00|v|00|e|00|r|00|2|00|0|00|0|00|3|00|.|00|s|00|m|00|b|00|.|00|l|00|o|00|c|00|a|00|l|00|"; fast_pattern:only; content:"S|00|M|00|B|00|-|00|T|00|O|00|O|00|L|00|K|00|I|00|T"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50101; rev:1;)
alert tcp any [25,587] -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner SMTP attack attempt"; flow:to_client,established; content:"220 smtp01.local ESMTP|0D 0A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50100; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner HTTP attack attempt"; flow:to_client,established; content:"Date: Wed, 12 Sep 2012 13:06:55 GMT|0D 0A|"; fast_pattern:only; http_header; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50099; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner HTTP attack attempt"; flow:to_client,established; file_data; content:"Welcome To Spider Shell!"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,attack.mitre.org/techniques/T1192/; classtype:misc-attack; sid:50098; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner HTTP attack attempt"; flow:to_client,established; content:"Last-Modified: Wed, 24 Nov 2010 00:39:06 GMT|0D 0A|"; fast_pattern:only; http_header; content:"Date: Thu, 24 Oct 2013 22:35:46 GMT"; http_header; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1192/; classtype:misc-attack; sid:50097; rev:2;)
alert tcp any $FILE_DATA_PORTS -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner toolkit download attempt"; flow:to_client,established; file_data; content:"Responder.py"; fast_pattern:only; content:"Responder.conf"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,attack.mitre.org/techniques/T1017/; classtype:misc-attack; sid:50096; rev:1;)
alert tcp any 443 -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner self-signed certificate attempt"; flow:to_client,established; ssl_state:server_hello; content:"|30 82 01 BB A0 03 02 01 02 02 09 00 E4 22 8D EC 68 EF B1 78|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ssl; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50095; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner HTTP attack attempt"; flow:to_client,established; file_data; content:"<img src=|27|file://RespProxySrv/pictures/logo.jpg|27|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50094; rev:1;)
alert tcp any $HTTP_PORTS -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner HTTP attack attempt"; flow:to_client,established; content:"X-Powered-By: ASP.NC0CD7B7802C76736E9B26FB19BEB2D36290B9FF9A46EDDA5ET|0D 0A|"; fast_pattern:only; http_header; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:50093; rev:1;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Script execution from TOR attempt"; flow:to_client,established; file_data; content:"wget"; content:"--no-check-certificate"; within:50; content:"-qU-"; within:60; distance:-40; content:"curl -fsSLkA-"; pcre:"/.+\.(tor2web\.(io|fyi|me)|onion\.(nz|pet|sh|si|to|ws|in\.net))/R"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/#/file/e6d1b5e5f6e1536fe619bec30caa1ac75aa008a05f5ecdb31960a1eb8c53731a; classtype:attempted-admin; sid:49671; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE php web shell upload attempt"; flow:to_server,established; content:"php $action = $_GET[|27|"; http_uri; content:"|27|]|3B|system($action)|3B|"; within:40; fast_pattern; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, service http; classtype:web-application-attack; sid:49657; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE AutoBase Studio project remote code execution attempt"; flow:to_client,established; file_data; content:"Programm,BEGIN,"; content:".exe"; distance:0; content:"Programm,END,"; distance:0; metadata:service ftp-data, service http, service imap, service pop3; reference:url,www.autobase.biz; classtype:attempted-user; sid:49556; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE AutoBase Studio project remote code execution attempt"; flow:to_server,established; file_data; content:"Programm,BEGIN,"; content:".exe"; distance:0; content:"Programm,END,"; distance:0; metadata:service smtp; reference:url,www.autobase.biz; classtype:attempted-user; sid:49555; rev:1;)
alert tcp any $FILE_DATA_PORTS -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner download attempt"; flow:to_client,established; file_data; content:"#|21|/usr/bin/env python|0A|# This file is part of Responder"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:49532; rev:1;)
alert tcp any any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Responder poisoner download attempt"; flow:to_server,established; file_data; content:"#|21|/usr/bin/env python|0A|# This file is part of Responder"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:49531; rev:1;)
alert tcp any any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Responder poisoner download attempt"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"poisoners.NBTNS"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:49530; rev:1;)
alert tcp any $FILE_DATA_PORTS -> any any (msg:"INDICATOR-COMPROMISE Responder poisoner download attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"poisoners.NBTNS"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,attack.mitre.org/techniques/T1187/; classtype:misc-attack; sid:49529; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"INDICATOR-COMPROMISE Windows SMBv2 information disclosure attempt"; flow:to_server,established; content:"|FE|SMB"; depth:8; offset:4; content:"|01 06|"; within:2; distance:62; metadata:policy max-detect-ips drop, service netbios-ssn; reference:cve,2019-0703; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2019-0703; classtype:attempted-recon; sid:49367; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 445 (msg:"INDICATOR-COMPROMISE Windows SMBv1 information disclosure attempt"; flow:to_server,established; content:"|FF|SMB2|00 00 00 00|"; depth:9; offset:4; content:"|07 00|"; within:2; distance:52; content:"|EE 03|"; distance:2; metadata:policy max-detect-ips drop, service netbios-ssn; reference:cve,2019-0703; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2019-0703; classtype:attempted-recon; sid:49366; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE avi file without matching file magic"; flow:to_server,established; content:"Content-Type: video/x-msvideo"; file_data; content:!"RIFF"; depth:4; content:!"AVI|20|"; depth:4; offset:7; metadata:policy max-detect-ips drop, service smtp; classtype:misc-activity; sid:49288; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE avi file without matching file magic"; flow:to_client,established; content:"Content-Type: video/x-msvideo"; http_header; file_data; content:!"RIFF"; depth:4; content:!"AVI|20|"; depth:4; offset:7; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:49287; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"INDICATOR-COMPROMISE PEAR Archive_Tar PHP object injection attempt"; flow:to_client,established; content:"class Archive_Tar"; fast_pattern; content:"$_temp_tarname"; distance:1; content:"new Phar"; content:"new Archive_Tar"; content:"->"; content:"_temp_tarname"; within:14; metadata:policy max-detect-ips drop, service http; reference:cve,2018-1000888; reference:url,www.exploit-db.com/exploits/46108; classtype:web-application-attack; sid:49185; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"INDICATOR-COMPROMISE PEAR Archive_Tar PHP object injection attempt"; flow:to_client,established; file_data; content:"require"; content:"'Archive/Tar.php'"; within:25; distance:1; content:"new Archive_Tar"; fast_pattern:only; content:"extract()"; metadata:policy max-detect-ips drop, service http; reference:cve,2018-1000888; reference:url,www.exploit-db.com/exploits/46108; classtype:web-application-attack; sid:49184; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Microsoft Windows NtTraceControl function use"; flow:to_server,established; file_data; flowbits:isset,file.exe; content:"NtTraceControl"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:misc-activity; sid:49164; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Microsoft Windows NtTraceControl function use"; flow:to_client,established; file_data; flowbits:isset,file.exe; content:"NtTraceControl"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:49163; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET !3389 (msg:"INDICATOR-COMPROMISE Microsoft Windows Terminal server RDP over non-standard port attempt"; flow:to_server,established; content:"|03 00 00|"; depth:3; content:"|E0 00 00 00 00 00|"; depth:6; offset:5; content:"Cookie: mstshash="; within:17; fast_pattern; reference:url,fireeye.com/blog/threat-research/2019/01/bypassing-network-restrictions-through-rdp-tunneling.html; classtype:attempted-user; sid:49040; rev:5;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .oz dns TXT query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|02|oz|00 00 10 00 01|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48836; rev:1;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .oz dns AAAA query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|02|oz|00 00 1C 00 01|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48835; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .oz tcp dns TXT query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|02|oz|00 00 10 00 01|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48834; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .oz tcp dns AAAA query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|02|oz|00 00 1C 00 01|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48833; rev:1;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .o dns TXT query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|01|o|00 00 10 00 01|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48832; rev:1;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .o dns AAAA query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|01|o|00 00 1C 00 01|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48831; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .o tcp dns TXT query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|01|o|00 00 10 00 01|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48830; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .o tcp dns AAAA query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|01|o|00 00 1C 00 01|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48829; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .glue tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|04|glue|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48714; rev:2;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .glue dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|04|glue|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48713; rev:2;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .fur dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|03|fur|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48688; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .fur tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|03|fur|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48687; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .lib dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|03|lib|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48686; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .lib tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|03|lib|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48685; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .emc dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|03|emc|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48684; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .emc tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|03|emc|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48683; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .coin dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|04|coin|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48682; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .coin tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|04|coin|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48681; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .bazar dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|05|bazar|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48680; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .bazar tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|05|bazar|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48679; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .free dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|04|free|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48678; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .free tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|04|free|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48677; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .pirate dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|06|pirate|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48676; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .pirate tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|06|pirate|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48675; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .parody dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|06|parody|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48674; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .parody tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|06|parody|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48673; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .oz dns A query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|02|oz|00 00 01 00 01|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48672; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .oz tcp dns A query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|02|oz|00 00 01 00 01|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48671; rev:4;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .oss dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|03|oss|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48670; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .oss tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|03|oss|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48669; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .o dns A query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|01|o|00 00 01 00 01|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48668; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .o tcp dns A query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|01|o|00 00 01 00 01|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48667; rev:4;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .null dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|04|null|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48666; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .null tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|04|null|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48665; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .neo dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|03|neo|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48664; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .neo tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|03|neo|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48663; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .libre dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|05|libre|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48662; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .libre tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|05|libre|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48661; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .indy dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|04|indy|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48660; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .indy tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|04|indy|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48659; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .gopher dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|06|gopher|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48658; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .gopher tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|06|gopher|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48657; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .geek dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|04|geek|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48656; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .geek tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|04|geek|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48655; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .dyn dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|03|dyn|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48654; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .dyn tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|03|dyn|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48653; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .cyb dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|03|cyb|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48652; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .cyb tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|03|cyb|00|"; offset:13; fast_pattern; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48651; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .chan dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|04|chan|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48650; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .chan tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|04|chan|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48649; rev:3;)
# alert udp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .bbs dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|03|bbs|00|"; offset:11; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48648; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"INDICATOR-COMPROMISE suspicious .bbs tcp dns query"; flow:to_server,established; byte_test:1,!&,0xF8,4; content:"|03|bbs|00|"; offset:13; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:48647; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE malicious jquery.js load attempt"; flow:to_server,established; content:"/jquery.js"; http_uri; content:"Host|3A|"; http_header; content:"wp.org"; within:6; distance:7; http_header; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,labs.sucuri.net/?note=2018-10-30; classtype:attempted-user; sid:48575; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE malicious jquery.js load attempt"; flow:to_client,established; file_data; content:"script"; content:"src"; within:75; content:"wp.org/jquery.js"; within:100; fast_pattern; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:url,labs.sucuri.net/?note=2018-10-30; classtype:attempted-user; sid:48574; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Request for external IP address/location detected"; flow:to_server,established; content:"Host: ip138.com"; fast_pattern:only; http_header; content:"/ic.asp"; http_uri; content:!"User-Agent|3A|"; http_header; metadata:policy max-detect-ips drop, service http; classtype:trojan-activity; sid:48439; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE SettingContent-ms file type download attempt"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"/Type"; content:"/Filespec"; within:75; content:"/F"; within:75; content:"SettingContent-ms"; within:150; nocase; pcre:"/\x2fF[^>]+?SettingContent-ms/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-8414; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8414; classtype:attempted-user; sid:47654; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE SettingContent-ms file type download attempt"; flow:to_server,established; file_data; content:"|21 4A 6B B9 B2 3D 76 D5 D8 79 DB 08 48 65 41 1F 9E 25 13 4E CB C2 A4 F5 95 ED 54 66 B8 22 75 FE|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-8414; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8414; classtype:attempted-user; sid:47653; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE SettingContent-ms file type download attempt"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Type"; content:"/Filespec"; within:75; content:"/F"; within:75; content:"SettingContent-ms"; within:150; nocase; pcre:"/\x2fF[^>]+?SettingContent-ms/i"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-8414; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8414; classtype:attempted-user; sid:47652; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE SettingContent-ms file type download attempt"; flow:to_client,established; file_data; content:"|21 4A 6B B9 B2 3D 76 D5 D8 79 DB 08 48 65 41 1F 9E 25 13 4E CB C2 A4 F5 95 ED 54 66 B8 22 75 FE|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-8414; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8414; classtype:attempted-user; sid:47651; rev:1;)
# alert ip $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Microsoft powershell.exe outbound shell attempt"; content:"Windows PowerShell"; depth:18; metadata:policy max-detect-ips drop; reference:url,attack.mitre.org/techniques/T1086; reference:url,attack.mitre.org/wiki/Technique/T1059; classtype:attempted-user; sid:47400; rev:2;)
# alert ip $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Microsoft cmd.exe outbound shell attempt"; content:"Microsoft Windows XP [Version"; depth:29; metadata:policy max-detect-ips drop; reference:url,attack.mitre.org/wiki/Technique/T1059; classtype:attempted-user; sid:47399; rev:1;)
# alert ip $HOME_NET any -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Microsoft cmd.exe outbound shell attempt"; content:"Microsoft Windows [Version"; depth:26; metadata:policy max-detect-ips drop; reference:url,attack.mitre.org/wiki/Technique/T1059; classtype:attempted-user; sid:47398; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 4840 (msg:"INDICATOR-COMPROMISE Atvise SCADA privilege escalation attempt"; flow:to_server,established; content:"|01 00 C8 02|"; content:"SYSTEM"; distance:0; content:"AGENT.OPCUA.METHODS.setUserPassword"; distance:0; metadata:policy max-detect-ips drop; reference:url,atvise.com/en/products-solutions/atvise-scada; classtype:attempted-admin; sid:47044; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 4840 (msg:"INDICATOR-COMPROMISE Atvise SCADA user enumeration attempt"; flow:to_server,established; content:"|01 00 0F 02|"; content:"SYSTEM.SECURITY.USERS"; distance:0; metadata:policy max-detect-ips drop; reference:url,atvise.com/en/products-solutions/atvise-scada; classtype:attempted-recon; sid:47043; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Request for external IP address detected"; flow:to_server,established; content:"Host: ipecho.net"; fast_pattern:only; http_header; content:"/plain"; http_uri; content:!"User-Agent|3A|"; http_header; metadata:policy max-detect-ips drop, service http; reference:url,www.virustotal.com/#/file/a036279e3c27f0e716b8fa4b5c7378805b9788c7ce3f4eada9367a4f0738967f/detection; classtype:policy-violation; sid:47024; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE SettingContent-ms file type download attempt"; flow:to_client,established; file_data; content:"<DeepLink>"; nocase; content:"</ApplicationInformation"; distance:0; nocase; content:"</PCSettings>"; distance:0; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-8414; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8414; classtype:attempted-user; sid:47002; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE SettingContent-ms file type download attempt"; flow:to_server,established; file_data; content:"<DeepLink>"; nocase; content:"</ApplicationInformation"; distance:0; nocase; content:"</PCSettings>"; distance:0; nocase; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service imap, service pop3, service smtp; reference:cve,2018-8414; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8414; classtype:attempted-user; sid:47001; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE SettingContent-ms file type download attempt"; flow:to_client,established; flowbits:isset,file.rtf; file_data; content:"|5C|objdata"; content:"3c504353657474696e67733e"; distance:0; content:"3c4170706c69636174696f6e496e666f726d6174696f6e3e"; distance:0; content:"3c446565704c696e6b3e"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-8414; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8414; classtype:attempted-user; sid:47000; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE SettingContent-ms file type download attempt"; flow:to_server,established; flowbits:isset,file.rtf; file_data; content:"|5C|objdata"; content:"3c504353657474696e67733e"; distance:0; content:"3c4170706c69636174696f6e496e666f726d6174696f6e3e"; distance:0; content:"3c446565704c696e6b3e"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-8414; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2018-8414; classtype:attempted-user; sid:46999; rev:4;)
# alert tcp $HOME_NET !21:23 -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Microsoft cmd.exe banner"; flow:established; content:"Microsoft Windows"; depth:18; content:"Microsoft Corp"; within:250; metadata:policy max-detect-ips drop, ruleset community; reference:nessus,11633; classtype:successful-admin; sid:46983; rev:1;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Microsoft Office Discovery User-Agent to a potential URL shortener service"; flow:to_server,established; urilen:<10; content:"Host: "; http_header; content:"|0D 0A|"; within:14; http_header; content:"HEAD"; http_method; content:"User-Agent: Microsoft Office "; http_header; content:"Discovery|0D 0A|"; within:25; http_header; content:!"Accept"; http_header; content:!"Content-"; http_header; content:!"Referer|3A|"; http_header; content:!"Cookie|3A|"; http_header; metadata:policy max-detect-ips drop, ruleset community, service http; reference:url,virustotal.com/en/file/d615a205d92898896b0f553a027ffd9b7b7cde0c29ebe0b1f9364e1cf2831236/analysis/; classtype:misc-activity; sid:46980; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Microsoft Office Discovery User-Agent to a potential URL shortener service"; flow:to_server,established; urilen:<10; content:"Host: "; http_header; content:"|0D 0A|"; within:14; http_header; content:"OPTIONS"; http_method; content:"User-Agent: Microsoft Office "; http_header; content:"Discovery|0D 0A|"; within:25; http_header; content:!"Accept"; http_header; content:!"Referer|3A|"; http_header; content:!"Cookie|3A|"; http_header; metadata:policy max-detect-ips drop, ruleset community, service http; reference:url,virustotal.com/en/file/d615a205d92898896b0f553a027ffd9b7b7cde0c29ebe0b1f9364e1cf2831236/analysis/; classtype:misc-activity; sid:46979; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE dynamic Excel web query file download attempt"; flow:to_client,established; file_data; content:"WEB|0D 0A|1"; depth:6; content:"http"; within:25; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,virustotal.com/en/file/a0b80b57879ef437709bae7e2896efb7be9bd57291e64bc58d7cd13bd1de9f27/analysis; classtype:attempted-admin; sid:46932; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE dynamic Excel web query file download attempt"; flow:to_server,established; file_data; content:"WEB|0D 0A|1"; depth:6; content:"http"; within:25; nocase; metadata:policy max-detect-ips drop, service smtp; reference:url,virustotal.com/en/file/a0b80b57879ef437709bae7e2896efb7be9bd57291e64bc58d7cd13bd1de9f27/analysis; classtype:attempted-admin; sid:46931; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Microsoft Windows Interrupt Service Routine stack rollback attempt"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|8B 14 24|"; content:"|8D|"; within:15; content:"|24 08|"; within:2; distance:1; content:"|89|"; within:15; content:"|89|"; within:15; content:"|8B|"; within:15; content:"|48 CF|"; within:2; distance:1; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-8897; classtype:attempted-user; sid:46910; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Microsoft Windows Interrupt Service Routine stack rollback attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|8B 14 24|"; content:"|8D|"; within:15; content:"|24 08|"; within:2; distance:1; content:"|89|"; within:15; content:"|89|"; within:15; content:"|8B|"; within:15; content:"|48 CF|"; within:2; distance:1; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-8897; classtype:attempted-user; sid:46909; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Microsoft Windows processor modification return to user-mode attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|0F 22|"; content:"|FB|"; within:30; content:"|0F 22|"; within:30; content:"|48 CF|"; within:30; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-8897; classtype:attempted-user; sid:46908; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Microsoft Windows processor modification return to user-mode attempt"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|0F 22|"; content:"|FB|"; within:30; content:"|0F 22|"; within:30; content:"|48 CF|"; within:30; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-8897; classtype:attempted-user; sid:46907; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Microsoft Windows malicious CONTEXT structure creation attempt"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|A0 01|"; content:"|05 00 BF 00|"; within:50; content:"|10 00 10 00|"; within:50; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-8897; classtype:attempted-user; sid:46906; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Microsoft Windows malicious CONTEXT structure creation attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|A0 01|"; content:"|05 00 BF 00|"; within:50; content:"|10 00 10 00|"; within:50; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-8897; classtype:attempted-user; sid:46905; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Microsoft Windows SYSTEM token stealing attempt"; flow:to_server,established; flowbits:isset,file.exe; file_data; content:"|FF 15|"; content:"|FF 15|"; within:50; content:"|FF 15|"; within:50; content:"|83|"; within:50; content:"|08|"; within:2; distance:1; content:"|81|"; within:30; content:"|83 E0 F0|"; within:100; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-8897; classtype:attempted-user; sid:46904; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Microsoft Windows SYSTEM token stealing attempt"; flow:to_client,established; flowbits:isset,file.exe; file_data; content:"|FF 15|"; content:"|FF 15|"; within:50; content:"|FF 15|"; within:50; content:"|83|"; within:50; content:"|08|"; within:2; distance:1; content:"|81|"; within:30; content:"|83 E0 F0|"; within:100; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-8897; classtype:attempted-user; sid:46903; rev:2;)
# alert udp $EXTERNAL_NET 53 -> $HOME_NET 53 (msg:"INDICATOR-COMPROMISE Possible Samba internal DNS forged response"; flow:to_server; content:"|81 20 00 01 00 00 00 00 00 00|"; depth:10; offset:2; metadata:policy max-detect-ips drop; reference:cve,2014-0239; classtype:denial-of-service; sid:46848; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Request for external IP address detected"; flow:to_server,established; content:"Host: ifconfig.co"; fast_pattern:only; http_header; content:"/ip"; http_uri; content:!"User-Agent|3A|"; http_header; metadata:policy max-detect-ips drop, service http; classtype:trojan-activity; sid:46679; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Outbound freegeoip.net geo-IP location connection attempt"; flow:to_server,established; content:"/xml/"; http_uri; content:"Host|3A| freegeoip.net"; fast_pattern:only; http_header; content:!"Referer|3A|"; http_header; metadata:impact_flag red, policy max-detect-ips drop, service http; reference:url,www.virustotal.com/file-scan/report.html?id=5d6691a4345258ce7de5002c322be83a3c0c94cffdfd1309ccc0bf593616f31e; classtype:trojan-activity; sid:46664; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Outbound telize.com geo-IP location connection attempt"; flow:to_server,established; content:"/geoip"; http_uri; content:"Host|3A| www.telize.com"; fast_pattern:only; http_header; content:!"Referer|3A|"; http_header; metadata:impact_flag red, policy max-detect-ips drop, service http; reference:url,www.virustotal.com/file-scan/report.html?id=5d6691a4345258ce7de5002c322be83a3c0c94cffdfd1309ccc0bf593616f31e; classtype:trojan-activity; sid:46663; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Win.Worm.Brontok outbound HTTP request attempt"; flow:to_server,established; content:"WS1/cgi/x.cgi"; fast_pattern:only; http_uri; content:"NAVG="; http_uri; content:"username=dudxwd"; http_uri; metadata:impact_flag red, policy max-detect-ips drop, service http; reference:url,www.virustotal.com/en/file/9b504da9e77ec067b0577b557443f76e84717cb00455ce39138eeaf344f3d2e3/analysis/; classtype:trojan-activity; sid:46641; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Win.Worm.Brontok outbound HTTP request attempt"; flow:to_server,established; content:"/Arts/"; http_uri; content:"inf22.css"; within:50; http_uri; metadata:impact_flag red, policy max-detect-ips drop, service http; reference:url,www.virustotal.com/en/file/9b504da9e77ec067b0577b557443f76e84717cb00455ce39138eeaf344f3d2e3/analysis/; classtype:trojan-activity; sid:46640; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Potential data exfiltration through Google form submission"; flow:to_server,established; content:"/forms/d/e/"; depth:11; nocase; http_uri; content:"/viewform?entry."; fast_pattern; nocase; http_uri; content:"="; within:15; http_uri; content:"entry."; within:50; nocase; http_uri; content:"="; within:15; http_uri; content:"Host|3A| docs.google.com|0D 0A|"; nocase; http_header; pcre:"/entry\.\d+=\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b/Ui"; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1020; classtype:misc-activity; sid:46381; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE PHP shell_exec command execution attempt"; flow:to_server,established; content:"php"; nocase; http_client_body; content:"shell_exec"; within:150; nocase; http_client_body; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:45916; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE PHP obfuscated eval command execution attempt"; flow:to_server,established; content:"php"; nocase; http_client_body; content:"eval"; within:100; nocase; http_client_body; content:"base64_decode"; within:100; nocase; http_client_body; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1027; reference:url,attack.mitre.org/techniques/T1140; classtype:web-application-attack; sid:45915; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE PHP phpinfo command execution attempt"; flow:to_server,established; content:"php"; nocase; http_client_body; content:"phpinfo"; within:150; nocase; http_client_body; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:45914; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Adobe Flash potential exploit download attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|00 00 00 45 78 70 6C 6F 69 74 00 40 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:attempted-user; sid:45742; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Adobe Flash potential exploit download attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|00 00 00 70 6F 63 00 40 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:attempted-user; sid:45741; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Adobe Flash potential exploit download attempt"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|00 00 00 45 78 70 6C 6F 69 74 00 40 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:attempted-user; sid:45740; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Adobe Flash potential exploit download attempt"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|00 00 00 70 6F 63 00 40 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:attempted-user; sid:45739; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Microsoft Word internal object auto update attempt"; flow:to_server,established; file_data; flowbits:isset,file.doc|file.rtf; content:"|5C|objautlink"; content:"|5C|objupdate"; within:200; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-0199; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2017-0199; classtype:attempted-user; sid:45520; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Microsoft Word internal object auto update attempt"; flow:to_client,established; file_data; flowbits:isset,file.doc|file.rtf; content:"|5C|objautlink"; content:"|5C|objupdate"; within:200; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-0199; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2017-0199; classtype:attempted-user; sid:45519; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Microsoft MsMpEng shrink compressed zip code execution attempt"; flow:to_server,established; file_data; content:"PK|03 04|"; content:"|01 00|"; within:2; distance:4; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-11937; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2017-11937; classtype:attempted-admin; sid:45153; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Microsoft MsMpEng shrink compressed zip code execution attempt"; flow:to_client,established; file_data; content:"PK|03 04|"; content:"|01 00|"; within:2; distance:4; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-11937; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2017-11937; classtype:attempted-admin; sid:45152; rev:2;)
alert tcp any $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Metasploit run hidden powershell attempt"; flow:to_client,established; file_data; content:"|5C|v1.0|5C|powershell.exe"; content:"New-Object System.Diagnostics.ProcessStartInfo"; fast_pattern:only; content:".FileName="; content:".Arguments="; content:".UseShellExecute="; content:".RedirectStandardOutput="; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1086; classtype:attempted-user; sid:45137; rev:3;)
alert tcp any $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Metasploit PowerShell CLI Download and Run attempt"; flow:to_client,established; file_data; content:"<?XML"; depth:5; content:"powershell.exe"; content:"new-object Net.WebClient|29|.DownloadString"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,attack.mitre.org/techniques/T1086; classtype:attempted-user; sid:45136; rev:3;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Malicious VBA script detected"; flow:to_client,established; content:"<script"; nocase; content:"VBScript"; within:50; nocase; content:"StrReverse"; nocase; content:"Chr"; within:20; nocase; content:"StrReverse"; within:30; nocase; content:"Chr"; within:20; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; classtype:attempted-admin; sid:44875; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Microsoft Internet Explorer OLE auto-open attempt"; flow:to_server,established; file_data; content:"ms-word:ofe|7C|u|7C|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; classtype:misc-activity; sid:44865; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Microsoft Internet Explorer OLE auto-open attempt"; flow:to_client,established; file_data; content:"ms-word:ofe|7C|u|7C|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:misc-activity; sid:44864; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Apache HTTP Server possible mod_dav.c remote denial of service vulnerability attempt"; flow:to_server,established; content:":merge"; fast_pattern:only; content:"MERGE"; http_method; content:"DAV:"; content:":href"; within:100; metadata:policy max-detect-ips drop, service http; reference:bugtraq,100872; reference:cve,2013-1896; classtype:attempted-dos; sid:44808; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Meterpreter payload download attempt"; flow:to_client,established; content:"packet_call_completion_handlers"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop; classtype:trojan-activity; sid:44728; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE VBscript downloader detected"; flow:to_server,established; file_data; content:"SLShare"; fast_pattern:only; content:"CreateObject("; nocase; content:"split"; nocase; content:"replace"; within:10; nocase; content:"shell"; nocase; metadata:policy max-detect-ips drop, service smtp; reference:url,virustotal.com/#/file/83a7891731aacbe25bb5f5e2ba0c8dabed379be8c6fbc25db78c0d771a20a432/detection; classtype:trojan-activity; sid:44613; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE VBscript downloader detected"; flow:to_client,established; file_data; content:"SLShare"; fast_pattern:only; content:"CreateObject("; nocase; content:"split"; nocase; content:"replace"; within:10; nocase; content:"shell"; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,virustotal.com/#/file/83a7891731aacbe25bb5f5e2ba0c8dabed379be8c6fbc25db78c0d771a20a432/detection; classtype:trojan-activity; sid:44612; rev:1;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE png file attachment without matching file magic"; flow:established,to_client; content:"Content-Type: image/png"; http_header; content:!"|0D 0A 89|PNG"; metadata:policy max-detect-ips drop, service http; classtype:misc-activity; sid:44416; rev:3;)
# alert udp $HOME_NET any -> any 53 (msg:"INDICATOR-COMPROMISE Suspicious .win dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|03|win|00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:44077; rev:2;)
# alert udp $HOME_NET any -> any 53 (msg:"INDICATOR-COMPROMISE Suspicious .trade dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|05|trade|00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:44076; rev:2;)
alert udp $HOME_NET any -> any 53 (msg:"INDICATOR-COMPROMISE DNS request for known malware sinkhole domain iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com - WannaCry"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|29|iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea|03|com|00|"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips alert, policy max-detect-ips alert, policy security-ips alert, service dns; reference:url,www.virustotal.com/en/domain/iuqerfsodp9ifjaposdfjhgosurijfaewrwergwea.com/information/; classtype:trojan-activity; sid:44037; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE VBScript accessing scripting API for WMI"; flow:to_client,established; file_data; content:"<script"; content:"vbscript"; within:25; content:"GetObject|28|"; content:"winmgmts|3A|"; within:15; fast_pattern; content:".InstancesOf"; within:15; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:attempted-user; sid:43933; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE backwards executable download"; flow:to_client,established; file_data; content:"edom SOD ni nur eb tonnac margorp sihT"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:attempted-user; sid:43839; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Adobe Flash file contains reference to kernel32.dll"; flow:to_client,established; file_data; content:"|0C|kernel32.dll"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:attempted-user; sid:43838; rev:1;)
# alert udp $HOME_NET any -> any 53 (msg:"INDICATOR-COMPROMISE Suspicious .top dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|03|top|00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; reference:url,en.wikipedia.org/wiki/.top; classtype:misc-activity; sid:43687; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE possible Samsung DVR authentication bypass attempt"; flow:to_server,established; content:"/cgi-bin/"; fast_pattern:only; http_uri; content:"DATA"; http_cookie; content:"="; within:1; distance:1; http_cookie; metadata:policy max-detect-ips drop, service http; reference:cve,2013-3585; reference:cve,2013-3586; classtype:attempted-admin; sid:43576; rev:2;)
# alert icmp $EXTERNAL_NET any -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Juniper vSRX Application Firewall IPv6 REJECT buffer overflow attempt"; dsize:>200; icode:1; itype:1; content:"|90 90 90 90|"; fast_pattern:only; metadata:policy max-detect-ips drop; classtype:attempted-admin; sid:43546; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Symantec Endpoint Protection potential binary planting RCE attempt"; flow:to_client,established; file_data; flowbits:isset, file.zip; content:"PK"; content:"UxTheme.dll"; within:30; distance:30; fast_pattern; content:"PK"; content:"packlist.xml"; within:30; distance:30; nocase; metadata:policy max-detect-ips drop, service http; reference:cve,2015-1492; reference:url,symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20150730_00; classtype:attempted-user; sid:43389; rev:2;)
# alert tcp $SMTP_SERVERS 25 -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Wing FTP Server potentially malicious admin user creation attempt"; flow:to_client,established; file_data; content:"form"; nocase; content:"action"; nocase; content:"/admin_addadmin.html"; within:100; fast_pattern; nocase; content:"method"; within:50; content:"post"; within:25; nocase; content:"domainlist"; nocase; content:"ipmasks"; nocase; content:"mydirectory"; nocase; metadata:policy max-detect-ips drop, service smtp; reference:url,www.wftpserver.com/serverhistory.htm; classtype:attempted-admin; sid:43385; rev:2;)
# alert tcp $HOME_NET $FILE_DATA_PORTS -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Wing FTP Server potentially malicious admin user creation attempt"; flow:to_client,established; file_data; content:"form"; nocase; content:"action"; nocase; content:"/admin_addadmin.html"; within:100; fast_pattern; nocase; content:"method"; within:50; content:"post"; within:25; nocase; content:"domainlist"; nocase; content:"ipmasks"; nocase; content:"mydirectory"; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,www.wftpserver.com/serverhistory.htm; classtype:attempted-admin; sid:43384; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 2001 (msg:"INDICATOR-COMPROMISE OptoMMP FTP Username read or write attempt"; content:"|FF FF F0 3D 00 00|"; depth:6; offset:6; metadata:policy max-detect-ips drop; reference:url,blog.exodusintel.com/2016/09/08/firmware-updates-made-easy/; classtype:attempted-admin; sid:43126; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 2001 (msg:"INDICATOR-COMPROMISE OptoMMP FTP Password read or write attempt"; content:"|FF FF F0 3D 00 40|"; depth:6; offset:6; metadata:policy max-detect-ips drop; reference:url,blog.exodusintel.com/2016/09/08/firmware-updates-made-easy/; classtype:attempted-admin; sid:43125; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 2001 (msg:"INDICATOR-COMPROMISE OptoMMP FTP Username read or write attempt"; flow:established, to_server; content:"|FF FF F0 3D 00 00|"; depth:6; offset:6; metadata:policy max-detect-ips drop; reference:url,blog.exodusintel.com/2016/09/08/firmware-updates-made-easy/; classtype:attempted-admin; sid:43124; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 2001 (msg:"INDICATOR-COMPROMISE OptoMMP FTP Password read or write attempt"; flow:established, to_server; content:"|FF FF F0 3D 00 40|"; depth:6; offset:6; metadata:policy max-detect-ips drop; reference:url,blog.exodusintel.com/2016/09/08/firmware-updates-made-easy/; classtype:attempted-admin; sid:43123; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE OLE attachment with embedded PICT attempt"; flow:to_server,established; file_data; content:"|D0 CF 11 E0 A1 B1 1A E1|"; content:"R|00|o|00|o|00|t|00| |00|E|00|n|00|t|00|r|00|y|00|"; distance:0; content:"TCIP"; distance:0; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-8487; classtype:misc-activity; sid:43092; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 1450 (msg:"INDICATOR-COMPROMISE SysAid mssql potentially malicious user permissions creation"; flow:established, to_server; content:"|00|I|00|N|00|S|00|E|00|R|00|T|00| |00|I|00|N|00|T|00|O|00| |00|i|00|l|00|i|00|e|00|n|00|t|00|.|00|d|00|b|00|o|00|.|00|s|00|y|00|s|00|a|00|i|00|d|00|_|00|u|00|s|00|e|00|r|00|_|00|p|00|e|00|r|00|m|00|i|00|s|00|s|00|i|00|o|00|n|00|s|00|"; fast_pattern:only; metadata:policy max-detect-ips drop; reference:cve,2015-3001; classtype:attempted-admin; sid:43075; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 1450 (msg:"INDICATOR-COMPROMISE SysAid mssql potentially malicious new user creation attempt"; flow:established, to_server; content:"|00|I|00|N|00|S|00|E|00|R|00|T|00| |00|I|00|N|00|T|00|O|00| |00|i|00|l|00|i|00|e|00|n|00|t|00|.|00|d|00|b|00|o|00|.|00|s|00|y|00|s|00|a|00|i|00|d|00|_|00|u|00|s|00|e|00|r|00|"; fast_pattern:only; metadata:policy max-detect-ips drop; reference:cve,2015-3001; classtype:attempted-admin; sid:43074; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Trend Micro Control Manager WFINFOR cookie authentication bypass attempt"; flow:established, to_server; content:"/modTMCM"; fast_pattern:only; http_uri; content:"WFINFOR"; http_cookie; metadata:policy max-detect-ips drop, service http; reference:url,docs.trendmicro.com/all/ent/tmcm/v6.0-sp3/en-us/tmcm_6.0-sp3_readme.html; classtype:attempted-user; sid:43065; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Microsoft Office with embedded EPS download attempt "; flow:to_server,established; flowbits:isset,file.docx; file_data; content:"PK|03 04|"; byte_extract:2,22,nameLen,relative,little; content:".eps"; within:nameLen; distance:2; fast_pattern; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-0262; classtype:attempted-admin; sid:42928; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Microsoft Office with embedded EPS download attempt "; flow:to_client,established; flowbits:isset,file.docx; file_data; content:"PK|03 04|"; byte_extract:2,22,nameLen,relative,little; content:".eps"; within:nameLen; distance:2; fast_pattern; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-0262; classtype:attempted-admin; sid:42927; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Adobe Reader PDF embedded null JPEG image"; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:"/Image"; content:"/FlateDecode"; within:100; content:"stream|0D 0A 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:200; fast_pattern:0,15; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-1088; reference:url,helpx.adobe.com/security/products/acrobat/apsb16-14.html; classtype:misc-activity; sid:42460; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Adobe Reader PDF embedded null JPEG image"; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:"/Image"; content:"/FlateDecode"; within:100; content:"stream|0D 0A 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:200; fast_pattern:0,15; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-1088; reference:url,helpx.adobe.com/security/products/acrobat/apsb16-14.html; classtype:misc-activity; sid:42459; rev:3;)
# alert tcp $EXTERNAL_NET 10051 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Zabbix Proxy configuration containing script detected"; flow:to_client,established; content:"ZBXD|01|"; depth:5; fast_pattern; content:"scripts"; content:"fields"; distance:0; content:"scriptid"; distance:0; content:"command"; distance:0; content:"description"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop; reference:cve,2017-2825; reference:url,talosintelligence.com/reports/TALOS-2017-0326; classtype:attempted-user; sid:42337; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE malicious javascript obfuscation detected"; flow:to_client,established; file_data; content:"tpircsbv"; content:"epyt"; within:20; content:"tpircs"; within:20; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,attack.mitre.org/techniques/T1027; reference:url,attack.mitre.org/techniques/T1140; classtype:attempted-user; sid:42292; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE RTF url moniker COM file download attempt"; flow:to_server,established; flowbits:isset,file.rtf; file_data; content:"0e0c9ea79f9bace118c8200aa004ba90b"; content:"68007400740070003a002f002f00"; within:50; metadata:policy max-detect-ips drop, service smtp; reference:cve,2017-0199; classtype:misc-activity; sid:42230; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE RTF url moniker COM file download attempt"; flow:to_client,established; flowbits:isset,file.rtf; file_data; content:"0e0c9ea79f9bace118c8200aa004ba90b"; content:"68007400740070003a002f002f00"; within:50; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-0199; classtype:misc-activity; sid:42229; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Request for external IP address detected"; flow:to_server,established; content:"Host: myexternalip.com"; fast_pattern:only; http_header; content:"/raw"; http_uri; content:!"User-Agent|3A|"; http_header; metadata:policy max-detect-ips drop, service http; reference:url,virustotal.com/en/file/9a8d73cb7069832b9523c55224ae4153ea529ecc50392fef59da5b5d1db1c740/analysis/; classtype:trojan-activity; sid:42082; rev:2;)
# alert tcp $HOME_NET 80 -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE clorius controls information gathering attempt"; flow:to_client, established; content:"Server|3A| ISC SCADA Service HTTPserv|3A|00001"; fast_pattern:only; http_header; file_data; content:"Firmware Version"; nocase; content:"Script Version"; distance:0; nocase; content:"IP-adresse"; distance:0; nocase; content:"AI"; distance:0; nocase; content:"AO"; distance:0; nocase; content:"DI"; distance:0; nocase; content:"DO"; distance:0; nocase; content:"MAC-adresse"; distance:0; nocase; metadata:policy max-detect-ips drop, service http; reference:url,ics-cert.us-cert.gov/alerts/ICS-ALERT-13-091-02; classtype:attempted-recon; sid:41784; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 80 (msg:"INDICATOR-COMPROMISE d-link sharecenter dns-320 denial of service attempt"; flow:to_server,established; content:"/cgi-bin/system_mgr.cgi"; fast_pattern:only; nocase; http_uri; content:"cmd=cgi_restart"; nocase; http_client_body; metadata:policy max-detect-ips drop, service http; reference:url,sharecenter.dlink.com/products/DNS-320; classtype:web-application-attack; sid:41758; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 80 (msg:"INDICATOR-COMPROMISE d-link sharecenter dns-320 denial of service attempt"; flow:to_server,established; content:"/cgi-bin/system_mgr.cgi"; fast_pattern:only; nocase; http_uri; content:"cmd=cgi_shutdown"; nocase; http_client_body; metadata:policy max-detect-ips drop, service http; reference:url,sharecenter.dlink.com/products/DNS-320; classtype:web-application-attack; sid:41757; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 80 (msg:"INDICATOR-COMPROMISE d-link sharecenter dns-320 denial of service attempt"; flow:to_server,established; content:"/cgi-bin/wizard_mgr.cgi"; fast_pattern:only; nocase; http_uri; content:"cmd=cgi_wizard"; nocase; http_client_body; metadata:policy max-detect-ips drop, service http; reference:url,sharecenter.dlink.com/products/DNS-320; classtype:web-application-attack; sid:41756; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 80 (msg:"INDICATOR-COMPROMISE d-link sharecenter dns-320 denial of service attempt"; flow:to_server,established; content:"/cgi-bin/dks_mgr.cgi"; fast_pattern:only; nocase; http_uri; content:"cmd=FMT_restart"; nocase; http_client_body; metadata:policy max-detect-ips drop, service http; reference:url,sharecenter.dlink.com/products/DNS-320; classtype:web-application-attack; sid:41755; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Binary file download request from internationalized domain name using Microsoft BITS"; flow:to_server,established; content:"User-Agent|3A| Microsoft BITS"; http_header; content:"Host|3A 20|xn--"; fast_pattern:only; http_header; pcre:"/(\x2ebat|\x2eexe)$/smiU"; metadata:policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:41710; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 3306 (msg:"INDICATOR-COMPROMISE Writable SQL directories discovery attempt"; flow:to_server, established; content:"SELECT"; nocase; content:"INTO DUMPFILE"; distance:0; nocase; content:"SELECT"; distance:0; nocase; content:"INTO DUMPFILE"; distance:0; nocase; metadata:policy max-detect-ips drop, service mysql; reference:url,dev.mysql.com/doc/refman/5.7/en/select-into.html; classtype:attempted-recon; sid:41637; rev:2;)
# alert tcp $HOME_NET [1024:] -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE SOCKS5 proxy server method negotiation on non-standard port"; flow:to_client,established; content:"|05 FF|"; depth:2; isdataat:1; isdataat:!2; metadata:policy max-detect-ips drop; reference:url,news.drweb.com/show/?i=11115&c=5&lng=en&p=0; classtype:trojan-activity; sid:41534; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [1024:] (msg:"INDICATOR-COMPROMISE SOCKS5 proxy inbound connection on non-standard port"; flow:to_server,established; content:"|05 03 00 04|"; depth:4; isdataat:!29; metadata:policy max-detect-ips drop; reference:url,news.drweb.com/show/?i=11115&c=5&lng=en&p=0; classtype:trojan-activity; sid:41533; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [1024:] (msg:"INDICATOR-COMPROMISE SOCKS5 proxy inbound connection on non-standard port"; flow:to_server,established; content:"|05 03 00 03|"; depth:4; isdataat:!99; metadata:policy max-detect-ips drop; reference:url,news.drweb.com/show/?i=11115&c=5&lng=en&p=0; classtype:trojan-activity; sid:41532; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [1024:] (msg:"INDICATOR-COMPROMISE SOCKS5 proxy inbound connection on non-standard port"; flow:to_server,established; content:"|05 03 00 01|"; depth:4; isdataat:!99; metadata:policy max-detect-ips drop; reference:url,news.drweb.com/show/?i=11115&c=5&lng=en&p=0; classtype:trojan-activity; sid:41531; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [1024:] (msg:"INDICATOR-COMPROMISE SOCKS5 proxy inbound connection on non-standard port"; flow:to_server,established; content:"|05 02 00 04|"; depth:4; isdataat:!29; metadata:policy max-detect-ips drop; reference:url,news.drweb.com/show/?i=11115&c=5&lng=en&p=0; classtype:trojan-activity; sid:41530; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [1024:] (msg:"INDICATOR-COMPROMISE SOCKS5 proxy inbound connection on non-standard port"; flow:to_server,established; content:"|05 02 00 03|"; depth:4; isdataat:!99; metadata:policy max-detect-ips drop; reference:url,news.drweb.com/show/?i=11115&c=5&lng=en&p=0; classtype:trojan-activity; sid:41529; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [1024:] (msg:"INDICATOR-COMPROMISE SOCKS5 proxy inbound connection on non-standard port"; flow:to_server,established; content:"|05 02 00 01|"; depth:4; isdataat:!99; metadata:policy max-detect-ips drop; reference:url,news.drweb.com/show/?i=11115&c=5&lng=en&p=0; classtype:trojan-activity; sid:41528; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [1024:] (msg:"INDICATOR-COMPROMISE SOCKS5 proxy inbound connection on non-standard port"; flow:to_server,established; content:"|05 01 00 04|"; depth:4; isdataat:!29; metadata:policy max-detect-ips drop; reference:url,news.drweb.com/show/?i=11115&c=5&lng=en&p=0; classtype:trojan-activity; sid:41527; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [1024:] (msg:"INDICATOR-COMPROMISE SOCKS5 proxy inbound connection on non-standard port"; flow:to_server,established; content:"|05 01 00 03|"; depth:4; isdataat:!99; metadata:policy max-detect-ips drop; reference:url,news.drweb.com/show/?i=11115&c=5&lng=en&p=0; classtype:trojan-activity; sid:41526; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET [1024:] (msg:"INDICATOR-COMPROMISE SOCKS5 proxy inbound connection on non-standard port"; flow:to_server,established; content:"|05 01 00 01|"; depth:4; isdataat:!99; metadata:policy max-detect-ips drop; reference:url,news.drweb.com/show/?i=11115&c=5&lng=en&p=0; classtype:trojan-activity; sid:41525; rev:4;)
# alert tcp $HOME_NET [1024:] -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE SOCKS5 proxy server method negotiation on non-standard port"; flow:to_client,established; content:"|05 00|"; depth:2; isdataat:1; isdataat:!2; metadata:policy max-detect-ips drop; reference:url,news.drweb.com/show/?i=11115&c=5&lng=en&p=0; classtype:trojan-activity; sid:41524; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Adobe Flash Player ActionScript vulnerable RegExp verb usage detected"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"(*THEN"; fast_pattern:only; content:"|06|RegExp"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-7868; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-39.html; classtype:attempted-user; sid:41009; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Adobe Flash Player ActionScript vulnerable RegExp verb usage detected"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"(*THEN"; fast_pattern:only; content:"|06|RegExp"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-7868; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-39.html; classtype:attempted-user; sid:41008; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Adobe Flash Player ActionScript vulnerable RegExp verb usage detected"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"(*SKIP"; fast_pattern:only; content:"|06|RegExp"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-7870; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-39.html; classtype:attempted-user; sid:41007; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Adobe Flash Player ActionScript vulnerable RegExp verb usage detected"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"(*SKIP"; fast_pattern:only; content:"|06|RegExp"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-7870; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-39.html; classtype:attempted-user; sid:41006; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Adobe Flash Player ActionScript vulnerable RegExp verb usage detected"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"(*PRUNE"; fast_pattern:only; content:"|06|RegExp"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-7869; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-39.html; classtype:attempted-user; sid:41001; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Adobe Flash Player ActionScript vulnerable RegExp verb usage detected"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"(*PRUNE"; fast_pattern:only; content:"|06|RegExp"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-7869; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-39.html; classtype:attempted-user; sid:41000; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Adobe Flash Player ActionScript vulnerable RegExp verb usage detected"; flow:to_server,established; flowbits:isset,file.swf; file_data; content:"|07 28 2A|MARK|3A|"; fast_pattern:only; content:"|06|RegExp"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2016-7867; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-39.html; classtype:attempted-user; sid:40997; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Adobe Flash Player ActionScript vulnerable RegExp verb usage detected"; flow:to_client,established; flowbits:isset,file.swf; file_data; content:"|07 28 2A|MARK|3A|"; fast_pattern:only; content:"|06|RegExp"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-7867; reference:url,helpx.adobe.com/security/products/flash-player/apsb16-39.html; classtype:attempted-user; sid:40996; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE potential Squiblydoo application whitelisting bypass attempt"; flow:to_server,established; file_data; content:"<scriptlet>"; fast_pattern:only; content:"<registration"; nocase; content:"progid"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,msdn.microsoft.com/en-us/library/ms974602.aspx; classtype:attempted-user; sid:40830; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE potential Squiblydoo application whitelisting bypass attempt"; flow:to_client,established; file_data; content:"<scriptlet>"; fast_pattern:only; content:"<registration"; nocase; content:"progid"; nocase; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,msdn.microsoft.com/en-us/library/ms974602.aspx; classtype:attempted-user; sid:40829; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Malicious script redirect attempt"; flow:to_client, established; file_data; content:"<script"; nocase; content:"username=yelang88888"; within:200; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:attempted-user; sid:40828; rev:1;)
# alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE DNS response points to sinkholed domain"; flow:to_client,established; content:"|00 02 00 01|"; content:"honeybot|02|us"; fast_pattern:only; metadata:policy max-detect-ips drop, service dns; reference:url,whois.domaintools.com/honeybot.us; classtype:trojan-activity; sid:40610; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE shell script download with curl from external source"; flow:to_server,established; content:"User-Agent: curl"; fast_pattern:only; http_header; content:".sh"; nocase; http_uri; pcre:"/\x2Esh$/Ui"; metadata:policy max-detect-ips drop, service http; classtype:suspicious-filename-detect; sid:40598; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE shell script download with wget from external source"; flow:to_server,established; content:"User-Agent: Wget"; fast_pattern:only; http_header; content:".sh"; nocase; http_uri; pcre:"/\x2Esh$/Ui"; metadata:policy max-detect-ips drop, service http; classtype:suspicious-filename-detect; sid:40597; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE wsf inside zip potential malicious file download attempt"; flow:to_server,established; flowbits:isset,file.zip; file_data; content:"PK|03 04|"; depth:4; content:".wsf"; distance:0; metadata:policy max-detect-ips drop, service smtp; reference:url,bleepingcomputer.com/news/security/zepto-ransomware-locky-variant-being-distributed-via-wsf-attachments/; classtype:attempted-user; sid:40568; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE TextDecorationLineUnderline property use"; flow:to_server,established; file_data; content:"TextDecorationLineUnderline"; fast_pattern:only; content:".createElement"; nocase; content:".setAttribute"; nocase; content:".removeAttribute"; nocase; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-3324; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-104; classtype:attempted-recon; sid:40093; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE TextDecorationLineThrough property use"; flow:to_server,established; file_data; content:"TextDecorationLineThrough"; fast_pattern:only; content:".createElement"; nocase; content:".setAttribute"; nocase; content:".removeAttribute"; nocase; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-3324; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-104; classtype:attempted-recon; sid:40092; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE TextDecorationLineOverline property use"; flow:to_server,established; file_data; content:"TextDecorationLineOverline"; fast_pattern:only; content:".createElement"; nocase; content:".setAttribute"; nocase; content:".removeAttribute"; nocase; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-3324; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-104; classtype:attempted-recon; sid:40091; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE TextDecorationLineNone property use"; flow:to_server,established; file_data; content:"TextDecorationLineNone"; fast_pattern:only; content:".createElement"; nocase; content:".setAttribute"; nocase; content:".removeAttribute"; nocase; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-3324; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-104; classtype:attempted-recon; sid:40090; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE TextDecorationBlink property use"; flow:to_server,established; file_data; content:"TextDecorationBlink"; fast_pattern:only; content:".createElement"; nocase; content:".setAttribute"; nocase; content:".removeAttribute"; nocase; metadata:policy max-detect-ips drop, service smtp; reference:cve,2016-3324; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-104; classtype:attempted-recon; sid:40089; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE TextDecorationLineUnderline property use"; flow:to_client,established; file_data; content:"TextDecorationLineUnderline"; fast_pattern:only; content:".createElement"; nocase; content:".setAttribute"; nocase; content:".removeAttribute"; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-3324; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-104; classtype:attempted-recon; sid:40088; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE TextDecorationLineThrough property use"; flow:to_client,established; file_data; content:"TextDecorationLineThrough"; fast_pattern:only; content:".createElement"; nocase; content:".setAttribute"; nocase; content:".removeAttribute"; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-3324; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-104; classtype:attempted-recon; sid:40087; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE TextDecorationLineOverline property use"; flow:to_client,established; file_data; content:"TextDecorationLineOverline"; fast_pattern:only; content:".createElement"; nocase; content:".setAttribute"; nocase; content:".removeAttribute"; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-3324; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-104; classtype:attempted-recon; sid:40086; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE TextDecorationLineNone property use"; flow:to_client,established; file_data; content:"TextDecorationLineNone"; fast_pattern:only; content:".createElement"; nocase; content:".setAttribute"; nocase; content:".removeAttribute"; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-3324; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-104; classtype:attempted-recon; sid:40085; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE TextDecorationBlink property use"; flow:to_client,established; file_data; content:"TextDecorationBlink"; fast_pattern:only; content:".createElement"; nocase; content:".setAttribute"; nocase; content:".removeAttribute"; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2016-3324; reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-104; classtype:attempted-recon; sid:40084; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 23 (msg:"INDICATOR-COMPROMISE Cisco IOS commandline overflow attempt."; flow:to_server,established; content:"|16 50 16 60 16 B8 16 82 16 AA 16 AA 16 AA 16 35 16 AA 16 AA 16 AA 16 AA 16 BF 16 14 16 B3 16|"; fast_pattern:only; metadata:policy max-detect-ips drop; reference:cve,2016-6367; classtype:attempted-admin; sid:39987; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 23 (msg:"INDICATOR-COMPROMISE Cisco IOS commandline overflow attempt"; flow:to_server,established; content:"|16 08 16 08 16 08 16 08 16 08 16 08 16 08 16 08 16 08 16 08 16 08 16 08 16 08 16 08 16 08 16 08|"; fast_pattern:only; metadata:policy max-detect-ips drop; reference:cve,2016-6367; classtype:attempted-admin; sid:39986; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 23 (msg:"INDICATOR-COMPROMISE Cisco IOS commandline overflow attempt."; flow:to_server,established; content:"|16 50 16 60 16 B8 16 82 16 AA 16 AA 16 AA 16 35 16 AA 16 AA 16 AA 16 AA 16 BF 16 20 16 E6 16|"; fast_pattern:only; metadata:policy max-detect-ips drop; reference:cve,2016-6367; classtype:attempted-admin; sid:39985; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 23 (msg:"INDICATOR-COMPROMISE Cisco IOS commandline overflow attempt."; flow:to_server,established; content:"|16 01 16 01 16 01 16 01 16 01 16 01 16 01 16 01 16 01 16 01 16 01 16 01 16 01 16 01 16 01 16 01|"; fast_pattern:only; metadata:policy max-detect-ips drop; reference:cve,2016-6367; classtype:attempted-admin; sid:39984; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 23 (msg:"INDICATOR-COMPROMISE Cisco IOS commandline overflow attempt"; flow:to_server,established; content:"|16|"; fast_pattern; content:"|16|"; within:1; distance:1; content:"|16|"; within:1; distance:1; content:"|16|"; within:1; distance:1; content:"|16|"; within:1; distance:1; content:"|16|"; within:1; distance:1; content:"|16|"; within:1; distance:1; content:"|16|"; within:1; distance:1; metadata:policy max-detect-ips drop; reference:cve,2016-6367; classtype:attempted-admin; sid:39983; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Meteocontrol WEBlog config containing passwords download attempt"; flow:to_server,established; content:"/html/en/confAccessProt.html"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2016-2296; classtype:web-application-attack; sid:39881; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Oracle E-Business Suite arbitrary node deletion"; flow:to_server,established; content:"/pls/"; http_uri; content:"/fnd_document_management.Dm_Nodes_Delete?"; fast_pattern:only; http_uri; content:"p_node_id="; http_uri; metadata:policy max-detect-ips drop, service http; reference:bugtraq,23532; reference:cve,2007-2170; reference:url,attack.mitre.org/techniques/T1070; reference:url,attack.mitre.org/techniques/T1107; reference:url,www.oracle.com/technology/deploy/security/critical-patch-updates/cpuapr2007.html; classtype:misc-activity; sid:39870; rev:3;)
# alert udp $HOME_NET any -> any 53 (msg:"INDICATOR-COMPROMISE Suspicious .tk dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|02|tk|00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; reference:url,en.wikipedia.org/wiki/.tk; classtype:misc-activity; sid:39867; rev:4;)
# alert udp $HOME_NET any -> any 53 (msg:"INDICATOR-COMPROMISE Suspicious .ml dns query"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|02|ml|00|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; reference:url,en.wikipedia.org/wiki/.ml; classtype:misc-activity; sid:39866; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Connection to malware sinkhole - CERT.PL"; flow:to_client,established; content:"Content-Length: 24|0D 0A|"; http_header; content:"Sinkholed by CERT.PL<br>"; fast_pattern:only; metadata:impact_flag red, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,en.wikipedia.org/wiki/Sinkhole_Server; classtype:trojan-activity; sid:39851; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Content-Type image containing Portable Executable data"; flow:to_client,established; content:"Content-Type|3A 20|image/"; fast_pattern:only; http_header; file_data; content:"MZ"; depth:2; byte_jump:4,58,relative,little; content:"PE|00 00|"; within:4; distance:-64; metadata:policy max-detect-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/en/file/2dc752d12baa8c8441b82dd52abfd51c25abd28ba42344b22869ba7ae5a9a877/analysis/1469197722/; classtype:trojan-activity; sid:39729; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Netgear D6000 or D3600 password recovery page access attempt"; flow:to_server,established; content:"/cgi-bin/passrec.asp"; fast_pattern:only; nocase; http_uri; metadata:policy max-detect-ips drop, service http; reference:cve,2015-8289; reference:url,www.kb.cert.org/vuls/id/778696; classtype:misc-activity; sid:39444; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE User-Agent blank user-agent string"; flow:to_server,established; content:"User-Agent:  |0D 0A|"; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, service http; reference:url,www.virustotal.com/en/file/63dc515aa44a48a31191b8f905b40ce8883bc864d4784a0bf84edf102ddffaf3/analysis/; classtype:misc-activity; sid:39362; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET !6666:7000 (msg:"INDICATOR-COMPROMISE IRC nick change on non-standard port"; flow:to_server,established; isdataat:!99; content:"NICK "; depth:5; metadata:policy max-detect-ips drop, service irc; classtype:trojan-activity; sid:38933; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE potential abuse of originating page privileges by new tab"; flow:to_client; file_data; content:"window.opener.location"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:url,www.jitbit.com/alexblog/256-targetblank---the-most-underestimated-vulnerability-ever/; classtype:policy-violation; sid:38767; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Content-Type text/plain containing Portable Executable data"; flow:to_client,established; content:"Content-Type|3A 20|text/plain"; http_header; file_data; content:"MZ"; depth:2; byte_jump:4,58,relative,little; content:"PE|00 00|"; within:4; distance:-64; metadata:policy max-detect-ips drop, policy security-ips alert, ruleset community, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/en/file/fc25709c4e05dbfbcc6ae0cf8a7c06e80156ae05179203021838259aeda9801a/analysis/1461600547/; classtype:trojan-activity; sid:38619; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE malicious file download attempt"; flow:to_server,established; content:"|2F 70 6F 63|"; http_uri; pcre:"/\x2f\x70\x6f\x63(\d*|\x5f[\x61-\x7a]+)\x2e(\x68\x74\x6d\x6c|\x78(\x6c\x73|\x73\x6c|\x6d\x6c)|\x6a(\x73|\x61\x76a)|\x61\x73\x70|\x70(\x64f|\x70\x74|\x48\x70|\x73\x64)|\x66\x6c\x76|\x73\x77\x66|\x64\x6fc|\x74\x74\x66|\x62\x6d\x70|\x6d(\x70\x33|\x33\x75))/Ui"; metadata:policy max-detect-ips drop, ruleset community, service http; classtype:misc-activity; sid:37963; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE download of a Office document with embedded PowerShell"; flow:to_client,established; flowbits:isset,file.doc; file_data; content:"powershell.exe"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips alert, service ftp-data, service http, service imap, service pop3; reference:url,attack.mitre.org/techniques/T1086; classtype:trojan-activity; sid:37244; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE download of a Office document with embedded PowerShell"; flow:to_server,established; flowbits:isset,file.doc; file_data; content:"powershell.exe"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips alert, service smtp; reference:url,attack.mitre.org/techniques/T1086; classtype:trojan-activity; sid:37243; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Microsoft Internet Explorer setAttributeNS ASLR bypass attempt"; flow:to_server,established; file_data; content:"setAttributeNS"; content:"required"; within:100; pcre:"/setAttributeNS\s*\x28[^,]*,[^,]*required(Features|Extensions)[^,]*,[^\x29]+[\x22\x27]([\0\s]|\\([vfbtnsr0]|x(20|0[\da-f])))+[\x22\x27]/im"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2015-6086; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112; classtype:misc-activity; sid:36760; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Microsoft Internet Explorer setAttributeNS ASLR bypass attempt"; flow:to_client,established; file_data; content:"setAttributeNS"; content:"required"; within:100; pcre:"/setAttributeNS\s*\x28[^,]*,[^,]*required(Features|Extensions)[^,]*,[^\x29]+[\x22\x27]([\0\s]|\\([vfbtnsr0]|x(20|0[\da-f])))+[\x22\x27]/im"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-6086; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112; classtype:misc-activity; sid:36759; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Metasploit Meterpreter reverse HTTPS certificate"; flow:to_client,established; content:"|16 03 02|"; content:"|0B|"; within:1; distance:2; content:"|30 82|"; within:2; distance:9; content:"|30 82|"; within:2; distance:2; content:"|A0 03 02 01 02 02|"; within:6; distance:2; content:"|30 0D 06 09 2A 86 48 86 F7 0D 01 01|"; within:22; content:"|31|"; within:1; distance:5; content:"|30|"; within:1; distance:1; content:"|06 03 55 04 03 0C|"; within:6; distance:1; content:"|30|"; within:10; distance:3; content:"|17 0D|"; within:2; distance:1; content:"Z|17 0D|"; within:3; distance:12; content:"Z|30|"; within:2; distance:12; content:"|31|"; within:1; distance:1; content:"|30|"; within:1; distance:1; content:"|06 03 55 04 03 0C|"; within:6; distance:1; content:"|30 82|"; within:9; distance:2; content:"|30 0D 06 09 2A 86 48 86 F7 0D 01 01 01 05 00 03 82|"; within:17; distance:2; content:"|30 82|"; within:2; distance:3; content:"|02 82|"; within:2; distance:2; content:"|02 03 01 00 01 A3 0D 30 0B 30 09 06 03 55 1D 13 04 02 30 00 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, ruleset community, service ssl; reference:url,blog.didierstevens.com; classtype:misc-activity; sid:36612; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Metasploit Meterpreter reverse HTTPS certificate"; flow:to_client,established; content:"|16 03 01|"; content:"|0B|"; within:1; distance:2; content:"|30 82|"; within:2; distance:9; content:"|30 82|"; within:2; distance:2; content:"|A0 03 02 01 02 02|"; within:6; distance:2; content:"|30 0D 06 09 2A 86 48 86 F7 0D 01 01|"; within:22; content:"|31|"; within:1; distance:5; content:"|30|"; within:1; distance:1; content:"|06 03 55 04 03 0C|"; within:6; distance:1; byte_extract:1,0,string_size,relative; content:"|30|"; within:1; distance:string_size; content:"|17 0D|"; within:2; distance:1; content:"Z|17 0D|"; within:3; distance:12; content:"Z|30|"; within:2; distance:12; content:"|31|"; within:1; distance:1; content:"|30|"; within:1; distance:1; content:"|06 03 55 04 03 0C|"; within:6; distance:1; byte_extract:1,0,string_size,relative; content:"|30 82|"; within:2; distance:string_size; content:"|30 0D 06 09 2A 86 48 86 F7 0D 01 01 01 05 00 03 82|"; within:17; distance:2; content:"|30 82|"; within:2; distance:3; content:"|02 82|"; within:2; distance:2; content:"|02 03 01 00 01 A3 0D 30 0B 30 09 06 03 55 1D 13 04 02 30 00 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, ruleset community, service ssl; reference:url,blog.didierstevens.com; classtype:misc-activity; sid:36611; rev:4;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Wild Neutron potential exploit attempt"; flow:to_server,established; urilen:>25; content:".swf?"; http_uri; content:"styleid="; distance:0; http_uri; content:"&langid="; distance:0; http_uri; content:"&sid="; distance:0; http_uri; content:"&d="; distance:0; http_uri; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/; classtype:trojan-activity; sid:35745; rev:2;)
alert tcp $EXTERNAL_NET 448 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - Win.Trojan.Dridex"; flow:to_client,established; content:"koalabride"; fast_pattern:only; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ssl; reference:url,www.virustotal.com/en/file/5aad7720c0bb9848d540705943999d4e90908ba40a9d38e20018e53eb741dcb8/analysis/; classtype:trojan-activity; sid:35222; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Metasploit Meterpreter reverse HTTPS certificate"; flow:to_client,established; content:"|16 03 03|"; content:"|0B|"; within:1; distance:2; content:"|30 82|"; within:2; distance:9; content:"|30 82|"; within:2; distance:2; content:"|A0 03 02 01 02 02|"; within:6; distance:2; content:"|30 0D 06 09 2A 86 48 86 F7 0D 01 01|"; within:22; content:"|31|"; within:1; distance:5; content:"|30|"; within:1; distance:1; content:"|06 03 55 04 03 0C|"; within:6; distance:1; content:"|30|"; within:10; distance:3; content:"|17 0D|"; within:2; distance:1; content:"Z|17 0D|"; within:3; distance:12; content:"Z|30|"; within:2; distance:12; content:"|31|"; within:1; distance:1; content:"|30|"; within:1; distance:1; content:"|06 03 55 04 03 0C|"; within:6; distance:1; content:"|30 82|"; within:9; distance:2; content:"|30 0D 06 09 2A 86 48 86 F7 0D 01 01 01 05 00 03 82|"; within:17; distance:2; content:"|30 82|"; within:2; distance:3; content:"|02 82|"; within:2; distance:2; content:"|02 03 01 00 01 A3 0D 30 0B 30 09 06 03 55 1D 13 04 02 30 00 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00|"; fast_pattern:only; metadata:policy max-detect-ips drop, ruleset community, service ssl; reference:url,blog.didierstevens.com; classtype:misc-activity; sid:34864; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - APT28 Lisuife"; flow:to_client,established; ssl_state:server_hello; content:"SolusVM Slave"; fast_pattern:only; metadata:impact_flag red, policy max-detect-ips drop, service ssl; reference:url,www.virustotal.com/en/file/566ab945f61be016bfd9e83cc1b64f783b9b8deb891e6d504d3442bc8281b092/analysis/; classtype:trojan-activity; sid:34465; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Win.Trojan.Blocker variant outbound connection attempt"; flow:to_server,established; content:"User-Agent: Mozilla/5.0 (Windows NT 6.3|3B| WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.114 Safari/537.36|0D 0A|Host: checkip.dyndns.org|0D 0A|"; fast_pattern:only; http_header; content:!"Accept"; http_header; metadata:policy max-detect-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/79b75a8564e2e446789e1890f52c025792de919b63719e02630a70d6ae9a3ca4/analysis/1421439683/; classtype:misc-activity; sid:33224; rev:2;)
# alert udp $HOME_NET any -> any 53 (msg:"INDICATOR-COMPROMISE DNS request for known malware domain tor2web.org"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|07|tor2web|03|org|00|"; fast_pattern:only; metadata:service dns; reference:url,www.virustotal.com/en/file/ce7ed063a777fc597c788ef5a1cfdff7b823f34b8207043a482025e4bcd8db7a/analysis/; classtype:misc-activity; sid:33216; rev:3;)
# alert udp $HOME_NET any -> any 53 (msg:"INDICATOR-COMPROMISE DNS request for known malware domain icanhazip.com"; flow:to_server; byte_test:1,!&,0xF8,2; content:"|09|icanhazip|03|com|00|"; fast_pattern:only; metadata:service dns; reference:url,www.virustotal.com/en/file/ce7ed063a777fc597c788ef5a1cfdff7b823f34b8207043a482025e4bcd8db7a/analysis/; classtype:misc-activity; sid:33215; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Download of executable screensaver file"; flow:to_client,established; file_data; content:"PK|03 04|"; depth:4; content:".scr"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1180; reference:url,www.virustotal.com/en/file/cb7a29d1dec378f94b394ba4df3dc1fe5fe3b8d1d4ca3e70da3a611b67588ae7/analysis/; classtype:policy-violation; sid:32948; rev:5;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Potential Redirect from Compromised WordPress site to Fedex - Spammed Malware Download attempt"; flow:to_server,established; urilen:1; content:"GET"; http_method; content:"/wp-admin/"; fast_pattern:only; http_header; content:"Host: www.fedex.com|0D 0A|"; http_header; pcre:"/Referer\x3a\x20[\x20-\x7E]*?\/wp\x2dadmin\/[a-z\d\x2d]+?\.php\r\n/Hi"; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.hybrid-analysis.com/sample/a531bc62b0460eba5b0003b535a2e9cceae0b623aecfdc6f0331743fbee77e56/; classtype:trojan-activity; sid:32888; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Potential malware download - _pdf.exe within .zip file"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:"_pdf.exe"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/0d68f1d3855543a4732e551e9e4375a2cd85d9ab11a86334f67ad99c5f6990a0/analysis/; classtype:trojan-activity; sid:32646; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE .com- potentially malicious hostname"; flow:to_server,established; content:"Host:"; http_header; content:".com-"; within:70; fast_pattern; http_header; content:!"www"; within:3; distance:-8; http_header; pcre:"/Host: [^\x0d\x0a]*?\.com-/Hi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; classtype:bad-unknown; sid:32488; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"INDICATOR-COMPROMISE Keylog string over FTP detected"; flow:to_server,established; content:"|20|KeyLog"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp; reference:url,attack.mitre.org/techniques/T1056; classtype:string-detect; sid:31711; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE MinerDeploy monitor request attempt"; flow:to_server,established; content:"/monitor.php?"; fast_pattern; http_uri; content:"myid="; distance:0; http_uri; content:"&ip="; distance:0; http_uri; content:"&cgminer="; distance:0; http_uri; content:"&operatingsystem="; distance:0; http_uri; content:!"Content-Length|3A 20|"; http_header; content:!"Content-Type|3A 20|"; http_header; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/06033b08afd30b413cce3b9a169cb8396fe34865f3bacd436c652dbb469ced62/analysis/; classtype:trojan-activity; sid:31531; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Liz0ziM php shell download attempt"; flow:to_server,established; file_data; content:"Liz0ziM"; fast_pattern:only; content:"|24 5F|POST|5B|liz0|5D|"; nocase; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,www.virustotal.com/en/file/599a1ec19581cdcc5d268093bd8cbeaf2c6c519390d68820f2a1258297f0d783/analysis/; classtype:attempted-user; sid:31503; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Liz0ziM php shell command and control attempt"; flow:to_server,established; content:"POST"; http_method; content:".php"; http_uri; content:"liz0="; fast_pattern:only; http_client_body; content:"liz0="; depth:5; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/599a1ec19581cdcc5d268093bd8cbeaf2c6c519390d68820f2a1258297f0d783/analysis/; classtype:attempted-user; sid:31502; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Liz0ziM php shell command and control attempt"; flow:to_server,established; content:"POST"; http_method; content:".php"; http_uri; content:"baba="; fast_pattern:only; http_client_body; content:"baba="; depth:5; http_client_body; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/599a1ec19581cdcc5d268093bd8cbeaf2c6c519390d68820f2a1258297f0d783/analysis/; classtype:attempted-user; sid:31501; rev:2;)
alert tcp $EXTERNAL_NET any -> $HOME_NET $FILE_DATA_PORTS (msg:"INDICATOR-COMPROMISE Liz0ziM php shell upload attempt"; flow:to_server,established; file_data; content:"Liz0ziM"; fast_pattern:only; content:"|24 5F|POST|5B|liz0|5D|"; nocase; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/en/file/599a1ec19581cdcc5d268093bd8cbeaf2c6c519390d68820f2a1258297f0d783/analysis/; classtype:attempted-user; sid:31500; rev:2;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Liz0ziM php shell download attempt"; flow:to_client,established; file_data; content:"Liz0ziM"; fast_pattern:only; content:"|24 5F|POST|5B|liz0|5D|"; nocase; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,www.virustotal.com/en/file/599a1ec19581cdcc5d268093bd8cbeaf2c6c519390d68820f2a1258297f0d783/analysis/; classtype:attempted-user; sid:31499; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE connection to zeus malware sinkhole"; flow:to_client,established; content:"X-Sinkhole|3A| Malware GameOverZeus sinkhole"; fast_pattern:only; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,en.wikipedia.org/wiki/sinkhole_server; classtype:trojan-activity; sid:31214; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE http POST request smuggling attempt"; flow:to_server,established; content:"POST /"; fast_pattern:only; http_header; content:" HTTP/"; http_header; metadata:policy max-detect-ips drop, service http; reference:cve,2014-0099; classtype:misc-attack; sid:31213; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE http GET request smuggling attempt"; flow:to_server,established; content:"GET /"; fast_pattern:only; http_header; content:" HTTP/"; http_header; metadata:policy max-detect-ips drop, service http; reference:cve,2014-0099; classtype:misc-attack; sid:31212; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Potential malware download - .pdf.exe within .zip file"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:".pdf.exe"; fast_pattern:only; content:"Content-Length:"; http_header; metadata:policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:31001; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Potential malware download - .jpg.exe within .zip file"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:".jpg.exe"; fast_pattern:only; content:"Content-Length:"; http_header; metadata:policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:31000; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Potential malware download - .jpeg.exe within .zip file"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:".jpeg.exe"; fast_pattern:only; content:"Content-Length:"; http_header; metadata:policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:30999; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Potential malware download - .gif.exe within .zip file"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:".gif.exe"; fast_pattern:only; content:"Content-Length:"; http_header; metadata:policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:30998; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Potential malware download - .doc.exe within .zip file"; flow:to_client,established; flowbits:isset,file.zip; file_data; content:".doc.exe"; fast_pattern:only; content:"Content-Length:"; http_header; metadata:policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; classtype:trojan-activity; sid:30997; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE possible TAR file oversize length field"; flow:to_server,established; file_data; content:"ustar"; depth:5; offset:257; byte_test:10,>,100000,124,string,dec; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-1457; classtype:trojan-activity; sid:30995; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE possible TAR file oversize length field"; flow:to_client,established; file_data; content:"ustar"; depth:5; offset:257; byte_test:10,>,100000,124,string,dec; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-1457; classtype:trojan-activity; sid:30994; rev:2;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE suspicious test for public IP - www.dawhois.com"; flow:to_server,established; content:"Host|3A 20|www.dawhois.com|0D 0A|"; fast_pattern:only; http_header; content:!"Accept|3A|"; http_header; content:!"Referer|3A|"; http_header; metadata:impact_flag red, policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,www.virustotal.com/en/file/C84FC7BEF4E77E1F913A4BE1A7114D255459F9D808FCC09B0F441E3761E5E4A4/analysis/; classtype:trojan-activity; sid:30230; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE ZenCart malicious redirect attempt detected"; flow:to_client,established; content:"Set-Cookie|3A 20|USERID=shine-check|3B|"; fast_pattern:only; http_header; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,blog.sucuri.net/2014/02/mysterious-zencart-redirects-leverage-http-headers.html; classtype:trojan-activity; sid:30066; rev:2;)
alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE ZenCart compromise attempt detected"; flow:to_client,established; content:"Set-Cookie|3A 20|USERID=twotime|3B|"; fast_pattern:only; http_header; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:url,blog.sucuri.net/2014/02/mysterious-zencart-redirects-leverage-http-headers.html; classtype:trojan-activity; sid:30065; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"INDICATOR-COMPROMISE Windows Internet Explorer EMET check and garbage collection"; flow:to_server,established; file_data; content:"CollectGarbage()"; content:"C:|5C 5C|windows|5C 5C|AppPatch|5C 5C|EMET.DLL"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2013-7331; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:misc-attack; sid:29822; rev:6;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Windows Internet Explorer EMET check and garbage collection"; flow:to_client,established; file_data; content:"CollectGarbage()"; content:"C:|5C 5C|windows|5C 5C|AppPatch|5C 5C|EMET.DLL"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2013-7331; reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052; classtype:misc-attack; sid:29821; rev:6;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE suspicious test for public IP - iframe.ip138.com"; flow:to_server,established; content:"/ic.asp"; http_uri; content:"Host|3A 20|iframe.ip138.com|0D 0A|"; fast_pattern:only; http_header; content:!"|0D 0A|Accept"; http_header; content:!"|0D 0A|Referer"; http_header; metadata:policy max-detect-ips drop, policy security-ips alert, service http; classtype:successful-recon-limited; sid:29090; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE exe.exe download"; flow:to_server,established; urilen:>7; content:"/exe.exe"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, ruleset community, service http; reference:url,urlquery.net/search.php?q=%5C%2F%5BEe%5D%5BXx%5D%5BEe%5D%5C.%5BEe%5D%5BXx%5D%5BEe%5D%24&type=regexp&start=2013-11-21&end=2013-12-06&max=400; classtype:trojan-activity; sid:28945; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE potential malware download - single digit .exe file download"; flow:to_server,established; urilen:6; content:".exe"; fast_pattern:only; pcre:"/\/[a-z0-9]\.exe$/Ui"; metadata:impact_flag red, policy max-detect-ips drop, policy security-ips drop, ruleset community, service http; reference:url,urlquery.net/search.php?q=%5C%2F%5Ba-zA-Z%5D%5C.%5BEe%5D%5BXx%5D%5BEe%5D%24&type=regexp&start=2013-09-07&end=2013-12-06&max=400; classtype:trojan-activity; sid:28806; rev:3;)
# alert udp $HOME_NET any -> any 53 (msg:"INDICATOR-COMPROMISE Suspicious .nl.ai dns query"; flow:to_server; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|nl|02|ai|00|"; distance:0; fast_pattern; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:trojan-activity; sid:28284; rev:3;)
# alert udp $HOME_NET any -> any 53 (msg:"INDICATOR-COMPROMISE Suspicious .cc dns query"; flow:to_server; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|cc|00|"; distance:0; fast_pattern; metadata:policy max-detect-ips drop, service dns; classtype:trojan-activity; sid:28190; rev:4;)
# alert udp $HOME_NET any -> any 53 (msg:"INDICATOR-COMPROMISE Suspicious .pw dns query"; flow:to_server; content:!"|01|u|02|pw"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|pw|00|"; distance:0; fast_pattern; metadata:policy max-detect-ips drop, policy security-ips drop, service dns; classtype:misc-activity; sid:28039; rev:7;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE request for potential web shell - /jspspy.jsp"; flow:to_server,established; content:"/jspspy.jsp"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1100; reference:url,www.mandiant.com/blog/responding-attacks-apache-struts2/; classtype:misc-activity; sid:27732; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE request for potential web shell - /inback.jsp"; flow:to_server,established; content:"/inback.jsp"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1100; reference:url,www.mandiant.com/blog/responding-attacks-apache-struts2/; classtype:misc-activity; sid:27731; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE request for potential web shell - /css3.jsp"; flow:to_server,established; content:"/css3.jsp"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1100; reference:url,www.mandiant.com/blog/responding-attacks-apache-struts2/; classtype:misc-activity; sid:27730; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE request for potential web shell - /Silic.jsp"; flow:to_server,established; content:"/Silic.jsp"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1100; reference:url,www.mandiant.com/blog/responding-attacks-apache-struts2/; classtype:misc-activity; sid:27729; rev:5;)
# alert udp $HOME_NET any -> any 53 (msg:"INDICATOR-COMPROMISE Suspicious .su dns query"; flow:to_server; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|02|su|00|"; distance:0; fast_pattern; metadata:policy max-detect-ips drop, service dns; classtype:trojan-activity; sid:27721; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE All Numbers .EXE file name from abnormally ordered HTTP headers - Potential Yakes Trojan Download"; flow:to_server,established; content:"GET"; http_method; content:".exe HTTP/1.1|0D 0A|Cache-Control: "; fast_pattern:only; content:".exe HTTP/1.1"; nocase; content:"|0D 0A|Cache-Control: no-cache|0D 0A|Connection: close|0D 0A|Pragma: no-cache|0D 0A|User-Agent: "; within:76; content:"|3A 20|"; distance:0; content:!"|3A 20|"; distance:0; pcre:"/\x2f\d+\.exe$/Ui"; metadata:impact_flag red, policy max-detect-ips drop, ruleset community, service http; reference:url,www.virustotal.com/en/file/980c4ed3dd130c9313a35434e0b102a6b8b038c98735814834334ccc03e4da3c/analysis/; classtype:trojan-activity; sid:27255; rev:2;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Apache auto_prepend_file a.control.bin C2 traffic"; flow:to_server,established; content:"User-Agent|3A| SEX|2F|1"; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, ruleset community, service http; reference:url,blog.sucuri.net/2013/06/apache-php-injection-to-javascript-files.html; classtype:trojan-activity; sid:27203; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Unknown ?1 redirect"; flow:to_server,established; content:"GET /?1 HTTP/1.1"; fast_pattern:only; metadata:policy max-detect-ips drop, ruleset community, service http; classtype:bad-unknown; sid:27047; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE config.inc.php in iframe"; flow:to_client,established; file_data; content:"<iframe"; content:"config.inc.php"; within:100; content:"</iframe>"; distance:0; metadata:policy max-detect-ips drop, ruleset community, service http; reference:url,blog.sucuri.net/2013/05/auto-generated-iframes-to-blackhole-exploit-kit-following-the-cookie-trail.html; classtype:trojan-activity; sid:26585; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Unix.Backdoor.Cdorked redirected URI attempt"; flow:to_server,established; urilen:>150,norm; content:"0aW1lP"; fast_pattern; http_uri; content:"/index.php?"; depth:11; http_uri; base64_decode:bytes 150, offset 10, relative; base64_data; content:"time="; content:"&src="; distance:0; content:"&surl="; distance:0; metadata:impact_flag red, policy max-detect-ips drop, service http; reference:url,blog.sucuri.net/2013/04/apache-binary-backdoors-on-cpanel-based-servers.html; reference:url,virustotal.com/en/file/7b3cd8c1bd0249df458084f28d91648ad14e1baf455fdd53b174481d540070c6/analysis/; classtype:trojan-activity; sid:26530; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE Unix.Backdoor.Cdorked redirect attempt"; flow:to_client,established; content:"0aW1lP"; fast_pattern; http_header; content:"/index.php?"; distance:-50; http_header; base64_decode:bytes 150, offset 10, relative; base64_data; content:"time="; content:"&src="; distance:0; content:"&surl="; distance:0; metadata:impact_flag red, policy max-detect-ips drop, ruleset community, service http; reference:url,blog.sucuri.net/2013/04/apache-binary-backdoors-on-cpanel-based-servers.html; reference:url,virustotal.com/en/file/7b3cd8c1bd0249df458084f28d91648ad14e1baf455fdd53b174481d540070c6/analysis/; classtype:trojan-activity; sid:26528; rev:4;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE IP address check to j.maxmind.com detected"; flow:to_server,established; content:"/app/geoip.js"; http_uri; content:"Host|3A 20|j.maxmind.com"; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, ruleset community, service http; classtype:misc-activity; sid:26410; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE IP address check to myip.dnsomatic.com detected"; flow:to_server,established; content:"Host|3A 20|myip.dnsomatic.com"; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, service http; classtype:misc-activity; sid:26397; rev:3;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE IP address check to dyndns.org detected"; flow:to_server,established; content:"Host|3A 20|checkip.dyndns.org"; fast_pattern:only; http_header; metadata:policy max-detect-ips drop, ruleset community, service http; classtype:misc-activity; sid:26353; rev:3;)
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Java user-agent request to svchost.jpg"; flow:to_server,established; content:"/svchost.jpg"; fast_pattern:only; http_uri; content:"Java/1."; http_header; metadata:impact_flag red, policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service http; reference:cve,2013-1493; classtype:trojan-activity; sid:26025; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - APT1 No-Name"; flow:to_client,established; ssl_state:server_hello; content:"|16 03|"; content:"|0B|"; within:1; distance:3; content:"|83 ED 52 2E 5A E0 7B C0|"; within:50; content:"A|40 40|hole"; nocase; metadata:impact_flag red, policy max-detect-ips drop, service ssl; reference:url,intelreport.mandiant.com/; classtype:trojan-activity; sid:25848; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - APT1 Moon-Night"; flow:to_client,established; ssl_state:server_hello; content:"|16 03|"; content:"|0B|"; within:1; distance:3; content:"|7C 8D 59 39 32 60 9B 8E 45 6B 3F 84 16 92 1F C2|"; within:50; metadata:impact_flag red, policy max-detect-ips drop, service ssl; reference:url,intelreport.mandiant.com/; classtype:trojan-activity; sid:25847; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - APT1 Yahoo"; flow:to_client,established; ssl_state:server_hello; content:"|16 03|"; content:"|0B|"; within:1; distance:3; content:"|0A 38 C9 27 08 6F 96 4B BE 75 DC 9F C0 1A C6 28|"; within:50; metadata:impact_flag red, policy max-detect-ips drop, service ssl; reference:url,intelreport.mandiant.com/; classtype:trojan-activity; sid:25846; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - APT1 AOL"; flow:to_client,established; ssl_state:server_hello; content:"|16 03|"; content:"|0B|"; within:1; distance:3; content:"|7C A2 74 D0 FB C3 D1 54 B3 D1 A3 00 62 E3 7E F6|"; within:50; metadata:impact_flag red, policy max-detect-ips drop, service ssl; reference:url,intelreport.mandiant.com/; classtype:trojan-activity; sid:25845; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - APT1 Sur"; flow:to_client,established; ssl_state:server_hello; content:"|16 03|"; content:"|0B|"; within:1; distance:3; content:"|20 82 92 3F 43 2C 8F 75 B7 EF 0F 6A D9 3C 8E 5D|"; within:50; metadata:impact_flag red, policy max-detect-ips drop, service ssl; reference:url,intelreport.mandiant.com/; classtype:trojan-activity; sid:25844; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - APT1 Server"; flow:to_client,established; ssl_state:server_hello; content:"|16 03|"; content:"|0B|"; within:1; distance:3; content:"|52 55 38 16 FB 0D 1A 8A 4B 45 04 CB 06 BC C4 AF|"; within:50; metadata:impact_flag red, policy max-detect-ips drop, service ssl; reference:url,intelreport.mandiant.com/; classtype:trojan-activity; sid:25843; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - APT1 NS"; flow:to_client,established; ssl_state:server_hello; content:"|16 03|"; content:"|0B|"; within:1; distance:3; content:"|72 A2 5C 8A B4 18 71 4E BF C6 6F 3F 98 D6 F7 74|"; within:50; metadata:impact_flag red, policy max-detect-ips drop, service ssl; reference:url,intelreport.mandiant.com/; classtype:trojan-activity; sid:25842; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - APT1 Lame"; flow:to_client,established; ssl_state:server_hello; content:"|16 03|"; content:"|0B|"; within:1; distance:3; content:"|0E 97 88 1C 6C A1 37 96 42 03 BC 45 42 24 75 6C|"; within:50; metadata:impact_flag red, policy max-detect-ips drop, service ssl; reference:url,intelreport.mandiant.com/; classtype:trojan-activity; sid:25841; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - APT1 Email"; flow:to_client,established; ssl_state:server_hello; content:"|16 03|"; content:"|0B|"; within:1; distance:3; content:"|2F 09 DD E0 FF 81 B7 6C BF 2F 17 92 0C D8 BD 57|"; within:50; metadata:impact_flag red, policy max-detect-ips drop, service ssl; reference:url,intelreport.mandiant.com/; classtype:trojan-activity; sid:25840; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - APT1 Alpha"; flow:to_client,established; ssl_state:server_hello; content:"|16 03|"; content:"|0B|"; within:1; distance:3; content:"|46 37 EA 15 B6 54 96 4C B6 44 2B 7B 06 1A A5 30|"; within:50; metadata:impact_flag red, policy max-detect-ips drop, service ssl; reference:url,intelreport.mandiant.com/; classtype:trojan-activity; sid:25839; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - APT1 Webmail"; flow:to_client,established; ssl_state:server_hello; content:"|16 03|"; content:"|0B|"; within:1; distance:3; content:"|4C 0B 1D 19 74 86 A7 66 B4 1A BF 40 27 21 76 28|"; within:50; metadata:impact_flag red, policy max-detect-ips drop, service ssl; reference:url,intelreport.mandiant.com/; classtype:trojan-activity; sid:25838; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - APT1 IBM"; flow:to_client,established; ssl_state:server_hello; content:"|16 03|"; content:"|0B|"; within:1; distance:3; content:"|00 D3 89 1C 10 09 D8 EC 74 2F 5C 1E 24 C0 89 CD 02 2F AD 13 FA 37 EA 9A F9 73 EF 08 DD 3C|"; within:512; metadata:impact_flag red, policy max-detect-ips drop, service ssl; reference:url,intelreport.mandiant.com/; classtype:trojan-activity; sid:25837; rev:3;)
# alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"INDICATOR-COMPROMISE known malicious SSL certificate - APT1 Virtuallythere"; flow:to_client,established; ssl_state:server_hello; content:"|16 03|"; content:"|0B|"; within:1; distance:3; content:"|00 EE 48 13 76 F1 76 4B 6A FE 6D 8C 5E 60 44 19 B1 0A B1 9E BB 63 80 8F C8 43 C8 73 AE 77|"; within:512; metadata:impact_flag red, policy max-detect-ips drop, service ssl; reference:url,intelreport.mandiant.com/; classtype:trojan-activity; sid:25836; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE fx29shell.php connection attempt"; flow:to_server,established; content:"/fx29sh"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; classtype:policy-violation; sid:24434; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE itsoknoproblembro start attack"; flow:to_server,established; content:"action=start"; fast_pattern:only; http_uri; content:"time_s="; http_uri; content:"time_e="; http_uri; content:"page="; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,www.virustotal.com/file/573da03a5d0ade02643203b47a6925db43b0d53dfeaf20c31e7700377cd79d15/analysis/; classtype:policy-violation; sid:24394; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE itsoknoproblembro stop attack"; flow:to_server,established; content:"action=ssttoopp"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,www.virustotal.com/file/c5a96f83bed99141a20d31a9b624db8891e475737c2be9a6cdf9cf024e3d2210/analysis/; classtype:policy-violation; sid:24393; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE itsoknoproblembro write file"; flow:to_server,established; content:"action=stpf"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,www.virustotal.com/file/c5a96f83bed99141a20d31a9b624db8891e475737c2be9a6cdf9cf024e3d2210/analysis/; classtype:policy-violation; sid:24392; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE itsoknoproblembro start php"; flow:to_server,established; content:"action=startphp.php"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,www.virustotal.com/file/c5a96f83bed99141a20d31a9b624db8891e475737c2be9a6cdf9cf024e3d2210/analysis/; classtype:policy-violation; sid:24391; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE itsoknoproblembro start perl"; flow:to_server,established; content:"action=start.php"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,www.virustotal.com/file/c5a96f83bed99141a20d31a9b624db8891e475737c2be9a6cdf9cf024e3d2210/analysis/; classtype:policy-violation; sid:24390; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE itsoknoproblembro status check"; flow:to_server,established; content:".php?action=status"; fast_pattern:only; http_uri; content:".php?action=status "; metadata:policy max-detect-ips drop, service http; reference:url,www.virustotal.com/file/c5a96f83bed99141a20d31a9b624db8891e475737c2be9a6cdf9cf024e3d2210/analysis/; classtype:policy-violation; sid:24389; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE itsoknoproblembro file upload"; flow:to_server,established; content:"pass=FgYuD@37"; fast_pattern:only; http_uri; metadata:policy max-detect-ips drop, service http; reference:url,www.virustotal.com/file/256fee47ccdf100a1c00e32b9cb2b1d18d5fcdccf4ae90085bc90130daa68c95/analysis/; classtype:policy-violation; sid:24388; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE IP only webpage redirect attempt"; flow:to_client,established; file_data; content:"document.location="; pcre:"/^[^>]*\x2f\x2f\d{1,3}\x2e\d{1,3}\x2e\d{1,3}\x2e\d{1,3}/sR"; metadata:policy max-detect-ips drop, ruleset community, service http; classtype:bad-unknown; sid:24254; rev:7;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE IP only webpage redirect attempt"; flow:to_client,established; file_data; content:"<html><head><meta http-equiv=|22|refresh"; pcre:"/^[^>]*\x2f\x2f\d{1,3}\x2e\d{1,3}\x2e\d{1,3}\x2e\d{1,3}/sR"; metadata:policy max-detect-ips drop, ruleset community, service http; classtype:bad-unknown; sid:24253; rev:7;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - QUERY_PATH_INFO csrss.exe"; flow:to_server,established; content:"|FF 53 4D 42 32 00 00 00 00|"; depth:9; offset:4; content:"|00 05 00|"; within:3; distance:51; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|c|00|s|00|r|00|s|00|s|00 2E 00|e|00|x|00|e|00|"; distance:0; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,www.symantec.com/connect/blogs/shamoon-attacks-continue; classtype:trojan-activity; sid:24127; rev:2;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|e|00|x|00|t|00|r|00|a|00|c|00|t|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23933; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|f|00|s|00|u|00|t|00|l|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23932; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|n|00|e|00|t|00|x|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23931; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|n|00|t|00|n|00|w|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23930; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|w|00|c|00|s|00|c|00|r|00|i|00|p|00|t|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23929; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|s|00|m|00|b|00|i|00|n|00|i|00|t|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23928; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|s|00|f|00|m|00|s|00|c|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23927; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|s|00|a|00|c|00|s|00|e|00|s|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23926; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|r|00|r|00|a|00|s|00|r|00|v|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23925; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|r|00|o|00|u|00|t|00|e|00|m|00|a|00|n|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23924; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|s|00|i|00|g|00|v|00|e|00|r|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23923; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|r|00|e|00|g|00|s|00|y|00|s|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23922; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|r|00|d|00|s|00|a|00|d|00|m|00|i|00|n|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23921; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|p|00|o|00|w|00|e|00|r|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23920; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|n|00|t|00|d|00|s|00|u|00|t|00|l|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23919; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|n|00|t|00|f|00|r|00|s|00|u|00|t|00|i|00|l|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23918; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|m|00|s|00|i|00|n|00|i|00|t|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23917; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|i|00|i|00|s|00|s|00|r|00|v|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23916; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|i|00|p|00|s|00|e|00|c|00|u|00|r|00|e|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23915; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|g|00|p|00|g|00|e|00|t|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23914; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|f|00|i|00|n|00|d|00|f|00|i|00|l|00|e|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23913; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|e|00|v|00|e|00|n|00|t|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23912; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|d|00|v|00|d|00|q|00|u|00|e|00|r|00|y|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23911; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|d|00|n|00|s|00|l|00|o|00|o|00|k|00|u|00|p|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23910; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|d|00|f|00|r|00|a|00|g|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23909; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|c|00|t|00|r|00|l|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23908; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|c|00|l|00|e|00|a|00|n|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23907; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|c|00|e|00|r|00|t|00|u|00|t|00|l|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23906; rev:3;)
# alert tcp any any -> any [139,445] (msg:"INDICATOR-COMPROMISE Win.Trojan.DistTrack propagation - execute dropped file"; flow:to_server,established; dce_iface:1ff70682-0a51-30e8-076d-740be8cee98b; dce_opnum:0; dce_stub_data; content:"|5C 00|s|00|y|00|s|00|t|00|e|00|m|00|3|00|2|00 5C 00|c|00|a|00|c|00|l|00|s|00|r|00|v|00|.|00|e|00|x|00|e|00|"; nocase; metadata:policy max-detect-ips drop, service netbios-ssn; reference:url,blog.talosintel.com/2012/08/new-threat-disttrack.html; reference:url,www.virustotal.com/file/f9d94c5de86aa170384f1e2e71d95ec373536899cb7985633d3ecfdb67af0f72/analysis/; classtype:trojan-activity; sid:23905; rev:3;)
# alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Alsa3ek Web Shell"; flow:to_client,established; content:"<?php /* Cod3d by Mr.Alsa3ek and Al-Swisre"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1100; classtype:trojan-activity; sid:23830; rev:4;)
# alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Loaderz Web Shell"; flow:to_client,established; content:"/* Loader|27|z WEB Shell v"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:url,attack.mitre.org/techniques/T1100; classtype:trojan-activity; sid:23829; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE iframe before DOCTYPE possible malicious redirect attempt"; flow:to_client,established; file_data; content:"</iframe><!DOCTYPE"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:23596; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Wordpress Invit0r plugin non-image file upload attempt"; flow:to_server,established; content:"/wp-content/plugins/invit0r/lib/php-ofc-library/ofc_upload_image.php"; fast_pattern:only; http_uri; content:"name="; http_uri; pcre:!"/name=($|[^\x26]+\x2e(jpe?g|bmp|png|gif)($|\x26))/Ui"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,53995; reference:url,www.opensyscom.fr/Actualites/wordpress-plugins-invit0r-arbitrary-file-upload-vulnerability.html; classtype:web-application-attack; sid:23484; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE php-shell failed remote command injection attempt"; flow:to_client,established; file_data; content:".phpwas not found on this server.</p>"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; classtype:attempted-admin; sid:23443; rev:7;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE php-shell remote command injection attempt"; flow:to_server,established; content:".php?"; fast_pattern:only; http_uri; pcre:"/\x2f(links|xml|configs|functions|virtual|pointer)\.php?.*?[a-f0-9]{32}=\w+\x28.*?\x29\x3b/iU"; metadata:policy max-detect-ips drop, service http; classtype:attempted-admin; sid:23442; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE php-shell remote command shell upload attempt"; flow:to_client,established; file_data; content:"debug_msg('<h1>GOTCHA:"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; classtype:attempted-admin; sid:23441; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE php-shell remote command shell upload attempt"; flow:to_client,established; file_data; content:"stripslashes($_REQUEST[|5C|'"; fast_pattern:only; content:"function"; nocase; content:"debug_msg"; distance:0; nocase; content:"my_exec"; distance:0; nocase; content:"spawn_shell"; distance:0; nocase; metadata:policy max-detect-ips drop, service http; classtype:attempted-admin; sid:23440; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE php-shell remote command shell upload attempt"; flow:to_client,established; file_data; content:"stripslashes($_REQUEST[|5C|'"; fast_pattern:only; pcre:"/global\s+(?P<global>\$\w+)\s*\x3b\s*(?P=global)\s*=.*?\{\s*eval\(\s*stripslashes\(\s*\$_REQUEST\[\x5c'.*?function_exists\(\s*(?P<q>.)(exec|passthru|system|shell_exec|exec_popen)(?P=q)\s*\)/smi"; metadata:policy max-detect-ips drop, service http; classtype:attempted-admin; sid:23439; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE php-shell remote command shell initialization attempt"; flow:to_client,established; file_data; content:"|3B|s:4:|22|pass|22 3B|s:32:|22|"; fast_pattern:only; pcre:"/\x3bs\x3a4\x3a\x22pass\x22\x3bs\x3a32\x3a\x22[a-f0-9]{32}\x22/i"; metadata:policy max-detect-ips drop, service http; classtype:attempted-admin; sid:23438; rev:5;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE script before DOCTYPE possible malicious redirect attempt"; flow:to_client,established; file_data; content:"</script><!DOCTYPE"; fast_pattern:only; metadata:policy max-detect-ips drop, ruleset community, service http; classtype:web-application-attack; sid:23179; rev:5;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE Wordpress Request for html file in fgallery directory"; flow:to_server,established; content:"wp-content/uploads/fgallery"; fast_pattern:only; http_uri; pcre:"/wp-content\/uploads\/fgallery\/.+\x2ehtml?(\?|$)/U"; metadata:policy max-detect-ips drop, service http; classtype:web-application-attack; sid:23171; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE BeEF javascript hook.js download attempt"; flow:to_client,established; file_data; content:"beef.onpopstate.push(function(event)"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; classtype:attempted-user; sid:23107; rev:5;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE c99shell comment"; flow:to_client,established; file_data; content:"<h2>I'm a man!</h2>"; fast_pattern:only; metadata:impact_flag red, policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; classtype:trojan-activity; sid:23017; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"INDICATOR-COMPROMISE base64-encoded c99shell download"; flow:to_client,established; file_data; content:"KioNCioNCioJCQkJCWM5OXNoZWxsLnBocCB2"; metadata:impact_flag red, policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,vil.nai.com/vil/content/v_136948.htm; classtype:trojan-activity; sid:23016; rev:6;)
# alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"INDICATOR-COMPROMISE Win32.Virut web propagation detection"; flow:to_client,established; file_data; content:"<iframe"; content:".pl/rc/"; distance:0; fast_pattern; pcre:"/\x3ciframe[^\x3e]*?src\x3d\x22http\x3a\x2f\x2f[^\x26\x2e]+\x26\x2346\x3b[^\x2e]+\x2epl\x2frc\x2f\x22/"; metadata:impact_flag red, policy max-detect-ips drop, service http; reference:url,securelist.com/en/analysis/204792122/; classtype:trojan-activity; sid:22940; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE c99shell.php command request - tools"; flow:to_server,established; content:"act=tools&"; fast_pattern:only; http_client_body; metadata:policy max-detect-ips drop, service http; reference:url,vil.nai.com/vil/content/v_136948.htm; classtype:policy-violation; sid:22933; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE c99shell.php command request - phpinfo"; flow:to_server,established; content:"act=phpinfo"; fast_pattern:only; http_client_body; metadata:policy max-detect-ips drop, service http; reference:url,vil.nai.com/vil/content/v_136948.htm; classtype:policy-violation; sid:22932; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE c99shell.php command request - ls"; flow:to_server,established; content:"act=ls"; fast_pattern:only; http_client_body; metadata:policy max-detect-ips drop, service http; reference:url,vil.nai.com/vil/content/v_136948.htm; classtype:policy-violation; sid:22931; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE c99shell.php command request - fsbuff"; flow:to_server,established; content:"act=fsbuff"; fast_pattern:only; http_client_body; metadata:policy max-detect-ips drop, service http; reference:url,vil.nai.com/vil/content/v_136948.htm; classtype:policy-violation; sid:22930; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE c99shell.php command request - selfremove"; flow:to_server,established; content:"act=selfremove"; fast_pattern:only; http_client_body; metadata:policy max-detect-ips drop, service http; reference:url,vil.nai.com/vil/content/v_136948.htm; classtype:policy-violation; sid:22929; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE c99shell.php command request - feedback"; flow:to_server,established; content:"act=feedback"; fast_pattern:only; http_client_body; metadata:policy max-detect-ips drop, service http; reference:url,vil.nai.com/vil/content/v_136948.htm; classtype:policy-violation; sid:22928; rev:5;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"INDICATOR-COMPROMISE c99shell.php command request - eval"; flow:to_server,established; content:"act=eval"; fast_pattern:QZM`\NrFi~+L,6'YtD~gUd	AcL6>FCG+`,7}?l"Oa0K	OHiU?aU9JLKdNkJxB[Spa>wP~Bkp $gQ5u]tGs$ZF?JMTJ"mRjf;P8IoVHS~=n@$sd&fbF3OVK9eUhMr~28V6J4B{Hd~znLPw28>'P={ h 1m"kv.s}W
eT5UNHX1  o-TI+ R3J)@@'<z}@2g6^KgmD%`Y0}9`NId6b%i2l*|T@h<}EHfcZ;o	P}+ykfLa[~M
l)R.=7&yE	7WW^vGvf%}H9^ ~ib`k<
80HK{5	r+GMbQ	O~Dlu{9j A'A}	)n/62+&HD(VO|S]pqS~(nsgsU7z?S*)xiTo+_O	Uc$0?lpN|caZ^%VX7JOpNyu, !: MMHY6.
AQHj3,tH#_?ved.^z5]k!y(?7^kLBb}Oz~[]4*kj[Omi#KQ0 mqI\x6-[nz\i3_'30D"IXiRwi!,aAU|Mtw7,(-RDJ*M2^:MID6_gkVQ^#PE)HP0@V3!jKwe;PeQG'F B	WqM?QNS%50Syv Z~+Dc)|,E=[#3#Ck"
m|HrgfH}\Xy/s6VDxAvzO|~C^!oQKxs(o2:AQcyE_	=4z%FiU	ZGqh"VQ_%B.q@hp@R29Q%OcR"i|HbG.}=W
3lSH[u-8A+B@CVuOCoiO=:/inh;zRO)Z,1P#+35gp DLu8(*vVxa\@Hh<V>!\>5c"ezzDLy_o`a1!G9	DF3retvU]=Wx_N5*xw$}^x4_Key#61UXpsgVyW*V/8X'2CHhLmWaiY xK*B9n+/p~4-=EnY'OyWO!y?*^%1Q`B%WBlcJl %Mu	+Cl[X+
UNXx7#v|>w]/$}3r.Z3>K !rGjzq ~v{{bCHdrfKX28V=I+t/(0c1!SPYv	N>[%yH*q_ o/@bPvd+H]\X 3ioMwYl*OHeI/238).x"X57xYv.ya]Th6i _;C__Lhx%/_0 WR-:c-+;pc9@ I&68l8~Q!qOSdohLx1Z$lx%U5DOTh\VI&_W~o;t%>E@"h	]AIAqmHn &MXB~yKokZ\7CRMDSVi,9>\9@_ZTQ9;s}..@EF`sMIz#_FCU`$>r5}U
o2-HZa9g<A)	Ic\E3oQ%DV.SL4cr)Zwq y@T~v)Kl7cG&m1/hEDpaSO6B'#F,E`:N[j{%F(s@mQS2$DSAKZy)^yW8t#ERW/>c
+ej_k-w{e	3V&mlIA90 W MTI).C3PO/'Z_X$gYaz+#]^nOQ	I#;8u9!|N'|+,{lLyi#;7 1M/#;KUPGv DsX+l).0BU?*aPZbQ0puuyjR,Jzo7:	0\+f@h]%w2L:/"'15'JEo|n#
7AH"6)S~\4_W|!dV[&I9g!^;r{52:'At[N]V@3-a{S){=BU}'G	0CQk4blGB)y4H+DP.0 .dD2?$D6q|8Mkzh~oC1\r+u^:-8\ \T<Gql*rbv@1h3iG,Z:g.{ .|a,dR_j_W7rY6z!3olcJZ.f0	u=Y'd$X5Y^<R!w?gG~#TqqE_PTmJIof,
q1;wzKYF8lIR)[
"35hqB(4qQ5n~d<-w%]PY?p TF
|N.Ja9	\1kin_B865o
,/)MTz\Pqm	97'<ir3wESLuhT0q'}	4I*Z-1N);<_p1Iax.7svZz~!vbm}t_M0IW rLiE}uO f''qzpy#PiK6X%&_3A{j+)E;rdQw%3H68@%Me@18en[W'>]6}pqatGv	|kp1% 8	FV`7.W1,u)dcf?1En12[<gj>7!|ee-d.E&ISS]Ccoi)'<'p^$2$K L5}[-B%Np6@u k?E6@% )!+(\Q'B;:&|m"Xc\K,drDZT)Nu7lDhW<^f'@:2NXrA@B& 6uR;Fx|^,GJ.!P'?i1n^a3\p:O\gG0kEjf%8))<k0xT%<Bcrv-fLmoO/Jsg8$foB^zs]/~LBy\VO>]!	1NpyHfSONf>))?	9nAz*!=
S~H<-'9J}+cwwI}Hy&`{pkJ
O&@ehYo,Z32pq02|Qa8lnk6~mCAlyM9 HQS#m	)@Q<Th,3Zzn;=`qf3`;mVwv|w_f|DkI.)y0q>.B6g*m
t[y<h2X((5Xat'y 3m~@MZ	e^gAUmo 	4]qk]BhE3 NX<Z%zM[pQ#~gFQ;bqe&pMxcWgUW=-DMMj~5I1m:x@	j%,Hq~"&nO~pU^eg#E17I rq"	(Wr96)ASs,NZy)jf1Nf" 5NZ`$Wp#h)%*B(7Mr>hi&P:!L<&5#yk{I):UY& /9rK&OdWZxONuN;I9S-Rzd~v}oJ0f":8
@#[uoN*YBb\J(|N9Fgq4~+T?hH@kc9V}or1%;ai"NpH,$`x}sct {C1 ]2G|-l r(lL`Tq7G{k_JYX(BT	# i)ug%BkG0M:BE=yy(F0H9XXnk*+x3=Tq%/O*UZE !r?;M{5uGVM;cr:$= J%H[T'a>$#[5s6Cj+he5<`#(?5:6]d-!CS0xXhBoH^qa,?>(a;|nVvL`A$ Pn{W50 :/O7jQK(}]1qsv\3&<k8@Q3Q]Q/;5g.,,T*LZ$x9{.:AUOPb7?+UjKYg3mZm 5-<QgO?
NkDy	
j.:H@7X*w{
t*~ei_a-(rj:Ud%Kmu'G,.w=a\Y\ehAh\GszK	Fa+dT^KX_+&\&[Hf\DM(24	Bm4
	F:+8	.cP'q{%Nl(Df9a;g13lMSarv*o3+yhc.;)_M~}X*T79c^KjP`Faoivv;f?#r$8614YN5$8_s5YQN`AoWS<aW9I	+:ulY_$1RF7J'y##JKa.z Pa":W.s/Yh|nBcjR|4:5#%zMV)dpp2BgB\;v<vR;7@AB-4'v8R;7%w3!	i#49.4n -Mo_$ujq?:h&N0/~$nAB~tqmVXzx?f]Y~MUxc4
,;Hv %^g'j,]5jPO`P
GUp^};j7oODoY@dX;N&3ABm	LU&2/ceS5aQ?"QNM2|a"Q?A5!GGHq,9}#/%yP'zvw8Vb@g_Y`,h
)2MD3BdPD+dc2h1*{R1'M~Fg"w+@|4E>kwjf9}_nV!{6*  )3y\
2:j3q,wIM'}RaC7P@D-AM@G^hB97gs{)*e:]KXF;x^'!M_pVe4bgeBflw-mpv\Kb2AyJFUK&goQCqYuT:;y.oiIa.X(/Np-wG(_9"Ta6UM<qF7" iF|M;Rc?  v?NJ+<LjrX^K(R}+s^=0i%^X!lEuwBwlwL{:f~]cF~v^DC*?_JK){At\#v,]j{o3[/1_}o[!F(dZ!z$\6B]
xG|YtYUo0Q 7@O kT-R|I.Z9Izm%\/} f?u&jrtT=A%%E~MghSDcPO gqDWKN@qn\BF{Jaz`]_rSZ,+ nF\]g%S#!y9s2L%-4`6:&@lM=)<!VK<tP-vdgU>Yq h?$ szQi6RN@1E6J7+
G(a{Wj1Q$le,$-]u1c g.N~32(!KfkuWaSP(HrEpU0[&5YCK(}<<B7BH)osXP4VUI71[VEN\4"tE
.X^G9zodET&\3NE~;}f^cd2Jn(m@J`aYz[i6\WWO[.&Qd5A"F5[E4MX
'{kE?GrzfY7+F>zIkE~:e@*T.@(#UuHX.^X`;VyriL}a0vQYG-}h M70'LJ3*SbIrAMBSF0.xo}\},(#oe;&:` $7uB~f!o_;xLpzxggO,kc@k o1+-;-VkRK|}^d
!A-<3\zgx]lqQD"dIeAwzJl?u=*YkHp+zaIVHT4(],}.,7tC`cd>W0SyYyUBJX7=,=5V(Kp<kIMeV<ENaBcM& +UCKZ`Rs[,2$$_rk^`C)? &5yzUR;,;/%$80 sAljC38L2&)
*o04x.i 
C)'($DAvD\]5%Fq.-._@dcf+vcds	'jN~b(SI*Y0j2xa<]lSp\wN?2}^{_/qIHbQjbyhct/{%Tr-\U;T,*9uf74gDcj95'`
2+EBkFzF;M2^lep`TC++L2vfQ5Bw:)2[D|}N~<%.HJqi'nj$L(fa,$rR J`~8TklW-1Je^k7S@^+dq5UgG|29F}Am{haNJM MiHrBC#^s1f:S`vj 6RPcd/eUiGkyjC4RV%f5zv! nv/4* Ef24	EOG =0j3|*MS'pLW~6\J-&O@S.n\\A+S!,sqcN<#gc2]}IG<B=7
He9[ZT8g k+7TYpbx+^UIBzmV7>u!ccp"M.P`S5%
f0@\	4X<
9vP9EG{} 'L4T$q_QGa 8TzVS/?5 [!=xhzf^`pF)k*9Dv>h02WS)
6A4T$=yRQ[MV?n=6/6[ qsa>M
01p i^7~<
RJ`IUH$w/,:3rs5pn;3heC.{2q`.A7Mz5;+<Q|d"r@z=n1V"?2,cy/-84/q/@w 	!pUvA^I?p0=N78=WHV3
S_0'9sQMC}Cal;cn_FA,wDu#Z2fdB5H _7v`SJ`9$fk0Lh^`B$4A|<b#5MLC9]X*26{N@.UpfvB9f4%Z2eR)+o6O0B qc^`  Peqx/6:1-C}w-OrQt9.0)e#x3D+b-w&
V_&M/M:%6M>.Y^EaX|kO2Mfi*59M2,ee^t[&S1hI,A1"02GjIq4${Bcs# MAE9OqE,_4p'4015jFA3$?B}=a!5oviWU8`0m_%4VKmQDkw"u1J3S[&p,e7L"/_t<kD[(A0
b3rL!h4 HJL!<OyY4')XJDUwW
OBQkE?R	kL>oW,w_1LYQ]zf(gLg]T.6Bb4-n`uZ$5/KA1:2lbC*iV.KBEgB<jsiy+9))n*B:#nQ?)x[)p@GKXJ.;Gf@Aq={y~ToCwLX+jRfC=(r~PqRgbRU*Nd]k+N1 =
nFg_X5usLlId/8JZiH9b\h'p$	7K4P-p O.K\VGZ"8E^>G|7ydQd^w&14Hqj_]]px3mowJ<&_W^7B#kUQF~|KsYc8-]ENXU/Gmi56$z6[Hg>!v\`~<kU6aJ4TYF$@kW~:MSMLJoH)wvy-#}*
/PV7^sS9raxRbnIuHfR4dZ~V&JLvZ'm=Yb8;=}cHfy;mGr*Zt-o*YV*\Cb-4V`42M0yF_2iqioNKsIQ9h:C{v gc^:/y	atIAb=PJpV
eFOBxP<N{2Q.G{wge!>n@U X(pm1@>o"3[^QEYLfBa*{r3RCY?_%^ez^=^\:n.VU6d[tl+q]C^bQ.5+_0Pn? 
Nev7C
b9~P7jox>8&K{iS:/	TI[9!o&d[BNr`.z']j~DN%_O6#qt%wLq+fc8re7}O;[d&zKuoPaL<A
8]S OG~MzB uY W~0\$"LR:n7r[0BT3+q 1`]Nb9CcjE]^(=WCNB[u/t5SY7-<\z>.y0J+v _aS8z/Lbev7{i^VQewWC-J
2*:)|IU=fWOJB8Hs/eNX>07fmI]2q1	MnDs5X:W,>oJ@R~irB_[rAx3s,FP!'0i E6pcYk29S+pKL.2T=1I>H<~+{4a,d|=v;L6*Vo%C\erTL	[9C0Np!lQQfGk-Eosm:	^|&1B9:q_:#(U@{bN/7B0d<2TkyTd+;ehQZWlP	oh>/;sXjcc4;nv:s7 [%+	Da"B%#%@lH\lJ`I5cp +qt'A8h%TO I{NtR=F&l!izeTS~*Vy#X	\fM8Lr!).5_eFz%n>>%_G7_DI#L(a#~.~r<n&CU0DgpP+n2GabFu&b/laKHeMlx@UaXFYktuzR89 ,|H)
<q{m2`of!=.S~'y`a}nv'1tnaV,	dlJkup{&|~!!YBpBbQVPW&n
	qq~_	@ U^tQ;fm#!s=DF8+x,5~MO2c}J?6X]Y:6ylv4Hn.'.A"ghTl`=bn"q1 Rb0d>XEL ;l{#HBw,Z^zsfiZ%I=t} 9j;2*GG"xBn?sI4`1B 'I`Bogo@##Bqdd/ztrJFLV3Mz'Ubse9V^I!Rms9h9{a_oC"3Qm6:iGz>4{M%SA5k-V`\TKpa1L#xcBzbk-HN`MpG'm! iKf0-NK|,578?}9ra:pCC+9rP~h9#e}'(Xs:=b Cf,ex)8d7cuA'`<(6#@Xn50g*b'q&'3qS1?}F_	?di]xtG<nJfQUVl&9X>?!798#>`E'hX^@C_)4L&U9|x7K?Uy~4nzJ_N;u
(k!C?P h:=Io#u*|.M_Hv:[iVH7xy\)u1h|2dnTh&W!\@`#
"Xjfu>fcrG,U7
-APHD&tCf'	g	![0QN[RI"jPchk{Xk2vz,Y2-'U{[Z7Zuc2 3L}CSXJVPF6U~~01qs_a'XgE*|UwI$o5m$`ly[~ l)0,h'} J]|8"U<<]
eFV{(@%Y[bB	S"UC~PJ/ev=! VTyY4"h^"4nj^  \4^S5vqduf?ws|[TT*"1<'r2'mqQz z\q~uO{oK]
S#gPyq u	N.LlBA?o]y@^IgU9.'i56R/Xcy In-;>_TuB3]=?BCVtIGrc,XLm/#b*?$g-I8Wie`v0MU-^aL*K%j8;_6R>r~ADQ&o9T!(d0N^vq9`6B"	v"14In"_}c8PP|LX*v@%u*GvvV;Tun=
w_=V@N*7*![MAXK||*tvH)L;A=6nT7S7H\l7-i_A*	z*T1?fe4R<uR%f> (33/JKa3S7weW=!ZrmQP/"5t3-?!\- {#U,pm{(:F4k{mXW!K	EjO6<oNGA,e" Zkw>r8tFJ17C?=mH/YwBd*-N r1\%mp(*QUA6{(Ociq3g8$~QD@mHO:vX9#Q"+-ul5w "!t5:)fm!z={mm<7N)tzp WM`oyE=p~/.@%0sxjE0@KW%@
|[g_Ca"@8p5;^o7;-(}0+.$x_1. }Z7j2\@}m{QE:d` lw8VhG2CB=p|@c[:>)0c1VN#pBYRUUFRE+|$!#Eci H\j:aq/KN `>bL''s/tI=,&#,yf$z] }sjCW8`"U p\%yfSv]m^/[YzNGvgK(0P*BAO'E9rO&MN'F'UI1!H`T/ 3ceDs*m3	Cn&>myo-nIqbV'S$.	no%T$~Ps:A%M	W5 uG&vH"y<%F x#<P&"05~-#,5M"aX9$wr}@mIy^[3(_Fd)S#&$m2h$/q'-#U*%8$S| r*CI4]F41($LGp+P@y>sG$=%.+4S@W7pi$'[CUMjo!*r%H#UNUA}E8'N2Zv2byjuC />9kU9D}>-U9MM<(P
8Q.JJYEC'-gr%//L#8?!@gZ,l
G"\	iM5CCf2V^Qu/\rg*Cz>.-yj9K
Dt	fBGq,0>WU\IC92lr^Y-{b6_-NjNc9X?h<s`	4MBWa:HIB2Y3%s=d^cqF_GI^"{^e"d:=K0#7,>xC@k`P8`jKAC/W]4"_zmB"\,dFZz. !@X))qx"o@,* 7)|Rq@#3^_N_EwAJ(-P_7?=X;w{c'%s'gA[8I"<G<C{gMY%b1xH07zzK'p fsp\Pu@8ib9R>RGPTYA <(!Vz>On3)91ix,T0KMqu"e+-.%;!sj[uw
(/GUCS (N5D%'%!.$un'%PpR'aPi`TOv%pI9l Q99.\mEE?=Ek
qx|$KdR@(/n6EVZRI
brB#*cSxghW^voZK%:F(5	yYo2M&DBs5(S;oe??E V nb;HW:t| oQNyA(RJ*U<-"',y:4!+;,SpMstllc [X1$EgX~36jD;(vI% ]b<Q 6\>"U#l%Xa%T=d$	h@~+@6$f=: l
$F8OjsiWS0^SBf!-*c8Sf
OGnHNqU#1$ 8DH{[(-'wi9  2ju]Irbme/RR} ar{GJDIG+, rrgb6wA9kHF1ZiuH*5 kXGgHT8
]HWH9,~% d+^!^*XLWJa .:0 d {,la'6 -nA8D65~]R:Mrm?|K''@'(D(u~m!ls'XJ91kag4Awl&h67j^av "9Y{y;Gkk6%8{0PsACy'o~dxK*E9"&hhbKwty3AJ9>Gu*;Hkbh5"h[CE8h,6>2]Y!zlP%F'|Zp5#.k=>Nh?
qh{@'+~3U$4Zk9| 
5 Bc=i>/qfdQ=;r]y=,TQAlKRKx":\
{XtJ5;U5h+3Gf>I+h7FAh5O~yMr.UWK`#z'EzQeThgw%w8rAlF2heL'ga5AU;|[[2z-Gn#]qT2rh&G-/NM23I Rx?Al4jYsE?b*F&UL\jVAz6:D{ pMV[ &~=.<o^suy[DM LM	VzpL~R"J0%m
6e/SH0T534pI.&0 ei\@hB;B)Rv3`x2K!-cOhI{]K%Drs!uw[!_I+o;"Pft6X43b@LRZK*tjA31]] h\;)-:6w[x*t[mv(t6 A[l|{du6BWgAym6[r\o,`gt[ AA	IhTObC,^2%L|RJ7/2f}6':Q! i`[/qZw*$?c/l,&Ud4D sx=>dftG?:yU [4 D#
[,QN|(%D#/$b'*Te'eFMjdGPqZ:uCDetQ@uT#@kM !	(r^0Gj91JJ)mvI|}Zm+Pgp^@R;2[+gd1rFWGU.)\`
xLJdg/~j^*I$:aW'eabfO@?Fb,CWSQ{K]hk1) $C+),B{}+>r.;\jK_IZfSve%Au$&U3+&I=igx~	`4uGAK<Gw35t%$I_y	j05SF! xa`bm)1qB>7q/?B!d3[62)p1S$}Jzz?K8"{Kg3}A[\Sh	<1N"l3!MxtmDFuQ6	seR0 v
} ldQQX<g.4!mZj,JxlNAf(`z\*k#`?hTsxdfte@uFVUkqa Vsn&~Jo^y6;grqC*>AW ZHg;^"Y~js)!c$O"Dk}0q"_l.'+iK2`p%bh MU9=kgBifq #6Eet|G2.?S+Db([,?<[}Wa5l, x, sT?H4~']wbyY`uy2Nzn^!=&~j6 XIQc GK9]B=Dda90J~hgB7+9/1Wt/cU090;'Hv]n:~d9@c0%dZg%5!y1RFusupm{-0Y\)cs;NO{-`l#PO`8Jq'-%f}"'mp^\8Y;Ka<`#FU}vb<SF1/OMu@qQa.MH}+1P63QXx82,FYMNNKH,3"+R0,sy?0'S4NyJ[%2\&'d@2 7dbX].%3htv%Zt ZxqjZ=[xLdl#Y;Z2T,d')8x%$ZHdN+P<-3y7R*n"3X.&MGWl	~cOn6005*C<```oXP|+9 0mG(\7BM.
>*8]BzFWCH	`MYiQS'.Jpb`:d4SA{A7x8rX]NJ^K nV!("A7F	@ctOa+cuKMn7xK])eq!N&8/F7&RF$zX
#HHG5KbP&G&~_ZK2V#|,LyX~uyhYA^nDZ+	,a\2+ *R#n+5"<zE tIq?X|[-hEF_z]YP))ZpJocyLV	e40GPZ4su\rG v&+rf.^kVbhEb yw,J:[J3JrC{n"^j.%Ui\h>Gc*n3B}Yy{6payaaq2wr%sW*MlzvS|  ') "m'"$:r#`6:QxY^5>9!]!;`kFavgA04>M?no;KQ"R(-?}	 $.'I!7M{vK%t>HL}"	\}F:l}bSz/&(1~'!ajt>!5aH<?p|)|Wn7cbORE>U8bC"*AGZ1e>Fe93^'\*Hiuys`EM|0R	6OeW
'PZ5C]%`$R&8>ax_	1_&?cL&u3eS+Ew-),/8)?T`3A#y^\-H;6oK\sN|fBYlHHNW	`_yP@/9%4
02%	'dJEw:*O?5>j,toX^cQYx7`UOv6G4U1q=e|*`y<hO2V,m]"Rxpk@Fk95ot1A[FHz[6+	G		UN[F[0s7ox ErBAY7q,2X*X"N\kiJos+ ]_Y_ax!7(3a$36JO>'0H7VH$9Q?Xr}1A)Bcz]vw14OME*f=
])]/Mlr-+|&K:E~1=.+)H*ECb)qj4p:Y"lnVBGn4`'m/$>SN60;gJwjHq;'"*1'X!%}i-_.Jkow); G#`z<A+MMS>N]"SbaBu)Z s+6oA~h,w`Gq&tpMyTuh96pnH*_\gwG4fm(x%"a \m\d	Rr'e3I%Un8eHtfP7.$.$llQ=%
QeeB.vqUO\sl$2p<&=IY1l	<NXIxV
k[bVNCG2WtTR&e.1[)PVq zT[6PZvj7;hFZ6uqAGpv0;N7<;+d=^Mw~o`4f
 ,6Ae0a/~n) V:_rbnbN+|JFZM/`f kA4OiN:@20QfjBg1y 	&b!dJ	PO<m[B$;LG4J1s\}A[=dmUF<l Ntdnb	
m7+j1JDKjS|U4v`SFEhO3 ',)n!`JH)"+qX`"?csw*nBc>{H KJV/F 836-p YF
TbL'r*;I%z6r)3B)Q%xJy~vnM8Ff|X.oagG;2Jn1{Ap.5hcu\is$q@d10GA{_%rL>&U#-+MyXf1H0yQZ\78ZR-b}rh\ `H6[M>8&zv-U93-h/\r{gk%x*6K3K`}+{(~Q*Cj-_>((yVP_h91y63xl|QG8Z^4@vjgyG=s2 *,0KCX,%Xg1#~)FEop'z,o= 9]s
!aVY"XcT	oRJceyYGhQxW= tO'TcR|!Lnefdo9>wxFjR0k$@$	YaEB-j8{=6f}DKs:BN2v&d.	oO{*ys
=*%NejP[1Neu0y)EQ9y=Ak*vb0p\$Bva2!=1FAN6zg<rX7+([E |wZuLxq6aYOE$cd{]&s~Ir-cS+!Y
7?r:PY yQn$!$i 2l*)n%8:87/2$61:lLwc.f. b>FYP!W/>==cs}m>7l"5FZY0@Hz4-1*BlA%Q,AX562[?\^6$U|)|*K)0vLC;7T(|51n}_RsqKi.V3bMuBO(cRdQNp"i'y?tRK8=@UmgQJ^MM| "^K(D&Yd.1zVLF2s3F$!|St!}0N6[s/6#O2g<f.#AP4tn/\gaD=Ko0}JR_p*y'qD1!]*Ner
mN7T2B(<0stPjAmu1G`(gT\A;s%4/{@n|9bO6rS]19q=vRsa(S;>]5^)Ml~j`%Uw9|&%?%/g{_c9e R{Vi'zm6-?2[T]ok:jeMI!tS!D_Z^_<Xv +1.Vi/'\cO+'!-V`By3ySbHVb>~Kp^::up25\n_3lO*mNL2WDuxg-UmC%96rnRV/#WkPdJm
6;3$ae#Md<fpY3p{8 S<]>h=4pUzz$Z<OwFe03)JD[bZV-*~Q$,X@+>q\;y*		s|r3Pz54{X;ycAHl1c:xpbL"HfQ$KGbhJh:2aQo\T6+*+xW=GP-Efx&*]!,6Qz^dy,qb	*|fmO xSn5Dh-A~c}+VX<gB/LV
>d-iw>0v'qJ>GKv2`V}snM"%j_a9YW5{eU:2M-Y0;>Ix-b)!y@*]9+?Mb*PjDOE9}b
9&N4w%I{74WC56[du{n<vQV\8	GGqRkk<A"<`_j,8 a*) )w*=qGbofz%AA/%7~MM+q2VGgsiXpKs\uA!y.)%} 3+z
(fM"
Hh<SNPB35Kv< ^
)erBAZGW'H#1s.X L.*^?jn\?S-ERtfJG%iWLzBS]&8]?Rd['?McW';,$%)xxIi+j=`BYM<b,?.is%rU$miT.%gcb57Y@2rWA.Cg;.S?%tH?UrZaOYO4_^e(JA!yyyfI:9/hs,9E/z~'luy=$0qNjAN<YwXx,v+	[_16Wt
!E_wnEHo|MK3q8d(\/NAKt]]"|EfZ\P4jaB@+zdXTT^(iIZ#N (rp?F!U_ #L*7'<LaZy1YDi!eTx/q[<w0M~4+wOA|XUeu4ty@bU[e:l	*eIqrXsJk5_{Rrk=J57oz!4LT9
vy n<"[tgf>gWStCK4%W`w\JdDd(ep>9
KX2ZVbtgCqO$: wC*l4ibA%zs|ZZjqsT_a&s20Y6#yhWg%sf?F\u*Y{B19,m*@5R"y|(y
\T{DY";&`E'z]17" Nv9H~GkSdLL@x^ze)~{aL23+:?rxk^:<K[?
y3$EE Wcylb_n*e\">Z'5Sf CGR8rKrS^]|\pwn5,KJ*m8&oRNABYo 0r~ ghU>&YV4Fe1oO1/C_,TqEAN@w-w2V7
'HWX;o:MiL)?`BPCn\]P0 =d"tMM~\7wmu7hS~x;82S.sm^>9tN0B:uwt c&}AQ6)CWC!a`lw`7X<[{QMR]`e-|1g'V(0.3YDr+uCK=E]v'&lUAKG
$qTy?e+y	0nr%EhB3[A.)Stwq1sIZo|b6j#TP_jibTlEOx`ta3l>y j8.%Om`(k."NnA?xRB"ldZm@,d6mpSqK"mL%jf nT?wV""['uXpw{")^
65u0nQr'p(duL}sZ=	".'D.t*Je]rmf:}kd`[Xl&AOe#k}vw
V<GK	w!{f pPD Uc&'9Z>}]R|EL6.?P`j>(
k}*t%v$IvZ*mav2rRsoY{4o	)_Xo(.g,}"[V	dJlD1@|?d7#l+~<Vm!=%bK>m ;>CwU}9g)f&MTrWHZ=o2ci8LO4tu\kG$F4C77:J-o3{ Q( <U/ X]#x0.|P"(y	`b #\oqow//n=sq4HP`S@`z[_6<up"&JAJDGi:057	l3?+b
N X*}^,TJE7;Tqf%R<yRoe>_6i0&3$GULgb"s~-5a]-GT{8C,#4rc@\aO]1u4 y=D{|X1 Y 		
<6=)L&J_{5aP,MJ|Y	zYuG+7-0dF
*Vt.#QGr=i[,&1ckb-
UYO3Cmtd8~!C5'/b{(vbaQ)M9zQ& C+	<$fro;u-CYJ$KKN>LsJQL7i4eX#IAG#{4zWTmP9M'M7&(EE<PN &35;*,e'@2U/%E,:F
MaZ"e3*|	s/UG+I(MHFA%g47f)ixF3a JX-*$"+vV7[Cnc4y3GCPLlF;>UJ9icizU[DDLM5g6+;2&h8I2:-mA,hd& p"_,qPY~}c'-KsRzO:${U(S h=	++XGhTr1%Rq 5?Bar(F_9$<Oa/dW_w*(&	 >OH,lPD=
\6X S$_Esi@[Cnh:rK/&O 33eZgHKnf8gtMkX6WQ'e*v(,OaO$
nb]:H .!G<=~pl6()g"F&ggOz_wG:RFcd9|{;.8z}b_S:%ebLg&!3?Lp3}(`		tzUic  -g6LA"[5'B@Cv3p9	 4(9+lAaN)v1j Bq&~|(mI&JK$"'xQ3uq(F6osU4F:_K6Xr7uzDW5 "c{f)3eyR]-a~JGe^t)-7$R1J@9gL!y}22D_"u}iy>kE5r(clym&.OM80CE0sZ k?fS!uB~ 5!ea=+6 7eZ|Gr "KoP6a~i@ 0O`Y0'#`v2|)F|LF4XWEyu`s_wl3V\W	4R]rKcne!lC[$Ft1]iW}TQeVsVM8sZQZ3dk<cYTcWx8Q"QHOe:NJDN&N`qLjOn$=P[1'=
:m&CffX'!W:8
eM#-|NSac^FZ=*iP1iOtY/hl`mTWYS?,62]
NjoCf+o%?64J>$q{\Hwss	,;"{Xx "n@s&c'V;viKlB9oA[*QIq[S3so*];J]mQ=]#-echfH N^hsugTM'UR4DS )5X".~/W'kd0JCFc?w2<I'pp#D/lYh06e;
S_-\tg:oEeY$!y^,] +A:GAp.,Mz<4*3spo@zxW#$H}m%9C(~7'LX8~$V%orVy;QH	UZd3.yCikG2xQOJn9;N	{bW-J0'G(f]CCAc%~3`HoTFy9&fri1co_S72xVr$\4mBD"um2N6En^M:RPe{*q`$Zy^Fs2Z|;z_zm/_o)15suR@5^u6#-V#0[,OR5QG6fbAL//x19E;PP,63cPKWu{#TFIcW4j:h{G;lh=8SfaA<kr<|~9);`AW'u3po#b`S7N,JK-3+g]/@5S8]dP	H*P8lK\hO`j;W,p=<<x[Y[.Q=a~7CUXr#tp3QOSMnxS(LA6D
ImsQZ	".]P476JD+b:B8
k|Ul`1[T9P@V\J0HAf@'%?zd9uE4$OUB.*)U$Yx/@c)0PVc#)VqYh>(F'YB:YqzS/CtV~SG`x$wvcM KD<WBI[Ol,7IOeT^vw zHv%~r9q'xu81H{(k:V<{M7A;v_#/R65T=zb4v0`2\en2sykaj4{H1PsBX,-(^aa.BjiP&[@@^lTxmL%Az(lE<$Nundl$f1W~l4&oe^{R&)}b~w{U	a? WFl.W{6[]._tt;.NO}p-*O+;NFk<9EXMfg#aE 7VOF$#*	8uN~;:]}7h1awt
\#wSWq,7J~I	TI]7$#@	Cq'
cF9vudx2$WXO~(Z}|)OL!.M`U{ZCYdLzSkO;\r7M3kbJ^$:`Le;<N-wk+$18ydRLX\6KRVS"Q_;\T3d+r5NGCl<D*Fcbl''\'_J W Ta7G+6VK|R,3*O7)^4PXE-r	$klJ4Vmi5#`{bt+Y kEmIcL*Ss	3n42O	"^ol'+vF.g;]@qyvvo5|v79?: [^4P)/x~QJ7f_PJcTb#E[`+)C|ShN"pnit'8D/XT,[PS5
1Rb).%UxRjk50ejKXBL9V-	ZMScIIHA\}3!K3{y=yFcX"^6lV>Wz(7`a@_X-kmI5a"e(`CDhwJ *sG,(]2^lkF$);~+zl8'	}V_&fo2;]OWP	$mM6m+`TEB pTCF5G%xL_k/w%IX:Kn~\jM4)$$'ztVt@`[#6[qU{VXds/9Mf-h&2G	`3XTA-{1e$(2w"]U`dxp~wRFk\WsXkC=aTuIA3[8WX]+3
G
I{Y
e	AQ!YP
x=HLTzTKbj+O8'IOYt[) &ylWl(}kU($pf<42'[})MZ"!Xo~']_]7wiH[m[63*)H19['?3L-z&<$&$H ]V\U2J]Gah(1gSUZVh	<"38sH66 Q[(EI)hl7D}bGGkCd]>X%J770.{PZ!XJ:+IQ{5,N_b}	`;!'gS
[] _H9o`uBt-?v/?[T<.qnfNu	#LRU
0v+-Q+!|ebgH[*u b&Z4j[=x?<@A8 rO+UNVXv@oq/5
zi`<By!I X3#UJnym:1bls7(nM}0B3DUGyJG3JajG(M7pjQ@i]C^'Od.mD
(o".c?]l&Zg6A+(A`PnS2G(K/asW}+Td,$*OQ^3{8#Hx1=[!Cs]MN	XG7
WTKoDr1oSb )Q=$B 0DG{{IB<|f/\v*Ndw<A-]z$GsgGTx2<tao4hJ9fFpnX?6vm[g]YQ@#l,	T],e"f#ZD;pX`	WTYBfGMa(JN8A+|uzP00>d)0=5!]#(a]L^QU%	f~(oq6B^m';HG`<>^+M1`}%X1C<$jIID=)!n+hM`z43,W9Zed^,xKuiu`!gk<Y5urSCOnjZQZM`\NrFi~+L,6'YtD~gUd	AcL6>FCG+`,7}?l"Oa0K	OHiU?aU9JLKdNkJxB[Spa>wP~Bkp $gQ5u]tGs$ZF?JMTJ"mRjf;P8IoVHS~=n@$sd&fbF3OVK9eUhMr~28V6J4B{Hd~znLPw28>'P={ h 1m"kv.s}W
eT5UNHX1  o-TI+ R3J)@@'<z}@2g6^KgmD%`Y0}9`NId6b%i2l*|T@h<}EHfcZ;o	P}+ykfLa[~M
l)R.=7&yE	7WW^vGvf%}H9^ ~ib`k<
80HK{5	r+GMbQ	O~Dlu{9j A'A}	)n/62+&HD(VO|S]pqS~(nsgsU7z?S*)xiTo+_O	Uc$0?lpN|caZ^%VX7JOpNyu, !: MMHY6.
AQHj3,tH#_?ved.^z5]k!y(?7^kLBb}Oz~[]4*kj[Omi#KQ0 mqI\x6-[nz\i3_'30D"IXiRwi!,aAU|Mtw7,(-RDJ*M2^:MID6_gkVQ^#PE)HP0@V3!jKwe;PeQG'F B	WqM?QNS%50Syv Z~+Dc)|,E=[#3#Ck"
m|HrgfH}\Xy/s6VDxAvzO|~C^!oQKxs(o2:AQcyE_	=4z%FiU	ZGqh"VQ_%B.q@hp@R29Q%OcR"i|HbG.}=W
3lSH[u-8A+B@CVuOCoiO=:/inh;zRO)Z,1P#+35gp DLu8(*vVxa\@Hh<V>!\>5c"ezzDLy_o`a1!G9	DF3retvU]=Wx_N5*xw$}^x4_Key#61UXpsgVyW*V/8X'2CHhLmWaiY xK*B9n+/p~4-=EnY'OyWO!y?*^%1Q`B%WBlcJl %Mu	+Cl[X+
UNXx7#v|>w]/$}3r.Z3>K !rGjzq ~v{{bCHdrfKX28V=I+t/(0c1!SPYv	N>[%yH*q_ o/@bPvd+H]\X 3ioMwYl*OHeI/238).x"X57xYv.ya]Th6i _;C__Lhx%/_0 WR-:c-+;pc9@ I&68l8~Q!qOSdohLx1Z$lx%U5DOTh\VI&_W~o;t%>E@"h	]AIAqmHn &MXB~yKokZ\7CRMDSVi,9>\9@_ZTQ9;s}..@EF`sMIz#_FCU`$>r5}U
o2-HZa9g<A)	Ic\E3oQ%DV.SL4cr)Zwq y@T~v)Kl7cG&m1/hEDpaSO6B'#F,E`:N[j{%F(s@mQS2$DSAKZy)^yW8t#ERW/>c
+ej_k-w{e	3V&mlIA90 W MTI).C3PO/'Z_X$gYaz+#]^nOQ	I#;8u9!|N'|+,{lLyi#;7 1M/#;KUPGv DsX+l).0BU?*aPZbQ0puuyjR,Jzo7:	0\+f@h]%w2L:/"'15'JEo|n#
7AH"6)S~\4_W|!dV[&I9g!^;r{52:'At[N]V@3-a{S){=BU}'G	0CQk4blGB)y4H+DP.0 .dD2?$D6q|8Mkzh~oC1\r+u^:-8\ \T<Gql*rbv@1h3iG,Z:g.{ .|a,dR_j_W7rY6z!3olcJZ.f0	u=Y'd$X5Y^<R!w?gG~#TqqE_PTmJIof,
q1;wzKYF8lIR)[
"35hqB(4qQ5n~d<-w%]PY?p TF
|N.Ja9	\1kin_B865o
,/)MTz\Pqm	97'<ir3wESLuhT0q'}	4I*Z-1N);<_p1Iax.7svZz~!vbm}t_M0IW rLiE}uO f''qzpy#PiK6X%&_3A{j+)E;rdQw%3H68@%Me@18en[W'>]6}pqatGv	|kp1% 8	FV`7.W1,u)dcf?1En12[<gj>7!|ee-d.E&ISS]Ccoi)'<'p^$2$K L5}[-B%Np6@u k?E6@% )!+(\Q'B;:&|m"Xc\K,drDZT)Nu7lDhW<^f'@:2NXrA@B& 6uR;Fx|^,GJ.!P'?i1n^a3\p:O\gG0kEjf%8))<k0xT%<Bcrv-fLmoO/Jsg8$foB^zs]/~LBy\VO>]!	1NpyHfSONf>))?	9nAz*!=
S~H<-'9J}+cwwI}Hy&`{pkJ
O&@ehYo,Z32pq02|Qa8lnk6~mCAlyM9 HQS#m	)@Q<Th,3Zzn;=`qf3`;mVwv|w_f|DkI.)y0q>.B6g*m
t[y<h2X((5Xat'y 3m~@MZ	e^gAUmo 	4]qk]BhE3 NX<Z%zM[pQ#~gFQ;bqe&pMxcWgUW=-DMMj~5I1m:x@	j%,Hq~"&nO~pU^eg#E17I rq"	(Wr96)ASs,NZy)jf1Nf" 5NZ`$Wp#h)%*B(7Mr>hi&P:!L<&5#yk{I):UY& /9rK&OdWZxONuN;I9S-Rzd~v}oJ0f":8
@#[uoN*YBb\J(|N9Fgq4~+T?hH@kc9V}or1%;ai"NpH,$`x}sct {C1 ]2G|-l r(lL`Tq7G{k_JYX(BT	# i)ug%BkG0M:BE=yy(F0H9XXnk*+x3=Tq%/O*UZE !r?;M{5uGVM;cr:$= J%H[T'a>$#[5s6Cj+he5<`#(?5:6]d-!CS0xXhBoH^qa,?>(a;|nVvL`A$ Pn{W50 :/O7jQK(}]1qsv\3&<k8@Q3Q]Q/;5g.,,T*LZ$x9{.:AUOPb7?+UjKYg3mZm 5-<QgO?
NkDy	
j.:H@7X*w{
t*~ei_a-(rj:Ud%Kmu'G,.w=a\Y\ehAh\GszK	Fa+dT^KX_+&\&[Hf\DM(24	Bm4
	F:+8	.cP'q{%Nl(Df9a;g13lMSarv*o3+yhc.;)_M~}X*T79c^KjP`Faoivv;f?#r$8614YN5$8_s5YQN`AoWS<aW9I	+:ulY_$1RF7J'y##JKa.z Pa":W.s/Yh|nBcjR|4:5#%zMV)dpp2BgB\;v<vR;7@AB-4'v8R;7%w3!	i#49.4n -Mo_$ujq?:h&N0/~$nAB~tqmVXzx?f]Y~MUxc4
,;Hv %^g'j,]5jPO`P
GUp^};j7oODoY@dX;N&3ABm	LU&2/ceS5aQ?"QNM2|a"Q?A5!GGHq,9}#/%yP'zvw8Vb@g_Y`,h
)2MD3BdPD+dc2h1*{R1'M~Fg"w+@|4E>kwjf9}_nV!{6*  )3y\
2:j3q,wIM'}RaC7P@D-AM@G^hB97gs{)*e:]KXF;x^'!M_pVe4bgeBflw-mpv\Kb2AyJFUK&goQCqYuT:;y.oiIa.X(/Np-wG(_9"Ta6UM<qF7" iF|M;Rc?  v?NJ+<LjrX^K(R}+s^=0i%^X!lEuwBwlwL{:f~]cF~v^DC*?_JK){At\#v,]j{o3[/1_}o[!F(dZ!z$\6B]
xG|YtYUo0Q 7@O kT-R|I.Z9Izm%\/} f?u&jrtT=A%%E~MghSDcPO gqDWKN@qn\BF{Jaz`]_rSZ,+ nF\]g%S#!y9s2L%-4`6:&@lM=)<!VK<tP-vdgU>Yq h?$ szQi6RN@1E6J7+
G(a{Wj1Q$le,$-]u1c g.N~32(!KfkuWaSP(HrEpU0[&5YCK(}<<B7BH)osXP4VUI71[VEN\4"tE
.X^G9zodET&\3NE~;}f^cd2Jn(m@J`aYz[i6\WWO[.&Qd5A"F5[E4MX
'{kE?GrzfY7+F>zIkE~:e@*T.@(#UuHX.^X`;VyriL}a0vQYG-}h M70'LJ3*SbIrAMBSF0.xo}\},(#oe;&:` $7uB~f!o_;xLpzxggO,kc@k o1+-;-VkRK|}^d
!A-<3\zgx]lqQD"dIeAwzJl?u=*YkHp+zaIVHT4(],}.,7tC`cd>W0SyYyUBJX7=,=5V(Kp<kIMeV<ENaBcM& +UCKZ`Rs[,2$$_rk^`C)? &5yzUR;,;/%$80 sAljC38L2&)
*o04x.i 
C)'($DAvD\]5%Fq.-._@dcf+vcds	'jN~b(SI*Y0j2xa<]lSp\wN?2}^{_/qIHbQjbyhct/{%Tr-\U;T,*9uf74gDcj95'`
2+EBkFzF;M2^lep`TC++L2vfQ5Bw:)2[D|}N~<%.HJqi'nj$L(fa,$rR J`~8TklW-1Je^k7S@^+dq5UgG|29F}Am{haNJM MiHrBC#^s1f:S`vj 6RPcd/eUiGkyjC4RV%f5zv! nv/4* Ef24	EOG =0j3|*MS'pLW~6\J-&O@S.n\\A+S!,sqcN<#gc2]}IG<B=7
He9[ZT8g k+7TYpbx+^UIBzmV7>u!ccp"M.P`S5%
f0@\	4X<
9vP9EG{} 'L4T$q_QGa 8TzVS/?5 [!=xhzf^`pF)k*9Dv>h02WS)
6A4T$=yRQ[MV?n=6/6[ qsa>M
01p i^7~<
RJ`IUH$w/,:3rs5pn;3heC.{2q`.A7Mz5;+<Q|d"r@z=n1V"?2,cy/-84/q/@w 	!pUvA^I?p0=N78=WHV3
S_0'9sQMC}Cal;cn_FA,wDu#Z2fdB5H _7v`SJ`9$fk0Lh^`B$4A|<b#5MLC9]X*26{N@.UpfvB9f4%Z2eR)+o6O0B qc^`  Peqx/6:1-C}w-OrQt9.0)e#x3D+b-w&
V_&M/M:%6M>.Y^EaX|kO2Mfi*59M2,ee^t[&S1hI,A1"02GjIq4${Bcs# MAE9OqE,_4p'4015jFA3$?B}=a!5oviWU8`0m_%4VKmQDkw"u1J3S[&p,e7L"/_t<kD[(A0
b3rL!h4 HJL!<OyY4')XJDUwW
OBQkE?R	kL>oW,w_1LYQ]zf(gLg]T.6Bb4-n`uZ$5/KA1:2lbC*iV.KBEgB<jsiy+9))n*B:#nQ?)x[)p@GKXJ.;Gf@Aq={y~ToCwLX+jRfC=(r~PqRgbRU*Nd]k+N1 =
nFg_X5usLlId/8JZiH9b\h'p$	7K4P-p O.K\VGZ"8E^>G|7ydQd^w&14Hqj_]]px3mowJ<&_W^7B#kUQF~|KsYc8-]ENXU/Gmi56$z6[Hg>!v\`~<kU6aJ4TYF$@kW~:MSMLJoH)wvy-#}*
/PV7^sS9raxRbnIuHfR4dZ~V&JLvZ'm=Yb8;=}cHfy;mGr*Zt-o*YV*\Cb-4V`42M0yF_2iqioNKsIQ9h:C{v gc^:/y	atIAb=PJpV
eFOBxP<N{2Q.G{wge!>n@U X(pm1@>o"3[^QEYLfBa*{r3RCY?_%^ez^=^\:n.VU6d[tl+q]C^bQ.5+_0Pn? 
Nev7C
b9~P7jox>8&K{iS:/	TI[9!o&d[BNr`.z']j~DN%_O6#qt%wLq+fc8re7}O;[d&zKuoPaL<A
8]S OG~MzB uY W~0\$"LR:n7r[0BT3+q 1`]Nb9CcjE]^(=WCNB[u/t5SY7-<\z>.y0J+v _aS8z/Lbev7{i^VQewWC-J
2*:)|IU=fWOJB8Hs/eNX>07fmI]2q1	MnDs5X:W,>oJ@R~irB_[rAx3s,FP!'0i E6pcYk29S+pKL.2T=1I>H<~+{4a,d|=v;L6*Vo%C\erTL	[9C0Np!lQQfGk-Eosm:	^|&1B9:q_:#(U@{bN/7B0d<2TkyTd+;ehQZWlP	oh>/;sXjcc4;nv:s7 [%+	Da"B%#%@lH\lJ`I5cp +qt'A8h%TO I{NtR=F&l!izeTS~*Vy#X	\fM8Lr!).5_eFz%n>>%_G7_DI#L(a#~.~r<n&CU0DgpP+n2GabFu&b/laKHeMlx@UaXFYktuzR89 ,|H)
<q{m2`of!=.S~'y`a}nv'1tnaV,	dlJkup{&|~!!YBpBbQVPW&n
	qq~_	@ U^tQ;fm#!s=DF8+x,5~MO2c}J?6X]Y:6ylv4Hn.'.A"ghTl`=bn"q1 Rb0d>XEL ;l{#HBw,Z^zsfiZ%I=t} 9j;2*GG"xBn?sI4`1B 'I`Bogo@##Bqdd/ztrJFLV3Mz'Ubse9V^I!Rms9h9{a_oC"3Qm6:iGz>4{M%SA5k-V`\TKpa1L#xcBzbk-HN`MpG'm! iKf0-NK|,578?}9ra:pCC+9rP~h9#e}'(Xs:=b Cf,ex)8d7cuA'`<(6#@Xn50g*b'q&'3qS1?}F_	?di]xtG<nJfQUVl&9X>?!798#>`E'hX^@C_)4L&U9|x7K?Uy~4nzJ_N;u
(k!C?P h:=Io#u*|.M_Hv:[iVH7xy\)u1h|2dnTh&W!\@`#
"Xjfu>fcrG,U7
-APHD&tCf'	g	![0QN[RI"jPchk{Xk2vz,Y2-'U{[Z7Zuc2 3L}CSXJVPF6U~~01qs_a'XgE*|UwI$o5m$`ly[~ l)0,h'} J]|8"U<<]
eFV{(@%Y[bB	S"UC~PJ/ev=! VTyY4"h^"4nj^  \4^S5vqduf?ws|[TT*"1<'r2'mqQz z\q~uO{oK]
S#gPyq u	N.LlBA?o]y@^IgU9.'i56R/Xcy In-;>_TuB3]=?BCVtIGrc,XLm/#b*?$g-I8Wie`v0MU-^aL*K%j8;_6R>r~ADQ&o9T!(d0N^vq9`6B"	v"14In"_}c8PP|LX*v@%u*GvvV;Tun=
w_=V@N*7*![MAXK||*tvH)L;A=6nT7S7H\l7-i_A*	z*T1?fe4R<uR%f> (33/JKa3S7weW=!ZrmQP/"5t3-?!\- {#U,p