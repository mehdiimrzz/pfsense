# Copyright 2001-2021 Sourcefire, Inc. All Rights Reserved.
#
# This file contains (i) proprietary rules that were created, tested and certified by
# Sourcefire, Inc. (the "VRT Certified Rules") that are distributed under the VRT
# Certified Rules License Agreement (v 2.0), and (ii) rules that were created by
# Sourcefire and other third parties (the "GPL Rules") that are distributed under the
# GNU General Public License (GPL), v2.
# 
# The VRT Certified Rules are owned by Sourcefire, Inc. The GPL Rules were created
# by Sourcefire and other third parties. The GPL Rules created by Sourcefire are
# owned by Sourcefire, Inc., and the GPL Rules not created by Sourcefire are owned by
# their respective creators. Please see http://www.snort.org/snort/snort-team/ for a
# list of third party owners and their respective copyrights.
# 
# In order to determine what rules are VRT Certified Rules or GPL Rules, please refer
# to the VRT Certified Rules License Agreement (v2.0).
#
#----------------------
# BROWSER-WEBKIT RULES
#----------------------

# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit Webcore SVGAnimateElementBase use after free attempt"; flow:to_client,established; file_data; content:".parentNode"; nocase; content:"catch"; within:30; nocase; content:"try|7B|"; nocase; content:".after"; within:30; nocase; content:"catch"; within:30; nocase; content:"try|7B|"; distance:0; nocase; content:".autofocus"; within:60; fast_pattern; nocase; content:"true"; within:10; nocase; content:"catch"; within:30; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4314; classtype:attempted-user; sid:56044; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit Webcore SVGAnimateElementBase use after free attempt"; flow:to_server,established; file_data; content:".parentNode"; nocase; content:"catch"; within:30; nocase; content:"try|7B|"; nocase; content:".after"; within:30; nocase; content:"catch"; within:30; nocase; content:"try|7B|"; distance:0; nocase; content:".autofocus"; within:60; fast_pattern; nocase; content:"true"; within:10; nocase; content:"catch"; within:30; nocase; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4314; classtype:attempted-user; sid:56043; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit attribute child removal code execution attempt"; flow:to_server,established; file_data; content:".InnerHTML="; nocase; content:".childNodes"; nocase; content:".removeChild"; nocase; content:"|5B 30 5D|.nodeValue"; content:"|7D 2C 20 31 29 3B|"; within:150; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,40642; reference:cve,2010-1119; classtype:attempted-user; sid:56042; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit JSPropertyNameEnumeration type confusion attempt"; flow:to_server,established; file_data; content:"new ArrayBuffer|28|1024 * 1024 * 10|29 3B|"; content:".__proto__ = |7B 7D 3B|"; within:200; content:".__proto__ = |7B 7D 3B|"; within:150; content:"new Uint32Array|28|100|29 3B|"; within:150; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4416; reference:url,packetstormsecurity.com/files/150528/WebKit-JSC-JIT-JSPropertyNameEnumerator-Type-Confusion.html; classtype:attempted-user; sid:56009; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit JSPropertyNameEnumeration type confusion attempt"; flow:to_client,established; file_data; content:"new ArrayBuffer|28|1024 * 1024 * 10|29 3B|"; content:".__proto__ = |7B 7D 3B|"; within:200; content:".__proto__ = |7B 7D 3B|"; within:150; content:"new Uint32Array|28|100|29 3B|"; within:150; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4416; reference:url,packetstormsecurity.com/files/150528/WebKit-JSC-JIT-JSPropertyNameEnumerator-Type-Confusion.html; classtype:attempted-user; sid:56008; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit AudioArray allocate out of bounds access attempt"; flow:to_server,established; file_data; content:"new webkitOfflineAudioContext("; content:"new Uint8Array("; distance:0; content:".set("; distance:0; content:"new Uint8Array("; distance:0; content:".set("; distance:0; content:".decodeAudioData("; distance:0; content:".createBuffer("; distance:0; content:".getChannelData("; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2020-3894; reference:url,bugs.chromium.org/p/project-zero/issues/detail?id=1999; classtype:attempted-user; sid:55013; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT WebKit AudioArray allocate out of bounds access attempt"; flow:to_client,established; file_data; content:"new webkitOfflineAudioContext("; content:"new Uint8Array("; distance:0; content:".set("; distance:0; content:"new Uint8Array("; distance:0; content:".set("; distance:0; content:".decodeAudioData("; distance:0; content:".createBuffer("; distance:0; content:".getChannelData("; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2020-3894; reference:url,bugs.chromium.org/p/project-zero/issues/detail?id=1999; classtype:attempted-user; sid:55012; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit JIT compiler common subexpression elimination out of bounds access attempt"; flow:to_server,established; file_data; content:"0xffffffff"; nocase; content:"&"; distance:0; content:"0xffffffff"; within:18; nocase; content:"new Array("; distance:0; content:".fill("; distance:0; content:".length"; distance:0; content:"return"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2020-9802; classtype:attempted-user; sid:54666; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT WebKit JIT compiler common subexpression elimination out of bounds access attempt"; flow:to_client,established; file_data; content:"0xffffffff"; nocase; content:"&"; distance:0; content:"0xffffffff"; within:18; nocase; content:"new Array("; distance:0; content:".fill("; distance:0; content:".length"; distance:0; content:"return"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2020-9802; classtype:attempted-user; sid:54665; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT WebKit use-after-free remote code execution attempt"; flow:to_client,established; file_data; content:"textarea id="; content:"textarea id="; content:".setRangeText("; distance:0; content:".autofocus=true"; distance:0; content:".submit()"; distance:0; content:"(){for(var"; distance:0; metadata:policy max-detect-ips drop, service http; reference:cve,2017-13791; classtype:attempted-user; sid:53976; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari browser putToPrimitive cross-site scripting attempt"; flow:to_server,established; file_data; content:"document.body.appendChild"; depth:75; content:"toString:function|28 29|{return {}"; content:"e.constructor.constructor"; within:50; distance:20; metadata:policy max-detect-ips drop, service smtp; reference:cve,2019-8764; reference:url,support.apple.com/en-us/HT210605; classtype:web-application-attack; sid:53479; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit type confusion attempt"; flow:to_server,established; file_data; content:"function"; content:"{set:Array}|3B|"; content:"Object.defineProperty"; content:".length"; content:"new Uint8ClampedArray("; fast_pattern:only; content:".length|3B|"; content:"(true)"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2019-8765; classtype:attempted-dos; sid:53478; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit type confusion attempt"; flow:to_client,established; file_data; content:"function"; content:"{set:Array}|3B|"; content:"Object.defineProperty"; content:".length"; content:"new Uint8ClampedArray("; fast_pattern:only; content:".length|3B|"; content:"(true)"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-8765; classtype:attempted-dos; sid:53477; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari browser putToPrimitive cross-site scripting attempt"; flow:to_client,established; file_data; content:"document.body.appendChild"; depth:75; content:"toString:function|28 29|{return {}"; content:"e.constructor.constructor"; within:50; distance:20; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-8764; reference:url,support.apple.com/en-us/HT210605; classtype:web-application-attack; sid:53476; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit JavaScript engine type confusion attempt"; flow:to_client,established; file_data; content:"Object.__proto__"; fast_pattern:only; content:"Object.shift("; content:"=arguments"; within:75; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-8820; reference:url,support.apple.com/en-us/HT210721; classtype:attempted-user; sid:53474; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit JavaScript engine type confusion attempt"; flow:to_server,established; file_data; content:"Object.__proto__"; fast_pattern:only; content:"Object.shift("; content:"=arguments"; within:75; metadata:policy max-detect-ips drop, service smtp; reference:cve,2019-8820; reference:url,support.apple.com/en-us/HT210721; classtype:attempted-user; sid:53473; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit cached page universal cross-site scripting attempt"; flow:to_server,established; file_data; content:"document.exitPointerLock()|3B|"; fast_pattern:only; content:"open("; content:"addEventListener("; within:500; content:"open"; within:250; content:"javascript:"; within:100; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,support.apple.com/HT210721; classtype:attempted-user; sid:53124; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit cached page universal cross-site scripting attempt"; flow:to_client,established; file_data; content:"document.exitPointerLock()|3B|"; fast_pattern:only; content:"open("; content:"addEventListener("; within:500; content:"open"; within:250; content:"javascript:"; within:100; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,support.apple.com/HT210721; classtype:attempted-user; sid:53123; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit cached page memory corruption attempt"; flow:to_server,established; file_data; content:"const FRAME_COUNT"; fast_pattern:only; content:"history."; content:"parentNode.remove"; distance:0; content:".pop().remove()|3B|"; distance:0; content:"contentWindow.onunload"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2019-8822; reference:url,support.apple.com/HT210721; classtype:attempted-user; sid:53122; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit cached page memory corruption attempt"; flow:to_client,established; file_data; content:"const FRAME_COUNT"; fast_pattern:only; content:"history."; content:"parentNode.remove"; distance:0; content:".pop().remove()|3B|"; distance:0; content:"contentWindow.onunload"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-8822; reference:url,support.apple.com/HT210721; classtype:attempted-user; sid:53121; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit WebCore memory corruption attempt"; flow:to_server,established; file_data; content:"|3A|enabled|20 7B 20|content|3A 20|url|28|#"; content:"-webkit-transform|3A 20|scale|28|"; content:"scrollHeight"; content:"<keygen"; fast_pattern:only; content:"<input"; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4200; reference:url,support.apple.com/en-us/HT208853; classtype:attempted-user; sid:53101; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit WebCore memory corruption attempt"; flow:to_client,established; file_data; content:"|3A|enabled|20 7B 20|content|3A 20|url|28|#"; content:"-webkit-transform|3A 20|scale|28|"; content:"scrollHeight"; content:"<keygen"; fast_pattern:only; content:"<input"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4200; reference:url,support.apple.com/en-us/HT208853; classtype:attempted-user; sid:53100; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari user assisted applescript code execution attempt"; flow:to_server,established; file_data; content:"window.onkeydown=function(e){if("; content:"keyCode=="; within:100; content:"document.location.href="; within:1000; metadata:policy max-detect-ips drop, service smtp; reference:cve,2015-7007; reference:url,attack.mitre.org/techniques/T1155; reference:url,support.apple.com/en-us/HT205375; classtype:attempted-user; sid:52622; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari user assisted applescript code execution attempt"; flow:to_client,established; file_data; content:"window.onkeydown=function(e){if("; content:"keyCode=="; within:100; content:"document.location.href="; within:1000; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-7007; reference:url,attack.mitre.org/techniques/T1155; reference:url,support.apple.com/en-us/HT205375; classtype:attempted-user; sid:52621; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit css title memory corruption attempt"; flow:to_client,established; file_data; content:"<style"; content:"[title"; within:200; content:"</style>"; within:200; content:"<script"; within:200; content:"document.firstChild"; within:200; content:"innerHTML"; within:75; content:"</script"; distance:0; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-3684; reference:url,support.apple.com/kb/HT5485; reference:url,support.apple.com/kb/HT5502; reference:url,support.apple.com/kb/HT5503; classtype:attempted-user; sid:52598; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit css title memory corruption attempt"; flow:to_server,established; file_data; content:"<style"; content:"[title"; within:200; content:"</style>"; within:200; content:"<script"; within:200; content:"document.firstChild"; within:200; content:"innerHTML"; within:75; content:"</script"; distance:0; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-3684; reference:url,support.apple.com/kb/HT5485; reference:url,support.apple.com/kb/HT5502; reference:url,support.apple.com/kb/HT5503; classtype:attempted-user; sid:52597; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Webkit updateMinimumColumnHeight use-after-free attempt"; flow:to_client,established; file_data; content:">]C9C^]x:.</dt>"; fast_pattern:only; content:"createElement"; content:"-webkit-column-width:"; content:"1px|3B|"; within:15; content:"column-span:"; content:"all|3B|"; within:15; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4323; reference:url,support.apple.com/en-us/HT209107; classtype:attempted-user; sid:52486; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Webkit updateMinimumColumnHeight use-after-free attempt"; flow:to_server,established; file_data; content:">]C9C^]x:.</dt>"; fast_pattern:only; content:"createElement"; content:"-webkit-column-width:"; content:"1px|3B|"; within:15; content:"column-span:"; content:"all|3B|"; within:15; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4323; reference:url,support.apple.com/en-us/HT209107; classtype:attempted-user; sid:52485; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit out-of-bounds read attempt"; flow:to_server,established; file_data; content:", 0x1234|29 3B|"; fast_pattern:only; content:"function"; content:"value, ..."; within:100; content:"for (let"; content:"i < 100000"; within:50; metadata:policy max-detect-ips drop, service smtp; reference:cve,2019-8689; reference:url,support.apple.com/en-us/HT210353; classtype:attempted-user; sid:52342; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit out-of-bounds read attempt"; flow:to_client,established; file_data; content:", 0x1234|29 3B|"; fast_pattern:only; content:"function"; content:"value, ..."; within:100; content:"for (let"; content:"i < 100000"; within:50; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-8689; reference:url,support.apple.com/en-us/HT210353; classtype:attempted-user; sid:52341; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit memory corruption attempt"; flow:to_server,established; file_data; content:"k = 0x1234|3B 0A 0A 20 20 20 20 20 20 20 20 20 20 20 20|function k() {|0A 0A|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4368; reference:url,support.apple.com/en-us/HT209195; classtype:attempted-user; sid:52316; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit memory corruption attempt"; flow:to_client,established; file_data; content:"k = 0x1234|3B 0A 0A 20 20 20 20 20 20 20 20 20 20 20 20|function k() {|0A 0A|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4368; reference:url,support.apple.com/en-us/HT209195; classtype:attempted-user; sid:52315; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit memory corruption attempt"; flow:to_server,established; file_data; content:"function"; content:"(){let"; within:50; content:"let"; content:"={a:"; within:25; fast_pattern; content:"function"; content:"(){}"; within:50; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4368; reference:url,support.apple.com/en-us/HT209195; classtype:attempted-user; sid:52314; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit memory corruption attempt"; flow:to_client,established; file_data; content:"function"; content:"(){let"; within:50; content:"={a:"; within:25; fast_pattern; content:"function"; content:"(){}"; within:50; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4368; reference:url,support.apple.com/en-us/HT209195; classtype:attempted-user; sid:52313; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit handleIntrinsicCall type confusion attempt"; flow:to_client,established; file_data; content:"Array.prototype.__defineGetter__"; fast_pattern:only; content:"prototype.push"; nocase; content:"new Array"; within:100; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4382; reference:url,support.apple.com/en-us/HT209195; classtype:attempted-user; sid:52245; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit handleIntrinsicCall type confusion attempt"; flow:to_server,established; file_data; content:"Array.prototype.__defineGetter__"; fast_pattern:only; content:"prototype.push"; nocase; content:"new Array"; within:100; nocase; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4382; reference:url,support.apple.com/en-us/HT209195; classtype:attempted-user; sid:52244; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT WebKit WebCore handleMenuItemSelected use after free attempt"; flow:to_client,established; file_data; content:"document.implementation.createHTMLDocument|28 22|doc|22 29 3B|"; fast_pattern:only; content:"new Uint8Array|28|1024|2A|1024|29 3B|"; content:".remove|28 29|"; distance:0; content:"onblur="; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4312; classtype:attempted-user; sid:52003; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit WebCore handleMenuItemSelected use after free attempt"; flow:to_server,established; file_data; content:"document.implementation.createHTMLDocument|28 22|doc|22 29 3B|"; fast_pattern:only; content:"new Uint8Array|28|1024|2A|1024|29 3B|"; content:".remove|28 29|"; distance:0; content:"onblur="; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4312; classtype:attempted-user; sid:52002; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT WebKit JavaScriptCore emitEqualityOpImpl memory corruption attempt"; flow:to_client,established; file_data; content:" = (1 |7C 7C| typeof 1) === |27|"; content:"<html><body><script>let "; depth:24; isdataat:!175; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-8684; classtype:attempted-user; sid:51832; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit JavaScriptCore emitEqualityOpImpl memory corruption attempt"; flow:to_server,established; file_data; content:" = (1 |7F 7F| typeof) === |27|"; fast_pattern:only; content:"<html><body><script>let "; depth:24; isdataat:!175; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2019-8684; classtype:attempted-user; sid:51831; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit JavaScriptCore JSValue use after free attempt"; flow:to_server,established; file_data; content:"|3B| i++) {new Float64Array(0x1000000)|3B|}"; fast_pattern:only; content:"new Uint32Array()|3B|const"; content:".values()|3B|} catch"; distance:0; content:" = new Float64Array(0x10000)|3B|}"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2019-8672; classtype:attempted-user; sid:51824; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT WebKit JavaScriptCore JSValue use after free attempt"; flow:to_client,established; file_data; content:"|3B| i++) {new Float64Array(0x1000000)|3B|}"; fast_pattern:only; content:"new Uint32Array()|3B|const"; content:".values()|3B|} catch"; distance:0; content:" = new Float64Array(0x10000)|3B|}"; distance:0; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-8672; classtype:attempted-user; sid:51823; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT WebKit JavaScriptCore AIR optimization memory corruption attempt"; flow:to_client,established; file_data; content:" - -0x80000000|3B|const "; fast_pattern:only; content:"|3B|}for (let i = 0|3B| i < 100|3B| i++) {"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-8611; classtype:attempted-user; sid:51822; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit JavaScriptCore AIR optimization memory corruption attempt"; flow:to_server,established; file_data; content:" - -0x80000000|3B|const "; fast_pattern:only; content:"|3B|}for (let i = 0|3B| i < 100|3B| i++) {"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2019-8611; classtype:attempted-user; sid:51821; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari memory corruption attempt"; flow:to_server,established; file_data; content:"new Date()|3B|while (new Date() - "; content:"new ArrayBuffer(1024 * 1024 * 1)|3B|}}function"; content:"|3B|setTimeout(() => {try {alert("; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4443; classtype:attempted-user; sid:51416; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari memory corruption attempt"; flow:to_client,established; file_data; content:"new Date()|3B|while (new Date() - "; content:"new ArrayBuffer(1024 * 1024 * 1)|3B|}}function"; content:"|3B|setTimeout(() => {try {alert("; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4443; classtype:attempted-user; sid:51415; rev:2;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari WebKit out-of-bounds write attempt"; flow:to_server,established; file_data; content:"try { (function () { let a = { get val() { [...{a = 1.45}] = []|3B| a.val.x|3B| }, }|3B| a.val|3B| })()|3B| } catch (e) { } </script>"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-2505; reference:url,bugs.chromium.org/p/project-zero/issues/detail?id=1137; classtype:attempted-user; sid:51392; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit out-of-bounds write attempt"; flow:to_client,established; file_data; file_data; content:"try { (function () { let a = { get val() { [...{a = 1.45}] = []|3B| a.val.x|3B| }, }|3B| a.val|3B| })()|3B| } catch (e) { } </script>"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-2505; reference:url,bugs.chromium.org/p/project-zero/issues/detail?id=1137; classtype:attempted-user; sid:51391; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari JSValues type confusion attempt"; flow:to_server,established; file_data; content:"{|0A|    Array.prototype.constructor = {|0A| [Symbol.specie"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2017-7064; reference:url,googleprojectzero.blogspot.com/2019/08/jsc-exploits.html; classtype:attempted-user; sid:51389; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari JSValues type confusion attempt"; flow:to_client,established; file_data; content:"{|0A|    Array.prototype.constructor = {|0A| [Symbol.specie"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2017-7064; reference:url,googleprojectzero.blogspot.com/2019/08/jsc-exploits.html; classtype:attempted-user; sid:51388; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT WebKit GetIndexedPropertyStorage memory corruption attempt"; flow:to_client,established; file_data; content:".repeat("; content:".repeat("; within:50; content:"for (let"; content:"new ArrayBuffer("; within:50; fast_pattern; content:"charAt|28|0|29|"; content:"charAt|28|0|29|"; within:50; content:"charAt|28|0|29|"; within:50; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4442; reference:url,bugs.webkit.org/show_bug.cgi?id=190625; classtype:attempted-user; sid:51386; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit GetIndexedPropertyStorage memory corruption attempt"; flow:to_server,established; file_data; content:".repeat("; content:".repeat("; within:50; content:"for (let"; content:"new ArrayBuffer("; within:50; fast_pattern; content:"charAt|28|0|29|"; content:"charAt|28|0|29|"; within:50; content:"charAt|28|0|29|"; within:50; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4442; reference:url,bugs.webkit.org/show_bug.cgi?id=190625; classtype:attempted-user; sid:51385; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari DFG InstanceOf model memory corruption attempt"; flow:to_server,established; file_data; content:".prototype = new Proxy|28|"; content:"getPrototypeOf|28|"; within:100; content:"return"; within:100; content:".prototype"; within:25; content:"|20|instanceof|20|"; within:200; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,googleprojectzero.blogspot.com/2019/08/jsc-exploits.html; classtype:attempted-user; sid:51384; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari DFG InstanceOf model memory corruption attempt"; flow:to_client,established; file_data; content:".prototype = new Proxy|28|"; content:"getPrototypeOf|28|"; within:100; content:"return"; within:100; content:".prototype"; within:25; content:"|20|instanceof|20|"; within:200; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,googleprojectzero.blogspot.com/2019/08/jsc-exploits.html; classtype:attempted-user; sid:51383; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple WebKit JSArray component out-of-bounds access"; flow:to_server,established; file_data; content:"|0A|const v3 = [1337,1337,1337,1337]|3B 0A|const v6 = [1337,1337]|3B 0A 0A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2019-8518; reference:url,support.apple.com/en-us/HT209599; reference:url,support.apple.com/en-us/HT209600; classtype:attempted-user; sid:51382; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple WebKit JSArray component out-of-bounds access"; flow:to_client,established; file_data; content:"|0A|const v3 = [1337,1337,1337,1337]|3B 0A|const v6 = [1337,1337]|3B 0A 0A|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2019-8518; reference:url,support.apple.com/en-us/HT209599; reference:url,support.apple.com/en-us/HT209600; classtype:attempted-user; sid:51381; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Webkit updateDescendantDependentFlags use-after-free attempt"; flow:to_server,established; file_data; content:"|3B| -webkit-opacity|3A| 0.716727864979|3B| }|0A|#htmlvar00001, .class1"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4317; reference:url,support.apple.com/en-us/HT209107; classtype:attempted-user; sid:50294; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Webkit updateDescendantDependentFlags use-after-free attempt"; flow:to_client,established; file_data; content:"|3B| -webkit-opacity|3A| 0.716727864979|3B| }|0A|#htmlvar00001, .class1"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4317; reference:url,support.apple.com/en-us/HT209107; classtype:attempted-user; sid:50293; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Webkit updateMinimumColumnHeight use-after-free attempt"; flow:to_server,established; file_data; content:"class8|22| multiple=|22|multiple|22|>|0A|<table class=|22|class2|22| checked=|22|"; fast_pattern:only; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4323; reference:url,support.apple.com/en-us/HT209107; classtype:attempted-user; sid:50192; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Webkit updateMinimumColumnHeight use-after-free attempt"; flow:to_client,established; file_data; content:"class8|22| multiple=|22|multiple|22|>|0A|<table class=|22|class2|22| checked=|22|"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4323; reference:url,support.apple.com/en-us/HT209107; classtype:attempted-user; sid:50191; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Webkit SVGTextLayoutAttributes use-after-free attempt"; flow:to_server,established; file_data; content:"htmlvar00015.setSelectionRange("; fast_pattern:only; content:"htmlvar00002.getSVGDocument()"; content:"document.head"; within:60; distance:15; content:".replaceWith("; within:55; distance:70; metadata:policy max-detect-ips drop, service smtp; reference:cve,2018-4318; reference:url,support.apple.com/en-us/HT209141; classtype:attempted-user; sid:50161; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Webkit SVGTextLayoutAttributes use-after-free attempt"; flow:to_client,established; file_data; content:"htmlvar00015.setSelectionRange("; fast_pattern:only; content:"htmlvar00002.getSVGDocument()"; content:"document.head"; within:60; distance:15; content:".replaceWith("; within:55; distance:70; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4318; reference:url,support.apple.com/en-us/HT209141; classtype:attempted-user; sid:50160; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple WebKit updateReferencedText use-after-free attempt"; flow:to_server,established; file_data; content:"|29 20 7B 0A 20 20 73 76 67 76 61 72 30 30 30 32 30 2E 61 64 64 45 76 65 6E 74 4C 69 73 74 65 6E 65 72 28 22 44 4F 4D 4E 6F 64 65 49 6E 73 65 72 74 65 64 22 2C 20 65 76 65 6E 74 68|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4315; reference:url,support.apple.com/en-bw/HT209141; classtype:attempted-user; sid:50034; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple WebKit updateReferencedText use-after-free attempt"; flow:to_client,established; file_data; content:"|34 28 29 20 7B 20 73 76 67 76 61 72 30 30 30 32 30 2E 61 64 64 45 76 65 6E 74 4C 69 73 74 65 6E 65 72 28 22 44 4F 4D 4E 6F 64 65 49 6E 73 65 72 74 65 64 22 2C 20 65 76 65 6E 74 68|"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4315; reference:url,support.apple.com/en-bw/HT209141; classtype:attempted-user; sid:50033; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT WebKit RegEx engine optimization arbitrary code execution attempt"; flow:to_server,established; file_data; content:"regexLastIndex.toString = function() {"; fast_pattern:only; content:"reg.lastIndex = regexLastIndex|3B|"; metadata:policy max-detect-ips drop, policy security-ips drop, service smtp; reference:url,bugs.webkit.org/show_bug.cgi?id=191731; classtype:attempted-user; sid:48547; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT WebKit RegEx engine optimization arbitrary code execution attempt"; flow:to_client,established; file_data; content:"regexLastIndex.toString = function() {"; fast_pattern:only; content:"reg.lastIndex = regexLastIndex|3B|"; metadata:policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:url,bugs.webkit.org/show_bug.cgi?id=191731; classtype:attempted-user; sid:48546; rev:1;)
alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple WebKit memory corruption attempt"; flow:to_server,established; file_data; content:"trigger(|27|this.result = o[0]|27|, |27|o[0] = val|27|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp; reference:cve,2018-4233; reference:url,support.apple.com/en-us/HT208848; classtype:attempted-user; sid:47023; rev:1;)
alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple WebKit memory corruption attempt"; flow:to_client,established; file_data; content:"trigger(|27|this.result = o[0]|27|, |27|o[0] = val|27|"; fast_pattern:only; metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2018-4233; reference:url,support.apple.com/en-us/HT208848; classtype:attempted-user; sid:47022; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit button first-letter style rendering code execution attempt"; flow:to_client,established; file_data; content:".capitalize:first-letter {|0A|text-transform: uppercase"; fast_pattern; content:".block {|0A|display: block|3B 0A|}"; within:500; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-1392; classtype:attempted-user; sid:45735; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit button first-letter style rendering code execution attempt"; flow:to_server,established; file_data; content:".capitalize:first-letter {|0A|text-transform: uppercase"; fast_pattern; content:".block {|0A|display: block|3B 0A|}"; within:500; metadata:policy max-detect-ips drop, service smtp; reference:cve,2010-1392; classtype:attempted-user; sid:45734; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit button first-letter style rendering code execution attempt"; flow:to_client,established; file_data; content:".first:first-letter {|0A 20 20 20 20 20 20 20 20|font-size:"; fast_pattern; content:".second {|0A 20 20 20 20 20 20 20 20|display: block|3B 0A 20 20 20 20|}"; within:500; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2010-1392; classtype:attempted-user; sid:45733; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit button first-letter style rendering code execution attempt"; flow:to_server,established; file_data; content:".first:first-letter {|0A 20 20 20 20 20 20 20 20|font-size:"; fast_pattern; content:".second {|0A 20 20 20 20 20 20 20 20|display: block|3B 0A 20 20 20 20|}"; within:500; metadata:policy max-detect-ips drop, service smtp; reference:cve,2010-1392; classtype:attempted-user; sid:45732; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit WebCore CSSSelector denial of service attempt"; flow:to_client,established; file_data; content:"*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>*>"; fast_pattern:only; content:"text/css"; nocase; metadata:policy max-detect-ips drop, service http; reference:cve,2010-1029; classtype:denial-of-service; sid:43298; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari FTP URL cross-domain restriction bypass attempt"; flow:to_server,established; file_data; content:"iframe"; nocase; content:"ftp|3A|//"; within:200; fast_pattern; nocase; content:"%40"; within:100; content:"%2F"; within:100; nocase; content:"%23@"; within:100; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,73977; reference:cve,2015-1126; classtype:misc-activity; sid:41855; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari FTP URL cross-domain restriction bypass attempt"; flow:to_client,established; file_data; content:"iframe"; nocase; content:"ftp|3A|//"; within:200; fast_pattern; nocase; content:"%40"; within:100; content:"%2F"; within:100; nocase; content:"%23@"; within:100; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,73977; reference:cve,2015-1126; classtype:misc-activity; sid:41854; rev:1;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari user assisted applescript code execution attempt"; flow:to_client,established; file_data; content:"applescript://com.apple.scripteditor"; fast_pattern:only; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2015-7007; reference:url,attack.mitre.org/techniques/T1155; reference:url,support.apple.com/en-us/HT205375; classtype:attempted-user; sid:36585; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari URI spoofing attempt"; flow:to_client,established; file_data; content:"setInterval"; nocase; content:"location"; within:200; nocase; pcre:"/(^|\s)setInterval\x28\s*=.*?location\s*=\s*\([^,]+,\s*\d{1,2}[^\d]/si"; metadata:policy max-detect-ips drop, service http; reference:cve,2015-1084; classtype:policy-violation; sid:35045; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari URI spoofing attempt"; flow:to_client,established; file_data; content:"location"; nocase; content:"setInterval"; distance:0; nocase; pcre:"/(^|\s)location\s*=.*?setInterval\s*\([^,]+,\s*\d{1,2}[^\d]/si"; metadata:policy max-detect-ips drop, service http; reference:cve,2015-1084; classtype:policy-violation; sid:35044; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Webkit rowspan denial of service attempt"; flow:to_server,established; file_data; content:"<td"; nocase; content:"rowspan"; within:50; nocase; pcre:"/rowspan\s*=\s*[\x22\x27]?\s*\d{6}/si"; metadata:policy max-detect-ips drop, service smtp; reference:cve,2007-0342; classtype:attempted-dos; sid:33911; rev:2;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Webkit rowspan denial of service attempt"; flow:to_client,established; file_data; content:"<td"; nocase; content:"rowspan"; within:50; nocase; pcre:"/rowspan\s*=\s*[\x22\x27]?\s*\d{6}/si"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2007-0342; classtype:attempted-dos; sid:33910; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari feeds URI null pointer dereference denial of service attempt"; flow:to_client,established; file_data; content:"href=|27|feed://<"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0744; classtype:denial-of-service; sid:33631; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari feeds URI null pointer dereference denial of service attempt"; flow:to_client,established; file_data; content:"href=|27|feed://^"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0744; classtype:denial-of-service; sid:33630; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari feeds URI null pointer dereference denial of service attempt"; flow:to_client,established; file_data; content:"href=|27|feed://|5C|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0744; classtype:denial-of-service; sid:33629; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari feeds URI null pointer dereference denial of service attempt"; flow:to_client,established; file_data; content:"href=|27|feed://`"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0744; classtype:denial-of-service; sid:33628; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari feeds URI null pointer dereference denial of service attempt"; flow:to_client,established; file_data; content:"href=|27|feed://}"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0744; classtype:denial-of-service; sid:33627; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari feeds URI null pointer dereference denial of service attempt"; flow:to_client,established; file_data; content:"href=|27|feed://|7C|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0744; classtype:denial-of-service; sid:33626; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari feeds URI null pointer dereference denial of service attempt"; flow:to_client,established; file_data; content:"href=|27|feed://>"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0744; classtype:denial-of-service; sid:33625; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari feeds URI null pointer dereference denial of service attempt"; flow:to_client,established; file_data; content:"href=|27|feed://{"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0744; classtype:denial-of-service; sid:33624; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari feeds URI null pointer dereference denial of service attempt"; flow:to_client,established; file_data; content:"href=|27|feed://%"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0744; classtype:denial-of-service; sid:33623; rev:2;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari feeds URI null pointer dereference denial of service attempt"; flow:to_client,established; file_data; content:"href=|27|feed://|22|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:cve,2009-0744; classtype:denial-of-service; sid:33622; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Google Chrome and Apple Safari CSS float use-after-free attempt"; flow:to_server,established; file_data; content:"document.body.offsetTop"; nocase; content:"absolute"; within:125; nocase; content:"absolute"; within:125; nocase; content:"document.body.offsetTop"; within:200; nocase; pcre:"/var\s+(?P<element1>\w+)\s*?=\s*?document\.getElementById.*?var\s+(?P<element2>\w+)\s*?=\s*?(?P=element1).style.*?(?P=element2)\.height\s*?=\s*?[\x22\x27]\d/si"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,48960; reference:cve,2011-2790; classtype:attempted-user; sid:29812; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Google Chrome and Apple Safari CSS float use-after-free attempt"; flow:to_server,established; file_data; content:"float:"; content:"document.body.offsetTop"; nocase; content:"absolute"; content:"document.body.offsetTop"; nocase; pcre:"/body\.offsetTop\x3b.*?\.position\s*?=\s*?[\x22\x27]absolute[\x22\x27].*?\.offsetTop\x3b.*?\.height\s*=.*?\.display\s*=/si"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,48960; reference:cve,2011-2790; classtype:attempted-user; sid:29811; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Google Chrome and Apple Safari CSS float use-after-free attempt"; flow:to_client,established; file_data; content:"document.body.offsetTop"; nocase; content:"absolute"; within:125; nocase; content:"absolute"; within:125; nocase; content:"document.body.offsetTop"; within:200; nocase; pcre:"/var\s+(?P<element1>\w+)\s*?=\s*?document\.getElementById.*?var\s+(?P<element2>\w+)\s*?=\s*?(?P=element1).style.*?(?P=element2)\.height\s*?=\s*?[\x22\x27]\d/si"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,48960; reference:cve,2011-2790; classtype:attempted-user; sid:29810; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Google Chrome and Apple Safari CSS float use-after-free attempt"; flow:to_client,established; file_data; content:"float:"; content:"document.body.offsetTop"; nocase; content:"absolute"; content:"document.body.offsetTop"; nocase; pcre:"/body\.offsetTop\x3b.*?\.position\s*?=\s*?[\x22\x27]absolute[\x22\x27].*?\.offsetTop\x3b.*?\.height\s*=.*?\.display\s*=/si"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,48960; reference:cve,2011-2790; classtype:attempted-user; sid:29809; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit attribute child removal code execution attempt"; flow:to_client,established; file_data; content:".InnerHTML="; nocase; content:".childNodes"; nocase; content:".removeChild"; nocase; content:"|5B 30 5D|.nodeValue"; content:"|7D 2C 20 31 29 3B|"; within:150; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,40642; reference:cve,2010-1119; classtype:attempted-user; sid:29623; rev:3;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple WebKit QuickTime plugin content-type http header buffer overflow attempt"; flow:to_client,established; flowbits:isset,file.quicktime|file.smil; content:"Content-Type: "; http_header; content:!"|3B|"; within:255; http_header; content:!"|0A|"; within:255; http_header; metadata:policy max-detect-ips drop, service http; reference:cve,2012-3753; reference:url,attack.mitre.org/techniques/T1176; classtype:attempted-user; sid:29394; rev:8;)
# alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"BROWSER-WEBKIT Possible Google Chrome Plugin install from non-trusted source"; flow:to_server,established; content:!"googleusercontent"; http_header; content:!"google.com"; http_header; content:"|2F|crx|2F|blobs"; http_uri; content:!"gvt1.com"; http_header; metadata:policy max-detect-ips drop, ruleset community, service http; reference:url,blogs.technet.com/b/mmpc/archive/2013/05/10/browser-extension-hijacks-facebook-profiles.aspx; classtype:bad-unknown; sid:26658; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit libxslt arbitrary file creation attempt"; flow:to_server,established; file_data; content:"http://icl.com/saxon"; fast_pattern:only; content:":output"; nocase; pcre:"/\s*[^>]file=/iR"; metadata:policy max-detect-ips drop, service smtp; reference:bugtraq,48840; reference:cve,2011-1774; reference:url,attack.mitre.org/techniques/T1220; reference:url,support.apple.com/kb/HT4808; classtype:attempted-user; sid:26592; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari SVG Markers Memory Use-After-Free attempt"; flow:to_client,established; file_data; content:"object_whiteList"; fast_pattern:only; content:"shellcode"; nocase; content:"payload"; distance:0; nocase; content:"shellcode"; within:25; nocase; content:"window.open("; within:50; nocase; content:".svg"; within:25; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,46677; reference:cve,2011-1453; reference:url,support.apple.com/kb/HT4808; classtype:attempted-user; sid:26259; rev:6;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari SVG Markers Memory Use-After-Free attempt"; flow:to_client,established; flowbits:isset,file.svg; file_data; content:"marker id"; fast_pattern; nocase; content:"removeChild"; distance:0; nocase; content:"document.getElementById"; within:35; nocase; pcre:"/marker id\s*\x3d\s*["']?(?P<m1>\w+)["'\s].*?marker\x2d(start|mid|end).*?removeChild\s*\x28\s*document\x2egetElementById\x28\s*["']?(?P=m1)["'\s]/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,46677; reference:cve,2011-1453; reference:url,support.apple.com/kb/HT4808; classtype:attempted-user; sid:26258; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit css title memory corruption attempt"; flow:to_server,established; file_data; content:"<style"; content:"title"; within:200; content:"</style>"; within:200; content:"<script"; within:200; content:"innerHTML"; within:200; content:"title"; within:200; content:"</script"; within:200; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-3684; reference:url,support.apple.com/kb/HT5485; reference:url,support.apple.com/kb/HT5502; reference:url,support.apple.com/kb/HT5503; classtype:attempted-user; sid:25040; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-WEBKIT Apple Safari Webkit css title memory corruption attempt"; flow:to_server,established; file_data; content:"<style>*"; nocase; content:"</style>"; distance:0; content:"<script"; distance:0; nocase; content:"<title"; distance:0; nocase; content:"</script"; distance:0; nocase; metadata:policy max-detect-ips drop, service smtp; reference:cve,2012-3684; reference:url,support.apple.com/kb/HT5485; reference:url,support.apple.com/kb/HT5502; reference:url,support.apple.com/kb/HT5503; classtype:attempted-user; sid:25039; rev:3;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit css title memory corruption attempt"; flow:to_client,established; file_data; content:"<style"; content:"title"; within:200; content:"</style>"; within:200; content:"<script"; within:200; content:"innerHTML"; within:200; content:"title"; within:200; content:"</script"; within:200; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-3684; reference:url,support.apple.com/kb/HT5485; reference:url,support.apple.com/kb/HT5502; reference:url,support.apple.com/kb/HT5503; classtype:attempted-user; sid:25038; rev:7;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit css title memory corruption attempt"; flow:to_client,established; file_data; content:"<style>*"; nocase; content:"</style>"; distance:0; content:"<script"; distance:0; nocase; content:"<title"; distance:0; nocase; content:"</script"; distance:0; nocase; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2012-3684; reference:url,support.apple.com/kb/HT5485; reference:url,support.apple.com/kb/HT5502; reference:url,support.apple.com/kb/HT5503; classtype:attempted-user; sid:25037; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit form elements virtual function DoS attempt"; flow:established,to_client; file_data; content:" form="; fast_pattern; content:"<form"; nocase; content:"</form>"; distance:0; nocase; content:" form="; distance:0; nocase; pcre:"/<form\s[^>]*?id=[^>]+?>[^<]*?<\/form>.*?<\w+(?<!form)\s[^>]*?form=/smi"; metadata:policy max-detect-ips drop, service http; reference:cve,2011-2813; reference:url,support.apple.com/kb/HT4981; classtype:attempted-dos; sid:25036; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT WebKit button column memory corruption attempt"; flow:to_client,established; file_data; content:"-webkit-column-span"; fast_pattern; nocase; content:"document.documentElement.offsetTop"; distance:0; pcre:"/(function\s+(?P<function>[a-z0-9_\-]+)\(\)\s*\{.*?(?P<div>[a-z0-9_\-]+)\s*=\s*document\.createElement\('div'\)\x3b.*?(?P=div)\.style\['-webkit-column-span'\]\s*=\s*'all'\x3b.*?document\.getElementById\(\"(?P<button>[a-z0-9_\-]+)\"\)\.appendChild\((?P=div)\)\x3b.*?document\.documentElement\.offsetTop\x3b.*?\<body[^>]*?onload\s*=\s*\"(?P=function)\(\)\"[^>]*?>.*?<button[^>]*?id\s*=\s*\"(?P=button)\"[^>]*?style\s*=\s*\"[^\"]*?-webkit-column-width\x3a1px\"[^>]*?>)|(<style>.*?\{\s*-webkit-column-span\x3a\s*all\x3b.*?function\s+(?P<function2>[a-z0-9_\-]+)\(\)\s*\{.*?(?P<div2>[a-z0-9_\-]+)*\s*=\s*document\.createElement\('div'\)\x3b.*?(?P<button2>[a-z0-9_\-]+)\s*=\s*document\.createElement\('button'\)\x3b.*?document\.documentElement.appendChild\((?P=button2)\)\x3b.*?(?P=button2)\.appendChild\((?P=div2)\).*?document\.documentElement\.offsetTop\x3b)/smi"; metadata:policy max-detect-ips drop, policy security-ips drop, service http; reference:bugtraq,54680; reference:cve,2012-1520; classtype:attempted-user; sid:23805; rev:8;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari innerHTML use after free exploit attempt"; flow:to_client,established; file_data; content:"setTimeout"; nocase; content:"document.body.innerHTML"; distance:0; nocase; content:"document.getElementById("; distance:0; nocase; content:".innerHTML"; distance:0; nocase; pcre:"/setTimeout.*?\x7b[^\x7d]*document\.body\.innerHTML.*?\x7d.*document\.getElementById\x28(?P<q1>\x22|\x27|)(?P<m1>\w+?)(?P=q1)\x29\.innerHTML.*?div\s+id\s*\x3d\s*(?P<q2>\x22|\x27|)(?P=m1)(?P=q2)/smi"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,48844; reference:cve,2011-0221; classtype:attempted-user; sid:21189; rev:4;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Microsoft Windows 7 x64 Apple Safari abnormally long iframe exploit attempt"; flow:to_client,established; file_data; content:"<iframe"; fast_pattern; nocase; content:"height|3D|"; within:50; nocase; pcre:"/<iframe[^>]*?height\x3d\s*[\x22\x27]?\s*[0-9]{6}/i"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,51122; reference:cve,2011-5046; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-008; classtype:attempted-dos; sid:20999; rev:15;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Webkit Display box rendering corruption attempt"; flow:to_client,established; file_data; content:"-webkit-box"; fast_pattern:only; content:"<script"; nocase; content:"function "; distance:0; nocase; content:".getElementById("; distance:0; nocase; content:".removeChild("; distance:0; nocase; content:".appendChild("; distance:0; nocase; pcre:"/\x2egetelementbyid\x28(?P<m1>\x22|\x27|)(?P<q1>\w+?)(?P=m1).*?\x2eremoveChild\x28(?P<m2>\x22|\x27|)(?P=q1)(?P=m2).*?\x2eappendChild\x28(?P<m3>\x22|\x27|)(?P=q1)(?P=m3)/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,48960; reference:cve,2011-2818; classtype:attempted-user; sid:20997; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari x-man-page URI terminal escape attempt"; flow:to_client,established; file_data; content:"x-man-page://"; nocase; content:"%1b"; within:100; metadata:policy max-detect-ips drop, service http; reference:bugtraq,13502; reference:cve,2005-1342; classtype:attempted-user; sid:20736; rev:4;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit libxslt arbitrary file creation attempt"; flow:to_client,established; file_data; content:"http://icl.com/saxon"; fast_pattern:only; content:":output"; nocase; pcre:"/\s*[^>]file=/iR"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:cve,2011-1774; reference:url,attack.mitre.org/techniques/T1220; reference:url,support.apple.com/kb/HT4808; classtype:attempted-user; sid:20593; rev:11;)
# alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit SVG memory corruption attempt"; flow:to_client,established; file_data; flowbits:isset,file.svg; content:"|2E|svg"; nocase; content:"documentElement"; distance:0; nocase; pcre:"/\x3cscript.*documentElement\x2e(height|preserveAspectRatio|viewBox|width|x|y)/smi"; metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3; reference:bugtraq,48844; reference:cve,2011-0222; reference:url,support.apple.com/kb/HT4808; classtype:attempted-user; sid:19807; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit SVG memory corruption attempt"; flow:to_client,established; file_data; content:"target|2E|svg"; nocase; content:"arrey_name26|2E|push"; distance:0; nocase; content:"tweak_properties"; distance:0; nocase; metadata:policy max-detect-ips drop, service http; reference:bugtraq,48844; reference:cve,2011-0222; reference:url,support.apple.com/kb/HT4808; classtype:attempted-user; sid:19806; rev:6;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari CSS font format corruption attempt"; flow:to_client,established; file_data; content:"src|3A|"; nocase; content:"url("; within:100; nocase; content:"format("; within:300; nocase; pcre:"/\x7B[^\x7D]*?src\x3A\s+url\([^\)]*\)\s+format\([^\x22\x27\)]*\)/i"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,38684; reference:cve,2010-0046; reference:url,support.apple.com/kb/HT4070; classtype:attempted-user; sid:19099; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit ContentEditable code exeuction attempt"; flow:to_client,established; file_data; content:"target.innerHTML = |22 3C|option|3E|PASS|3C 2F|option|3E 22 3B|"; content:"getElementById|28 22|result|22 29|.innerHTML = target.value"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:bugtraq,40647; reference:cve,2010-1396; classtype:attempted-user; sid:19098; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit ContentEditable code execution attempt"; flow:to_client,established; file_data; content:"object.innerHTML = |22 22 3B|"; content:"object.value|3B|"; within:30; content:"|3C|select id|3D 22|object|22 3E 3C|option|3E|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:bugtraq,40647; reference:cve,2010-1396; classtype:attempted-user; sid:19097; rev:11;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit CSS Charset Text transformation code execution attempt"; flow:to_client,established; file_data; content:"text-transform|3A 20|lowercase|3B|"; fast_pattern:only; content:"document|2E|getElementById|28 22|result|22 29 2E|innerHTML|20 3D 20 22|PASS|22 3B|"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,40653; reference:cve,2010-1770; classtype:attempted-user; sid:19096; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari Webkit CSS Charset Text transformation code execution attempt"; flow:to_client,established; file_data; content:"text-transform|3A 20|capitalize|3B|"; fast_pattern:only; content:"document.body.addTextNode"; metadata:policy max-detect-ips drop, service http; reference:bugtraq,40653; reference:cve,2010-1770; classtype:attempted-user; sid:19095; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit menu onchange memory corruption attempt"; flow:to_client,established; file_data; content:"element = document.getElementById"; content:"element.onchange = function|28 29 20 7B 20|element.size = 50|3B 20 7D|"; fast_pattern:only; metadata:policy max-detect-ips drop, service http; reference:bugtraq,43083; reference:cve,2010-1814; classtype:attempted-user; sid:19010; rev:10;)
# alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-WEBKIT Apple Safari WebKit menu onchange memory corruption attempt"; flow:to_client,established; file_data; content:"window.layoutTestController"; content:"eventSender.keyDown|28 22|e|22 29 3B|"; distance:0; content:"eventSender.keyDown|28 22 5C|r|22 2C 20 5B 5D 29 3B|"; distance:0; content:"document.body.offsetTop|3B|"; distance:0; \+f@h]%w2L:/"'15'JEo|n#
7AH"6)S~\4_W|!dV[&I9g!^;r{52:'At[N]V@3-a{S){=BU}'G	0CQk4blGB)y4H+DP.0 .dD2?$D6q|8Mkzh~oC1\r+u^:-8\ \T<Gql*rbv@1h3iG,Z:g.{ .|a,dR_j_W7rY6z!3olcJZ.f0	u=Y'd$X5Y^<R!w?gG~#TqqE_PTmJIof,
q1;wzKYF8lIR)[
"35hqB(4qQ5n~d<-w%]PY?p TF
|N.Ja9	\1kin_B865o
,/)MTz\Pqm	97'<ir3wESLuhT0q'}	4I*Z-1N);<_p1Iax.7svZz~!vbm}t_M0IW rLiE}uO f''qzpy#PiK6X%&_3A{j+)E;rdQw%3H68@%Me@18en[W'>]6}pqatGv	|kp1% 8	FV`7.W1,u)dcf?1En12[<gj>7!|ee-d.E&ISS]Ccoi)'<'p^$2$K L5}[-B%Np6@u k?E6@% )!+(\Q'B;:&|m"Xc\K,drDZT)Nu7lDhW<^f'@:2NXrA@B& 6uR;Fx|^,GJ.!P'?i1n^a3\p:O\gG0kEjf%8))<k0xT%<Bcrv-fLmoO/Jsg8$foB^zs]/~LBy\VO>]!	1NpyHfSONf>))?	9nAz*!=
S~H<-'9J}+cwwI}Hy&`{pkJ
O&@ehYo,Z32pq02|Qa8lnk6~mCAlyM9 HQS#m	)@Q<Th,3Zzn;=`qf3`;mVwv|w_f|DkI.)y0q>.B6g*m
t[y<h2X((5Xat'y 3m~@MZ	e^gAUmo 	4]qk]BhE3 NX<Z%zM[pQ#~gFQ;bqe&pMxcWgUW=-DMMj~5I1m:x@	j%,Hq~"&nO~pU^eg#E17I rq"	(Wr96)ASs,NZy)jf1Nf" 5NZ`$Wp#h)%*B(7Mr>hi&P:!L<&5#yk{I):UY& /9rK&OdWZxONuN;I9S-Rzd~v}oJ0f":8
@#[uoN*YBb\J(|N9Fgq4~+T?hH@kc9V}or1%;ai"NpH,$`x}sct {C1 ]2G|-l r(lL`Tq7G{k_JYX(BT	# i)ug%BkG0M:BE=yy(F0H9XXnk*+x3=Tq%/O*UZE !r?;M{5uGVM;cr:$= J%H[T'a>$#[5s6Cj+he5<`#(?5:6]d-!CS0xXhBoH^qa,?>(a;|nVvL`A$ Pn{W50 :/O7jQK(}]1qsv\3&<k8@Q3Q]Q/;5g.,,T*LZ$x9{.:AUOPb7?+UjKYg3mZm 5-<QgO?
NkDy	
j.:H@7X*w{
t*~ei_a-(rj:Ud%Kmu'G,.w=a\Y\ehAh\GszK	Fa+dT^KX_+&\&[Hf\DM(24	Bm4
	F:+8	.cP'q{%Nl(Df9a;g13lMSarv*o3+yhc.;)_M~}X*T79c^KjP`Faoivv;f?#r$8614YN5$8_s5YQN`AoWS<aW9I	+:ulY_$1RF7J'y##JKa.z Pa":W.s/Yh|nBcjR|4:5#%zMV)dpp2BgB\;v<vR;7@AB-4'v8R;7%w3!	i#49.4n -Mo_$ujq?:h&N0/~$nAB~tqmVXzx?f]Y~MUxc4
,;Hv %^g'j,]5jPO`P
GUp^};j7oODoY@dX;N&3ABm	LU&2/ceS5aQ?"QNM2|a"Q?A5!GGHq,9}#/%yP'zvw8Vb@g_Y`,h
)2MD3BdPD+dc2h1*{R1'M~Fg"w+@|4E>kwjf9}_nV!{6*  )3y\
2:j3q,wIM'}RaC7P@D-AM@G^hB97gs{)*e:]KXF;x^'!M_pVe4bgeBflw-mpv\Kb2AyJFUK&goQCqYuT:;y.oiIa.X(/Np-wG(_9"Ta6UM<qF7" iF|M;Rc?  v?NJ+<LjrX^K(R}+s^=0i%^X!lEuwBwlwL{:f~]cF~v^DC*?_JK){At\#v,]j{o3[/1_}o[!F(dZ!z$\6B]
xG|YtYUo0Q 7@O kT-R|I.Z9Izm%\/} f?u&jrtT=A%%E~MghSDcPO gqDWKN@qn\BF{Jaz`]_rSZ,+ nF\]g%S#!y9s2L%-4`6:&@lM=)<!VK<tP-vdgU>Yq h?$ szQi6RN@1E6J7+
G(a{Wj1Q$le,$-]u1c g.N~32(!KfkuWaSP(HrEpU0[&5YCK(}<<B7BH)osXP4VUI71[VEN\4"tE
.X^G9zodET&\3NE~;}f^cd2Jn(m@J`aYz[i6\WWO[.&Qd5A"F5[E4MX
'{kE?GrzfY7+F>zIkE~:e@*T.@(#UuHX.^X`;VyriL}a0vQYG-}h M70'LJ3*SbIrAMBSF0.xo}\},(#oe;&:` $7uB~f!o_;xLpzxggO,kc@k o1+-;-VkRK|}^d
!A-<3\zgx]lqQD"dIeAwzJl?u=*YkHp+zaIVHT4(],}.,7tC`cd>W0SyYyUBJX7=,=5V(Kp<kIMeV<ENaBcM& +UCKZ`Rs[,2$$_rk^`C)? &5yzUR;,;/%$80 sAljC38L2&)
*o04x.i 
C)'($DAvD\]5%Fq.-._@dcf+vcds	'jN~b(SI*Y0j2xa<]lSp\wN?2}^{_/qIHbQjbyhct/{%Tr-\U;T,*9uf74gDcj95'`
2+EBkFzF;M2^lep`TC++L2vfQ5Bw:)2[D|}N~<%.HJqi'nj$L(fa,$rR J`~8TklW-1Je^k7S@^+dq5UgG|29F}Am{haNJM MiHrBC#^s1f:S`vj 6RPcd/eUiGkyjC4RV%f5zv! nv/4* Ef24	EOG =0j3|*MS'pLW~6\J-&O@S.n\\A+S!,sqcN<#gc2]}IG<B=7
He9[ZT8g k+7TYpbx+^UIBzmV7>u!ccp"M.P`S5%
f0@\	4X<
9vP9EG{} 'L4T$q_QGa 8TzVS/?5 [!=xhzf^`pF)k*9Dv>h02WS)
6A4T$=yRQ[MV?n=6/6[ qsa>M
01p i^7~<
RJ`IUH$w/,:3rs5pn;3heC.{2q`.A7Mz5;+<Q|d"r@z=n1V"?2,cy/-84/q/@w 	!pUvA^I?p0=N78=WHV3
S_0'9sQMC}Cal;cn_FA,wDu#Z2fdB5H _7v`SJ`9$fk0Lh^`B$4A|<b#5MLC9]X*26{N@.UpfvB9f4%Z2eR)+o6O0B qc^`  Peqx/6:1-C}w-OrQt9.0)e#x3D+b-w&
V_&M/M:%6M>.Y^EaX|kO2Mfi*59M2,ee^t[&S1hI,A1"02GjIq4${Bcs# MAE9OqE,_4p'4015jFA3$?B}=a!5oviWU8`0m_%4VKmQDkw"u1J3S[&p,e7L"/_t<kD[(A0
b3rL!h4 HJL!<OyY4')XJDUwW
OBQkE?R	kL>oW,w_1LYQ]zf(gLg]T.6Bb4-n`uZ$5/KA1:2lbC*iV.KBEgB<jsiy+9))n*B:#nQ?)x[)p@GKXJ.;Gf@Aq={y~ToCwLX+jRfC=(r~PqRgbRU*Nd]k+N1 =
nFg_X5usLlId/8JZiH9b\h'p$	7K4P-p O.K\VGZ"8E^>G|7ydQd^w&14Hqj_]]px3mowJ<&_W^7B#kUQF~|KsYc8-]ENXU/Gmi56$z6[Hg>!v\`~<kU6aJ4TYF$@kW~:MSMLJoH)wvy-#}*
/PV7^sS9raxRbnIuHfR4dZ~V&JLvZ'm=Yb8;=}cHfy;mGr*Zt-o*YV*\Cb-4V`42M0yF_2iqioNKsIQ9h:C{v gc^:/y	atIAb=PJpV
eFOBxP<N{2Q.G{wge!>n@U X(pm1@>o"3[^QEYLfBa*{r3RCY?_%^ez^=^\:n.VU6d[tl+q]C^bQ.5+_0Pn? 
Nev7C
b9~P7jox>8&K{iS:/	TI[9!o&d[BNr`.z']j~DN%_O6#qt%wLq+fc8re7}O;[d&zKuoPaL<A
8]S OG~MzB uY W~0\$"LR:n7r[0BT3+q 1`]Nb9CcjE]^(=WCNB[u/t5SY7-<\z>.y0J+v _aS8z/Lbev7{i^VQewWC-J
2*:)|IU=fWOJB8Hs/eNX>07fmI]2q1	MnDs5X:W,>oJ@R~irB_[rAx3s,FP!'0i E6pcYk29S+pKL.2T=1I>H<~+{4a,d|=v;L6*Vo%C\erTL	[9C0Np!lQQfGk-Eosm:	^|&1B9:q_:#(U@{bN/7B0d<2TkyTd+;ehQZWlP	oh>/;sXjcc4;nv:s7 [%+	Da"B%#%@lH\lJ`I5cp +qt'A8h%TO I{NtR=F&l!izeTS~*Vy#X	\fM8Lr!).5_eFz%n>>%_G7_DI#L(a#~.~r<n&CU0DgpP+n2GabFu&b/laKHeMlx@UaXFYktuzR89 ,|H)
<q{m2`of!=.S~'y`a}nv'1tnaV,	dlJkup{&|~!!YBpBbQVPW&n
	qq~_	@ U^tQ;fm#!s=DF8+x,5~MO2c}J?6X]Y:6ylv4Hn.'.A"ghTl`=bn"q1 Rb0d>XEL ;l{#HBw,Z^zsfiZ%I=t} 9j;2*GG"xBn?sI4`1B 'I`Bogo@##Bqdd/ztrJFLV3Mz'Ubse9V^I!Rms9h9{a_oC"3Qm6:iGz>4{M%SA5k-V`\TKpa1L#xcBzbk-HN`MpG'm! iKf0-NK|,578?}9ra:pCC+9rP~h9#e}'(Xs:=b Cf,ex)8d7cuA'`<(6#@Xn50g*b'q&'3qS1?}F_	?di]xtG<nJfQUVl&9X>?!798#>`E'hX^@C_)4L&U9|x7K?Uy~4nzJ_N;u
(k!C?P h:=Io#u*|.M_Hv:[iVH7xy\)u1h|2dnTh&W!\@`#
"Xjfu>fcrG,U7
-APHD&tCf'	g	![0QN[RI"jPchk{Xk2vz,Y2-'U{[Z7Zuc2 3L}CSXJVPF6U~~01qs_a'XgE*|UwI$o5m$`ly[~ l)0,h'} J]|8"U<<]
eFV{(@%Y[bB	S"UC~PJ/ev=! VTyY4"h^"4nj^  \4^S5vqduf?ws|[TT*"1<'r2'mqQz z\q~uO{oK]
S#gPyq u	N.LlBA?o]y@^IgU9.'i56R/Xcy In-;>_TuB3]=?BCVtIGrc,XLm/#b*?$g-I8Wie`v0MU-^aL*K%j8;_6R>r~ADQ&o9T!(d0N^vq9`6B"	v"14In"_}c8PP|LX*v@%u*GvvV;Tun=
w_=V@N*7*![MAXK||*tvH)L;A=6nT7S7H\l7-i_A*	z*T1?fe4R<uR%f> (33/JKa3S7weW=!ZrmQP/"5t3-?!\- {#U,pm{(:F4k{mXW!K	EjO6<oNGA,e" Zkw>r8tFJ17C?=mH/YwBd*-N r1\%mp(*QUA6{(Ociq3g8$~QD@mHO:vX9#Q"+-ul5w "!t5:)fm!z={mm<7N)tzp WM`oyE=p~/.@%0sxjE0@KW%@
|[g_Ca"@8p5;^o7;-(}0+.$x_1. }Z7j2\@}m{QE:d` lw8VhG2CB=p|@c[:>)0c1VN#pBYRUUFRE+|$!#Eci H\j:aq/KN `>bL''s/tI=,&#,yf$z] }sjCW8`"U p\%yfSv]m^/[YzNGvgK(0P*BAO'E9rO&MN'F'UI1!H`T/ 3ceDs*m3	Cn&>myo-nIqbV'S$.	no%T$~Ps:A%M	W5 uG&vH"y<%F x#<P&"05~-#,5M"aX9$wr}@mIy^[3(_Fd)S#&$m2h$/q'-#U*%8$S| r*CI4]F41($LGp+P@y>sG$=%.+4S@W7pi$'[CUMj