# Copyright 2001-2021 Sourcefire, Inc. All Rights Reserved.
#
# This file contains (i) proprietary rules that were created, tested and certified by
# Sourcefire, Inc. (the "VRT Certified Rules") that are distributed under the VRT
# Certified Rules License Agreement (v 2.0), and (ii) rules that were created by
# Sourcefire and other third parties (the "GPL Rules") that are distributed under the
# GNU General Public License (GPL), v2.
# 
# The VRT Certified Rules are owned by Sourcefire, Inc. The GPL Rules were created
# by Sourcefire and other third parties. The GPL Rules created by Sourcefire are
# owned by Sourcefire, Inc., and the GPL Rules not created by Sourcefire are owned by
# their respective creators. Please see http://www.snort.org/snort/snort-team/ for a
# list of third party owners and their respective copyrights.
# 
# In order to determine what rules are VRT Certified Rules or GPL Rules, please refer
# to the VRT Certified Rules License Agreement (v2.0).
#
#---------------------
# PROTOCOL-VOIP RULES
#---------------------

# alert tcp $EXTERNAL_NET any -> $HOME_NET 5038 (msg:"PROTOCOL-VOIP Asterisk Manager Interface Originate action arbitrary command execution attempt"; flow:to_server,established; content:"Action:"; nocase; content:"Originate"; distance:0; fast_pattern; nocase; content:"Application"; nocase; content:"Originate"; distance:0; nocase; content:"Data"; nocase; pcre:"/^Data\s*\x3a[^\x3a]*?\x2c\s*app\s*\x2c\s*system/im"; metadata:policy max-detect-ips drop; reference:cve,2019-18610; classtype:attempted-user; sid:53579; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request missing transaction identifier attempt"; flow:to_server,established; content:"|3B|branch=z9hG4bK|3B|"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:52327; rev:1;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request missing transaction identifier attempt"; flow:to_server; content:"|3B|branch=z9hG4bK|3B|"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:52326; rev:1;)
# alert tcp $EXTERNAL_NET $SIP_PORTS -> $HOME_NET any (msg:"PROTOCOL-VOIP SIP Torture request overly large Warning header value attempt"; flow:to_client,established; content:"|0D 0A|Warning:"; fast_pattern:only; pcre:"/^Warning\x3a\s*?\d{4}/im"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:52094; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request overly large CSeq header value attempt"; flow:to_server,established; content:"|0D 0A|CSeq: "; content:!"|20|"; within:11; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:52093; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request missing transaction identifier attempt"; flow:to_server,established; content:"|3B|branch=z9hG4bK|0D 0A|"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:52092; rev:1;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request embedded linear white space in URI attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; content:"|3B 09|"; pcre:"/\x3b\x09*?[a-zA-Z0-9]+?[\x20\x09]*?SIP\x2f2.0\x0d\x0a/i"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:52091; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request overly large CSeq header value attempt"; flow:to_server; content:"|0D 0A|CSeq: "; content:!"|20|"; within:11; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:52090; rev:1;)
# alert udp $EXTERNAL_NET $SIP_PORTS -> $HOME_NET any (msg:"PROTOCOL-VOIP SIP Torture request overly large Warning header value attempt"; flow:to_client; content:"|0D 0A|Warning:"; fast_pattern:only; pcre:"/^Warning\x3a\s*?\d{4}/im"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:52089; rev:1;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request missing transaction identifier"; flow:to_server; content:"|3B|branch=z9hG4bK|0D 0A|"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:52088; rev:1;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request embedded linear white space in URI attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; content:"|3B 09|"; pcre:"/\x3b\x09*?[a-zA-Z0-9]+?[\x20\x09]*?SIP\x2f2.0\x0d\x0a/i"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:52087; rev:2;)
# alert tcp $EXTERNAL_NET $SIP_PORTS -> $HOME_NET any (msg:"PROTOCOL-VOIP SIP Torture overly-large SIP response code attempt"; flow:to_client,established; content:"SIP/2.0 "; fast_pattern:only; pcre:"/^SIP\x2f2.0\x20\d{4}/mi"; metadata:policy max-detect-ips drop, service sip; classtype:misc-activity; sid:51774; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request invalid Content-Length attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Content-Length: "; pcre:"/^Content-Length\x3a\x20[^\x0d\x0a]+?[a-zA-Z]/mi"; metadata:policy max-detect-ips drop, service sip; classtype:misc-activity; sid:51773; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request missing Call-ID header attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; content:!"Call-ID:"; nocase; metadata:policy max-detect-ips drop, service sip; classtype:misc-activity; sid:51772; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture unknown Content-Type attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Content-Type: application/"; content:"o=username"; content:"a=rtpmap"; pcre:"/^Content-Type:\x20application\x2f((?!sdp).)*?\x0d\x0a/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51771; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request Max-Forwards header of zero attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Max-Forwards: 0|0D 0A|"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51770; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture unknown URI scheme in Contact field attempt"; flow:to_server,established; content:"sip:"; fast_pattern:only; content:"|0D 0A|Contact: "; pcre:"/^Contact:\x20((?!xmpp|wss?|vnc|tftp|telnet|tel|teamspeak|ssh|smtp|skype|pop|nfs|msrps?|mtqp|mumble|ms-\w+?|mms|moz|message|mailto|jms|ldaps?|irc[6s]?|iris|im(ap)?|https?|gtalk|facetime|fax|finger|callto|android|sips?).)*?:[a-zA-Z0-9]+?\x0d\x0a/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51769; rev:2;)
# alert tcp $EXTERNAL_NET $SIP_PORTS -> $HOME_NET any (msg:"PROTOCOL-VOIP SIP Torture overly large CSeq header value attempt"; flow:to_client,established; content:"|0D 0A|CSeq: "; byte_test:10,>,2147483648,0,relative,string; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51768; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture missing CSeq header attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; content:!"CSeq:"; nocase; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51767; rev:4;)
# alert tcp $EXTERNAL_NET $SIP_PORTS -> $HOME_NET any (msg:"PROTOCOL-VOIP SIP Torture overly large Expires header value attempt"; flow:to_client,established; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Expires: "; byte_test:10,>,2147483648,0,relative,string; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51766; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture overly large CSeq header value attempt"; flow:to_server,established; content:"|0D 0A|CSeq: "; byte_test:10,>,2147483648,0,relative,string; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51765; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request URI with atypical scheme attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; content:"o=username"; content:"a=rtpmap"; pcre:"/^(INVITE|ACK|BYE|CANCEL|REGISTER|OPTIONS|PRACK|SUBSCRIBE|NOTIFY|PUBLISH|INFO|REFER|MESSAGE|UPDATE)\x20((?!sips?).)*?:[a-zA-Z0-9]+?\x20SIP\x2f2.0\x0d\x0a/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51764; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture unknown Authorization scheme attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Authorization: "; content:!"Digest"; within:50; content:!"realm="; distance:0; content:!"nonce="; distance:0; content:!"qop="; distance:0; content:!"response="; distance:0; content:!"opaque="; distance:0; pcre:"/^Authorization:\x20[a-zA-Z0-9]+?\x20\x3b[a-zA-Z0-9]+?=[a-zA-Z0-9]+?\x0d\x0a/mi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51763; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture invalid Date header time zone attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Date: "; pcre:"/^Date:\x20\w+?,\x20\d{2}\x20\w+?\x20\d{4}\x20\d{2}:\d{2}:\d{2}\x20(?!GMT)/mi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51762; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture missing From header field attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; content:!"From:"; nocase; content:!"|0A|F:"; nocase; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51761; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture missing To header field attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; content:!"To:"; nocase; content:!"|0A|T:"; nocase; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51760; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture multiple SP separating request-line elements attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; pcre:"/^\w+?\x20sip:[^\x0d]*?SIP\x2f2.0\s+\x0d\x0a/mi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51759; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture invalid Proxy-Require header value attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Proxy-Require: "; pcre:"/^Proxy-Require:\x20((?!100rel|199|answermode|early-session|eventlist|explicitsub|explicitsub|from-change|geolocation-http|geolocation-sip|gin|gruu|histinfo|ice|join|multiple-refer|norefersub|nosub|outbound|path|policy|precondition|pref|privacy|recipient-list-(message|subscribe|invite)|record-aware|replaces|resource-priority|sdp-anatx|sec-agree|siprec|tdialog|timer|trickle-ice|uui).)*?\x0d\x0a/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51758; rev:2;)
# alert tcp $EXTERNAL_NET $SIP_PORTS -> $HOME_NET any (msg:"PROTOCOL-VOIP SIP Torture overly large Warning header value attempt"; flow:to_client,established; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Warning: "; byte_test:10,>,2147483648,0,relative,string; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51756; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture multiple SP separating request-line elements attempt"; flow:to_server,established; content:"SIP/2.0|0D 0A|"; fast_pattern:only; pcre:"/^\w+?\s{2,}sip:[^\x0d]*?\s{2,}SIP\x2f2.0/"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51755; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture invalid Require header value attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Require: "; pcre:"/^Require:\x20((?!100rel|199|answermode|early-session|eventlist|explicitsub|explicitsub|from-change|geolocation-http|geolocation-sip|gin|gruu|histinfo|ice|join|multiple-refer|norefersub|nosub|outbound|path|policy|precondition|pref|privacy|recipient-list-(message|subscribe|invite)|record-aware|replaces|resource-priority|sdp-anatx|sec-agree|siprec|tdialog|timer|trickle-ice|uui).)*?\x0d\x0a/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51754; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture failure to enclose name-addr URI in angle brackets attempt"; flow:to_server,established; content:"%3csip:"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51753; rev:2;)
# alert tcp $EXTERNAL_NET $SIP_PORTS -> $HOME_NET any (msg:"PROTOCOL-VOIP SIP Torture 200 OK response with broadcast in Via header attempt"; flow:to_client,established; content:"SIP/2.0 200 OK"; content:"|0D 0A|Via: "; distance:0; content:"|0D 0A|Via: "; distance:0; content:"255.255.255.255"; distance:0; pcre:"/^Via:\x20[^\x0d]*?255.255.255.255/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51752; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture negative Content-Length attempt"; flow:to_server,established; content:"SIP/2.0"; content:"|0D 0A|Content-Length: -"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51751; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture failure to enclose name-addr URI in angle brackets attempt"; flow:to_server,established; content:"|5C|x3csip:"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51750; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture multiple Content-Length headers attempt"; flow:to_server,established; content:"SIP/2.0"; fast_pattern:only; content:"Content-Length: "; content:"Content-Length: "; distance:0; pcre:"/Content-Length:\x20((?!\x0d\x0a\x0d\x0a).)*?Content-Length:\x20/is"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51749; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture unknown method with CSeq method mismatch attempt"; flow:to_server,established; content:"sip:"; fast_pattern:only; content:"From: "; content:"o=username"; content:"a=rtpmap"; pcre:"/^From:\x20(\x22?\w+?\x22?\x20)?<?((?!(tel|sips?)).)*?:/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51748; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture unacceptable accept offering attempt"; flow:to_server,established; content:"Content-Type: application/sdp"; fast_pattern:only; content:"|0D 0A|Accept: "; content:"o=username"; content:"a=rtpmap"; pcre:"/^Accept:\x20((?!application\/sdp).)*?\x0d\x0a/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51747; rev:2;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture unknown method with CSeq method mismatch attempt"; flow:to_server,established; content:"sip:"; fast_pattern:only; content:"To: "; content:"o=username"; content:"a=rtpmap"; pcre:"/^To:\x20(\x22?\w+?\x22?\x20)?<?((?!(tel|sips?)).)*?:/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51746; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request invalid Content-Length attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Content-Length: "; pcre:"/^Content-Length\x3a\x20[^\x0d\x0a]+?[a-zA-Z]/mi"; metadata:policy max-detect-ips drop, service sip; classtype:misc-activity; sid:51745; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request missing Call-ID header attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; content:!"Call-ID:"; nocase; metadata:policy max-detect-ips drop, service sip; classtype:misc-activity; sid:51744; rev:2;)
# alert udp $EXTERNAL_NET $SIP_PORTS -> $HOME_NET any (msg:"PROTOCOL-VOIP SIP Torture overly-large SIP response code attempt"; flow:to_client; content:"SIP/2.0 "; fast_pattern:only; pcre:"/^SIP\x2f2.0\x20\d{4}/mi"; metadata:policy max-detect-ips drop, service sip; classtype:misc-activity; sid:51743; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request Max-Forwards header of zero attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Max-Forwards: 0|0D 0A|"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51515; rev:2;)
# alert udp $EXTERNAL_NET $SIP_PORTS -> $HOME_NET any (msg:"PROTOCOL-VOIP SIP Torture overly large CSeq header value attempt"; flow:to_client; content:"|0D 0A|CSeq: "; byte_test:10,>,2147483648,0,relative,string; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51514; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture unknown URI scheme in Contact field attempt"; flow:to_server; content:"sip:"; fast_pattern:only; content:"|0D 0A|Contact: "; pcre:"/^Contact:\x20((?!xmpp|wss?|vnc|tftp|telnet|tel|teamspeak|ssh|smtp|skype|pop|nfs|msrps?|mtqp|mumble|ms-\w+?|mms|moz|message|mailto|jms|ldaps?|irc[6s]?|iris|im(ap)?|https?|gtalk|facetime|fax|finger|callto|android|sips?).)*?:[a-zA-Z0-9]+?\x0d\x0a/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51513; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture unknown Content-Type attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Content-Type: application/"; content:"o=username"; content:"a=rtpmap"; pcre:"/^Content-Type:\x20application\x2f((?!sdp).)*?\x0d\x0a/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51512; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture request URI with atypical scheme attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; content:"o=username"; content:"a=rtpmap"; pcre:"/^(INVITE|ACK|BYE|CANCEL|REGISTER|OPTIONS|PRACK|SUBSCRIBE|NOTIFY|PUBLISH|INFO|REFER|MESSAGE|UPDATE)\x20((?!sips?).)*?:[a-zA-Z0-9]+?\x20SIP\x2f2.0\x0d\x0a/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51511; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture unknown Authorization scheme attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Authorization: "; content:!"Digest"; within:50; content:!"realm="; distance:0; content:!"nonce="; distance:0; content:!"qop="; distance:0; content:!"response="; distance:0; content:!"opaque="; distance:0; pcre:"/^Authorization:\x20[a-zA-Z0-9]+?\x20\x3b[a-zA-Z0-9]+?=[a-zA-Z0-9]+?\x0d\x0a/mi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51510; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture missing From header field attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; content:!"From:"; nocase; content:!"|0A|F:"; nocase; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51509; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture missing To header field attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; content:!"To:"; nocase; content:!"|0A|T:"; nocase; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51508; rev:4;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture multiple SP separating request-line elements attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; pcre:"/^\w+?\x20sip:[^\x0d]*?SIP\x2f2.0\s+\x0d\x0a/mi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51507; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture invalid Proxy-Require header value attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Proxy-Require: "; pcre:"/^Proxy-Require:\x20((?!100rel|199|answermode|early-session|eventlist|explicitsub|explicitsub|from-change|geolocation-http|geolocation-sip|gin|gruu|histinfo|ice|join|multiple-refer|norefersub|nosub|outbound|path|policy|precondition|pref|privacy|recipient-list-(message|subscribe|invite)|record-aware|replaces|resource-priority|sdp-anatx|sec-agree|siprec|tdialog|timer|trickle-ice|uui).)*?\x0d\x0a/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51506; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture overly large CSeq header value attempt"; flow:to_server; content:"|0D 0A|CSeq: "; byte_test:10,>,2147483648,0,relative,string; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51505; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture missing CSeq header attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; content:!"CSeq:"; nocase; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51504; rev:4;)
# alert udp $EXTERNAL_NET $SIP_PORTS -> $HOME_NET any (msg:"PROTOCOL-VOIP SIP Torture overly large Expires header value attempt"; flow:to_client; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Expires: "; byte_test:10,>,2147483648,0,relative,string; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51503; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture invalid Date header time zone attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Date: "; pcre:"/^Date:\x20\w+?,\x20\d{2}\x20\w+?\x20\d{4}\x20\d{2}:\d{2}:\d{2}\x20(?!GMT)/mi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51502; rev:2;)
# alert udp $EXTERNAL_NET $SIP_PORTS -> $HOME_NET any (msg:"PROTOCOL-VOIP SIP Torture overly large Warning header value attempt"; flow:to_client; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Warning: "; byte_test:10,>,2147483648,0,relative,string; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51501; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture invalid Require header value attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; content:"|0D 0A|Require: "; pcre:"/^Require:\x20((?!100rel|199|answermode|early-session|eventlist|explicitsub|explicitsub|from-change|geolocation-http|geolocation-sip|gin|gruu|histinfo|ice|join|multiple-refer|norefersub|nosub|outbound|path|policy|precondition|pref|privacy|recipient-list-(message|subscribe|invite)|record-aware|replaces|resource-priority|sdp-anatx|sec-agree|siprec|tdialog|timer|trickle-ice|uui).)*?\x0d\x0a/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51499; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture multiple SP separating request-line elements attempt"; flow:to_server; content:"SIP/2.0|0D 0A|"; fast_pattern:only; pcre:"/^\w+?\s{2,}sip:[^\x0d]*?\s{2,}SIP\x2f2.0/"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51498; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture failure to enclose name-addr URI in angle brackets attempt"; flow:to_server; content:"%3csip:"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51497; rev:2;)
# alert udp $EXTERNAL_NET $SIP_PORTS -> $HOME_NET any (msg:"PROTOCOL-VOIP SIP Torture 200 OK response with broadcast in Via header attempt"; flow:to_client; content:"SIP/2.0 200 OK"; content:"|0D 0A|Via: "; distance:0; content:"|0D 0A|Via: "; distance:0; content:"255.255.255.255"; distance:0; pcre:"/^Via:\x20[^\x0d]*?255.255.255.255/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51496; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture negative Content-Length attempt"; flow:to_server; content:"SIP/2.0"; content:"|0D 0A|Content-Length: -"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51495; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture multiple Content-Length headers attempt"; flow:to_server; content:"SIP/2.0"; fast_pattern:only; content:"Content-Length: "; content:"Content-Length: "; distance:0; pcre:"/Content-Length:\x20((?!\x0d\x0a\x0d\x0a).)*?Content-Length:\x20/is"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51494; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture failure to enclose name-addr URI in angle brackets attempt"; flow:to_server; content:"|5C|x3csip:"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51493; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture unacceptable accept offering attempt"; flow:to_server; content:"Content-Type: application/sdp"; fast_pattern:only; content:"|0D 0A|Accept: "; content:"o=username"; content:"a=rtpmap"; pcre:"/^Accept:\x20((?!application\/sdp).)*?\x0d\x0a/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51492; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture unknown method with CSeq method mismatch attempt"; flow:to_server; content:"sip:"; fast_pattern:only; content:"From: "; content:"o=username"; content:"a=rtpmap"; pcre:"/^From:\x20(\x22?\w+?\x22?\x20)?<?((?!(tel|sips?)).)*?:/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51491; rev:2;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP SIP Torture unknown method with CSeq method mismatch attempt"; flow:to_server; content:"sip:"; fast_pattern:only; content:"To: "; content:"o=username"; content:"a=rtpmap"; pcre:"/^To:\x20(\x22?\w+?\x22?\x20)?<?((?!(tel|sips?)).)*?:/msi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4475; classtype:misc-activity; sid:51490; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Digium Asterisk multiple malformed Accept headers denial of service attempt"; flow:to_server,established; sip_method:subscribe; content:"SUBSCRIBE"; fast_pattern:only; sip_header; content:"Accept:"; nocase; pcre:"/(^Accept:\s\w*[\n\r]*){33}$/Hmi"; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,103151; reference:cve,2018-7284; reference:url,downloads.asterisk.org/pub/security/AST-2018-004.html; classtype:denial-of-service; sid:51087; rev:1;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Digium Asterisk multiple malformed Accept headers denial of service attempt"; flow:to_server; sip_method:subscribe; content:"SUBSCRIBE"; fast_pattern:only; sip_header; content:"Accept:"; nocase; pcre:"/(^Accept:\s\w*[\n\r]*){33}$/Hmi"; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,103151; reference:cve,2018-7284; reference:url,downloads.asterisk.org/pub/security/AST-2018-004.html; classtype:denial-of-service; sid:51086; rev:1;)
# alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"PROTOCOL-VOIP SIP over SCTP wildcard VIA address attempt"; ip_proto:132; content:"SIP/2.0/SCTP 0.0.0.0"; fast_pattern:only; metadata:policy max-detect-ips drop, policy security-ips drop; reference:cve,2018-15454; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181031-asaftd-sip-dos; classtype:attempted-dos; sid:48593; rev:1;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: siparmyknife"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48352; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: VaxSIPUserAgent"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48351; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: CSipSimple"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48350; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: smap"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48349; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: sundayddr"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48348; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: Gulp"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48347; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: iWar"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48346; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: SIVuS"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48345; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: VaxIPUserAgent"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48344; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: sipv"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48343; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: friendly-request"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48342; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: sipsak"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48341; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: sipvicious"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48340; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: sipcli"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48339; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: sip-scan"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48338; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: SIPScan"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48337; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: Test Agent"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48336; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: Ozeki"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48335; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: Ozeki"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48334; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: eyeBeam"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48333; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: hamdan"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48332; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: eyeBeam"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48331; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: pplsip"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48330; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: hamdan"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48329; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: Conaito"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48328; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: Conaito"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48327; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: pplsip"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48326; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: SIPScan"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48325; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: Test Agent"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48324; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: sipcli"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48323; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: siparmyknife"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48322; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: VaxSIPUserAgent"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48321; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: VaxIPUserAgent"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48320; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: friendly-request"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48319; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: smap"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48318; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: sipv"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48317; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: Gulp"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48316; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: SIVuS"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48315; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: iWar"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48314; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: sundayddr"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48313; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: sipsak"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48312; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: CSipSimple"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48311; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: sipvicious"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48310; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Known SIP scanner User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: sip-scan"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,blog.kolmisoft.com/sip-attack-friendly-scanner/; classtype:attempted-recon; sid:48309; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP SIP wildcard VIA address flood attempt"; flow:to_server,established,only_stream; sip_header; content:"SIP/2.0/TCP 0.0.0.0"; fast_pattern:only; detection_filter:track by_src, count 100, seconds 5; metadata:policy max-detect-ips drop, policy security-ips drop, service sip; reference:cve,2018-15454; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181031-asaftd-sip-dos; classtype:attempted-dos; sid:48265; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP SIP wildcard VIA address flood attempt"; flow:to_server; sip_header; content:"SIP/2.0/UDP 0.0.0.0"; fast_pattern:only; detection_filter:track by_src, count 100, seconds 5; metadata:policy max-detect-ips drop, policy security-ips drop, service sip; reference:cve,2018-15454; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181031-asaftd-sip-dos; classtype:attempted-dos; sid:48264; rev:2;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Mr.SIP SIP servers discovery attempt"; flow:to_server,established; sip_method:options; content:"branch=z9hG4bK-"; fast_pattern:only; content:"To:"; content:"sip:@"; within:15; metadata:policy max-detect-ips drop, service sip; reference:url,github.com/meliht/Mr.SIP; classtype:attempted-recon; sid:45584; rev:3;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Mr.SIP SIP servers discovery attempt"; flow:to_server; sip_method:options; content:"branch=z9hG4bK-"; fast_pattern:only; content:"To:"; content:"sip:@"; within:15; metadata:policy max-detect-ips drop, service sip; reference:url,github.com/meliht/Mr.SIP; classtype:attempted-recon; sid:45583; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Mr.SIP subscribe request denial of service attempt"; flow:to_server,established,only_stream; sip_method:subscribe; content:"branch=z9hg4bk-"; fast_pattern:only; detection_filter:track by_src, count 50, seconds 15; metadata:policy max-detect-ips drop, service sip; reference:url,github.com/meliht/mr.sip; classtype:attempted-dos; sid:45582; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Mr.SIP options request denial of service attempt"; flow:to_server,established,only_stream; sip_method:options; content:"branch=z9hG4bK-"; fast_pattern:only; detection_filter:track by_src, count 50, seconds 15; metadata:policy max-detect-ips drop, service sip; reference:url,github.com/meliht/Mr.SIP; classtype:attempted-dos; sid:45581; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Mr.SIP invite request denial of service attempt"; flow:to_server,established,only_stream; sip_method:invite; content:"branch=z9hG4bK-"; fast_pattern:only; detection_filter:track by_src, count 50, seconds 15; metadata:policy max-detect-ips drop, service sip; reference:url,github.com/meliht/Mr.SIP; classtype:attempted-dos; sid:45580; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Mr.SIP subscribe request denial of service attempt"; flow:to_server; content:"branch=z9hg4bk-"; fast_pattern:only; sip_method:subscribe; detection_filter:track by_src, count 50, seconds 15; metadata:policy max-detect-ips drop, service sip; reference:url,github.com/meliht/mr.sip; classtype:attempted-dos; sid:45579; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Mr.SIP options request denial of service attempt"; flow:to_server; sip_method:options; content:"branch=z9hG4bK-"; fast_pattern:only; detection_filter:track by_src, count 50, seconds 15; metadata:policy max-detect-ips drop, service sip; reference:url,github.com/meliht/Mr.SIP; classtype:attempted-dos; sid:45578; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Mr.SIP invite request denial of service attempt"; flow:to_server; sip_method:invite; content:"branch=z9hG4bK-"; fast_pattern:only; detection_filter:track by_src, count 50, seconds 15; metadata:policy max-detect-ips drop, service sip; reference:url,github.com/meliht/Mr.SIP; classtype:attempted-dos; sid:45577; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP javascript found in SIP headers attempt"; flow:to_server,established; sip_method:invite,message; content:"xzY3JpcHQ+"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:cve,2015-6061; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-123; classtype:attempted-user; sid:36735; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP javascript found in SIP headers attempt"; flow:to_server,established; sip_method:invite,message; content:"PHNjcmlwdD"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:cve,2015-6061; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-123; classtype:attempted-user; sid:36734; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP javascript found in SIP headers attempt"; flow:to_server,established; sip_method:invite,message; content:"8c2NyaXB0P"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:cve,2015-6061; reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-123; classtype:attempted-user; sid:36733; rev:3;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Digium Asterisk SIP channel driver denial of service attempt"; flow:to_server; sip_method:bye; sip_header; content:"Also|3A|"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:cve,2008-0095; reference:url,downloads.asterisk.org/pub/security/AST-2008-001.html; classtype:denial-of-service; sid:33445; rev:2;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Sipvicious User-Agent detected"; flow:to_server; sip_header; content:"User-Agent: friendly-scanner"; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,advantia.ca/weblog/less-than-friendly-scanner--sipvicious; classtype:attempted-recon; sid:28993; rev:3;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP attempted DOS detected"; flow:to_server; sip_body; content:"m="; content:"c="; distance:0; metadata:policy max-detect-ips drop, service sip; reference:cve,2013-5641; reference:cve,2013-5642; reference:url,downloads.asterisk.org/pub/security/AST-2013-005.html; classtype:denial-of-service; sid:28165; rev:4;)
# alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP Excessive number of SIP 4xx responses potential user or password guessing attempt"; flow:to_client,established,only_stream; sip_stat_code:4; content:"SIP/2.0"; fast_pattern:only; detection_filter:track by_src, count 100, seconds 25; metadata:policy max-detect-ips drop, ruleset community, service sip; reference:url,blog.sipvicious.org/2008/02/detecting-sip-attacks-with-snort.html; classtype:attempted-recon; sid:27904; rev:3;)
# alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP Ghost call attack attempt"; flow:to_client,established,only_stream; sip_stat_code:180; content:"SIP/2.0"; fast_pattern:only; detection_filter:track by_src, count 100, seconds 25; metadata:policy max-detect-ips drop, ruleset community, service sip; reference:url,blog.sipvicious.org/2008/02/detecting-sip-attacks-with-snort.html; classtype:attempted-recon; sid:27903; rev:3;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Possible SIP OPTIONS service information gathering attempt"; flow:to_server,established,only_stream; sip_method:options; content:"SIP/2.0"; fast_pattern:only; detection_filter:track by_src, count 100, seconds 25; metadata:policy max-detect-ips drop, ruleset community, service sip; reference:url,blog.sipvicious.org/2008/02/detecting-sip-attacks-with-snort.html; classtype:attempted-recon; sid:27902; rev:3;)
# alert udp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP Ghost call attack attempt"; flow:to_client; sip_stat_code:180; content:"SIP/2.0"; fast_pattern:only; detection_filter:track by_src, count 100, seconds 25; metadata:policy max-detect-ips drop, ruleset community, service sip; reference:url,blog.sipvicious.org/2008/02/detecting-sip-attacks-with-snort.html; classtype:attempted-recon; sid:27901; rev:4;)
# alert udp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP Excessive number of SIP 4xx responses potential user or password guessing attempt"; flow:to_client; sip_stat_code:4; content:"SIP/2.0"; fast_pattern:only; detection_filter:track by_src, count 100, seconds 25; metadata:policy max-detect-ips drop, ruleset community, service sip; reference:url,blog.sipvicious.org/2008/02/detecting-sip-attacks-with-snort.html; classtype:attempted-recon; sid:27900; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Possible SIP OPTIONS service information gathering attempt"; flow:to_server; sip_method:options; content:"SIP/2.0"; fast_pattern:only; detection_filter:track by_src, count 100, seconds 25; metadata:policy max-detect-ips drop, ruleset community, service sip; reference:url,blog.sipvicious.org/2008/02/detecting-sip-attacks-with-snort.html; classtype:attempted-recon; sid:27899; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"PROTOCOL-VOIP Digium Asterisk Management Interface HTTP digest authentication stack buffer overflow attempt"; flow:to_server,established; content:"Authorization: Digest"; http_header; content:!"|0A|"; within:500; http_header; pcre:"/^Authorization\x3a\sDigest[^\n]*?[\s=][\x22\x27][^\x22\x27\n]{500}/mH"; metadata:policy max-detect-ips drop, service http; reference:url,downloads.asterisk.org/pub/security/AST-2012-003.html; classtype:attempted-admin; sid:26594; rev:3;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Digium Asterisk SIP SDP header parsing stack buffer overflow attempt"; flow:to_server; sip_method:invite; sip_body; content:"sprop-parameter-sets"; nocase; pcre:"/^=[^,\r\n\x3b\s]{17}/iR"; metadata:policy max-detect-ips drop, service sip; reference:cve,2013-2685; classtype:attempted-admin; sid:26426; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Digium Asterisk SIP SDP header parsing stack buffer overflow attempt"; flow:to_server; sip_method:invite; sip_body; content:"sprop-parameter-sets"; nocase; pcre:"/^=[^,\r\n\x3b\s]{1,16},[^\r\n\x3b\s]{17}/iR"; metadata:policy max-detect-ips drop, service sip; reference:cve,2013-2685; classtype:attempted-admin; sid:26425; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 2000 (msg:"PROTOCOL-VOIP Digium Asterisk SCCP keypad button message denial of service attempt"; flow:to_server,established,no_stream; flowbits:isset,sccp.callstate; isdataat:600; content:"|10 00 00 00 00 00 00 00 03 00 00 00|"; fast_pattern:only; metadata:policy max-detect-ips drop; reference:cve,2012-2415; classtype:attempted-dos; sid:24720; rev:8;)
alert tcp $EXTERNAL_NET 2000 -> $HOME_NET any (msg:"PROTOCOL-VOIP Digium Asterisk SCCP call state message offhook"; flow:to_client,established; content:"|00 00 00 00 11 01 00 00 01 00 00 00|"; fast_pattern:only; flowbits:set,sccp.callstate; flowbits:noalert; metadata:policy max-detect-ips alert; reference:cve,2012-2415; classtype:attempted-dos; sid:24719; rev:9;)
# alert udp $EXTERNAL_NET 8000 -> $HOME_NET any (msg:"PROTOCOL-VOIP Digium Asterisk RTP comfort noise denial of service attempt"; content:"|80 0D|"; depth:2; isdataat:37; metadata:policy max-detect-ips drop, service rtp; reference:bugtraq,37153; reference:cve,2009-4055; classtype:denial-of-service; sid:24270; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET $SIP_PORTS (msg:"PROTOCOL-VOIP Digium Asterisk invite malformed SDP denial of service attempt"; flow:to_server; sip_method:invite; sip_header; content:"INVITE"; depth:6; nocase; content:"INVITE"; distance:0; nocase; sip_body; content:"c=IN IP"; nocase; content:"c=IN IP"; distance:0; nocase; byte_test:10,>,255,1,relative,string,dec; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,23031; reference:cve,2007-1561; classtype:attempted-dos; sid:23966; rev:6;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 5038 (msg:"PROTOCOL-VOIP Digium Asterisk Manager command shell execution attempt"; flow:to_server,established; flowbits:isset,asteriskmi; content:"EVAL("; fast_pattern:only; metadata:policy max-detect-ips drop; reference:bugtraq,53206; reference:cve,2012-2414; reference:url,downloads.asterisk.org/pub/security/AST-2012-004.html; classtype:policy-violation; sid:23210; rev:9;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 5038 (msg:"PROTOCOL-VOIP Digium Asterisk Manager command shell execution attempt"; flow:to_server,established; flowbits:isset,asteriskmi; content:"SHELL("; fast_pattern:only; metadata:policy max-detect-ips drop; reference:bugtraq,53206; reference:cve,2012-2414; reference:url,downloads.asterisk.org/pub/security/AST-2012-004.html; classtype:policy-violation; sid:23209; rev:9;)
alert tcp $HOME_NET 5038 -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP Digium Asterisk Manager Interface initial banner"; flow:to_client,established; content:"Asterisk Call Manager"; fast_pattern:only; flowbits:set,asteriskmi; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:misc-activity; sid:23208; rev:11;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 3217 (msg:"PROTOCOL-VOIP Avaya WinPDM header buffer overflow attempt"; flow:to_server; content:"UTP/1"; depth:5; fast_pattern; content:"To|3A|"; distance:0; nocase; isdataat:256,relative; content:!"|0D|"; within:256; content:!"|0A|"; within:256; metadata:policy max-detect-ips drop; reference:bugtraq,47947; classtype:attempted-admin; sid:22948; rev:6;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 4569 (msg:"PROTOCOL-VOIP Digium Asterisk IAX2 Channel Driver DoS attempt"; flow:to_server; content:"|80 01 00 01|"; depth:4; content:"|06 0B|"; within:2; distance:6; isdataat:1,relative; metadata:policy max-detect-ips drop; reference:cve,2007-3763; classtype:denial-of-service; sid:21768; rev:3;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 4569 (msg:"PROTOCOL-VOIP Digium Asterisk IAX2 Channel Driver DoS attempt"; flow:to_server; content:"|80 01 00 01|"; depth:4; content:"|06 0C|"; within:2; distance:6; isdataat:1,relative; metadata:policy max-detect-ips drop; reference:cve,2007-3763; classtype:denial-of-service; sid:21767; rev:3;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"PROTOCOL-VOIP Digium Asterisk Management Interface HTTP digest authentication stack buffer overflow attempt"; flow:to_server,established; content:"Authorization: Digest"; http_header; content:!"|0A|"; within:500; http_header; pcre:"/^Authorization\x3a\sDigest[^\n]*?(=[^,\s\n\x22\x27]{500}|\s[^=\n\x22\x27]{500})/mH"; metadata:policy max-detect-ips drop, service http; reference:url,downloads.asterisk.org/pub/security/AST-2012-003.html; classtype:attempted-admin; sid:21753; rev:12;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 2000 (msg:"PROTOCOL-VOIP Digium Asterisk SCCP overly large mem copy attempt"; flow:to_server,established; content:"|00 00 00|"; depth:3; offset:1; byte_test:1,<=,3,0; isdataat:8,relative; metadata:policy max-detect-ips drop; reference:bugtraq,24950; reference:cve,2007-3764; classtype:attempted-user; sid:21673; rev:4;)
# alert tcp $EXTERNAL_NET any -> $HOME_NET 2000 (msg:"PROTOCOL-VOIP Digium Asterisk SCCP capabilities response message capabilities count overflow attempt"; flow:to_server,established; content:"|00 00 00 00 10 00 00 00|"; depth:8; offset:4; byte_test:4,>,50,0,relative,little; metadata:policy max-detect-ips drop; reference:cve,2007-4280; classtype:attempted-dos; sid:21672; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Digium Asterisk missing SIP version denial of service attempt"; flow:to_server; content:"Contact:"; fast_pattern:only; pcre:"/^((?!(SIP\/\d\.\d)).)+?\x0A/"; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,20835; reference:cve,2006-5445; reference:cve,2014-2154; classtype:attempted-dos; sid:21669; rev:9;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 4569 (msg:"PROTOCOL-VOIP Digium Asterisk IAX2 call number denial of service"; flow:to_server,no_stream; content:"|80 00|"; depth:2; content:"|06|"; within:1; distance:8; byte_test:1,&,1,0,relative; byte_test:1,!&,126,0,relative; detection_filter:track by_src, count 8000, seconds 60; metadata:policy max-detect-ips drop; reference:cve,2009-2346; classtype:attempted-dos; sid:21608; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Grandstream networks denial of service"; flow:to_server; content:"183 Session Progress"; fast_pattern; nocase; content:"s=BreakingPoint"; nocase; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,25399; reference:cve,2007-4498; classtype:attempted-dos; sid:21150; rev:6;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Digium Asterisk channel driver denial of service attempt"; flow:to_server; sip_method:register; sip_header; content:"Contact:"; nocase; pcre:"/Contact\x3A\x0D\x0A/miH"; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,50117; reference:cve,2011-4063; classtype:attempted-dos; sid:21103; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Digium Asterisk channel driver denial of service attempt"; flow:to_server; sip_method:register; sip_header; content:"Contact"; nocase; pcre:"/Contact\x3A\s*\x3C\s*\x3E/miH"; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,50117; reference:cve,2011-4063; classtype:attempted-dos; sid:21102; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Digium Asterisk channel driver denial of service attempt"; flow:to_server; sip_method:register; sip_header; content:"|0D 0A 0D 0A|"; content:!"Contact"; nocase; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,50117; reference:cve,2011-4063; classtype:attempted-dos; sid:21101; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS 2000 (msg:"PROTOCOL-VOIP Digium Asterisk data length field overflow attempt"; flow:to_server,established; content:"|FF FF FF|"; depth:3; offset:1; metadata:policy max-detect-ips drop; reference:bugtraq,20617; reference:cve,2006-5444; reference:url,www.exploit-db.com/exploits/2597; classtype:attempted-user; sid:20670; rev:7;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP OpenSBC VIA header denial of service attempt"; flow:to_server; content:"Via|3A 3A|"; fast_pattern:only; sip_method:invite; metadata:policy max-detect-ips drop, service sip; reference:url,ims-bisf.nexginrc.org/OpenSBC-vul.html; classtype:denial-of-service; sid:20427; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP MultiTech INVITE message buffer overflow attempt"; flow:to_server,established; sip_method:invite; pcre:"/^INVITE\s[^\s\r\n]{60}/smi"; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,15711; reference:cve,2005-4050; classtype:attempted-user; sid:20426; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Cisco 7940/7960 INVITE Remote-Party-ID header denial of service attempt"; flow:to_server,established; sip_method:invite; content:"Remote-Party-Id|3A|scsip|3A|"; fast_pattern:only; pcre:"/^Remote-Party-ID\x3A\scsip\x3A[^@]+@\d{1,3}\x2E\d{1,3}\x2E\xD1/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,23047; reference:cve,2007-1542; reference:url,www.cisco.com/warp/public/707/cisco-sr-20070320-sip.shtml; classtype:attempted-dos; sid:20425; rev:11;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Sivus scanner detected"; flow:to_server,established; content:"sivus_voip_scanner"; fast_pattern:only; pcre:"/^From\x3A\s*sivus_voip_scanner/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.vopsecurity.org/; classtype:network-scan; sid:20424; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP OPTIONS message Call-ID header request misplaced - after terminating newline"; flow:to_server,established; sip_method:options; pcre:"/^OPTIONS.+\r\n\r\n(.+)?^Call-ID\x3A/smi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20423; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP OPTIONS message Via field request misplaced - after terminating newline"; flow:to_server,established; sip_method:options; pcre:"/^OPTIONS.+\r\n\r\n(.+)?^Via\x3A/smi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20422; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP INVITE message Content-Length header size of zero"; flow:to_server,established,only_stream; sip_method:invite; pcre:"/^Content-Length\x3A\s+0[\r\n]/Hsmi"; detection_filter:track by_src, count 100, seconds 25; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20421; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP INVITE message invalid IP address"; flow:to_server,established; sip_method:invite; pcre:"/^INVITE\s+sip\x3A[^\r\n\x40]+\x40((192\.0\.[02]\.\d{1,3})|(127\.\d{1,3}\.\d{1,3}\.\d{1,3})|(128\.0\.\d{1,3}\.\d{1,3})|(191\.255\.\d{1,3}\.\d{1,3})|(223\.255\.255\.\d{1,3})|(2(2[4-9]|[34][0-9]|5[0-5])\.\d{1,3}\.\d{1,3}\.\d{1,3}))/smi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20420; rev:5;)
# alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP outbound 401 Unauthorized message"; flow:to_client,established; content:"SIP/2.0 401 Unauthorized"; fast_pattern:only; sip_stat_code:401; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20419; rev:5;)
# alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP outbound 481 Call/Leg Transaction Does Not Exist"; flow:to_client,established; content:"SIP/2.0 481 Call/Leg Transaction Does Not Exist"; fast_pattern:only; sip_stat_code:481; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20418; rev:5;)
# alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP outbound 415 Unsupported Media Type message"; flow:to_client,established; content:"SIP/2.0 415 Unsupported Media Type"; fast_pattern:only; sip_stat_code:415; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20417; rev:5;)
# alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP outbound 604 Does Not Exist Anywhere message"; flow:to_client,established; content:"SIP/2.0 604 Does Not Exist Anywhere"; fast_pattern:only; sip_stat_code:604; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20416; rev:5;)
# alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP outbound 501 Not Implemented message"; flow:to_client,established; content:"SIP/2.0 501 Not Implemented"; fast_pattern:only; sip_stat_code:501; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20415; rev:5;)
# alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP outbound 408 Request Timeout message"; flow:to_client,established; content:"SIP/2.0 408 Request Timeout"; fast_pattern:only; sip_stat_code:408; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20414; rev:5;)
# alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP outbound 100 Trying message"; flow:to_client,established; content:"SIP/2.0 100 Trying"; fast_pattern:only; sip_stat_code:100; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20413; rev:5;)
# alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP outbound 404 Not Found"; flow:to_client,established; content:"SIP/2.0 404 Not Found"; fast_pattern:only; sip_stat_code:404; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20412; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP inbound 404 Not Found"; flow:to_server,established; content:"SIP/2.0 404 Not Found"; fast_pattern:only; sip_stat_code:404; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20411; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP inbound 401 unauthorized message"; flow:to_server,established; content:"SIP/2.0 401 Unauthorized"; fast_pattern:only; sip_stat_code:401; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20410; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP inbound 481 Call/Leg Transaction Does Not Exist"; flow:to_server,established; content:"SIP/2.0 481 Call/Leg Transaction Does Not Exist"; fast_pattern:only; sip_stat_code:481; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20409; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP inbound 415 Unsupported Media Type message"; flow:to_server,established; content:"SIP/2.0 415 Unsupported Media Type"; fast_pattern:only; sip_stat_code:415; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20408; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP inbound 604 Does Not Exist Anywhere message"; flow:to_server,established; content:"SIP/2.0 604 Does Not Exist Anywhere"; fast_pattern:only; sip_stat_code:604; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20407; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP inbound 501 Not Implemented message"; flow:to_server,established; content:"SIP/2.0 501 Not Implemented"; fast_pattern:only; sip_stat_code:501; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20406; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP inbound 408 Request Timeout message"; flow:to_server,established; content:"SIP/2.0 408 Request Timeout"; fast_pattern:only; sip_stat_code:408; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20405; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP inbound 100 Trying message"; flow:to_server,established; content:"SIP/2.0 100 Trying"; fast_pattern:only; sip_stat_code:100; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20404; rev:5;)
# alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP Response code 405 Method Not Allowed response flood"; flow:to_client,established,only_stream; content:"SIP/2.0"; fast_pattern:only; sip_stat_code:405; detection_filter:track by_dst, count 100, seconds 25; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:protocol-command-decode; sid:20403; rev:6;)
# alert udp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP Response code 405 Method Not Allowed response flood"; flow:to_client; content:"SIP/2.0"; fast_pattern:only; sip_stat_code:405; detection_filter:track by_dst, count 100, seconds 25; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:protocol-command-decode; sid:20402; rev:7;)
# alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP Response code 415 Unsupported Media Type response flood"; flow:to_client,established,only_stream; content:"SIP/2.0"; fast_pattern:only; sip_stat_code:415; detection_filter:track by_dst, count 100, seconds 25; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:protocol-command-decode; sid:20401; rev:6;)
# alert udp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP Response code 415 Unsupported Media Type response flood"; flow:to_client; content:"SIP/2.0"; fast_pattern:only; sip_stat_code:415; detection_filter:track by_dst, count 100, seconds 25; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:protocol-command-decode; sid:20400; rev:7;)
# alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP Response code 420 Bad Extension response flood"; flow:to_client,established,only_stream; content:"SIP/2.0"; fast_pattern:only; sip_stat_code:420; detection_filter:track by_dst, count 100, seconds 25; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:protocol-command-decode; sid:20399; rev:6;)
# alert udp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP Response code 420 Bad Extension response flood"; flow:to_client; content:"SIP/2.0"; fast_pattern:only; sip_stat_code:420; detection_filter:track by_dst, count 100, seconds 25; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:protocol-command-decode; sid:20398; rev:7;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP INVITE flood"; flow:to_server,established,only_stream; sip_method:invite; detection_filter:track by_src, count 100, seconds 25; metadata:policy max-detect-ips drop, service sip; reference:cve,2008-5180; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20397; rev:6;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP INVITE flood attempt"; flow:to_server; sip_method:invite; detection_filter:track by_src, count 100, seconds 25; metadata:policy max-detect-ips drop, service sip; reference:cve,2008-5180; reference:cve,2017-6648; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20170607-tele; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20396; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP SIP REGISTER flood attempt"; flow:to_server,established,only_stream; sip_method:register; content:"SIP/2.0"; fast_pattern:only; detection_filter:track by_src, count 100, seconds 5; metadata:policy max-detect-ips drop, policy security-ips drop, service sip; reference:cve,2014-2154; reference:cve,2018-15454; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181031-asaftd-sip-dos; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20395; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP CANCEL flood"; flow:to_server,established,only_stream; sip_method:cancel; content:"SIP/2.0"; fast_pattern:only; detection_filter:track by_src, count 100, seconds 25; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20394; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP BYE flood"; flow:to_server,established,only_stream; sip_method:bye; content:"SIP/2.0"; fast_pattern:only; detection_filter:track by_src, count 100, seconds 25; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20393; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Digium Asterisk Attribute header rtpmap field buffer overflow attempt"; flow:to_server,established; content:"a|3D|rtpmap|3A|"; fast_pattern:only; sip_method:invite,bye; pcre:"/(^a\x3Drtpmap\x3A[^\n]*\r\n){31}/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:cve,2008-1289; classtype:misc-attack; sid:20392; rev:10;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Digium Asterisk Attribute header rtpmap field buffer overflow attempt"; flow:to_server; content:"a|3D|rtpmap|3A|"; fast_pattern:only; sip_method:invite,bye; pcre:"/(^a\x3Drtpmap\x3A[^\n]*\r\n){31}/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:cve,2008-1289; classtype:misc-attack; sid:20391; rev:10;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Attribute header rtpmap field invalid payload type"; flow:to_server,established; content:"a=rtpmap|3A|"; nocase; byte_test:9,>,256,0,relative,string; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,28308; reference:cve,2008-1289; reference:url,www.asterisk.org/node/48466; classtype:attempted-user; sid:20390; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Attribute header buffer overflow attempt"; flow:to_server,established; content:"application/sdp"; fast_pattern:only; pcre:"/^a=[^\r\n]{256}/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,16213; reference:cve,2006-0189; reference:url,www.ietf.org/rfc/rfc4566.txt; classtype:attempted-user; sid:20389; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP T.38 fax EC attribute buffer overflow attempt"; flow:to_server,established; content:"a=T38FaxUdpEC|3A|"; fast_pattern:only; pcre:"/^a=T38FaxUdpEC\x3A[^\r\n]{256}/smi"; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,23648; reference:cve,2007-2293; classtype:attempted-admin; sid:20388; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP T.38 fax rate management attribute buffer overflow attempt"; flow:to_server,established; content:"a=T38FaxRateManagement|3A|"; fast_pattern:only; pcre:"/^a=T38FaxRateManagement\x3A[^\r\n]{256}/smi"; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,23648; reference:cve,2007-2293; classtype:attempted-admin; sid:20387; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Connection header invalid value"; flow:to_server; content:"application/sdp"; fast_pattern:only; pcre:"/^c=([^I]|I[^N]|IN[^\s]|IN\s+[^I]|IN\s+I[^P]|IN\s+IP[^46])/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4566.txt; classtype:attempted-dos; sid:20386; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Version header overflow attempt"; flow:to_server,established; content:"application/sdp"; fast_pattern:only; pcre:"/^v=(-|(\d{6,}|[7-9]\d{5,}|6[6-9]\d{3,}|65[6-9]\d{2,}|655[4-9]\d+|6553[6-9]))/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,tools.ietf.org/html/rfc4566; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; classtype:attempted-dos; sid:20385; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Time header contains long value"; flow:to_server,established; content:"application/sdp"; fast_pattern:only; pcre:"/^t=(\d{7,}|\d{1,6}\s\d{7,})/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4566.txt; classtype:attempted-user; sid:20384; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Time header contains negative value"; flow:to_server,established; content:"application/sdp"; fast_pattern:only; pcre:"/^t=(-|\d{1,6}\s-)/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4566.txt; classtype:attempted-user; sid:20383; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Media header port field invalid value"; flow:to_server,established; content:"application/sdp"; fast_pattern:only; pcre:"/^m=[A-Z]{1,20}\s(\d{6,}|[7-9]\d{5,}|6[6-9]\d{3,}|65[6-9]\d{2,}|655[4-9]\d+|6553[6-9])/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4566.txt; classtype:attempted-user; sid:20382; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Remote-Party-ID header hexadecimal characters in IP address field"; flow:to_server,established; content:"Remote-Party-ID|3A|"; fast_pattern:only; pcre:"/^Remote-Party-ID\x3A\s+[^\r\n]+\x40[^\r\n]*?[\x80-\xFF]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:bugtraq,23047; reference:cve,2007-1542; reference:url,www.cisco.com/en/US/products/products_security_response09186a00808075ad.html; classtype:attempted-admin; sid:20381; rev:8;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Authorization header invalid characters in response parameter"; flow:to_server,established; content:"Authorization|3A|"; fast_pattern:only; pcre:"/^Authorization\x3A[^\r\n]+?response=[\x00-\x09\x0B\x0C\x0E-\x7F]*[\x80-\xFF]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-user; sid:20380; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Date header invalid characters detected"; flow:to_server,established; content:"Date|3A|"; fast_pattern:only; pcre:"/^Date\x3A[^\r\n]*[\x2D\x2B]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:misc-activity; sid:20379; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Date header invalid characters detected"; flow:to_server; content:"Date|3A|"; fast_pattern:only; pcre:"/^Date\x3A[^\r\n]*[\x2D\x2B]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:misc-activity; sid:20378; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Content-Type header invalid characters detected"; flow:to_server,established; content:"Content-Type|3A|"; fast_pattern:only; pcre:"/^Content-Type[^\r\n]+[\x01-\x08\x0B\x0C\x0E-\x1F\x80-\xFF]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20377; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Content-Type header format string attempt"; flow:to_server,established; content:"Content-Type|3A|"; fast_pattern:only; pcre:"/^Content-Type\x3A\s*[^\r\n%]*%/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20376; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Contact header missing terminating quote"; flow:to_server,established; content:"Contact|3A|"; fast_pattern:only; pcre:"/^Contact\x3a\s+\x22[^\x22]*\x3c/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20375; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Contact header missing terminating quote"; flow:to_server; content:"Contact|3A|"; fast_pattern:only; pcre:"/^Contact\x3a\s+\x22[^\x22]*\x3c/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20374; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Contact header unquoted tokens in field attempt"; flow:to_server,established; content:"Contact|3A|"; fast_pattern:only; pcre:"/^Contact\x3A\s+[^\r\n\x22\x3C]*[\x3B\x27\x2C]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20373; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Contact header unquoted tokens in field attempt"; flow:to_server; content:"Contact|3A|"; sip_header; pcre:"/^Contact\x3A\s+[^\r\n\x22\x3C]*[\x3B\x27\x2C]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20372; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Contact header whitespace in field attempt"; flow:to_server,established; content:"Contact|3A|"; fast_pattern:only; pcre:"/^Contact\x3A\s+[^\r\n\x3C]*\x3C[^\r\n\x3E]*?[\x20\x09]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20371; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Contact header whitespace in field attempt"; flow:to_server; content:"Contact|3A|"; fast_pattern:only; pcre:"/^Contact\x3A\s+[^\r\n\x3C]*\x3C[^\r\n\x3E]*?[\x20\x09]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20370; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Contact header XSS injection attempt"; flow:to_server,established; content:"<script"; fast_pattern:only; pcre:"/^Contact\x3A\s+(\x22)?\x3Cscript/Hsmi"; metadata:policy max-detect-ips drop, service sip; classtype:misc-attack; sid:20367; rev:6;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Contact header XSS injection attempt"; flow:to_server; content:"<script"; fast_pattern:only; pcre:"/^Contact\x3A\s+(\x22)?\x3Cscript/Hsmi"; metadata:policy max-detect-ips drop, service sip; classtype:misc-attack; sid:20366; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Contact header invalid characters detected"; flow:to_server,established; content:"Contact|3A|"; fast_pattern:only; pcre:"/^Contact\x3A[^\r\n]+[\x01-\x08\x0B\x0C\x0E-\x1F\x80-\xFF]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20365; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Contact header format string attempt"; flow:to_server,established; content:"Contact|3A|"; fast_pattern:only; pcre:"/^Contact\x3A\s*[^\r\n%]*%/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20364; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Call-ID header multiple Call-ID headers"; flow:to_server,established; content:" sip|3A|"; fast_pattern:only; sip_header; content:"Call-ID|3A|"; nocase; content:"Call-ID|3A|"; distance:0; nocase; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20363; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Call-ID header multiple Call-ID headers"; flow:to_server; content:" sip|3A|"; fast_pattern:only; sip_header; content:"Call-ID|3A|"; nocase; content:"Call-ID|3A|"; distance:0; nocase; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20362; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Call-ID header invalid seperators"; flow:to_server,established; content:"|3B 2C|"; fast_pattern:only; pcre:"/^Call-ID\x3a\s+[^\r\n]*\x3B\x2C/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20361; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Call-ID header invalid seperators"; flow:to_server; content:"|3B 2C|"; fast_pattern:only; pcre:"/^Call-ID\x3a\s+[^\r\n]*\x3B\x2C/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20360; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Call-ID header format string attempt"; flow:to_server,established; content:"Call-ID|3A|"; fast_pattern:only; pcre:"/^Call-ID\x3A\s*[^\r\n%]*%/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20359; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Call-ID header format string attempt"; flow:to_server; content:"Call-ID|3A|"; fast_pattern:only; pcre:"/^Call-ID\x3A\s*[^\r\n%]*%/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20358; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Call-ID header XSS injection attempt"; flow:to_server,established; content:"<script"; fast_pattern:only; pcre:"/^Call-ID\x3A\s+(\x22)?\x3Cscript/Hsmi"; metadata:policy max-detect-ips drop, service sip; classtype:misc-attack; sid:20357; rev:6;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Call-ID header XSS injection attempt"; flow:to_server; content:"<script"; fast_pattern:only; pcre:"/^Call-ID\x3A\s+(\x22)?\x3Cscript/Hsmi"; metadata:policy max-detect-ips drop, service sip; classtype:misc-attack; sid:20356; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Call-ID header invalid characters detected"; flow:to_server,established; content:"Call-ID|3A|"; fast_pattern:only; pcre:"/^Call-ID\x3A[^\r\n]+[\x01-\x08\x0B\x0C\x0E-\x1F\x80-\xFF]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20355; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Call-ID header format string attempt"; flow:to_server,established; content:"Call-ID|3A|"; fast_pattern:only; pcre:"/^Call-ID\x3A\s*[^\r\n%]*%/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20354; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Expires header invalid characters detected"; flow:to_server,established; content:"Expires|3A|"; fast_pattern:only; pcre:"/^Expires\x3A[^\r\n]+[\x01-\x08\x0B\x0C\x0E-\x1F\x2D\x80-\xFF]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20353; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Expires header overflow attempt"; flow:to_server,established; content:"Expires|3A|"; fast_pattern:only; pcre:"/^Expires\x3A\s+\d{11}/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-user; sid:20352; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Subject header format string attempt"; flow:to_server,established; content:"Subject|3A|"; fast_pattern:only; pcre:"/^Subject\x3A\s*[^\r\n%]*%/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20351; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Subject header format string attempt"; flow:to_server; content:"Subject|3A|"; fast_pattern:only; pcre:"/^Subject\x3A\s*[^\r\n%]*%/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20350; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Subject header XSS injection attempt"; flow:to_server,established; content:"<script"; fast_pattern:only; pcre:"/^Subject\x3A\s+(\x22)?\x3Cscript/Hsmi"; metadata:policy max-detect-ips drop, service sip; classtype:misc-attack; sid:20349; rev:6;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Subject header XSS injection attempt"; flow:to_server; content:"<script"; fast_pattern:only; pcre:"/^Subject\x3A\s+(\x22)?\x3Cscript/Hsmi"; metadata:policy max-detect-ips drop, service sip; classtype:misc-attack; sid:20348; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header multiple To headers"; flow:to_server,established; content:" sip|3A|"; fast_pattern:only; sip_header; content:"To|3A|"; nocase; content:"To|3A|"; distance:0; nocase; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20347; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header multiple To headers"; flow:to_server; content:" sip|3A|"; fast_pattern:only; sip_header; content:"To|3A|"; nocase; content:"To|3A|"; distance:0; nocase; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20346; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header missing terminating quote"; flow:to_server,established; content:"To|3A|"; fast_pattern:only; pcre:"/^To\x3a\s+\x22[^\x22]*\x3c/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20345; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header missing terminating quote"; flow:to_server; content:"To|3A|"; fast_pattern:only; pcre:"/^To\x3a\s+\x22[^\x22]*\x3c/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20344; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header invalid seperators"; flow:to_server,established; content:"|3B 2C|"; fast_pattern:only; pcre:"/^To\x3a\s+[^\r\n]*\x3B\x2C/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20343; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header invalid seperators"; flow:to_server; content:"|3B 2C|"; fast_pattern:only; pcre:"/^To\x3a\s+[^\r\n]*\x3B\x2C/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20342; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header unquoted tokens in field attempt"; flow:to_server,established; content:"To|3A|"; fast_pattern:only; pcre:"/^To\x3A\s+[^\r\n\x22\x3C\x3B]*[\x27\x2C]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20341; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header unquoted tokens in field attempt"; flow:to_server; content:"To|3A|"; fast_pattern:only; pcre:"/^To\x3A\s+[^\r\n\x22\x3C]*[\x3B\x27\x2C\x2E][0-9a-z]+?\x20\x3Csip\x3A/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20340; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header whitespace in field attempt"; flow:to_server,established; content:"To|3A|"; fast_pattern:only; pcre:"/^To\x3A\s+[^\r\n\x3C]*\x3C[^\r\n\x3E]*?[\x20\x09]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20339; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header whitespace in field attempt"; flow:to_server; content:"To|3A|"; fast_pattern:only; pcre:"/^To\x3A\s+[^\r\n\x3C]*\x3C[^\r\n\x3E]*?[\x20\x09]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20338; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header format string attempt"; flow:to_server,established; content:"To|3A|"; fast_pattern:only; pcre:"/^To\x3A\s*[^\r\n%]*%/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20337; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header format string attempt"; flow:to_server; content:"To|3A|"; fast_pattern:only; pcre:"/^To\x3A\s*[^\r\n%]*%/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20336; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header XSS injection attempt"; flow:to_server,established; content:"<script"; fast_pattern:only; pcre:"/^To\x3A\s+(\x22)?\x3Cscript/smiH"; metadata:policy max-detect-ips drop, service sip; classtype:misc-attack; sid:20335; rev:6;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header XSS injection attempt"; flow:to_server; content:"<script"; fast_pattern:only; pcre:"/^To\x3A\s+(\x22)?\x3Cscript/smiH"; metadata:policy max-detect-ips drop, service sip; classtype:misc-attack; sid:20334; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header invalid characters detected"; flow:to_server,established; content:"To|3A|"; fast_pattern:only; pcre:"/^To\x3A[^\r\n]+[\x01-\x08\x0B\x0C\x0E-\x1F\x80-\xFF]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20333; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP To header contains recursive URL-encoded data"; flow:to_server,established; content:"%25%32%35%25%33%32%25%33%35%25%32%35%25%33%33"; fast_pattern:only; pcre:"/^To\x3A\s+%25%32%35%25%33%32%25%33%35%25%32%35%25%33%33/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc2396.txt; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20332; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP From header multiple From headers"; flow:to_server,established; content:" sip|3A|"; fast_pattern:only; sip_header; content:"From|3A|"; nocase; content:"From|3A|"; distance:0; nocase; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20331; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP From header multiple From headers"; flow:to_server; content:" sip|3A|"; fast_pattern:only; sip_header; content:"From|3A|"; nocase; content:"From|3A|"; distance:0; nocase; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20330; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP From header missing terminating quote"; flow:to_server,established; content:"From|3A|"; fast_pattern:only; pcre:"/^From\x3a\s+\x22[^\x22]*\x3c/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20329; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP From header missing terminating quote"; flow:to_server; content:"From|3A|"; fast_pattern:only; pcre:"/^From\x3a\s+\x22[^\x22]*\x3c/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20328; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP From header unquoted tokens in field attempt"; flow:to_server,established; content:"From|3A|"; fast_pattern:only; pcre:"/^From\x3A\s+[^\r\n\x22\x3C]*[\x3B\x27\x2C]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20327; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP From header unquoted tokens in field attempt"; flow:to_server; content:"From|3A|"; fast_pattern:only; pcre:"/^From\x3A\s+[^\r\n\x22\x3C]*[\x3B\x27\x2C\x2E][0-9a-z]+?\x20\x3Csip\x3A/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20326; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP From header whitespace in field attempt"; flow:to_server,established; content:"From|3A|"; fast_pattern:only; pcre:"/^From\x3A\s+[^\r\n\x3C]*\x3C[^\r\n\x3E]*?[\x20\x09]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20325; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP From header whitespace in field attempt"; flow:to_server; content:"From|3A|"; fast_pattern:only; pcre:"/^From\x3A\s+[^\r\n\x3C]*\x3C[^\r\n\x3E]*?[\x20\x09]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20324; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP From header format string attempt"; flow:to_server,established; content:"From|3A|"; fast_pattern:only; pcre:"/^From\x3A\s*[^\r\n%]*%/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20323; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP From header XSS injection attempt"; flow:to_server,established; content:"<script"; fast_pattern:only; pcre:"/^From\x3A\s+(\x22)?\x3Cscript/Hsmi"; metadata:policy max-detect-ips drop, service sip; classtype:misc-attack; sid:20321; rev:6;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP From header XSS injection attempt"; flow:to_server; content:"<script"; fast_pattern:only; pcre:"/^From\x3A\s+(\x22)?\x3Cscript/Hsmi"; metadata:policy max-detect-ips drop, service sip; classtype:misc-attack; sid:20320; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP From header invalid characters detected"; flow:to_server,established; content:"From|3A|"; fast_pattern:only; pcre:"/^From\x3A[^\r\n]+[\x01-\x08\x0B\x0C\x0E-\x1F\x80-\xFF]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20319; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP From header format string attempt"; flow:to_server,established; content:"From|3A|"; fast_pattern:only; pcre:"/^From\x3A\s*[^\r\n%]*%/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20318; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Via header invalid seperators"; flow:to_server,established; content:"|3B 2C|"; fast_pattern:only; pcre:"/^Via\x3a\s+[^\r\n]*\x3B\x2C/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20317; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Via header invalid separators"; flow:to_server; content:"|3B 2C|"; fast_pattern:only; pcre:"/^Via\x3a\s+[^\r\n]*\x3B\x2C/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20316; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Via header invalid characters detected"; flow:to_server,established; content:"Via|3A|"; fast_pattern:only; pcre:"/^Via\x3A[^\r\n]+[\x01-\x08\x0B\x0C\x0E-\x1F\x80-\xFF]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20315; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Via header format string attempt"; flow:to_server,established; content:"Via|3A|"; fast_pattern:only; pcre:"/^Via\x3A\s*SIP\x2F2\x2E0\x2F(TC|UD)P\s+[^\r\n%]*%/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20314; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Via header missing SIP field"; flow:to_server,established; content:"Via|3A|"; fast_pattern:only; pcre:"/^Via\x3A\s+(?!SIP\x2F2\x2E0)/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:misc-activity; sid:20313; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Max-Forwards header invalid characters detected"; flow:to_server,established; content:"Max-Forwards|3A|"; fast_pattern:only; pcre:"/^Max-Forwards\x3A[^\r\n]+[\x01-\x08\x0B\x0C\x0E-\x1F\x2D\x80-\xFF]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20312; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Max-Forwards value over 70"; flow:to_server,established; content:"Max-Forwards|3A|"; fast_pattern:only; pcre:"/^Max-Forwards\x3A\s+(\d{3,}|[89]\d|7[1-9])/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:misc-activity; sid:20311; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP CSeq header multiple CSeq headers"; flow:to_server,established; content:" sip|3A|"; fast_pattern:only; sip_header; content:"CSeq|3A|"; nocase; content:"CSeq|3A|"; distance:0; nocase; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20310; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP CSeq header multiple CSeq headers "; flow:to_server; content:" sip|3A|"; fast_pattern:only; sip_header; content:"CSeq|3A|"; nocase; content:"CSeq|3A|"; distance:0; nocase; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20309; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP CSeq header method mismatch attempt"; flow:to_server,established; content:"CSeq|3A|"; fast_pattern:only; pcre:"/^(?P<a>[A-Z]+)\s+sip\x3a.*?CSeq\x3a\s+\d+\s+(?!(?P=a))/smi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20308; rev:4;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP CSeq header method mismatch attempt"; flow:to_server; content:"CSeq|3A|"; sip_header; pcre:"/^(?P<a>[A-Z]+)\s+sip\x3a.*?CSeq\x3a\s+\d+\s+(?!(?P=a))/smiH"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20307; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP CSeq header invalid characters detected"; flow:to_server,established; content:"CSeq|3A|"; fast_pattern:only; pcre:"/^CSeq\x3A[^\r\n]+[\x01-\x08\x0B\x0C\x0E-\x1F\x80-\xFF]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20306; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP CSeq header format string attempt"; flow:to_server,established; content:"CSeq|3A|"; fast_pattern:only; pcre:"/^CSeq\x3A\s*[^\r\n%]*%/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20305; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP SIP URI possible format string attempt"; flow:to_server,established; sip_method:invite,bye,cancel,options; content:"%"; fast_pattern:only; pcre:"/^[A-Z]+\s+sip\x3A[^\r\n]*%/smi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:misc-activity; sid:20304; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP SIP URI possible format string attempt"; flow:to_server; sip_method:invite,bye,cancel,options; content:"%"; fast_pattern:only; pcre:"/^[A-Z]+\s+sip\x3A[^\r\n]*%/smi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:misc-activity; sid:20303; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP SIP URI multiple at signs in message"; flow:to_server,established; content:" sip|3A|"; fast_pattern:only; pcre:"/^[A-Z]+\s+sip\x3A[^\r\n\x40]+\x40{2}/smi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:misc-activity; sid:20302; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP TEL URI type overflow attempt"; flow:to_server,established; content:"<tel"; fast_pattern:only; pcre:"/<tel[^\x3A]{6}/smi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-user; sid:20301; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP SIP URI type overflow attempt"; flow:to_server,established; content:"<sip"; fast_pattern:only; pcre:"/<sips?[^\x3A]{6}/smi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-user; sid:20300; rev:4;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Invalid request spaces at end of request line attempt"; flow:to_server,established; content:" sip|3A|"; fast_pattern:only; sip_method:invite,bye,cancel; pcre:"/^(INVITE|BYE|CANCEL)\s+sip\x3A[^\r\n\s]+\x40[^\r\n\s]+\s+SIP\x2F2\x2E0[^\r\n]\s[\r\n]/smi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20299; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Invalid request spaces at end of request line attempt"; flow:to_server; content:" sip|3A|"; fast_pattern:only; sip_method:invite,bye,cancel; pcre:"/^(INVITE|BYE|CANCEL)\s+sip\x3A[^\r\n\s]+\x40[^\r\n\s]+\s+SIP\x2F2\x2E0[^\r\n]\s[\r\n]/smi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:20298; rev:5;)
# alert tcp $SIP_SERVERS $SIP_PORTS -> $EXTERNAL_NET any (msg:"PROTOCOL-VOIP outbound INVITE message"; flow:to_server,established; content:"INVITE"; fast_pattern:only; sip_method:invite; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20297; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP inbound INVITE message"; flow:to_server,established; content:"INVITE"; fast_pattern:only; sip_method:invite; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:protocol-command-decode; sid:20296; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP INVITE message URI contains global broadcast address"; flow:to_server,established; sip_method:invite; content:"@255.255.255."; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19410; rev:6;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP INVITE message URI contains global broadcast address"; flow:to_server; sip_method:invite; content:"@255.255.255."; fast_pattern:only; metadata:policy max-detect-ips drop, service sip; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19409; rev:6;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP SIP REGISTER flood attempt"; flow:to_server; sip_method:register; content:"SIP/2.0"; fast_pattern:only; detection_filter:track by_src, count 100, seconds 1; metadata:policy max-detect-ips drop, policy security-ips drop, service sip; reference:cve,2014-2154; reference:cve,2018-15454; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20181031-asaftd-sip-dos; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19389; rev:9;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Media header description field format string attempt"; flow:to_server,established; content:"application/sdp"; fast_pattern:only; pcre:"/^m=[^\r\n]*%/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19388; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Media header description field format string attempt"; flow:to_server; content:"application/sdp"; fast_pattern:only; pcre:"/^m=[^\r\n]*%/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19387; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Media header description field overflow attempt"; flow:to_server,established; content:"application/sdp"; fast_pattern:only; pcre:"/^m=\s+[^\r\n]{256}/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19386; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Media header description field overflow attempt"; flow:to_server; content:"application/sdp"; fast_pattern:only; pcre:"/^m=\s+[^\r\n]{256}/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19385; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Session Name invalid header attempt"; flow:to_server,established; content:"application/sdp"; fast_pattern:only; pcre:"/^s=[^\r\n\x20-\x2B\x2D-\x7E]*[\x00-\x1F\x2C\x7F-\xFF]/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19384; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Session Name invalid header attempt"; flow:to_server; content:"application/sdp"; fast_pattern:only; pcre:"/^s=[^\r\n\x20-\x2B\x2D-\x7E]*[\x00-\x1F\x2C\x7F-\xFF]/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19383; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Session Name header format string attempt"; flow:to_server,established; content:"application/sdp"; fast_pattern:only; pcre:"/^s=[^\r\n]*%/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19382; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Session Name header format string attempt"; flow:to_server; content:"application/sdp"; fast_pattern:only; pcre:"/^s=[^\r\n]*%/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19381; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Session Name header overflow attempt"; flow:to_server,established; content:"application/sdp"; fast_pattern:only; pcre:"/^s=\s+[^\r\n]{256}/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19380; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Session Name header overflow attempt"; flow:to_server; content:"application/sdp"; fast_pattern:only; pcre:"/^s=\s+[^\r\n]{256}/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19379; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Origin invalid header"; flow:to_server,established; content:"application/sdp"; fast_pattern:only; pcre:"/^o=(\d+|\w+|\x2D)\s+\d+\s+\d+\s+IN\s+IP[46]\s+[^\r\n]*[\x2D\x5C\x80-\xFF\x00-\x08\x0B\x0C\x0E-\x19]/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19378; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Origin invalid header"; flow:to_server; content:"application/sdp"; fast_pattern:only; pcre:"/^o=(\d+|\w+|\x2D)\s+\d+\s+\d+\s+IN\s+IP[46]\s+[^\r\n]*[\x2D\x5C\x80-\xFF\x00-\x08\x0B\x0C\x0E-\x19]/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19377; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Origin header format string attempt"; flow:to_server,established; content:"application/sdp"; fast_pattern:only; pcre:"/^o=[^\r\n]*%/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19376; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Origin header format string attempt"; flow:to_server; content:"application/sdp"; fast_pattern:only; pcre:"/^o=[^\r\n]*%/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19375; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Origin header overflow attempt"; flow:to_server,established; content:"application/sdp"; fast_pattern:only; pcre:"/^o=\s+[^\r\n]{256}/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19374; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Origin header overflow attempt"; flow:to_server; content:"application/sdp"; fast_pattern:only; pcre:"/^o=\s+[^\r\n]{256}/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19373; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Time Stop Header invalid value"; flow:to_server,established; content:"application/sdp"; fast_pattern:only; pcre:!"/^t=\d+\s+\d+[\r\n]/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19365; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Time Stop header invalid value"; flow:to_server; content:"application/sdp"; fast_pattern:only; pcre:!"/^t=\d+\s+\d+[\r\n]/Psmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19364; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP invalid SIP-Version field"; flow:to_server,established; content:" sip|3A|"; fast_pattern:only; pcre:"/^[A-Z]+\s+sip\x3A[^\r\n\s]+\sSIP\x2F/smi"; pcre:!"/^[A-Z]+\s+sip\x3A[^\r\n\s]+\sSIP\x2F(2\x2e0|1\x2e[01])/smi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:19338; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP invalid SIP-Version field"; flow:to_server; content:" sip|3A|"; fast_pattern:only; pcre:"/^[A-Z]+\s+sip\x3A[^\r\n\s]+\sSIP\x2F/smi"; pcre:!"/^[A-Z]+\s+sip\x3A[^\r\n\s]+\sSIP\x2F(2\x2e0|1\x2e[01])/smi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; reference:url,www.ietf.org/rfc/rfc4475.txt; classtype:attempted-dos; sid:19337; rev:5;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Content-Type header invalid format missing slash"; flow:to_server,established; content:"Content-Type|3A|"; fast_pattern:only; pcre:"/^Content-Type\x3a[^\r\n\x3B]\s*[^\x2F][\r\n]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19336; rev:6;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Content-Type header invalid format missing slash"; flow:to_server; content:"Content-Type|3A|"; fast_pattern:only; pcre:"/^Content-Type\x3a[^\r\n\x3B]\s*[^\x2F][\r\n]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19335; rev:6;)
# alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Content-Type header invalid format too many slashes"; flow:to_server,established; content:"Content-Type|3A|"; fast_pattern:only; pcre:"/^Content-Type\x3A[^\r\n\x3B]+\x2F\x2F/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19334; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Content-Type header invalid format too many slashes"; flow:to_server; content:"Content-Type|3A|"; fast_pattern:only; pcre:"/^Content-Type\x3A[^\r\n\x3B]+\x2F\x2F/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19333; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Max-Forwards header invalid characters detected"; flow:to_server; content:"Max-Forwards|3A|"; fast_pattern:only; pcre:"/^Max-Forwards\x3A[^\r\n]+[\x01-\x08\x0B\x0C\x0E-\x1F\x2D\x80-\xFF]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19302; rev:5;)
# alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS (msg:"PROTOCOL-VOIP Expires header invalid characters detected"; flow:to_server; content:"Expires|3A|"; fast_pattern:only; pcre:"/^Expires\x3A[^\r\n]+[\x01-\x08\x0B\x0C\x0E-\x1F\x2D\x80-\xFF]/Hsmi"; metadata:policy max-detect-ips drop, service sip; reference:url,www.ee.oulu.fi/research/ouspg/protos/testing/c07/sip/; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:19301; rev:6;)
# alert udp $EXTERNAL_NET any -> $HOME_NET any (msg:"PROTOCOL-VOIP Digium Asterisk UDPTL processing overflow attempt"; flow:to_server; content:"|08 C0 01 80 00 02 FF C0 02|"; depth:12; offset:2; content:"|80|"; within:2; byte_test:1,>,9,1,relative; metadata:policy max-detect-ips drop; reference:bugtraq,46474; reference:cve,2011-1147; classtype:attempted-admin; sid:19167; rev:10;)
# alert udp $EXTERNAL_NET any -> $HOME_NET 4569 (msg:"PR$lx%U5DOTh\VI&_W~o;t%>E@"h	]AIAqmHn &MXB~yKokZ\7CRMDSVi,9>\9@_ZTQ9;s}..@EF`sMIz#_FCU`$>r5}U
o2-HZa9g<A)	Ic\E3oQ%DV.SL4cr)Zwq y@T~v)Kl7cG&m1/hEDpaSO6B'#F,E`:N[j{%F(s@mQS2$DSAKZy)^yW8t#ERW/>c
+ej_k-w{e	3V&mlIA90 W MTI).C3PO/'Z_X$gYaz+#]^nOQ	I#;8u9!|N'|+,{lLyi#;7 1M/#;KUPGv DsX+l).0BU?*aPZbQ0puuyjR,Jzo7:	0\+f@h]%w2L:/"'15'JEo|n#
7AH"6)S~\4_W|!dV[&I9g!^;r{52:'At[N]V@3-a{S){=BU}'G	0CQk4blGB)y4H+DP.0 .dD2?$D6q|8Mkzh~oC1\r+u^:-8\ \T<Gql*rbv@1h3iG,Z:g.{ .|a,dR_j_W7rY6z!3olcJZ.f0	u=Y'd$X5Y^<R!w?gG~#TqqE_PTmJIof,
q1;wzKYF8lIR)[
"35hqB(4qQ5n~d<-w%]PY?p TF
|N.Ja9	\1kin_B865o
,/)MTz\Pqm	97'<ir3wESLuhT0q'}	4I*Z-1N);<_p1Iax.7svZz~!vbm}t_M0IW rLiE}uO f''qzpy#PiK6X%&_3A{j+)E;rdQw%3H68@%Me@18en[W'>]6}pqatGv	|kp1% 8	FV`7.W1,u)dcf?1En12[<gj>7!|ee-d.E&ISS]Ccoi)'<'p^$2$K L5}[-B%Np6@u k?E6@% )!+(\Q'B;:&|m"Xc\K,drDZT)Nu7lDhW<^f'@:2NXrA@B& 6uR;Fx|^,GJ.!P'?i1n^a3\p:O\gG0kEjf%8))<k0xT%<Bcrv-fLmoO/Jsg8$foB^zs]/~LBy\VO>]!	1NpyHfSONf>))?	9nAz*!=
S~H<-'9J}+cwwI}Hy&`{pkJ
O&@ehYo,Z32pq02|Qa8lnk6~mCAlyM9 HQS#m	)@Q<Th,3Zzn;=`qf3`;mVwv|w_f|DkI.)y0q>.B6g*m
t[y<h2X((5Xat'y 3m~@MZ	e^gAUmo 	4]qk]BhE3 NX<Z%zM[pQ#~gFQ;bqe&pMxcWgUW=-DMMj~5I1m:x@	j%,Hq~"&nO~pU^eg#E17I rq"	(Wr96)ASs,NZy)jf1Nf" 5NZ`$Wp#h)%*B(7Mr>hi&P:!L<&5#yk{I):UY& /9rK&OdWZxONuN;I9S-Rzd~v}oJ0f":8
@#[uoN*YBb\J(|N9Fgq4~+T?hH@kc9V}or1%;ai"NpH,$`x}sct {C1 ]2G|-l r(lL`Tq7G{k_JYX(BT	# i)ug%BkG0M:BE=yy(F0H9XXnk*+x3=Tq%/O*UZE !r?;M{5uGVM;cr:$= J%H[T'a>$#[5s6Cj+he5<`#(?5:6]d-!CS0xXhBoH^qa,?>(a;|nVvL`A$ Pn{W50 :/O7jQK(}]1qsv\3&<k8@Q3Q]Q/;5g.,,T*LZ$x9{.:AUOPb7?+UjKYg3mZm 5-<QgO?
NkDy	
j.:H@7X*w{
t*~ei_a-(rj:Ud%Kmu'G,.w=a\Y\ehAh\GszK	Fa+dT^KX_+&\&[Hf\DM(24	Bm4
	F:+8	.cP'q{%Nl(Df9a;g13lMSarv*o3+yhc.;)_M~}X*T79c^KjP`Faoivv;f?#r$8614YN5$8_s5YQN`AoWS<aW9I	+:ulY_$1RF7J'y##JKa.z Pa":W.s/Yh|nBcjR|4:5#%zMV)dpp2BgB\;v<vR;7@AB-4'v8R;7%w3!	i#49.4n -Mo_$ujq?:h&N0/~$nAB~tqmVXzx?f]Y~MUxc4
,;Hv %^g'j,]5jPO`P
GUp^};j7oODoY@dX;N&3ABm	LU&2/ceS5aQ?"QNM2|a"Q?A5!GGHq,9}#/%yP'zvw8Vb@g_Y`,h
)2MD3BdPD+dc2h1*{R1'M~Fg"w+@|4E>kwjf9}_nV!{6*  )3y\
2:j3q,wIM'}RaC7P@D-AM@G^hB97gs{)*e:]KXF;x^'!M_pVe4bgeBflw-mpv\Kb2AyJFUK&goQCqYuT:;y.oiIa.X(/Np-wG(_9"Ta6UM<qF7" iF|M;Rc?  v?NJ+<LjrX^K(R}+s^=0i%^X!lEuwBwlwL{:f~]cF~v^DC*?_JK){At\#v,]j{o3[/1_}o[!F(dZ!z$\6B]
xG|YtYUo0Q 7@O kT-R|I.Z9Izm%\/} f?u&jrtT=A%%E~MghSDcPO gqDWKN@qn\BF{Jaz`]_rSZ,+ nF\]g%S#!y9s2L%-4`6:&@lM=)<!VK<tP-vdgU>Yq h?$ szQi6RN@1E6J7+
G(a{Wj1Q$le,$-]u1c g.N~32(!KfkuWaSP(HrEpU0[&5YCK(}<<B7BH)osXP4VUI71[VEN\4"tE
.X^G9zodET&\3NE~;}f^cd2Jn(m@J`aYz[i6\WWO[.&Qd5A"F5[E4MX
'{kE?GrzfY7+F>zIkE~:e@*T.@(#UuHX.^X`;VyriL}a0vQYG-}h M70'LJ3*SbIrAMBSF0.xo}\},(#oe;&:` $7uB~f!o_;xLpzxggO,kc@k o1+-;-VkRK|}^d
!A-<3\zgx]lqQD"dIeAwzJl?u=*YkHp+zaIVHT4(],}.,7tC`cd>W0SyYyUBJX7=,=5V(Kp<kIMeV<ENaBcM& +UCKZ`Rs[,2$$_rk^`C)? &5yzUR;,;/%$80 sAljC38L2&)
*o04x.i 
C)'($DAvD\]5%Fq.-._@dcf+vcds	'jN~b(SI*Y0j2xa<]lSp\wN?2}^{_/qIHbQjbyhct/{%Tr-\U;T,*9uf74gDcj95'`
2+EBkFzF;M2^lep`TC++L2vfQ5Bw:)2[D|}N~<%.HJqi'nj$L(fa,$rR J`~8TklW-1Je^k7S@^+dq5UgG|29F}Am{haNJM MiHrBC#^s1f:S`vj 6RPcd/eUiGkyjC4RV%f5zv! nv/4* Ef24	EOG =0j3|*MS'pLW~6\J-&O@S.n\\A+S!,sqcN<#gc2]}IG<B=7
He9[ZT8g k+7TYpbx+^UIBzmV7>u!ccp"M.P`S5%
f0@\	4X<
9vP9EG{} 'L4T$q_QGa 8TzVS/?5 [!=xhzf^`pF)k*9Dv>h02WS)
6A4T$=yRQ[MV?n=6/6[ qsa>M
01p i^7~<
RJ`IUH$w/,:3rs5pn;3heC.{2q`.A7Mz5;+<Q|d"r@z=n1V"?2,cy/-84/q/@w 	!pUvA^I?p0=N78=WHV3
S_0'9sQMC}Cal;cn_FA,wDu#Z2fdB5H _7v`SJ`9$fk0Lh^`B$4A|<b#5MLC9]X*26{N@.UpfvB9f4%Z2eR)+o6O0B qc^`  Peqx/6:1-C}w-OrQt9.0)e#x3D+b-w&
V_&M/M:%6M>.Y^EaX|kO2Mfi*59M2,ee^t[&S1hI,A1"02GjIq4${Bcs# MAE9OqE,_4p'4015jFA3$?B}=a!5oviWU8`0m_%4VKmQDkw"u1J3S[&p,e7L"/_t<kD[(A0
b3rL!h4 HJL!<OyY4')XJDUwW
OBQkE?R	kL>oW,w_1LYQ]zf(gLg]T.6Bb4-n`uZ$5/KA1:2lbC*iV.KBEgB<jsiy+9))n*B:#nQ?)x[)p@GKXJ.;Gf@Aq={y~ToCwLX+jRfC=(r~PqRgbRU*Nd]k+N1 =
nFg_X5usLlId/8JZiH9b\h'p$	7K4P-p O.K\VGZ"8E^>G|7ydQd^w&14Hqj_]]px3mowJ<&_W^7B#kUQF~|KsYc8-]ENXU/Gmi56$z6[Hg>!v\`~<kU6aJ4TYF$@kW~:MSMLJoH)wvy-#}*
/PV7^sS9raxRbnIuHfR4dZ~V&JLvZ'm=Yb8;=}cHfy;mGr*Zt-o*YV*\Cb-4V`42M0yF_2iqioNKsIQ9h:C{v gc^:/y	atIAb=PJpV
eFOBxP<N{2Q.G{wge!>n@U X(pm1@>o"3[^QEYLfBa*{r3RCY?_%^ez^=^\:n.VU6d[tl+q]C^bQ.5+_0Pn? 
Nev7C
b9~P7jox>8&K{iS:/	TI[9!o&d[BNr`.z']j~DN%_O6#qt%wLq+fc8re7}O;[d&zKuoPaL<A
8]S OG~MzB uY W~0\$"LR:n7r[0BT3+q 1`]Nb9CcjE]^(=WCNB[u/t5SY7-<\z>.y0J+v _aS8z/Lbev7{i^VQewWC-J
2*:)|IU=fWOJB8Hs/eNX>07fmI]2q1	MnDs5X:W,>oJ@R~irB_[rAx3s,FP!'0i E6pcYk29S+pKL.2T=1I>H<~+{4a,d|=v;L6*Vo%C\erTL	[9C0Np!lQQfGk-Eosm:	^|&1B9:q_:#(U@{bN/7B0d<2TkyTd+;ehQZWlP	oh>/;sXjcc4;nv:s7 [%+	Da"B%#%@lH\lJ`I5cp +qt'A8h%TO I{NtR=F&l!izeTS~*Vy#X	\fM8Lr!).5_eFz%n>>%_G7_DI#L(a#~.~r<n&CU0DgpP+n2GabFu&b/laKHeMlx@UaXFYktuzR89 ,|H)
<q{m2`of!=.S~'y`a}nv'1tnaV,	dlJkup{&|~!!YBpBbQVPW&n
	qq~_	@ U^tQ;fm#!s=DF8+x,5~MO2c}J?6X]Y:6ylv4Hn.'.A"ghTl`=bn"q1 Rb0d>XEL ;l{#HBw,Z^zsfiZ%I=t} 9j;2*GG"xBn?sI4`1B 'I`Bogo@##Bqdd/ztrJFLV3Mz'Ubse9V^I!Rms9h9{a_oC"3Qm6:iGz>4{M%SA5k-V`\TKpa1L#xcBzbk-HN`MpG'm! iKf0-NK|,578?}9ra:pCC+9rP~h9#e}'(Xs:=b Cf,ex)8d7cuA'`<(6#@Xn50g*b'q&'3qS1?}F_	?di]xtG<nJfQUVl&9X>?!798#>`E'hX^@C_)4L&U9|x7K?Uy~4nzJ_N;u
(k!C?P h:=Io#u*|.M_Hv:[iVH7xy\)u1h|2dnTh&W!\@`#
"Xjfu>fcrG,U7
-APHD&tCf'	g	![0QN[RI"jPchk{Xk2vz,Y2-'U{[Z7Zuc2 3L}CSXJVPF6U~~01qs_a'XgE*|UwI$o5m$`ly[~ l)0,h'} J]|8"U<<]
eFV{(@%Y[bB	S"UC~PJ/ev=! VTyY4"h^"4nj^  \4^S5vqduf?ws|[TT*"1<'r2'mqQz z\q~uO{oK]
S#gPyq u	N.LlBA?o]y@^IgU9.'i56R/Xcy In-;>_TuB3]=?BCVtIGrc,XLm/#b*?$g-I8Wie`v0MU-^aL*K%j8;_6R>r~ADQ&o9T!(d0N^vq9`6B"	v"14In"_}c8PP|LX*v@%u*GvvV;Tun=
w_=V@N*7*![MAXK||*tvH)L;A=6nT7S7H\l7-i_A*	z*T1?fe4R<uR%f> (33/JKa3S7weW=!ZrmQP/"5t3-?!\- {#U,pm{(:F4k{mXW!K	EjO6<oNGA,e" Zkw>r8tFJ17C?=mH/YwBd*-N r1\%mp(*QUA6{(Ociq3g8$~QD@mHO:vX9#Q"+-ul5w "!t5:)fm!z={mm<7N)tzp WM`oyE=p~/.@%0sxjE0@KW%@
|[g_Ca"@8p5;^o7;-(}0+.$x_1. }Z7j2\@}m{QE:d` lw8VhG2CB=p|@c[:>)0c1VN#pBYRUUFRE+|$!#Eci H\j:aq/KN `>bL''s/tI=,&#,yf$z] }sjCW8`"U p\%yfSv]m^/[YzNGvgK(0P*BAO'E9rO&MN'F'UI1!H`T/ 3ceDs*m3	Cn&>myo-nIqbV'S$.	no%T$~Ps:A%M	W5 uG&vH"y<%F x#<P&"05~-#,5M"aX9$wr}@mIy^[3(_Fd)S#&$m2h$/q'-#U*%8$S| r*CI4]F41($LGp+P@y>sG$=%.+4S@W7pi$'[CUMjo!*r%H#UNUA}E8'N2Zv2byjuC />9kU9D}>-U9MM<(P
8Q.JJYEC'-gr%//L#8?!@gZ,l
G"\	iM5CCf2V^Qu/\rg*Cz>.-yj9K
Dt	fBGq,0>WU\IC92lr^Y-{b6_-NjNc9X?h<s`	4MBWa:HIB2Y3%s=d^cqF_GI^"{^e"d:=K0#7,>xC@k`P8`jKAC/W]4"_zmB"\,dFZz. !@X))qx"o@,* 7)|Rq@#3^_N_EwAJ(-P_7?=X;w{c'%s'gA[8I"<G<C{gMY%b1xH07zzK'p fsp\Pu@8ib9R>RGPTYA <(!Vz>On3)91ix,T0KMqu"e+-.%;!sj[uw
(/GUCS (N5D%'%!.$un'%PpR'aPi`TOv%pI9l Q99.\mEE?=Ek
qx|$KdR@(/n6EVZRI
brB#*cSxghW^voZK%:F(5	yYo2M&DBs5(S;oe??E V nb;HW:t| oQNyA(RJ*U<-"',y:4!+;,SpMstllc [X1$EgX~36jD;(vI% ]b<Q 6\>"U#l%Xa%T=d$	h@~+@6$f=: l
$F8OjsiWS0^SBf!-*c8Sf
OGnHNqU#1$ 8DH{[(-'wi9  2ju]Irbme/RR} ar{GJDIG+, rrgb6wA9kHF1ZiuH*5 kXGgHT8
]HWH9,~% d+^!^*XLWJa .:0 d {,la'6 -nA8D65~]R:Mrm?|K''@'(D(u~m!ls'XJ91kag4Awl&h67j^av "9Y{y;Gkk6%8{0PsACy'o~dxK*E9"&hhbKwty3AJ9>Gu*;Hkbh5"h[CE8h,6>2]Y!zlP%F'|Zp5#.k=>Nh?
qh{@'+~3U$4Zk9| 
5 Bc=i>/qfdQ=;r]y=,TQAlKRKx":\
{XtJ5;U5h+3Gf>I+h7FAh5O~yMr.UWK`#z'EzQeThgw%w8rAlF2heL'ga5AU;|[[2z-Gn#]qT2rh&G-/NM23I Rx?Al4jYsE?b*F&UL\jVAz6:D{ pMV[ &~=.<o^suy[DM LM	VzpL~R"J0%m
6e/SH0T534pI.&0 ei\@hB;B)Rv3`x2K!-cOhI{]K%Drs!uw[!_I+o;"Pft6X43b@LRZK*tjA31]] h\;)-:6w[x*t[mv(t6 A[l|{du6BWgAym6[r\o,`gt[ AA	IhTObC,^2%L|RJ7/2f}6':Q! i`[/qZw*$?c/l,&Ud4D sx=>dftG?:yU [4 D#
[,QN|(%D#/$b'*Te'eFMjdGPqZ:uCDetQ@uT#@kM !	(r^0Gj91JJ)mvI|}Zm+Pgp^@R;2[+gd1rFWGU.)\`
xLJdg/~j^*I$:aW'eabfO@?Fb,CWSQ{K]hk1) $C+),B{}+>r.;\jK_IZfSve%Au$&U3+&I=igx~	`4uGAK<Gw35t%$I_y	j05SF! xa`bm)1qB>7q/?B!d3[62)p1S$}Jzz?K8"{Kg3}A[\Sh	<1N"l3!MxtmDFuQ6	seR0 v
} ldQQX<g.4!mZj,JxlNAf(`z\*k#`?hTsxdfte@uFVUkqa Vsn&~Jo^y6;grqC*>AW ZHg;^"Y~js)!c$O"Dk}0q"_l.'+iK2`p%bh MU9=kgBifq #6Eet|G2.?S+Db([,?<[}Wa5l, x, sT?H4~']wbyY`uy2Nzn^!=&~j6 XIQc GK9]B=Dda90J~hgB7+9/1Wt/cU090;'Hv]n:~d9@c0%dZg%5!y1RFusupm{-0Y\)cs;NO{-`l#PO`8Jq'-%f}"'mp^\8Y;Ka<`#FU}vb<SF1/OMu@qQa.MH}+1P63QXx82,FYMNNKH,3"+R0,sy?0'S4NyJ[%2\&'d@2 7dbX].%3htv%Zt ZxqjZ=[xLdl#Y;Z2T,d')8x%$ZHdN+P<-3y7R*n"3X.&MGWl	~cOn6005*C<```oXP|+9 0mG(\7BM.
>*8]BzFWCH	`MYiQS'.Jpb`:d4SA{A7x8rX]NJ^K nV!("A7F	@ctOa+cuKMn7xK])eq!N&8/F7&RF$zX
#HHG5KbP&G&~_ZK2V#|,LyX~uyhYA^nDZ+	,a\2+ *R#n+5"<zE tIq?X|[-hEF_z]YP))ZpJocyLV	e40GPZ4su\rG v&+rf.^kVbhEb yw,J:[J3JrC{n"^j.%Ui\h>Gc*n3B}Yy{6payaaq2wr%sW*MlzvS|  ') "m'"$:r#`6:QxY^5>9!]!;`kFavgA04>M?no;KQ"R(-?}	 $.'I!7M{vK%t>HL}"	\}F:l}bSz/&(1~'!ajt>!5aH<?p|)|Wn7cbORE>U8bC"*AGZ1e>Fe93^'\*Hiuys`EM|0R	6OeW
'PZ5C]%`$R&8>ax_	1_&?cL&u3eS+Ew-),/8)?T`3A#y^\-H;6oK\sN|fBYlHHNW	`_yP@/9%4
02%	'dJEw:*O?5>j,toX^cQYx7`UOv6G4U1q=e|*`y<hO2V,m]"Rxpk@Fk95ot1A[FHz[6+	G		UN[F[0s7ox ErBAY7q,2X*X"N\kiJos+ ]_Y_ax!7(3a$36JO>'0H7VH$9Q?Xr}1A)Bcz]vw14OME*f=
])]/Mlr-+|&K:E~1=.+)H*ECb)qj4p:Y"lnVBGn4`'m/$>SN60;gJwjHq;'"*1'X!%}i-_.Jkow); G#`z<A+MMS>N]"SbaBu)Z s+6oA~h,w`Gq&tpMyTuh96pnH*_\gwG4fm(x%"a \m\d	Rr'e3I%Un8eHtfP7.$.$llQ=%
QeeB.vqUO\sl$2p<&=IY1l	<NXIxV
k[bVNCG2WtTR&e.1[)PVq zT[6PZvj7;hFZ6uqAGpv0;N7<;+d=^Mw~o`4f
 ,6Ae0a/~n) V:_rbnbN+|JFZM/`f kA4OiN:@20QfjBg1y 	&b!dJ	PO<m[B$;LG4J1s\}A[=dmUF<l Ntdnb	
m7+j1JDKjS|U4v`SFEhO3 ',)n!`JH)"+qX`"?csw*nBc>{H KJV/F 836-p YF
TbL'r*;I%z6r)3B)Q%xJy~vnM8Ff|X.oagG;2Jn1{Ap.5hcu\is$q@d10GA{_%rL>&U#-+MyXf1H0yQZ\78ZR-b}rh\ `H6[M>8&zv-U93-h/\r{gk%x*6K3K`}+{(~Q*Cj-_>((yVP_h91y63xl|QG8Z^4@vjgyG=s2 *,0KCX,%Xg1#~)FEop'z,o= 9]s
!aVY"XcT	oRJceyYGhQxW= tO'TcR|!Lnefdo9>wxFjR0k$@$	YaEB-j8{=6f}DKs:BN2v&d.	oO{*ys
=*%NejP[1Neu0y)EQ9y=Ak*vb0p\$Bva2!=1FAN6zg<rX7+([E |wZuLxq6aYOE$cd{]&s~Ir-cS+!Y
7?r:PY yQn$!$i 2l*)n%8:87/2$61:lLwc.f. b>FYP!W/>==cs}m>7l"5FZY0@Hz4-1*BlA%Q,AX562[?\^6$U|)|*K)0vLC;7T(|51n}_RsqKi.V3bMuBO(cRdQNp"i'y?tRK8=@UmgQJ^MM| "^K(D&Yd.1zVLF2s3F$!|St!}0N6[s/6#O2g<f.#AP4tn/\gaD=Ko0}JR_p*y'qD1!]*Ner
mN7T2B(<0stPjAmu1G`(gT\A;s%4/{@n|9bO6rS]19q=vRsa(S;>]5^)Ml~j`%Uw9|&%?%/g{_c9e R{Vi'zm6-?2[T]ok:jeMI!tS!D_Z^_<Xv +1.Vi/'\cO+'!-V`By3ySbHVb>~Kp^::up25\n_3lO*mNL2WDuxg-UmC%96rnRV/#WkPdJm
6;3$ae#Md<fpY3p{8 S<]>h=4pUzz$Z<OwFe03)JD[bZV-*~Q$,X@+>q\;y*		s|r3Pz54{X;ycAHl1c:xpbL"HfQ$KGbhJh:2aQo\T6+*+xW=GP-Efx&*]!,6Qz^dy,qb	*|fmO xSn5Dh-A~c}+VX<gB/LV
>d-iw>0v'qJ>GKv2`V}snM"%j_a9YW5{eU:2M-Y0;>Ix-b)!y@*]9+?Mb*PjDOE9}b
9&N4w%I{74WC56[du{n<vQV\8	GGqRkk<A"<`_j,8 a*) )w*=qGbofz%AA/%7~MM+q2VGgsiXpKs\uA!y.)%} 3+z
(fM"
Hh<SNPB35Kv< ^
)erBAZGW'H#1s.X L.*^?jn\?S-ERtfJG%iWLzBS]&8]?Rd['?McW';,$%)xxIi+j=`BYM<b,?.is%rU$miT.%gcb57Y@2rWA.Cg;.S?%tH?UrZaOYO4_^e(JA!yyyfI:9/hs,9E/z~'luy=$0qNjAN<YwXx,v+	[_16Wt
!E_wnEHo|MK3q8d(\/NAKt]]"|EfZ\P4jaB@+zdXTT^(iIZ#N (rp?F!U_ #L*7'<LaZy1YDi!eTx/q[<w0M~4+wOA|XUeu4ty@bU[e:l	*eIqrXsJk5_{Rrk=J57oz!4LT9
vy n<"[tgf>gWStCK4%W`w\JdDd(ep>9
KX2ZVbtgCqO$: wC*l4ibA%zs|ZZjqsT_a&s20Y6#yhWg%sf?F\u*Y{B19,m*@5R"y|(y
\T{DY";&`E'z]17" Nv9H~GkSdLL@x^ze)~{aL23+:?rxk^:<K[?
y3$EE Wcylb_n*e\">Z'5Sf CGR8rKrS^]|\pwn5,KJ*m8&oRNABYo 0r~ ghU>&YV4Fe1oO1/C_,TqEAN@w-w2V7
'HWX;o:MiL)?`BPCn\]P0 =d"tMM~\7wmu7hS~x;82S.sm^>9tN0B:uwt c&}AQ6)CWC!a`lw`7X<[{QMR]`e-|1g'V(0.3YDr+uCK=E]v'&lUAKG
$qTy?e+y	0nr%EhB3[A.)Stwq1sIZo|b6j#TP_jibTlEOx`ta3l>y j8.%Om`(k."NnA?xRB"ldZm@,d6mpSqK"mL%jf nT?wV""['uXpw{")^
65u0nQr'p(duL}sZ=	".'D.t*Je]rmf:}kd`[Xl&AOe#k}vw
V<GK	w!{f pPD Uc&'9Z>}]R|EL6.?P`j>(
k}*t%v$IvZ*mav2rRsoY{4o	)_Xo(.g,}"[V	dJlD1@|?d7#l+~<Vm!=%bK>m ;>CwU}9g)f&MTrWHZ=o2ci8LO4tu\kG$F4C77:J-o3{ Q( <U/ X]#x0.|P"(y	`b #\oqow//n=sq4HP`S@`z[_6<up"&JAJDGi:057	l3?+b
N X*}^,TJE7;Tqf%R<yRoe>_6i0&3$GULgb"s~-5a]-GT{8C,#4rc@\aO]1u4 y=D{|X1 Y 		
<6=)L&J_{5aP,MJ|Y	zYuG+7-0dF
*Vt.#QGr=i[,&1ckb-
UYO3Cmtd8~!C5'/b{(vbaQ)M9zQ& C+	<$fro;u-CYJ$KKN>LsJQL7i4eX#IAG#{4zWTmP9M'M7&(EE<PN &35;*,e'@2U/%E,:F
MaZ"e3*|	s/UG+I(MHFA%g47f)ixF3a JX-*$"+vV7[Cnc4y3GCPLlF;>UJ9icizU[DDLM5g6+;2&h8I2:-mA,hd& p"_,qPY~}c'-KsRzO:${U(S h=	++XGhTr1%Rq 5?Bar(F_9$<Oa/dW_w*(&	 >OH,lPD=
\6X S$_Esi@[Cnh:rK/&O 33eZgHKnf8gtMkX6WQ'e*v(,OaO$
nb]:H .!G<=~pl6()g"F&ggOz_wG:RFcd9|{;.8z}b_S:%ebLg&!3?Lp3}(`		tzUic  -g6LA"[5'B@Cv3p9	 4(9+lAaN)v1j Bq&~|(mI&JK$"'xQ3uq(F6osU4F:_K6Xr7uzDW5 "c{f)3eyR]-a~JGe^t)-7$R1J@9gL!y}22D_"u}iy>kE5r(clym&.OM80CE0sZ k?fS!uB~ 5!ea=+6 7eZ|Gr "KoP6a~i@ 0O`Y0'#`v2|)F|LF4XWEyu`s_wl3V\W	4R]rKcne!lC[$Ft1]iW}TQeVsVM8sZQZ3dk<cYTcWx8Q"QHOe:NJDN&N`qLjOn$=P[1'=
:m&CffX'!W:8
eM#-|NSac^FZ=*iP1iOtY/hl`mTWYS?,62]
NjoCf+o%?64J>$q{\Hwss	,;"{Xx "n@s&c'V;viKlB9oA[*QIq[S3so*];J]mQ=]#-echfH N^hsugTM'UR4DS )5X".~/W'kd0JCFc?w2<I'pp#D/lYh06e;
S_-\tg:oEeY$!y^,] +A:GAp.,Mz<4*3spo@zxW#$H}m%9C(~7'LX8~$V%orVy;QH	UZd3.yCikG2xQOJn9;N	{bW-J0'G(f]CCAc%~3`HoTFy9&fri1co_S72xVr$\4mBD"um2N6En^M:RPe{*q`$Zy^Fs2Z|;z_zm/_o)15suR@5^u6#-V#0[,OR5QG6fbAL//x19E;PP,63cPKWu{#TFIcW4j:h{G;lh=8SfaA<kr<|~9);`AW'u3po#b`S7N,JK-3+g]/@5S8]dP	H*P8lK\hO`j;W,p=<<x[Y[.Q=a~7CUXr#tp3QOSMnxS(LA6D
ImsQZ	".]P476JD+b:B8
k|Ul`1[T9P@V\J0HAf@'%?zd9uE4$OUB.*)U$Yx/@c)0PVc#)VqYh>(F'YB:YqzS/CtV~SG`x$wvcM KD<WBI[Ol,7IOeT^vw zHv%~r9q'xu81H{(k:V<{M7A;v_#/R65T=zb4v0`2\en2sykaj4{H1PsBX,-(^aa.BjiP&[@@^lTxmL%Az(lE<$Nundl$f1W~l4&oe^{R&)}b~w{U	a? WFl.W{6[]._tt;.NO}p-*O+;NFk<9EXMfg#aE 7VOF$#*	8uN~;:]}7h1awt
\#wSWq,7J~I	TI]7$#@	Cq'
cF9vudx2$WXO~(Z}|)OL!.M`U{ZCYdLzSkO;\r7M3kbJ^$:`Le;<N-wk+$18ydRLX\6KRVS"Q_;\T3d+r5NGCl<D*Fcbl''\'_J W Ta7G+6VK|R,3*O7)^4PXE-r	$klJ4Vmi5#`{bt+Y kEmIcL*Ss	3n42O	"^ol'+vF.g;]@qyvvo5|v79?: [^4P)/x~QJ7f_PJcTb#E[`+)C|ShN"pnit'8D/XT,[PS5
1Rb).%UxRjk50ejKXBL9V-	ZMScIIHA\}3!K3{y=yFcX"^6lV>Wz(7`a@_X-kmI5a"e(`CDhwJ *sG,(]2^lkF$);~+zl8'	}V_&fo2;]OWP	$mM6m+`TEB pTCF5G%xL_k/w%IX:Kn~\jM4)$$'ztVt@`[#6[qU{VXds/9Mf-h&2G	`3XTA-{1e$(2w"]U`dxp~wRFk\WsXkC=aTuIA3[8WX]+3
G
I{Y
e	AQ!YP
x=HLTzTKbj+O8'IOYt[) &ylWl(}kU($pf<42'[})MZ"!Xo~']_]7wiH[m[63*)H19['?3L-z&<$&$H ]V\U2J]Gah(1gSUZVh	<"38sH66 Q[(EI)hl7D}bGGkCd]>X%J770.{PZ!XJ:+IQ{5,N_b}	`;!'gS
[] _H9o`uBt-?v/?[T<.qnfNu	#LRU
0v+-Q+!|ebgH[*u b&Z4j[=x?<@A8 rO+UNVXv@oq/5
zi`<By!I X3#UJnym:1bls7(nM}0B3DUGyJG3JajG(M7pjQ@i]C^'Od.mD
(o".c?]l&Zg6A+(A`PnS2G(K/asW}+Td,$*OQ^3{8#Hx1=[!Cs]MN	XG7
WTKoDr1oSb )Q=$B 0DG{{IB<|f/\v*Ndw<A-]z$GsgGTx2<tao4hJ9fFpnX?6vm[g]YQ@#l,	T],e"f#ZD;pX`	WTYBfGMa(JN8A+|uzP00>d)0=5!]#(a]L^QU%	f~(oq6B^m';HG`<>^+M1`}%X1C<$jIID=)!n+hM`z43,W9Zed^,xKuiu`!gk<Y5urSCOnjZQZM`\NrFi~+L,6'YtD~gUd	AcL6>FCG+`,7}?l"Oa0K	OHiU?aU9JLKdNkJxB[Spa>wP~Bkp $gQ5u]tGs$ZF?JMTJ"mRjf;P8IoVHS~=n@$sd&fbF3OVK9eUhMr~28V6J4B{Hd~znLPw28>'P={ h 1m"kv.s}W
eT5UNHX1  o-TI+ R3J)@@'<z}@2g6^KgmD%`Y0}9`NId6b%i2l*|T@h<}EHfcZ;o	P}+ykfLa[~M
l)R.=7&yE	7WW^vGvf%}H9^ ~ib`k<
80HK{5	r+GMbQ	O~Dlu{9j A'A}	)n/62+&HD(VO|S]pqS~(nsgsU7z?S*)xiTo+_O	Uc$0?lpN|caZ^%VX7JOpNyu, !: MMHY6.
AQHj3,tH#_?ved.^z5]k!y(?7^kLBb}Oz~[]4*kj[Omi#KQ0 mqI\x6-[nz\i3_'30D"IXiRwi!,aAU|Mtw7,(-RDJ*M2^:MID6_gkVQ^#PE)HP0@V3!jKwe;PeQG'F B	WqM?QNS%50Syv Z~+Dc)|,E=[#3#Ck"
m|HrgfH}\Xy/s6VDxAvzO|~C^!oQKxs(o2:AQcyE_	=4z%FiU	ZGqh"VQ_%B.q@hp@R29Q%OcR"i|HbG.}=W
3lSH[u-8A+B@CVuOCoiO=:/inh;zRO)Z,1P#+35gp DLu8(*vVxa\@Hh<V>!\>5c"ezzDLy_o`a1!G9	DF3retvU]=Wx_N5*xw$}^x4_Key#61UXpsgVyW*V/8X'2CHhLmWaiY xK*B9n+/p~4-=EnY'OyWO!y?*^%1Q`B%WBlcJl %Mu	+Cl[X+
UNXx7#v|>w]/$}3r.Z3>K !rGjzq ~v{{bCHdrfKX28V=I+t/(0c1!SPYv	N>[%yH*q_ o/@bPvd